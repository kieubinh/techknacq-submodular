{
  "info": {
    "authors": [
      "Jianfeng Li",
      "Haifeng Wang",
      "Dengjun Ren",
      "Guohua Li"
    ],
    "book": "International Conference on Computational Linguistics and Annual Meeting of the Association for Computational Linguistics",
    "id": "acl-P06-1126",
    "title": "Discriminative Pruning of Language Models for Chinese Word Segmentation",
    "url": "https://aclweb.org/anthology/P06-1126",
    "year": 2006
  },
  "references": [
    "acl-C04-1081",
    "acl-J05-4005",
    "acl-J96-3004",
    "acl-P00-1073",
    "acl-P02-1023",
    "acl-P02-1038",
    "acl-P03-1035",
    "acl-P04-1007",
    "acl-W03-1730"
  ],
  "sections": [
    {
      "heading": "Abstract",
      "text": [
        "This paper presents a discriminative pruning method of n-gram language model for Chinese word segmentation.",
        "To reduce the size of the language model that is used in a Chinese word segmentation system, importance of each bigram is computed in terms of discriminative pruning criterion that is related to the performance loss caused by pruning the bi-gram.",
        "Then we propose a step-by-step growing algorithm to build the language model of desired size.",
        "Experimental results show that the discriminative pruning method leads to a much smaller model compared with the model pruned using the state-of-the-art method.",
        "At the same Chinese word segmentation F-measure, the number of bigrams in the model can be reduced by up to 90%.",
        "Correlation between language model perplexity and word segmentation performance is also discussed."
      ]
    },
    {
      "heading": "1 Introduction",
      "text": [
        "Chinese word segmentation is the initial stage of many Chinese language processing tasks, and has received a lot of attention in the literature (Sproat et al., 1996; Sun and Tsou, 2001; Zhang et al., 2003; Peng et al., 2004).",
        "In Gao et al.",
        "(2003), an approach based on source-channel model for Chinese word segmentation was proposed.",
        "Gao et al.",
        "(2005) further developed it to a linear mixture model.",
        "In these statistical models, language models are essential for word segmentation disambiguation.",
        "However, an uncompressed language model is usually too large for practical use since all realistic applications have memory constraints.",
        "Therefore, language model pruning techniques are used to produce smaller models.",
        "Pruning a language model is to eliminate a number of parameters explicitly stored in it, according to some pruning criteria.",
        "The goal of research for language model pruning is to find criteria or methods, using which the model size could be reduced effectively, while the performance loss is kept as small as possible.",
        "A few criteria have been presented for language model pruning, including count cut-off (Jelinek, 1990), weighted difference factor (Seymore and Rosenfeld, 1996), Kullback-Leibler distance (Stolcke, 1998), rank and entropy (Gao and Zhang, 2002).",
        "These criteria are general for language model pruning, and are not optimized according to the performance of language model in specific tasks.",
        "In recent years, discriminative training has been introduced to natural language processing applications such as parsing (Collins, 2000), machine translation (Och and Ney, 2002) and language model building (Kuo et al., 2002; Roark et al., 2004).",
        "To the best of our knowledge, it has not been applied to language model pruning.",
        "In this paper, we propose a discriminative pruning method of n-gram language model for Chinese word segmentation.",
        "It differentiates from the previous pruning approaches in two respects.",
        "First, the pruning criterion is based on performance variation of word segmentation.",
        "Second, the model of desired size is achieved by adding valuable bigrams to a base model, instead of by pruning bigrams from an unpruned model.",
        "We define a misclassification function that approximately represents the likelihood that a sentence will be incorrectly segmented.",
        "The",
        "variation value of the misclassification function caused by adding a parameter to the base model is used as the criterion for model pruning.",
        "We also suggest a step-by-step growing algorithm that can generate models of any reasonably desired size.",
        "We take the pruning method based on Kullback-Leibler distance as the baseline.",
        "Experimental results show that our method outperforms the baseline significantly with small model size.",
        "With the F-Measure of 96.33%, number of bigrams decreases by up to 90%.",
        "In addition, by combining the discriminative pruning method with the baseline method, we obtain models that achieve better performance for any model size.",
        "Correlation between language model perplexity and system performance is also discussed.",
        "The remainder of the paper is organized as follows.",
        "Section 2 briefly discusses the related work on language model pruning.",
        "Section 3 proposes our discriminative pruning method for Chinese word segmentation.",
        "Section 4 describes the experimental settings and results.",
        "Result analysis and discussions are also presented in this section.",
        "We draw the conclusions in section 5."
      ]
    },
    {
      "heading": "2 Related Work",
      "text": [
        "A simple way to reduce the size of an n-gram language model is to exclude those n-grams occurring infrequently in training corpus.",
        "It is named as count cut-off method (Jelinek, 1990).",
        "Because counts are always integers, the size of the model can only be reduced to discrete values.",
        "Gao and Lee (2000) proposed a distribution-based pruning.",
        "Instead of pruning n-grams that are infrequent in training data, they prune n-grams that are likely to be infrequent in a new document.",
        "Experimental results show that it is better than traditional count cut-off method.",
        "Seymore and Rosenfeld (1996) proposed a method to measure the difference of the models before and after pruning each n-gram, and the difference is computed as:",
        "Where P(wi|hj) denotes the conditional probabilities assigned by the original model, and P′(wi|hj) denotes the probabilities in the pruned model.",
        "N(hj, wi) is the discounted frequency of n-gram event hjwi.",
        "Seymore and Rosenfeld (1996) showed that this method is more effective than the traditional cut-off method.",
        "Stolcke (1998) presented a more sound criterion for computing the difference of models before and after pruning each n-gram, which is called relative entropy or Kullback-Leibler distance.",
        "It is computed as:",
        "The sum is over all words wi and histories hj.",
        "This criterion removes some of the approximations employed in Seymore and Rosenfeld (1996).",
        "In addition, Stolcke (1998) presented a method for efficient computation of the Kull-back-Leibler distance of each n-gram.",
        "In Gao and Zhang (2002), three measures are studied for the purpose of language model pruning.",
        "They are probability, rank, and entropy.",
        "Among them, probability is very similar to that proposed by Seymore and Rosenfeld (1996).",
        "Gao and Zhang (2002) also presented a method of combining two criteria, and showed the combination of rank and entropy achieved the smallest models."
      ]
    },
    {
      "heading": "3 Discriminative Pruning for Chinese Word Segmentation",
      "text": []
    },
    {
      "heading": "3.1 Problem Definition",
      "text": [
        "In this paper, discussions are restricted to bigram language model P(wy|wx).",
        "In a bigram model, three kinds of parameters are involved: bigram probability Pm(wy|wx) for seen bigram wxwy in training corpus, unigram probability Pm(w) and backoff coefficient αm(w) for any word w. For any wx and wy in the vocabulary, bigram probability P(wy|wx) is computed as:",
        "As equation (3) shows, the probability of an unseen bigram is computed by the product of the unigram probability and the corresponding backoff coefficient.",
        "If we remove a seen bigram from the model, we can still yield a bigram probability for it, by regarding it as an unseen bigram.",
        "Thus, we can reduce the number of bigram probabilities explicitly stored in the model.",
        "By doing this, model size decreases.",
        "This is the foundation for bigram model pruning.",
        "The research issue is to find an effective criterion to compute \"importance\" of each bigram.",
        "Here, \"importance\" indicates the performance loss caused by pruning the bigram.",
        "Generally, given a target model size, the method for language model pruning is described in Figure 1.",
        "In fact, deciding which bigrams should be excluded from the model is equivalent to deciding",
        "which bigrams should be included in the model.",
        "Hence, we suggest a growing algorithm through which a model of desired size can also be achieved.",
        "It is illustrated in Figure 2.",
        "Here, two terms are introduced.",
        "Full-bigram model is the unpruned model containing all seen bigrams in training corpus.",
        "And base model is currently the unigram model.",
        "For the discriminative pruning method suggested in this paper, growing algorithm instead of pruning algorithm is applied to generate the model of desired size.",
        "In addition, \"importance\" of each bigram indicates the performance improvement caused by adding a bigram into the base model.",
        "1.",
        "Given the desired model size, compute the number of bigrams that should be pruned.",
        "The number is denoted as m; 2.",
        "Compute \"importance\" of each bigram; 3.",
        "Sort all bigrams in the language model, according to their \"importance\"; 4.",
        "Remove m most \"unimportant\" bigrams from the model; 5.",
        "Recompute backoff coefficients in the model.",
        "1.",
        "Given the desired model size, compute the number of bigrams that should be added into the base model.",
        "The number is denoted as n; 2.",
        "Compute \"importance\" of each bigram included in the full-bigram model but excluded from the base model; 3.",
        "Sort the bigrams according to their \"importance\"; 4.",
        "Add n most \"important\" bigrams into the base model; 5.",
        "Recompute backoff coefficients in the base model."
      ]
    },
    {
      "heading": "3.2 Discriminative Pruning Criterion",
      "text": [
        "Given a Chinese character string S, a word segmentation system chooses a sequence of words W* as the segmentation result, satisfying:",
        "The sum of the two logarithm probabilities in equation (4) is called discriminant function:",
        "Where Г denotes a language model that is used to compute P(W), and Λ denotes a generative model that is used to compute P(S |W).",
        "In language model pruning, Λ is an invariable.",
        "The discriminative pruning criterion is inspired by the comparison of segmented sentences using full-bigram model ГF and using base model ГB.",
        "Given a sentence S, full-bigram model chooses WF as the segmentation result, and base model chooses WB as the segmentation result, satisfying:",
        "Here, given a language model Г, we define a misclassification function representing the difference between discriminant functions of WF and *",
        "The misclassification function reflects which one of WF and WB is inclined to be chosen as the segmentation result.",
        "If WF � WB , we may extract some hints from the comparison of them, and select a few valuable bigrams.",
        "By adding these bigrams to base model, we should make the model choose the correct answer between WF and WB.",
        "If WF = WB, no hints can be extracted.",
        "Let W0 be the known correct word sequence.",
        "Under the preconditionWF ;\"-WB , we describe our method in the following three cases.",
        "Here, full-bigram model chooses the correct answer, while base model does not.",
        "Based on equation (6), (7) and (8), we know that d(S;Λ,ГB) > 0 and d(S;Λ,ГF) < 0.",
        "It implies that adding bigrams into base model may lead the misclassification function from positive to negative.",
        "Which bigram should be added depends on the variation of misclassification function caused by adding it.",
        "If adding a bigram makes the misclassification function become smaller, it should be added with higher priority.",
        "We add each bigram individually to ГB, and then compute the variation of the misclassification function.",
        "Let Г′ denotes the model after add",
        "ing bigram wxwy into ГB.",
        "According to equation (5) and (8), we can write the misclassification function using ГB and Г′ separately:",
        "Where PB(.",
        "), P′(.",
        "), PΛ(.)",
        "represent probabilities in base model, model Г′ and model Λ separately.",
        "The variation of the misclassification function is computed as:",
        "Because the only difference between base model and model Г′ is that model Г′ involves the bigram probability P′(wy|wx), we have:",
        "Where n(WF, wxwy) denotes the number of times the bigram w wy appears in sequence WF .",
        "Note that in equation (12), base model is treated as a bigram model instead of a unigram model.",
        "The reason lies in two respects.",
        "First, the unigram model can be regarded as a particular bigram model by setting all backoff coefficients to 1.",
        "Second, the base model is not always a unigram model during the step-by-step growing algorithm, which will be discussed in the next subsection.",
        "In fact, bigram probability P′(wy|wx) is extracted from full-bigram model, so P′(wy|wx) = PF(wy|wx).",
        "In addition, similar deductions can be conducted to the second bracket in equation (11).",
        "Thus, we have:",
        "Note that d(S;Λ,Г) approximately indicates the likelihood that S will be incorrectly segmented, so Δd(S;wxwy) represents the performance improvement caused by adding wxwy.",
        "Thus, \"importance\" of bigram wxwy on S is computed as:",
        "In case 1 and 2, bigrams are added so that discriminant function of correct word sequence becomes bigger, and that of incorrect word sequence becomes smaller.",
        "In case 3, both WF and WB are incorrect.",
        "Thus, the misclassification function in equation (8) does not represent the likelihood that S will be incorrectly segmented.",
        "Therefore, variation of the misclassification function in equation (13) can not be used to measure the \"importance\" of a bigram.",
        "Here, sentence S is ignored, and the \"importance\" of all bigrams on S are zero.",
        "The above three cases are designed for one sentence.",
        "The \"importance\" of each bigram on the whole training corpus is the sum of its \"importance\" on each single sentence, as equation (16) shows.",
        "To sum up, the \"importance\" of each bigram is computed as Figure 3 shows.",
        "1.",
        "For each wxwy, set imp(wxwy) = 0; 2.",
        "For each sentence in training corpus:",
        "We illustrate the process of computing \"importance\" of bigrams with a simple example.",
        "Suppose S is \" 这 (zhe4) 样 (yang4) 才 (cai2) 能 (neng2) 更 (geng4) 方 (fang1) 便 (bian4)\".",
        "The segmented result using full-bigram model is \"这 样(zhe4yang4)/才(cai2)/ 能(neng2)/更(geng4)/方 便 (fang 1bian4)\", which is the correct word sequence.",
        "The segmented result using base model",
        "(cai2)\", it occurs in WF once, and does not occur * in WB.",
        "According to equation (13), its \"importance\" on sentence S is:",
        "For bigram \" 更 (geng4) 方 便 (fang1bian4)\", since it occurs once both in WF and WB , its \"importance\" on S is zero."
      ]
    },
    {
      "heading": "3.3 Step-by-step Growing",
      "text": [
        "Given the target model size, we can add exact number of bigrams to the base model at one time by using the growing algorithm illustrated in Figure 2.",
        "But it is more suitable to adopt a step-by-step growing algorithm illustrated in Figure 4.",
        "As shown in equation (13), the \"importance\" of each bigram depends on the base model.",
        "Initially, the base model is set to the unigram model.",
        "With bigrams added in, it becomes a growing bigram model.",
        "Thus, WB and log α B (wx) will change.",
        "So, the added bigrams will affect the calculation of \"importance\" of bigrams to be added.",
        "Generally, adding more bigrams at one time will lead to more negative impacts.",
        "Thus, it is expected that models produced by step-by-step growing algorithm may achieve better performance than growing algorithm, and smaller step size will lead to even better performance.",
        "1.",
        "Given step size s; 2.",
        "Set the base model to be the unigram model; 3.",
        "Segment corpus with full-bigram model; 4.",
        "Segment corpus with base model; 5.",
        "Compute \"importance\" of each bigram included in the full-bigram model but excluded from the base model; 6.",
        "Sort the bigrams according to their \"importance\"; 7.",
        "Add s bigrams with the biggest \"importance\" to the base model; 8.",
        "Recompute backoff coefficients in the base model; 9.",
        "If the base model is still smaller than the desired size, go to step 4; otherwise, stop."
      ]
    },
    {
      "heading": "4 Experiments",
      "text": []
    },
    {
      "heading": "4.1 Experiment Settings",
      "text": [
        "The training corpus comes from People's daily 2000, containing about 25 million Chinese characters.",
        "It is manually segmented into word sequences, according to the word segmentation specification of Peking University (Yu et al., 2003).",
        "The testing text that is provided by Peking University comes from the second international Chinese word segmentation bakeoff organized by SIGHAN.",
        "The testing text is a part of People's daily 2001, consisting of about 170K Chinese characters.",
        "The vocabulary is automatically extracted from the training corpus, and the words occurring only once are removed.",
        "Finally, about 67K words are included in the vocabulary.",
        "The full-bigram model and the unigram model are trained by CMU language model toolkit (Clarkson and Rosenfeld, 1997).",
        "Without any count cut-off, the full-bigram model contains about 2 million bigrams.",
        "The word segmentation system is developed based on a source-channel model similar to that described in (Gao et al., 2003).",
        "Viterbi algorithm is applied to find the best word segmentation path."
      ]
    },
    {
      "heading": "4.2 Evaluation Metrics",
      "text": [
        "The language models built in our experiments are evaluated by two metrics.",
        "One is F-Measure of the word segmentation result; the other is language model perplexity.",
        "For F-Measure evaluation, we firstly segment the raw testing text using the model to be evaluated.",
        "Then, the segmented result is evaluated by comparing with the gold standard set.",
        "The evaluation tool is also from the word segmentation bakeoff.",
        "F-Measure is calculated as:",
        "For perplexity evaluation, the language model to be evaluated is used to provide the bigram probabilities for each word in the testing text.",
        "The perplexity is the mean logarithm probability as shown in equation (18):"
      ]
    },
    {
      "heading": "4.3 Comparison of Pruning Methods",
      "text": [
        "The Kullback-Leibler Distance (KLD) based method is the state-of-the-art method, and is",
        "taken as the baseline1.",
        "Pruning algorithm illustrated in Figure 1 is used for KLD based pruning.",
        "Growing algorithms illustrated in Figure 2 and Figure 4 are used for discriminative pruning method.",
        "Growing algorithms are not applied to KLD based pruning, because the computation of KLD is independent of the base model.",
        "At step 1 for KLD based pruning, m is set to produce ten models containing 10K, 20K, ..., 100K bigrams.",
        "We apply each of the models to the word segmentation system, and evaluate the segmented results with the evaluation tool.",
        "The F-Measures of the ten models are illustrated in Figure 5, denoted by \"KLD\".",
        "For the discriminative pruning criterion, the growing algorithm illustrated in Figure 2 is firstly used.",
        "Unigram model acts as the base model.",
        "At step 1, n is set to 10K, 20K, ..., 100K separately.",
        "At step 2, \"importance\" of each bigram is computed following Figure 3.",
        "Ten models are produced and evaluated.",
        "The F-Measures are also illustrated in Figure 5, denoted by \"Discrim\".",
        "By adding bigrams step by step as illustrated in Figure 4, and setting step size to 10K, 5K, and 2K separately, we obtain other three series of models, denoted by \"Step-10K\", \"Step-5K\" and \"Step-2K\" in Figure 5.",
        "We also include in Figure 5 the performance of the count cut-off method.",
        "Obviously, it is inferior to other methods.",
        "First, we compare the performance of \"KLD\" and \"Discrim\".",
        "When the model size is small,",
        "such as those models containing less than 70K bigrams, the performance of \"Discrim\" is better than \"KLD\".",
        "For the models containing more than 70K bigrams, \"KLD\" gets better performance than \"Discrim\".",
        "The reason is that the added bigrams affect the calculation of \"importance\" of bigrams to be added, which has been discussed in section 3.3.",
        "If we add the bigrams step by step, better performance is achieved.",
        "From Figure 5, it can be seen that all of the models generated by step-by-step growing algorithm outperform \"KLD\" and \"Discrim\" consistently.",
        "Compared with the baseline KLD based method, step-by-step growing methods result in at least 0.2 percent improvement for each model size.",
        "Comparing \"Step-10K\", \"Step-5K\" and \"Step2K\", they perform differently before the 60K-bigram point, and perform almost the same after that.",
        "The reason is that they are approaching their saturation states, which will be discussed in section 4.5.",
        "Before 60K-bigram point, smaller step size yields better performance.",
        "An example of detailed comparison result is shown in Table 1, where the F-Measure is 96.33%.",
        "The last column shows the relative model sizes with respect to the KLD pruned model.",
        "It shows that with the F-Measure of 96.33%, number of bigrams decreases by up to 90%."
      ]
    },
    {
      "heading": "4.4 Correlation between Perplexity and F-Measure",
      "text": [
        "Perplexities of the models built above are evaluated over the gold standard set.",
        "Figure 6 shows how the perplexities vary with the bigram numbers in models.",
        "Here, we notice that the KLD models achieve the lowest perplexities.",
        "It is not a surprising result, because the goal of KLD based pruning is to minimize the Kullback-Leibler distance that can be interpreted as a relative change of perplexity (Stolcke, 1998).",
        "Now we compare Figure 5 and Figure 6.",
        "Perplexities of KLD models are much lower than that of the other models, but their F-Measures are much worse than that of step-by-step growing 96.",
        "1",
        "models.",
        "It implies that lower perplexity does not always lead to higher F-Measure.",
        "However, when the comparison is restricted in a single pruning method, the case is different.",
        "For each pruning method, as more bigrams are included in the model, the perplexity curve falls, and the F-Measure curve rises.",
        "It implies there are correlations between them.",
        "We compute the Pearson product-moment correlation coefficient for each pruning method, as listed in Table 2.",
        "It shows that the correlation between perplexity and F-Measure is very strong.",
        "To sum up, the correlation between language model perplexity and system performance (here represented by F-Measure) depends on whether the models come from the same pruning method.",
        "If so, the correlation is strong.",
        "Otherwise, the correlation is weak."
      ]
    },
    {
      "heading": "4.5 Combination of Saturated Model and KLD",
      "text": [
        "The above experimental results show that step-by-step growing models achieve the best performance when less than 100K bigrams are added in.",
        "Unfortunately, they can not grow up into any desired size.",
        "A bigram has no chance to be added into the base model, unless it appears in the misaligned part of the segmented corpus, where WF ≠ WB .",
        "It is likely that not all bigrams have the opportunity.",
        "As more and more bigrams are added into the base model, the segmented training corpus using the current base model approaches to that using the full-bigram model.",
        "Gradually, none bigram can be added into the current base model.",
        "At that time, the model stops growing, and reaches its saturation state.",
        "The model that reaches its saturation state is named as saturated model.",
        "In our experiments, three step-by-step growing models reach their saturation states when about 100K bigrams are added in.",
        "By combining with the baseline KLD based method, we obtain models that outperform the baseline for any model size.",
        "We combine them as follows.",
        "If the desired model size is smaller than that of the saturated model, step-by-step growing is applied.",
        "Otherwise, Kullback-Leibler distance is used for further growing over the saturated model.",
        "For instance, by growing over the saturated model of \"Step-2K\", we obtain combined models containing from 100K to 2 million bigrams.",
        "The performance of the combined models and that of the baseline KLD models are illustrated in Figure 7.",
        "It shows that the combined model performs consistently better than KLD model over all of bigram numbers.",
        "Finally, the two curves converge at the performance of the full-bigram model."
      ]
    },
    {
      "heading": "5 Conclusions and Future Work",
      "text": [
        "A discriminative pruning criterion of n-gram language model for Chinese word segmentation was proposed in this paper, and a step-by-step growing algorithm was suggested to generate the model of desired size based on a full-bigram model and a base model.",
        "Experimental results",
        "showed that the discriminative pruning method achieves significant improvements over the baseline KLD based method.",
        "At the same F-measure, the number of bigrams can be reduced by up to 90%.",
        "By combining the saturated model and the baseline KLD based method, we achieved better performance for any model size.",
        "Analysis shows that, if the models come from the same pruning method, the correlation between perplexity and performance is strong.",
        "Otherwise, the correlation is weak.",
        "The pruning methods discussed in this paper focus on bigram pruning, keeping unigram probabilities unchanged.",
        "The future work will attempt to prune bigrams and unigrams simultaneously, according to a same discriminative pruning criterion.",
        "And we will try to improve the efficiency of the step-by-step growing algorithm.",
        "In addition, the method described in this paper can be extended to other applications, such as IME and speech recognition, where language models are applied in a similar way."
      ]
    }
  ]
}
