{
  "info": {
    "authors": [
      "Adam Vogel",
      "Christopher Potts",
      "Dan Jurafsky"
    ],
    "book": "ACL",
    "id": "acl-P13-2014",
    "title": "Implicatures and Nested Beliefs in Approximate Decentralized-POMDPs",
    "url": "https://aclweb.org/anthology/P13-2014",
    "year": 2013
  },
  "references": [
    "acl-D10-1040",
    "acl-J12-1006",
    "acl-N13-1127"
  ],
  "sections": [
    {
      "heading": "Abstract",
      "text": [
        "Conversational implicatures involve reasoning about multiply nested belief structures.",
        "This complexity poses significant challenges for computational models of conversation and cognition.",
        "We show that agents in the multi-agent Decentralized-POMDP reach implicature-rich interpretations simply as a by-product of the way they reason about each other to maximize joint utility.",
        "Our simulations involve a reference game of the sort studied in psychology and linguistics as well as a dynamic, interactional scenario involving implemented artificial agents."
      ]
    },
    {
      "heading": "1 Introduction",
      "text": [
        "Gricean conversational implicatures (Grice, 1975) are inferences that listeners make in order to reconcile the speaker's linguistic behavior with the assumption that the speaker is cooperative.",
        "As Grice conceived of them, implicatures crucially involve reasoning about multiply-nested belief structures: roughly, for p to count as an implicature, the speaker must believe that the listener will infer that the speaker believes p. This complexity makes implicatures an important testing ground for models of conversation and cognition.",
        "Implicatures have received considerable attention in the context of simple reference games in which the listener uses the speaker's utterance to try to identify the speaker's intended referent (Rosenberg and Cohen, 1964; Clark and Wilkes-Gibbs, 1986; Dale and Reiter, 1995; DeVault and Stone, 2007; Krahmer and van Deemter, 2012).",
        "Many implicature patterns can be embedded in these games using specific combinations of potential referents and message sets.",
        "The paradigm has proven fruitful not only for evaluating computational models (Golland et al., 2010; Degen and Franke, 2012; Frank and Goodman, 2012; Rohde et al., 2012; Bergen et al., 2012) but also for studying children's pragmatic abilities without implicitly assuming they have mastered challenging linguistic structures (Stiller et al., 2011).",
        "In this paper, we extend these results beyond simple reference games to full decision-problems in which the agents reason about language and action together over time.",
        "To do this, we use the Decentralized Partially Observable Markov Decision Process (Dec-POMDP) to implement agents that are capable of manipulating the multiply-nested belief structures required for implicature calculation.",
        "Optimal decision making in Dec-POMDPs is NEXP complete, so we employ the single-agent POMDP approximation of Vogel et al. (2013).",
        "We show that agents in the Dec-POMDP reach implicature-rich interpretations simply as a by-product of the way they reason about each other to maximize joint utility.",
        "Our simulations involve a reference game and a dynamic, interactional scenario involving implemented artificial agents."
      ]
    },
    {
      "heading": "2 Decision-Theoretic Communication",
      "text": [
        "al., 2002) is a multi-agent generalization of the POMDP, where agents act to maximize a shared utility function.",
        "Formally, a Dec-POMDP consists of a tuple (S,A,O,R, T,?, b0, ?).",
        "S is a finite set of states, A is the set of actions, O is the set of observations, and T (s?|a1, a2, s) is the transition distribution which determines what effect the joint action (a1, a2) has on the state of the world.",
        "The true state s ?",
        "S is not observable to the agents, who must utilize observations o ?",
        "O, which are emitted after each action according to the observation distribution ?",
        "(o1, o2|s?, a).",
        "The reward functionR(s, a1, a2) represents the goal of the agents, who act to maximize expected reward.",
        "Lastly, b0 ?",
        "?",
        "(S) is the initial belief state and",
        "?",
        "?",
        "[0, 1) is the discount factor.",
        "The true state of the world s ?",
        "S is not observable to either agent.",
        "In single-agent POMDPs, agents maintain a belief state b(s) ?",
        "?",
        "(S), which is a distribution over states.",
        "Agents acting in Dec-POMDPs must take into account not only their beliefs about the state of the world, but also the beliefs of their partners, leading to nested belief states.",
        "In the model presented here, our agent models the other agent's beliefs about the state of the world, and assumes that the other agent does not take into account our own beliefs, a common approach (Gmytrasiewicz and Doshi, 2005).",
        "Agents make decisions according to a policy pii : ?",
        "(S) ?",
        "A which maximizes the discounted expected reward?",
        "?",
        "the assumption that the other agent tracks one less level of belief, we can solve for the other agent's policy p?i, which allows us to estimate his actions and beliefs over time.",
        "To construct policies, we use Perseus (Spaan and Vlassis, 2005), a point-based value iteration algorithm.",
        "Even tracking just one level of nested beliefs quickly leads to a combinatorial explosion in the number of belief states the other agent might have.",
        "This causes decision making in Dec-POMDPs to be NEXP complete, limiting their application to problems with only a handful of states (Bernstein et al., 2002).",
        "To ameliorate this difficulty, we use the method of Vogel et al. (2013), which creates a single-agent approximation to the full Dec-POMDP.",
        "To form this single-agent POMDP, we augment the state space to be S ?",
        "S, where the second set of state variables allows us to model the other agent's beliefs.",
        "We maintain a point estimate b?",
        "of the other agent's beliefs, which is formed by summing out observations O that the other player might have received.",
        "To accomplish this, we factor the transition distribution into two terms: T ((s?, s??",
        ")|a, p?i(s?",
        "), (s, s?))",
        "= T?",
        "(s?",
        "?|s?, a, p?i(s?",
        "), (s, s?",
        "))T (s?|a, p?i(s?",
        "), (s, s?)).",
        "This observation marginalization can be folded into the transition distribution T?",
        "(s?",
        "?|s?, a, p?i(s?",
        "), (s, s?",
        ")):",
        "Communication is treated as another type of observation, with messages coming from a finite set M .",
        "Each message m ?",
        "M has the semantics Pr(s|m), which represents the probability that the world is in state s ?",
        "S given that m is true.",
        "Messages m received from a partner are combined with perceptual observations o ?",
        "O, to form a joint observation (m, o).",
        "A literal listener, denoted L, interprets messages according to this semantics, without taking into account the beliefs of the speaker.",
        "L assumes that the perceptual observations and messages are conditionally independent given the state of the world.",
        "Using Bayes?",
        "rule, the literal listener's joint",
        "(2) The Pr(m) prior over messages can be estimated from corpus data, but we use a uniform prior for simplicity.",
        "A literal speaker, denoted S, produces messages according to the most descriptive term:",
        "The literal speaker does not model the beliefs of the listener.",
        "To interpret implicatures, a level-one listener, denoted L(S), models the beliefs a literal speaker must have had to produce an utterance:",
        "one listener's estimate of the speaker's policy.",
        "In this setting, we denote the level-one listener's estimate of the speaker's belief as s?, yielding the belief update equation Pr((o,m)|(s, s?",
        "), (s?, s??",
        "), a, p?iS(s?))",
        "= ?",
        "(o|s?, a)1[p?iS(s?)",
        "= m] (4) The literal semantics of messages is not explicitly included in the level-one listener's belief update.",
        "Instead, when he solves for the literal speaker's policy p?iS , the meaning of a message is the set of beliefs that would lead the literal speaker to produce the utterance.",
        "A level-one speaker, S(L), produces utterances to influence a literal listener, and a level-two listener, L(S(L)), uses two levels of belief nesting to interpret utterances as the beliefs that a level-one speaker might have to produce that utterance.",
        "At each level of nesting, we apply the marginalized",
        "(c) Implicature-rich interpretations.",
        "give distributions Pr(t = ri|utterance) belief-state approach of (Vogel et al., 2013), augmenting the state space with another copy of the underlying world state space, where the new copy represents the next level of belief.",
        "For instance, the L(S(L)) agent will make decisions in the S?S?S space.",
        "For an L(S(L)) state (s, s?, s?",
        "), s is the true state of the world, s?",
        "is the speaker's belief of the state of the world, and s?",
        "is the speaker's belief of the listener's beliefs.",
        "In the next two sections we show how a level-one and level-two listener infer implicatures."
      ]
    },
    {
      "heading": "3 Reference Game Implicatures",
      "text": [
        "Fig.",
        "1a is the scenario for a reference game of the sort pioneered by Rosenberg and Cohen (1964) and Dale and Reiter (1995).",
        "The potential referents are r1, r2, and r3.",
        "Speakers use a restricted vocabulary consisting of three messages: ?moustache?, ?glasses?, and ?hat?.",
        "The speaker is assigned a referent ri (hidden from the listener) and produces a message on that basis.",
        "The speaker and listener share the goal of having the listener identify the speaker's intended referent ri.",
        "Fig.",
        "1b depicts the literal interpretations for this game.",
        "It looks like the listener's chances of success are low.",
        "Only ?hat?",
        "refers unambiguously.",
        "However, the language and scenario facilitate scalar implicature (Horn, 1972; Harnish, 1979; Gazdar, 1979).",
        "Briefly, the scalar implicature pattern is that a speaker who is knowledgeable about the relevant domain will choose a communicatively weak utterance U over a communicatively stronger utterance U ?",
        "iff U ?",
        "is false (assuming U and U ?",
        "are relevant).",
        "The required sense of communicative strength encompasses logical entailments as well as more particularized pragmatic partial orders (Hirschberg, 1985).",
        "In our scenario, ?hat?",
        "is stronger than ?glasses?",
        ": the referents wearing a hat are a proper subset of those wearing glasses.",
        "Thus, given the players?",
        "goal, if the speaker says ?glasses?, the listener should draw the scalar implicature that ?hat?",
        "is false.",
        "Thus, ?glasses?",
        "comes to unambiguously refer to r2 (Fig.",
        "1c, line 2).",
        "Similarly, though ?moustache?",
        "and ?glasses?",
        "do not literally stand in the specific?general relationship needed for scalar implicature, they do with ?glasses?",
        "pragmatically associated with r2 (Fig.",
        "1c, line 1).",
        "Our implementation of these games as Dec-POMDPs mirrors their intuitive description and their treatment in iterated best response models (Ja?ger, 2007; Ja?ger, 2012; Franke, 2009; Frank and Goodman, 2012).",
        "The state space S encodes the attributes of the referents (e.g., hat(r2) = T, glasses(r1) = F) and includes a target variable t identifying the speaker's referent (hidden from the listener).",
        "The speaker has three speech actions, identified with the three messages.",
        "The listener has four actions: ?listen?",
        "plus a ?choose?",
        "action ci for each referent ri.",
        "The set of observations O is just the set of messages (construed as utterances).",
        "The agents receive a positive reward iff the listener action ci corresponds to the speaker's target t. Because this is a one-step reference game, the transition distribution T is the identity distribution.",
        "The literal listener L interprets utterances as a truth-conditional speaker would produce them (Fig.",
        "1b).",
        "The level-one speaker S(L) augments the state space with a variable ?listener target?",
        "and models L's beliefs b?",
        "using the approximate methods of Sec. 2.",
        "Crucially, the optimal speaker policy piS(L) is such that piS(L)(t=r3) = ?hat?",
        "and piS(L)(t=r1) = ?moustache?.",
        "The level-two listener L(S(L)) models S(L) via an estimate of the ?listener target?",
        "variable.",
        "For each speech action m, L(S(L)) considers all values of t and the likeli",
        "hood that S(L) would have produced m:",
        "Since S(L) uses ?hat?",
        "to describe r3 and ?moustache?",
        "to describe r1, L(S(L)) correctly infers that ?glasses?",
        "refers to r2, completing Fig. 1c's full implicature-rich pattern of mutual exclusivity (Clark, 1987; Frank et al., 2009).",
        "This basic pattern is robustly attested empirically in human data.",
        "The experimental data are, of course, invariably less crisp than our idealized model predicts, but many important sources of variation could be brought into our model, with the addition of strong salience priors (Frank and Goodman, 2012; Stiller et al., 2011), assumptions about bounded rationality (Camerer et al., 2004; Franke, 2009), and a ?soft-max?",
        "view of the listener (Frank et al., 2009)."
      ]
    },
    {
      "heading": "4 Cards World Implicatures",
      "text": [
        "The Cards corpus1 contains 1266 metadata-rich transcripts from a two-player chat-based game.",
        "The world is a simple maze in which a deck of cards has been distributed.",
        "The players?",
        "goal is to find specific subsets of the cards, subject to a variety of constraints on what they can see and do.",
        "The Dec-POMDP-based agents of Vogel et al. (2013) play a simplified version in which the goal is to be co-located with a single card.",
        "Vogel et al. show that their agents?",
        "linguistic behavior is broadly Gricean.",
        "However, their agents?",
        "language is too simple to reveal implicatures.",
        "The present section remedies this shortcoming.",
        "Implicature-rich interpretations are an immediate consequence.",
        "We implement the simplified Cards tasks as follows.",
        "The state space S is composed of the location of each player and the location of the card.",
        "The transition distribution T (s?|s, a1, a2) encodes the outcome of movement actions.",
        "Agents receive one of two sensor observations, indicating whether the card is at their current location.",
        "The players are rewarded when they are both located on the card.",
        "Each player begins knowing his own location, but not the location of the other player nor of the card.",
        "The players have four movement actions (?up?, ?down?, ?left?, ?right?)",
        "and nine speech actions interpreted as identifying card locations.",
        "Fig.",
        "2 depicts these utterances as a partial order determined by entailment.",
        "These general-to-specific relation",
        "top right top left bottom right bottom left top right left bottom middle",
        "included in parentheses.",
        "Each term is estimated from all tokens that contain it, which washes out implicature-rich usage, thereby providing our model with an empirically-grounded literal start.",
        "ships show that the language can support scalar conversational implicatures.2 Fig. 2 is not entirely appropriate in our setting, however.",
        "Our expressions are vague; there is no sharp boundary between, e.g., ?top?",
        "and ?bottom?, nor is it clear where ?top right?",
        "begins.",
        "To model this vagueness, we analyze each message m as denoting a conditional distribution Pr(x|m) over grid squares x in the gameboard.",
        "These distributions are derived from human?human Cards interactions using the data and methods of Potts (2012).",
        "Of course, there is a tension here: our model assumes that we begin with literal interpretations, but human?human data will reflect pragmatically-enriched usage.",
        "To get around this, we approximate literal interpretations by deriving each term's distribution from all the corpus tokens that contain it.",
        "For example, the distribution for ?top?",
        "is 2Our agents cannot produce modified versions of ?middle?",
        "like ?middle right?.",
        "These would be synonymous with implicature-enriched general terms.",
        "We work with a simple cost-function that treats all forms alike, but future versions of this work will incorporate more realistic form-based costs.",
        "top left (5.17) top (3.46) top right (5.04) left (3.91) middle (2.35) right (3.58) bottom left (4.81) bottom (3.70) bottom right (5.04)",
        "using the level-one listener L(S).",
        "estimated not only from ?top?",
        "but also from ?top right?, ?middle right?, and so forth.",
        "The denotation for ?top right?",
        "excludes simple ?top?",
        "and ?right?",
        "utterances but includes expressions like ?very top right?.",
        "This semantics washes out any implicature patterns, thereby giving us a proper literal starting point.",
        "Fig.",
        "3 shows these denotations for the full set of expressions.",
        "The entailment relations from Fig. 2 are (fuzzily) evident.",
        "For example, the areas of high probability for ?right?",
        "properly contain the areas of high probability for ?top right?.",
        "To show how the Dec-POMDP model delivers implicatures, we begin with a literal speaker S who does not consider the location of the other player and instead searches the board until he finds the card.",
        "After finding it, he communicates the referring expression with highest literal probability for his location, using the distributions from Fig. 3.",
        "We denote the literal speaker's policy by piS.",
        "The level-one listener L(S) tracks an estimate of S's location and beliefs about the card location.",
        "Using the approximation defined in Sec. 2, L(S) interprets an utterancem as Pr(m|s) = 1[p?iS(s) = m].",
        "Thus, the meaning of each m is the set of beliefs that S might have to produce this utterance.",
        "Fig.",
        "4 shows how L(S) interprets each message.",
        "The meaning of general terms like ?top?",
        "and ?right?",
        "now exclude their modified counterparts.",
        "This is evident in the lack of overlap between high-probability areas and in the lower entropy values.",
        "Direct evaluation of this result against the corpus data is not possible, because the corpus does not encode interpretations.",
        "However, we expect top left (5.82) top (5.74) top right (5.49) left (6.15) middle (6.14) right (6.57) bottom left (5.29) bottom (5.43) bottom right (5.44)",
        "aggregate referential intentions .",
        "Each term is estimated only from tokens that exactly match it.",
        "listener interpretations to align with speaker intentions, and we can gain insight into (aggregate) speaker intentions using our method for grounding referential terms.",
        "Whereas the literal interpretation for message m is obtained from all the tokens that contain it (Fig.",
        "3), the speaker's intended interpretation for m is obtained from all of the tokens that exactly match it.",
        "For instance, the meaning of ?top?",
        "now excludes tokens like ?top left?.",
        "Fig.",
        "5 shows these denotations, which mirror the distributions predicted by our model (Fig.",
        "4).",
        "Thus, the L(S) model correctly infers the pragmatic meaning of referring expressions as used by human speakers, albeit in an idealized manner."
      ]
    },
    {
      "heading": "5 Future Work",
      "text": [
        "We showed that implicatures arise in cooperative contexts from nested belief models.",
        "Our listener-centric implicatures must be combined with rational speaker behavior (Vogel et al., 2013) to produce general dialog agents.",
        "The computational complexity of Dec-POMDPs is prohibitive, and our approximations can be problematic for deep belief nesting.",
        "Future work will explore sampling-based approaches to belief update and decision making (Doshi and Gmytrasiewicz, 2009) to overcome these problems.",
        "These steps will move us closer to a computationally effective, unified theory of pragmatic enrichment and decision making.",
        "Acknowledgements This research was supported in part by ONR grants N00014-10-1-0109 and N00014-13-10287 and ARO grant W911NF-07-1-0216."
      ]
    }
  ]
}
