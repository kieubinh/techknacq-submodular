{
  "info": {
    "authors": [
      "Feng Jiao",
      "Shaojun Wang",
      "Chi-Hoon Lee",
      "Russell Greiner",
      "Dale Schuurmans"
    ],
    "book": "International Conference on Computational Linguistics and Annual Meeting of the Association for Computational Linguistics",
    "id": "acl-P06-1027",
    "title": "Semi-Supervised Conditional Random Fields for Improved Sequence Segmentation and Labeling",
    "url": "https://aclweb.org/anthology/P06-1027",
    "year": 2006
  },
  "references": [
    "acl-J04-3004",
    "acl-P95-1026"
  ],
  "sections": [
    {
      "heading": "Abstract",
      "text": [
        "We present a new semi-supervised training procedure for conditional random fields (CRFs) that can be used to train sequence segmentors and labelers from a combination of labeled and unlabeled training data.",
        "Our approach is based on extending the minimum entropy regularization framework to the structured prediction case, yielding a training objective that combines unlabeled conditional entropy with labeled conditional likelihood.",
        "Although the training objective is no longer concave, it can still be used to improve an initial model (e.g. obtained from supervised training) by iterative ascent.",
        "We apply our new training algorithm to the problem of identifying gene and protein mentions in biological texts, and show that incorporating unlabeled data improves the performance of the supervised CRF in this case."
      ]
    },
    {
      "heading": "1 Introduction",
      "text": [
        "Semi-supervised learning is often touted as one of the most natural forms of training for language processing tasks, since unlabeled data is so plentiful whereas labeled data is usually quite limited or expensive to obtain.",
        "The attractiveness of semi-supervised learning for language tasks is further heightened by the fact that the models learned are large and complex, and generally even thousands of labeled examples can only sparsely cover the parameter space.",
        "Moreover, in complex structured prediction tasks, such as parsing or sequence modeling (part-of-speech tagging, word segmentation, named entity recognition, and so on), it is considerably more difficult to obtain labeled training data than for classification tasks (such as document classification), since hand-labeling individual words and word boundaries is much harder than assigning text-level class labels.",
        "Many approaches have been proposed for semi-supervised learning in the past, including: generative models (Castelli and Cover 1996; Cohen and Cozman 2006; Nigam et al.",
        "2000), self-learning",
        "(Celeux and Govaert 1992; Yarowsky 1995), co-training (Blum and Mitchell 1998), information-theoretic regularization (Corduneanu and Jaakkola 2006; Grandvalet and Bengio 2004), and graph-based transductive methods (Zhou et al.",
        "2004; Zhou et al.",
        "2005; Zhu et al.",
        "2003).",
        "Unfortunately, these techniques have been developed primarily for single class label classification problems, or class label classification with a structured input (Zhou et al.",
        "2004; Zhou et al.",
        "2005; Zhu et al.",
        "2003).",
        "Although still highly desirable, semi-supervised learning for structured classification problems like sequence segmentation and labeling have not been as widely studied as in the other semi-supervised settings mentioned above, with the sole exception of generative models.",
        "With generative models, it is natural to include unlabeled data using an expectation-maximization approach (Nigam et al.",
        "2000).",
        "However, generative models generally do not achieve the same accuracy as discriminatively trained models, and therefore it is preferable to focus on discriminative approaches.",
        "Unfortunately, it is far from obvious how unlabeled training data can be naturally incorporated into a discriminative training criterion.",
        "For example, unlabeled data simply cancels from the objective if one attempts to use a traditional conditional likelihood criterion.",
        "Nevertheless, recent progress has been made on incorporating unlabeled data in discriminative training procedures.",
        "For example, dependencies can be introduced between the labels of nearby instances and thereby have an effect on training (Zhu et al.",
        "2003; Li and McCallum 2005; Altun et al.",
        "2005).",
        "These models are trained to encourage nearby data points to have the same class label, and they can obtain impressive accuracy using a very small amount of labeled data.",
        "However, since they model pairwise similarities among data points, most of these approaches require joint inference over the whole data set at test time, which is not practical for large data sets.",
        "In this paper, we propose a new semi-supervised training method for conditional random fields (CRFs) that incorporates both labeled and unlabeled sequence data to estimate a discriminative",
        "Proceedings of the 21st International Conference on Computational Linguistics and 44th Annual Meeting of the ACL, pages 209–216, Sydney, July 2006. c©2006 Association for Computational Linguistics structured predictor.",
        "CRFs are a flexible and powerful model for structured predictors based on undirected graphical models that have been globally conditioned on a set of input covariates (Lafferty et al.",
        "2001).",
        "CRFs have proved to be particularly useful for sequence segmentation and labeling tasks, since, as conditional models of the labels given inputs, they relax the independence assumptions made by traditional generative models like hidden Markov models.",
        "As such, CRFs provide additional flexibility for using arbitrary overlapping features of the input sequence to define a structured conditional model over the output sequence, while maintaining two advantages: first, efficient dynamic program can be used for inference in both classification and training, and second, the training objective is concave in the model parameters, which permits global optimization.",
        "To obtain a new semi-supervised training algorithm for CRFs, we extend the minimum entropy regularization framework of Grandvalet and Bengio (2004) to structured predictors.",
        "The resulting objective combines the likelihood of the CRF on labeled training data with its conditional entropy on unlabeled training data.",
        "Unfortunately, the maximization objective is no longer concave, but we can still use it to effectively improve an initial supervised model.",
        "To develop an effective training procedure, we first show how the derivative of the new objective can be computed from the covariance matrix of the features on the unlabeled data (combined with the labeled conditional likelihood).",
        "This relationship facilitates the development of an efficient dynamic programming for computing the gradient, and thereby allows us to perform efficient iterative ascent for training.",
        "We apply our new training technique to the problem of sequence labeling and segmentation, and demonstrate it specifically on the problem of identifying gene and protein mentions in biological texts.",
        "Our results show the advantage of semi-supervised learning over the standard supervised algorithm."
      ]
    },
    {
      "heading": "2 Semi-supervised CRF training",
      "text": [
        "In what follows, we use the same notation as (Laf-ferty et al.",
        "2001).",
        "Let X be a random variable over data sequences to be labeled, and Y be a random variable over corresponding label sequences.",
        "All components, Yi, of Y are assumed to range over a finite label alphabet Y.",
        "For example, X might range over sentences and Y over part-of-speech taggings of those sentences; hence Y would be the set of possible part-of-speech tags in this case.",
        "Assume we have a set of labeled examples,",
        "would like to build a CRF model",
        "Our goal is to learn such a model from the combined set of labeled and unlabeled examples, Dl U Du.",
        "The standard supervised CRF training procedure is based upon maximizing the log conditional likelihood of the labeled examples in Dl",
        "where U(9) is any standard regularizer on 0, e.g. U(e) = 1101122.",
        "Regularization can be used to limit over-fitting on rare features and avoid degeneracy in the case of correlated features.",
        "Obviously, (1) ignores the unlabeled examples in Du.",
        "To make full use of the available training data, we propose a semi-supervised learning algorithm that exploits a form of entropy regularization on the unlabeled data.",
        "Specifically, for a semi-supervised CRF, we propose to maximize the following objective",
        "where the first term is the penalized log conditional likelihood of the labeled data under the CRF, (1), and the second line is the negative conditional entropy of the CRF on the unlabeled data.",
        "Here, y is a tradeoff parameter that controls the influence of the unlabeled data."
      ]
    },
    {
      "heading": "3 An efficient training procedure",
      "text": [
        "As (2) is not concave, many of the standard global maximization techniques do not apply.",
        "However, one can still use unlabeled data to improve a supervised CRF via iterative ascent.",
        "To derive an efficient iterative ascent procedure, we need to compute gradient of (2) with respect to the parameters 0.",
        "Taking derivative of the objective function (2) with respect to 0 yields Appendix A for the derivation)",
        "This approach resembles that taken by (Grandvalet and Bengio 2004) for single variable classification, but here applied to structured CRF training.",
        "The motivation is that minimizing conditional entropy over unlabeled data encourages the algorithm to find putative labelings for the unlabeled data that are mutually reinforcing with the supervised labels; that is, greater certainty on the putative labelings coincides with greater conditional likelihood on the supervised labels, and vice versa.",
        "For a single classification variable this criterion has been shown to effectively partition unlabeled data into clusters (Grandvalet and Bengio 2004; Roberts et al.",
        "2000).",
        "To motivate the approach in more detail, consider the overlap between the probability distribution over a label sequence g and the empirical distribution of p(x) on the unlabeled data Dw.",
        "The overlap can be measured by the Kullback-Leibler divergence D(pe(ylx)p(x)JIp(x)).",
        "It is well known that Kullback-Leibler divergence (Cover and Thomas 1991) is positive and increases as the overlap between the two distributions decreases.",
        "In other words, maximizing Kullback-Leibler divergence implies that the overlap between two distributions is minimized.",
        "The total overlap over all possible label sequences can be defined as",
        "which motivates the negative entropy term in (2).",
        "The combined training objective (2) exploits unlabeled data to improve the CRF model, as we will see.",
        "However, one drawback with this approach is that the entropy regularization term is not concave.",
        "To see why, note that the entropy regularizer can be seen as a composition,",
        "second derivative of a composition, h = f o g, is given by (Boyd and Vandenberghe 2004)",
        "Although f and gy are concave here, since f is not nondecreasing, h is not necessarily concave.",
        "So in general there are local maxima in (2).",
        "i – N+1 The first three items on the right hand side are just the standard gradient of the CRF objective, aCL(0)/a0 (Lafferty et al.",
        "2001), and the final item is the gradient of the entropy regularizer (the derivation of which is given in Appendix A.",
        "Here, covpa(ylx(0) [f (x(i), y)1 is the conditional covariance matrix of the features, fi (x, y), given sample sequence x(i).",
        "In particular, the (j, k)th element of this matrix is given by covpe (Ylx) [fi (X, Y)A (X, Y)] = EPO(Ylx) (fj (X I Y).fk (X, Y))",
        "To efficiently calculate the gradient, we need to be able to efficiently compute the expectations with respect to y in (3) and (4).",
        "However, this can pose a challenge in general, because there are exponentially many values for y.",
        "Techniques for computing the linear feature expectations in (3) are already well known if y is sufficiently structured (e.g. y forms a Markov chain) (Lafferty et al.",
        "2001).",
        "However, we now have to develop efficient techniques for computing the quadratic feature expectations in (4).",
        "For the quadratic feature expectations, first note that the diagonal terms, j = 1, are straightforward, since each feature is an indicator, we have",
        "For the off diagonal terms, j �/ 1, however, we need to develop a new algorithm.",
        "Fortunately, for structured label sequences, Y, one can devise an efficient algorithm for calculating the quadratic expectations based on nested dynamic programming.",
        "To illustrate the idea, we assume that the dependencies of Y, conditioned on X, form a"
      ]
    },
    {
      "heading": "Markov chain.",
      "text": [
        "Define one feature for each state pair (9', 9), and one feature for each state-observation pair",
        "Following (Lafferty et al.",
        "2001), we also add special start and stop states, Yo = start and Yn+l = stop.",
        "The conditional probability of a label sequence can now be expressed concisely in a matrix form.",
        "For each position j in the observation",
        "and recurrence",
        "With these definitions, the expectation of the product of each pair of feature functions, Yi(x, y), fk (x, y)), Yi(x, y), 9k (x, y)) , and (9i (x, y), 9k (x, y)), for j, k = 1, K, j :7� k, can be recursively calculated.",
        "First define the summary matrix",
        "Then the quadratic feature expectations can be computed by the following recursion, where the two double sums in each expectation correspond to the two cases depending on which feature occurs first (es occuring before et).",
        "The computation of these expectations can be organized in a trellis, as illustrated in Figure 1.",
        "Once we obtain the gradient of the objective function (2), we use limited-memory L-BFGS, a quasi-Newton optimization algorithm (McCallum 2002; Nocedal and Wright 2000), to find the local maxima with the initial value being set to be the optimal solution of the supervised CRF on labeled data."
      ]
    },
    {
      "heading": "4 Time and space complexity",
      "text": [
        "The time and space complexity of the semi-supervised CRF training procedure is greater than that of standard supervised CRF training, but nevertheless remains a small degree polynomial in the size of the training data.",
        "Let ml = size of the labeled set",
        "Then the time required to classify a test sequence is 0(nts2), independent of training method, since the Viterbi decoder needs to access each path.",
        "For training, supervised CRF training requires 0(cminls2) time, whereas semi-supervised CRF training requires 0(cminls2 + cmun283) time.",
        "The additional cost for semi-supervised training arises from the extra nested loop required to calculated the quadratic feature expectations, which introduces in an additional nus factor.",
        "However, the space requirements of the two training methods are the same.",
        "That is, even though the covariance matrix has size O(K2), there is never any need to store the entire matrix in memory.",
        "Rather, since we only need to compute the product of the covariance with 0, the calculation can be performed iteratively without using extra space beyond that already required by supervised CRF training."
      ]
    },
    {
      "heading": "5 Identifying gene and protein mentions",
      "text": [
        "We have developed our new semi-supervised training procedure to address the problem of information extraction from biomedical text, which has received significant attention in the past few years.",
        "We have specifically focused on the problem of identifying explicit mentions of gene and protein names (McDonald and Pereira 2005).",
        "Recently, McDonald and Pereira (2005) have obtained interesting results on this problem by using a standard supervised CRF approach.",
        "However, our contention is that stronger results could be obtained in this domain by exploiting a large corpus of unannotated biomedical text to improve the quality of the predictions, which we now show.",
        "Given a biomedical text, the task of identifying gene mentions can be interpreted as a tagging task, where each word in the text can be labeled with a tag that indicates whether it is the beginning of gene mention (B), the continuation of a gene mention (I), or outside of any gene mention (O).",
        "To compare the performance of different taggers learned by different mechanisms, one can measure the precision, recall and F-measure, given by # correct predictions # predicted gene mentions # correct predictions # true gene mentions"
      ]
    },
    {
      "heading": "2xprecision xrecall",
      "text": [
        "precision+recall In our evaluation, we compared the proposed semi-supervised learning approach to the state of the art supervised CRF of McDonald and Pereira (2005), and also to self-training (Celeux and Govaert 1992; Yarowsky 1995), using the same feature set as (McDonald and Pereira 2005).",
        "The CRF training procedures, supervised and semi",
        "supervised, were run with the same regularization function, U(0) =1101122, used in (McDonald and Pereira 2005).",
        "First we evaluated the performance of the semi-supervised CRF in detail, by varying the ratio between the amount of labeled and unlabeled data, and also varying the tradeoff parameter y.",
        "We choose a labeled training set A consisting of 5448 words, and considered alternative unlabeled training sets, B (5210 words), C (10,208 words), and D (25,145 words), consisting of the same, 2 times and 5 times as many sentences as A respectively.",
        "All of these sets were disjoint and selected randomly from the full corpus, the smaller one in (McDonald et al.",
        "2005), consisting of 184,903 words in total.",
        "To determine sensitivity to the parameter y we examined a range of discrete values 0, 0.",
        "1, 0.5, 1, 5, 10, 20, 50.",
        "In our first experiment, we train the CRF models using labeled set A and unlabeled sets B, C and D respectively.",
        "Then test the performance on the sets B, C and D respectively The results of our evaluation are shown in Table 1.",
        "The performance of the supervised CRF algorithm, trained only on the labeled set A, is given on the first row in Table 1 (corresponding to y = 0).",
        "By comparison, the results obtained by the semi-supervised CRFs on the held-out sets B, C and D are given in Table 1 by increasing the value of y.",
        "The results of this experiment demonstrate quite clearly that in most cases the semi-supervised CRF obtains higher precision, recall and F-measure than the fully supervised CRF, yielding a 20% improvement in the best case.",
        "In our second experiment, again we train the CRF models using labeled set A and unlabeled sets B, C and D respectively with increasing values of y, but we test the performance on the held-out set E which is the full corpus minus the labeled set A and unlabeled sets B, C and D. The results of our evaluation are shown in Table 2 and Figure 2.",
        "The blue line in Figure 2 is the result of the supervised CRF algorithm, trained only on the labeled set A.",
        "In particular, by using the supervised CRF model, the system predicted 3334 out of 7472 gene mentions, of which 2435 were correct, resulting in a precision of 0.73, recall of 0.33 and F-measure of 0.45.",
        "The other curves are those of the semi-supervised CRFs.",
        "The results of this experiment demonstrate quite clearly that the semi-supervised CRFs simultane",
        "ously increase both the number of predicted gene mentions and the number of correct predictions, thus the precision remains almost the same as the supervised CRF, and the recall increases significantly.",
        "Both experiments as illustrated in Figure 2 and Tables 1 and 2 show that clearly better results are obtained by incorporating additional unlabeled training data, even when evaluating on disjoint testing data (Figure 2).",
        "The performance of the semi-supervised CRF is not overly sensitive to the tradeoff parameter y, except that y cannot be set too large."
      ]
    },
    {
      "heading": "5.1 Comparison to self-training",
      "text": [
        "For completeness, we also compared our results to the self-learning algorithm, which has commonly been referred to as bootstrapping in natural language processing and originally popularized by the work of Yarowsky in word sense disambiguation (Abney 2004; Yarowsky 1995).",
        "In fact, similar ideas have been developed in pattern recognition under the name of the decision-directed algorithm (Duda and Hart 1973), and also traced back to 1970s in the EM literature (Celeux and Govaert 1992).",
        "The basic algorithm works as follows:",
        "1.",
        "Given Dl and Dw, begin with a seed set of labeled examples, DO), chosen from V. 2.",
        "For m=0,1,••• (a) Train the supervised CRF on labeled examples D('), obtaining 0(m).",
        "(b) For each sequence xW E Du, find",
        "Viterbi decoding or other inference algorithm, and add the pair (x(')y� ))) to the set of labeled examples (replacing any previous label for x(z) if present).",
        "stop; otherwise m ✟ m ❡ ✺, iterate.",
        "We implemented this self training approach and tried it in our experiments.",
        "Unfortunately, we were not able to obtain any improvements over the standard supervised CRF with self-learning, using the sets ✆✝ ✟ A✖ and ✆✯ ✍ ✁ ✁✖ C✖ D}.",
        "The semi-supervised CRF remains the best of the approaches we have tried on this problem."
      ]
    },
    {
      "heading": "6 Conclusions and further directions",
      "text": [
        "We have presented a new semi-supervised training algorithm for CRFs, based on extending minimum conditional entropy regularization to the structured prediction case.",
        "Our approach is motivated by the information-theoretic argument (Grandvalet and Bengio 2004; Roberts et al.",
        "2000) that unlabeled examples can provide the most benefit when classes have small overlap.",
        "An iterative ascent optimization procedure was developed for this new criterion, which exploits a nested dynamic programming approach to efficiently compute the covariance matrix of the features.",
        "We applied our new approach to the problem of identifying gene name occurrences in biological text, exploiting the availability of auxiliary unlabeled data to improve the performance of the state of the art supervised CRF approach in this domain.",
        "Our semi-supervised CRF approach shares all of the benefits of the standard CRF training, including the ability to exploit arbitrary features of the inputs, while obtaining improved accuracy through the use of unlabeled data.",
        "The main drawback is that training time is increased because of the extra nested loop needed to calculate feature covariances.",
        "Nevertheless, the algorithm is sufficiently efficient to be trained on unlabeled data sets that yield a notable improvement in classification accuracy over standard supervised training.",
        "To further accelerate the training process of our semi-supervised CRFs, we may apply stochastic gradient optimization method with adaptive gain adjustment as proposed by Vishwanathan et al.",
        "(2006)."
      ]
    },
    {
      "heading": "Acknowledgments",
      "text": [
        "Research supported by Genome Alberta, Genome Canada, and the Alberta Ingenuity Centre for Machine Learning."
      ]
    }
  ]
}
