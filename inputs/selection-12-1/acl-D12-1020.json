{
  "info": {
    "authors": [
      "Robert Lindsey",
      "William Headden",
      "Michael Stipicevic"
    ],
    "book": "EMNLP",
    "id": "acl-D12-1020",
    "title": "A Phrase-Discovering Topic Model Using Hierarchical Pitman-Yor Processes",
    "url": "https://aclweb.org/anthology/D12-1020",
    "year": 2012
  },
  "references": [
    "acl-P06-1124",
    "acl-P10-1117",
    "acl-W01-0513"
  ],
  "sections": [
    {
      "heading": "Abstract",
      "text": [
        "Topic models traditionally rely on the bag-of-words assumption.",
        "In data mining applications, this often results in end-users being presented with inscrutable lists of topical un-igrams, single words inferred as representative of their topics.",
        "In this article, we present a hierarchical generative probabilistic model of topical phrases.",
        "The model simultaneously infers the location, length, and topic of phrases within a corpus and relaxes the bag-of-words assumption within phrases by using a hierarchy of Pitman-Yor processes.",
        "We use Markov chain Monte Carlo techniques for approximate inference in the model and perform slice sampling to learn its hyperparameters.",
        "We show via an experiment on human subjects that our model finds substantially better, more interpretable topical phrases than do competing models."
      ]
    },
    {
      "heading": "1 Introduction",
      "text": [
        "Probabilistic topic models have been the focus of intense study in recent years.",
        "The archetypal topic model, Latent Dirichlet Allocation (LDA), posits that words within a document are conditionally independent given their topic (Blei et al2003).",
        "This ?bag-of-words?",
        "assumption is a common simplification in which word order is ignored, but one which introduces undesirable properties into a model meant to serve as an unsupervised exploratory tool for data analysis.",
        "When an end-user runs a topic model, the output he or she is often interested in is a list of topical unigrams, words probable in a topic (hence, representative of it).",
        "In many situations, such as during the use of the topic model for the analysis of a new or ill-understood corpus, these lists can be insufficiently informative.",
        "For instance, if a layperson ran LDA on the NIPS corpus, he would likely get a topic whose most prominent words include policy, value, and reward.",
        "Seeing these words isolated from their context in a list would not be particularly insightful to the layperson unfamiliar with computer science research.",
        "An alternative to LDA which produced richer output like policy iteration algorithm, value function, and model-based reinforcement learning alongside the unigrams would be much more enlightening.",
        "Most situations where a topic model is actually useful for data exploration require a model whose output is rich enough to dispel the need for the user's extensive prior knowledge of the data.",
        "Furthermore, lists of topical unigrams are often made only marginally interpretable by virtue of their non-compositionality, the principle that a collocation's meaning typically is not derivable from its constituent words (Schone and Jurafsky, 2001).",
        "For example, the meaning of compact disc as a music medium comes from neither the unigram compact nor the unigram disc, but emerges from the bi-gram as a whole.",
        "Moreover, non-compositionality is topic dependent; compact disc should be interpreted as a music medium in a music topic, and as a small region bounded by a circle in a mathematical topic.",
        "LDA is prone to decompose collocations into different topics and violate the principle of non-compositionality, and its unigram lists are harder to interpret as a result.",
        "We present an extension of LDA called Phrase-Discovering LDA (PDLDA) that satisfies two desiderata: providing rich, interpretable output and honoring the non-compositionality of collocations.",
        "PDLDA is built in the tradition of the ?Topical N-Gram?",
        "(TNG) model of Wang et al2007).",
        "TNG is a topic model which satisfies the first desideratum by producing lists of representative, topically cohesive n-grams of the form shown in Figure 1.",
        "We diverge from TNG by our addressing the second desideratum, and we do so through a more straightforward and intuitive definition of what constitutes a phrase and its topic.",
        "In the furtherance of our goals, we employ a hierarchical method of modeling phrases that uses dependent Pitman-Yor processes to ameliorate overfitting.",
        "Pitman-Yor processes have been successfully used in the past in n-gram (Teh, 2006) and LDA-based models (Wallach, 2006) for creating Bayesian language models which exploit word order, and they prove equally useful in this scenario of exploiting both word order and topics.",
        "This article is organized as follows: after describing TNG, we discuss PDLDA and how PDLDA addresses the limitations of TNG.",
        "We then provide details of our inference procedures and evaluate our model against competing models on a subset of the TREC AP corpus (Harman, 1992) in an experiment on human subjects which assesses the inter-pretability of topical n-gram lists.",
        "The experiment is premised on the notion that topic models should be evaluated through a real-world task instead of through information-theoretic measures which often negatively correlate with topic quality (Chang et al. 2009).",
        "2 Background: LDA and TNG LDA represents documents as probabilistic mixtures of latent topics.",
        "Each wordw in a corpus w is drawn from a distribution ?",
        "indexed by a topic z, where z is drawn from a distribution ?",
        "indexed by its document d. The formal definition of LDA is",
        "where ?d is document d's topic distribution, ?z is topic z's distribution over words, zi is the topic assignment of the ith token, and wi is the ith word.",
        "?",
        "and ?",
        "are hyperparameters to the Dirichlet priors.",
        "Here and throughout the article, we use a bold font for vector notation: for example, z is the vector of all topic assignments, and its ith entry, zi, corresponds to the topic assignment of the ith token in the corpus.",
        "TNG extends LDA to model n-grams of arbitrary length in order to create the kind of rich output for text mining discussed in the introduction.",
        "It does this by representing a joint distribution P (z, c|w) where each ci is a Boolean variable that signals the start of a new n-gram beginning at the ith token.",
        "c partitions a corpus into consecutive non-overlapping n-grams of various lengths.",
        "Formally, TNG differs from LDA by the distributional assumptions",
        "where the new distributions pizw and ?zw are endowed with conjugate prior distributions: pizw ?",
        "Beta(?)",
        "and ?zw ?",
        "Dirichlet(?).",
        "When ci = 0, word wi is joined into a topic-specific bigram with wi?1.",
        "When ci = 1, wi is drawn from a topic-specific unigram distribution and is the start of a new n-gram.",
        "An unusual feature of TNG is that words within a topical n-gram, a sequence of words delineated by c, do not share the same topic.",
        "To compensate for this after running a Gibbs sampler, Wang et al2007) analyze each topical n-gram post hoc as if the topic of the final word in the n-gram was the topic assignment of the entire n-gram.",
        "Though this design simplifies inference, we perceive it as a shortcoming since the aforementioned principle of non-compositionality supports the intuitive idea that each collocation ought to be drawn from a single topic.",
        "Another potential drawback of TNG is that the topic-specific bigram distributions ?zw share no probability mass between each other or with the un-igram distributions ?z .",
        "Hence, observing a bigram under one topic does not make it more likely under another topic or make its constituent unigrams more probable.",
        "To be more concrete, in TNG, observing space shuttle under a topic z (or under two topics, one for each word) regrettably does not make space shuttle more likely under a topic z?",
        "6= z, nor does it make observing shuttle more likely under any topic.",
        "Smoothing, the sharing of probability mass between",
        "Associates (TASA) corpus (Landauer and Dumais, 1997).",
        "Each column within a box shows the top fifteen phrases for a topic and is restricted to phrases of a minimum length of one, two, or three words, respectively.",
        "The rows are ordered by likelihood.",
        "contexts, is desirable so that a model like this does not need to independently infer the probability of every bigram under every topic.",
        "The advantages of smoothing are especially pronounced for small corpora or for a large number of topics.",
        "In these situations, the observed number of bigrams in a given topic will necessarily be very small and thus not support strong inferences."
      ]
    },
    {
      "heading": "3 PDLDA",
      "text": [
        "A more natural definition of a topical phrase, one which meets our second desideratum, is to have each phrase possess a single topic.",
        "We adopt this intuitive idea in PDLDA.",
        "It can also be understood through the lens of Bayesian changepoint detection.",
        "Changepoint detection is used in time series models in which the generative parameters periodically change abruptly (Adams and MacKay, 2007).",
        "Viewing a sentence as a time series of words, we posit that the generative parameter, the topic, changes periodically in accordance with the changepoint indicators c. Because there is no restriction on the number of words between changepoints, topical phrases can be arbitrarily long but will always have a single topic drawn from ?d.",
        "The full definition of PDLDA is given by",
        "with the prior distriutions over the parameters as",
        "Like TNG, PDLDA assumes that the probability of a changepoint ci+1 after the ith token depends on the current topic zi and word wi.",
        "This causes the length of a phrase to depend on its topic and constituent words.",
        "The changepoints explicitly model which words tend to start and end phrases in each document.",
        "Depending on ci, zi is either set deterministically to the preceding topic (when ci = 0) or is drawn anew from ?d (when ci = 1).",
        "In this way, each topical phrase has a single topic drawn from its document's topic distribution.",
        "As in TNG, the parameters pizw and ?d are given conjugate priors parameterized by ?",
        "and ?.",
        "Let u be a context vector consisting of the phrase topic and the past m words: u , < zi, wi?1, wi?2, .",
        ".",
        ".",
        ", wi?m >.",
        "The operator pi(u) denotes the prefix of u, the vector with the rightmost element of u removed.",
        "|u |denotes the length of u, and ?",
        "represents an empty context.",
        "For practical reasons, we pad u with a special start symbol when the context overlaps a phrase boundary.",
        "For example, the first word wi of a phrase beginning at a position i necessarily has ci = 1; consequently, all the preceding words wi?j in the context vector are treated as start symbols so that wi is effectively drawn from a topic-specific unigram distribution.",
        "In PDLDA, each token is drawn from a distribution conditioned on its context u.",
        "When m = 1, this conditioning is analogous to TNG's word distribution.",
        "However, in contrast with TNG, the word",
        "process for a toy two-word vocabulary V = {honda, civic} and two-topic (T = 2) model with m = 1.",
        "Each node G in the tree is a Pitman-Yor process whose base distribution is its parent node, andH is a uniform distribution over V .",
        "When, for example, the context is u = z1 : honda, the darkened path is followed and the probability of the next word is calculated from the shaded node using Equation 1, which combines predictions from all the nodes along the darkened path.",
        "distributions used are Pitman-Yor processes (PYPs) linked together into a tree structure.",
        "This hierarchical construction creates the desired smoothing among different contexts.",
        "The next section explains this hierarchical distribution in more detail."
      ]
    },
    {
      "heading": "3.1 Hierarchical Pitman-Yor process",
      "text": [
        "Words in PDLDA are emitted from Gu, which has a PYP prior (Pitman and Yor, 1997).",
        "PYPs are a generalization of the Dirichlet Process, with the addition of a discount parameter 0 ?",
        "a ?",
        "1.",
        "When considering the distribution of a sequence of words w drawn iid from a PYP-distributed G, one can analytically marginalize G and consider the resulting conditional distribution of w given its parameters a, b, and base distribution ?.",
        "This marginal can best be understood by considering the distribution of any wi|w1, .",
        ".",
        ".",
        ", wi?1, a, b, ?, which is characterized by a generative process known as the generalized Chinese Restaurant Process (CRP) (Pitman, 2002).",
        "In the CRP metaphor, one imagines a restaurant with an unbounded number of tables, where each table has one shared dish (a draw from ?)",
        "and can seat an unlimited number of customers.",
        "The CRP specifies a process by which customers entering the restaurant choose a table to sit at and, consequently, the dish they eat.",
        "The first customer to arrive always sits at the first table.",
        "Subsequent customers sit at an occupied table k with probability proportional to ck ?",
        "a and choose a new unoccupied table with probability proportional to b + ta, where ck is the number of customers seated at table k and t is the number of occupied tables in G. For our language modeling purposes, ?customers?",
        "are word tokens and ?dishes?",
        "are word types.",
        "The hierarchical PYP (HPYP) is an intuitive recursive formulation of the PYP in which the base distribution ?",
        "is itself PYP-distributed.",
        "Figure 3 demonstrates this principle as applied to PDLDA.",
        "The hierarchy forms a tree structure, where leaves are restaurants corresponding to full contexts and internal nodes correspond to partial contexts.",
        "An edge between a parent and child node represents a dependency of the child on the parent, where the base distribution of the child node is its parent.",
        "This smooths each context's distribution like the Bayesian n-gram model of Teh (2006), which is a Bayesian version of interpolated Kneser-Ney smoothing (Chen and Goodman, 1998).",
        "One ramification of this setup is that if a word occurs in a context u, the sharing makes it more likely in other contexts that have something in common with u, such as a shared topic or word.",
        "The HPYP gives the following probability for a word following the context u being w:",
        "where Ppi(?",
        ")(w|?,a,b) = G?",
        "(w), cuw?",
        "is the number of customers eating dish w in restaurant u, and tuw is the number of tables serving w in restaurant u, and ?",
        "represents the current seating arrangement.",
        "Here and throughout the rest of the paper, we use a dot to indicate marginal counts: e.g., cuw?",
        "=?",
        "k cuwk where cuwk is the number of customers eating w in u at table k. The base distribution of G?",
        "was chosen to be uniform: H(w) = 1/V with V being the vocabulary size.",
        "The above equation an interpolation between distributions of context lengths",
        "|u|, |u |?",
        "1, .",
        ".",
        ".",
        "0 and realizes the sharing of statistical strength between different contexts."
      ]
    },
    {
      "heading": "3.2 Inference",
      "text": [
        "In this section, we describe Markov chain Monte Carlo procedures to sample from P (z, c, ?",
        "|w, U), the posterior distribution over topic assignments z, phrase boundaries c, and seating arrangements ?",
        "given an observed corpus w. Let U be shorthand for ?, ?,a,b.",
        "In order to draw samples from P (z, c, ?",
        "|w, U), we employ a Metropolis-Hastings sampler for approximate inference.",
        "The sampler we use is a collapsed sampler (Griffiths and Steyvers, 2004), wherein ?, ?, and G are analytically marginalized.",
        "Because we marginalize eachG, we use the Chinese Restaurant Franchise representation of the hierarchical PYPs (Teh, 2006).",
        "However, rather than onerously storing the table assignment of every token in w, we store only the counts of how many tables there are in a restaurant and how many customers are sitting at each table in that restaurant.",
        "We refer the inquisitive reader to the appendix of Teh (2006) for further details of this procedure.",
        "Our sampling strategy for a given token i in document d is to jointly propose changes to the changepoint ci and topic assignment zi, and then to the seating arrangement ?",
        ".",
        "Recall that according to the model, if ci = 0, zi = zi?1; otherwise zi is generated from the topic distribution for document d. Since the topic assignment remains the same until a new changepoint at a position i?",
        "is reached, each token wj for j from position i until i?",
        "?",
        "1 will depend on zi because for these j, zj = zi.",
        "We call this set of tokens the phrase suffix of the ith token and denote it s(i).",
        "More formally, let s(i) be the maximal set of continuous indices j ?",
        "i including i such that, if j 6= i, cj = 0.",
        "That is, s(i) are the indices comprising the remainder of the phrase beginning at position i.",
        "In addition, let x(i) indicate the extended suffix version of s(i) which includes one additional index: x(i) , {s(i) ?",
        "{max (s(i)) + 1}}.",
        "In addition to the words in the suffix s(i), the changepoint indicator variables cj for j in x(i) are also conditioned on zi.",
        "To make these dependencies more explicit, we refer to zs(i) , zj ?j ?",
        "s(i), which are constrained by the model to share a topic.",
        "The variables that depend directly on zi, ci are zs(i),ws(i), cx(i).",
        "The proposal distribution first draws from a multinomial over T + 1 options: one option for ci = 0, zi = zi ?",
        "1; and one for ci = 1 paired with each possible zi = z ?",
        "1 .",
        ".",
        ".",
        "T .",
        "This is",
        "if cj = 1 ?zj ,zj?1 if cj = 0 where Puj (wj |?",
        "?s(i), U) is given by Equation 1, T is the number of topics, n?s(j)dz is the number of phrases in document d that have topic z when s(j)'s assignment is excluded, and n?s(j)zwc is the number of times a changepoint c has followed a word w with topic z when s(j)'s assignments are excluded.",
        "After drawing a proposal for ci, zs(i) for token i, the sampler adds a customer eating wi to a table serving wi in restaurant ui.",
        "An old table k is selected with probability ?",
        "max(0, cuwk ?",
        "a|u|) and a new table is selected with probability ?",
        "(b|ui |+ a|ui|tui?)Ppi(u)(wi).",
        "Let z?s(i), c ?",
        "i, ?",
        "?",
        "s(i) denote the proposed change to zs(i), ci, ?s(i).",
        "We accept the proposal with probability min(A, 1) where",
        "where Q is the proposal distribution and P?",
        "is the true unnormalized distribution.",
        "P?",
        "differs from Q in that the probability of each word wj and the seating arrangement depends only on ?s(j), as opposed to the simplification of using ?s(i).",
        "Almost all proposals are accepted; hence, this theoretically motivated Metropolis Hastings correction step makes little difference in practice.",
        "Because the parameters a and b have no intuitive interpretation and we lack any strong belief about what they should be, we give them vague priors where ?1 = ?2 = 1 and 1 = 10, 2 = .1.",
        "We then",
        "interleave a slice sampling algorithm (Neal, 2000) between sweeps of the Metropolis-Hastings sampler to learn these parameters.",
        "We chose not to do inference on ?",
        "in order to make the tests of our model against TNG more equitable."
      ]
    },
    {
      "heading": "4 Related Work",
      "text": [
        "An integral part of modeling topical phrases is the relaxation of the bag-of-words assumption in LDA.",
        "There are many models that make this relaxation.",
        "Among them, Griffiths and Steyvers (2005) present a model in which words are generated either conditioned on a topic or conditioned on the previous word in a bigram, but not both.",
        "They use this to model human performance on a word-association task.",
        "Wallach (2006) experiments with incorporating LDA into a bigram language model.",
        "Her model uses a hierarchical Dirichlet to share parameters across bigrams in a topic in a manner similar to our use of PYPs, but it lacks a notion of the topic being shared between the words in an n-gram.",
        "The Hidden Topic Markov Model (HTMM) (Gruber et al., 2007) assumes that all words in a sentence have the same topic, and consecutive sentences are likely to have the same topic.",
        "By dropping the independence assumption among topics, HTMM is able to achieve lower perplexity scores than LDA at minimal additional computational costs.",
        "These models are unconcerned with topical n-grams and thus do not model phrases.",
        "Johnson (2010) presents an Adaptor Grammar model of topical phrases.",
        "Adaptor Grammars are a framework for specifying nonparametric Bayesian models over context-free grammars in which certain subtrees are ?memoized?",
        "or remembered for reuse.",
        "In Johnson's model, subtrees corresponding to common phrases for a topic are memoized, resulting in a model in which each topic is associated with a distribution over whole phrases.",
        "While it is a theoretically elegant method for finding topical phrases, for large corpora we found inference to be impractically slow."
      ]
    },
    {
      "heading": "5 Phrase Intrusion Experiment",
      "text": [
        "Perplexity is the typical information theoretic measure of language model quality used in lieu of extrinsic measures, which are more difficult and costly to run.",
        "However, it is well known that perplexity Trial 1 of 80",
        "experiment in which subjects must click on the n-gram that does not belong.",
        "scores may negatively correlate with actual quality as assessed by humans (Chang et al2009).",
        "With that fact in mind, we expanded the methodology of Chang et al2009) to create a ?phrase intrusion?",
        "task that quantitatively compares the quality of the topical n-gram lists produced by our model against those of other models.",
        "Each of 48 subjects underwent 80 trials of a web-based experiment on Amazon Mechanical Turk, a reliable (Paolacci et al2010) and increasingly common venue for conducting online experiments.",
        "In each trial, a subject is presented with a randomly ordered list of four n-grams (cf.",
        "Figure 4).",
        "Each subject's task is to select the intruder phrase, a spurious n-gram not belonging with the others in the list.",
        "If, other than the intruder, the items in the list are all on the same topic, then subjects can easily identify the intruder because the list is semantically cohesive and makes sense.",
        "If the list is incohesive and has no discernible topic, subjects must guess arbitrarily and performance is at random.",
        "To construct each trial's list, we chose two topics z and z?",
        "(z 6= z?",
        "), then selected the three most probable n-grams from z and the intruder phrase, an n-gram probable in z?",
        "and improbable in z.",
        "This design ensures that the intruder is not identifiable due solely to its being rare.",
        "Interspersed among the phrase intrusion trials were several simple screening trials intended to affirm that subjects possessed a minimal level of attentiveness and reading comprehension.",
        "For example, one such screening trial presented subjects with the list banana, apple, television, orange.",
        "Subjects who got any of these trials",
        "Excluding trials with repeated words does not qualitatively affect the results.",
        "wrong were excluded from our analyses.",
        "Each subject was presented with trials constructed from the output of PDLDA and TNG for unigrams, bigrams, and trigrams.",
        "For unigrams, we also tested the output of the original smoothed LDA (Blei et al., 2003).",
        "The experiment was conducted twice for a 2,246-document subset of the TREC AP corpus (Blei et al2003; Harman, 1992): the first time proceeded as described above, but the second time did not allow word repetition within a topic's list.",
        "The topical phrases found by TNG and PDLDA often revolve around a central n-gram, with other words pre-or post-appended to it.",
        "In this intrusion experiment, any n-gram not containing the central word or phrase may be trivially identifiable, regardless of its relevance to the topic.",
        "For example, the intruder in Trial 4 of Figure 4 is easily identifiable even if a subject does not understand English.",
        "This second experiment was designed to test whether our conclusions hinge on word repetition.",
        "We used the MALLET toolbox (McCallum, 2002) for the implementations of LDA and TNG.",
        "Each model was run with 100 topics for 5,000 iterations.",
        "We set m = 2, ?",
        "= .01, ?",
        "= .01, ?",
        "= 1,",
        "els, we treated certain punctuation as the start of a phrase by setting cj = 1 for all tokens j immediately following periods, commas, semicolons, and exclamation and question marks.",
        "To reduce runtime, we removed stopwords occuring in the MALLET toolbox's stopword list.",
        "Because TNG and LDA had trouble with single character words not in the sto-plist, we manually removed them before the experiment.",
        "Any token immediately following a removed word was treated as if it were the start of a phrase.",
        "As in Chang et al2009), performance is measured via model precision, the fraction of subjects agreeing with the model.",
        "It is defined as MPm,nk =?",
        "k,s is the index of the intruding n-gram for subject s among the words generated from the kth topic of model m, im,nk,s is the intruder selected by s, and S is the number of subjects.",
        "The model precisions are shown in Figure 5.",
        "PDLDA achieves the highest precision in all conditions.",
        "Model precision is low in all models, which is a reflection of how challenging the task is on a small corpus laden with proper nouns and low-frequency words.",
        "Figure 5b demonstrates that the outcome of the experiment does not depend strongly on whether the topical n-gram lists have repeated words."
      ]
    },
    {
      "heading": "6 Conclusion",
      "text": [
        "We presented a topic model which simultaneously segments a corpus into phrases of varying lengths and assigns topics to them.",
        "The topical phrases found by PDLDA are much richer sources of information than the topical unigrams typically produced in topic modeling.",
        "As evidenced by the phrase-intrusion experiment, the topical n-gram lists that PDLDA finds are much more interpretable than",
        "those found by TNG.",
        "The formalism of Bayesian changepoint detection arose naturally from the intuitive assumption that the topic of a sequence of tokens changes periodically, and that the tokens in between changepoints comprise a phrase.",
        "This formalism provides a principled way to discover phrases within the LDA framework.",
        "We presented a model embodying these principles and showed how to incorporate dependent Pitman-Yor processes into it."
      ]
    },
    {
      "heading": "Acknowledgements",
      "text": [
        "The first author is supported by an NSF Graduate Research Fellowship.",
        "The first and second authors began this project while working at J.D.",
        "Power & Associates.",
        "We are indebted to Michael Mozer, Matt Wilder, and Nicolas Nicolov for their advice."
      ]
    }
  ]
}
