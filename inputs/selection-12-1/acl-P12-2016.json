{
  "info": {
    "authors": [
      "Sravana Reddy",
      "Kevin Knight"
    ],
    "book": "ACL",
    "id": "acl-P12-2016",
    "title": "Decoding Running Key Ciphers",
    "url": "https://aclweb.org/anthology/P12-2016",
    "year": 2012
  },
  "references": [
    "acl-D08-1085",
    "acl-P10-1106",
    "acl-P11-1025"
  ],
  "sections": [
    {
      "heading": "Abstract",
      "text": [
        "There has been recent interest in the problem of decoding letter substitution ciphers using techniques inspired by natural language processing.",
        "We consider a different type of classical encoding scheme known as the running key cipher, and propose a search solution using Gibbs sampling with a word language model.",
        "We evaluate our method on synthetic cipher-texts of different lengths, and find that it outperforms previous work that employs Viterbi decoding with character-based models."
      ]
    },
    {
      "heading": "1 Introduction",
      "text": [
        "The running key cipher is an encoding scheme that uses a secret keyR that is typically a string of words, usually taken from a book or other text that is agreed upon by the sender and receiver.",
        "When sending a plaintext message P , the sender truncates R to the length of the plaintext.",
        "The scheme also relies on a substitution function f , which is usually publicly known, that maps a plaintext letter p and key letter r to a unique ciphertext letter c. The most common choice for f is the tabula recta, where c = (p + r) mod 26 for letters in the English alphabet, with A = 0, B = 1, and so on.",
        "To encode a plaintext with a running key, the spaces in the plaintext and the key are removed, and for every 0 ?",
        "i < |P |, the ciphertext letter at position i is computed to be Ci ?",
        "f(Pi, Ri).",
        "Figure 1 shows an example encoding using the tabula recta.",
        "For a given ciphertext and known f , the plaintext uniquely determines the running key and vice versa.",
        "?Research conducted while the author was visiting ISI.",
        "Since we know that the plaintext and running key are both drawn from natural language, our objective function for the solution plaintext under some language model is:",
        "where the running key RP,C is the key that corresponds to plaintext P and ciphertext C. Note that if RP,C is a perfectly random sequence of letters, this scheme is effectively a ?one-time pad?, which is provably unbreakable (Shannon, 1949).",
        "The knowledge that both the plaintext and the key are natural language strings is important in breaking a running key cipher.",
        "The letter-frequency distribution of running key ciphertexts is notably flatter than than the plaintext distribution, unlike substitution ciphers where the frequency profile remains unchanged, modulo letter substitutions.",
        "However, the ciphertext letter distribution is not uniform; there are peaks corresponding to letters (like I) that are formed by high-frequency plaintext/key pairs (like E and E)."
      ]
    },
    {
      "heading": "2 Related Work",
      "text": []
    },
    {
      "heading": "2.1 Running Key Ciphers",
      "text": [
        "Bauer and Tate (2002) use letter n-grams (without smoothing) up to order 6 to find the most probable plaintext/key character pair at each position in the ciphertext.",
        "They test their method on 1000-character ciphertexts produced from plaintexts and keys extracted from Project Gutenberg.",
        "Their accuracies range from 28.9% to 33.5%, where accuracy is measured as the percentage of correctly decoded char",
        "Plaintext ?",
        "linguistics is fun, Running Key ?",
        "colorless green ideas, tabula recta substitution where Ci ?",
        "(Pi +Ri) mod 26 Plaintext: L I N G U I S T I C S I S F U N Running Key: C O L O R L E S S G R E E N I D Ciphertext: N W Y U L T W L A I J M W S C Q acters.",
        "Such figures are too low to produce readable plaintexts, especially if the decoded regions are not contiguous.",
        "Griffing (2006) uses Viterbi decoding and letter 6-grams to improve on the above result, achieving a median 87% accuracy over several 1000-character ciphertexts.",
        "A key shortcoming of this work is that it requires searching through about 265 states at each position in the ciphertext."
      ]
    },
    {
      "heading": "2.2 Letter Substitution Ciphers",
      "text": [
        "Previous work in decipherment of classical ciphers has mainly focused on letter substitution.",
        "These ciphers use a substitution table as the secret key.",
        "The ciphertext is generated by substituting each letter of the plaintext according to the substitution table.",
        "The table may be homophonic; that is, a single plaintext letter could map to more than one possible ciphertext letter.",
        "Just as in running key ciphers, spaces in the plaintext are usually removed before encoding.",
        "Proposed decipherment solutions for letter substitution ciphers include techniques that use expectation maximization (Ravi and Knight, 2008), genetic algorithms (Oranchak, 2008), integer programming (Ravi and Knight, 2009), A* decoding (Corlett and Penn, 2010), and Bayesian learning with Dirichlet processes (Ravi and Knight, 2011)."
      ]
    },
    {
      "heading": "2.3 Vigene`re Ciphers",
      "text": [
        "A scheme similar to the running key cipher is the Vi-gene`re cipher, also known as the periodic key cipher.",
        "Instead of a single long string spanning the length of the plaintext, the key is a short string ?",
        "usually but not always a single word or phrase ?",
        "repeated to the length of the plaintext.",
        "Figure 2 shows an example Vigene`re cipher encoding.",
        "This cipher is less secure than the running key, since the short length of the key vastly reduces the size of the search space, and the periodic repetition of the key leaks information.",
        "Recent work on decoding periodic key ciphers perform Viterbi search on the key using letter n-gram models (Olsen et al., 2011), with the assumption that the length of the key is known.",
        "If unknown, the key length can be inferred using the Kasiski Test (Kasiski, 1863) which takes advantage of repeated plaintext/key character pairs."
      ]
    },
    {
      "heading": "3 Solution with Gibbs Sampling",
      "text": [
        "In this paper, we describe a search algorithm that uses Gibbs Sampling to break a running key cipher."
      ]
    },
    {
      "heading": "3.1 Choice of Language Model",
      "text": [
        "The main advantage of a sampling-based approach over Viterbi decoding is that it allows us to seamlessly use word-based language models.",
        "Lower order letter n-grams may fail to decipher most ciphertexts even with perfect search, since an incorrect plaintext and key could have higher likelihood under a weak language model than the actual message."
      ]
    },
    {
      "heading": "3.2 Blocked Sampling",
      "text": [
        "One possible approach is to sample a plaintext letter at each position in the ciphertext.",
        "The limitation of such a sampler for the running key problem is that is extremely slow to mix, especially for longer ciphertexts: we found that in practice, it does not usually converge to the optimal solution in a reasonable number of iterations even with simulated annealing.",
        "We therefore propose a blocked sampling algorithm that samples words rather than letters in the plaintext, as follows:",
        "1.",
        "Initialize randomly P := p1p2 .",
        ".",
        ".",
        "p|C|, fix R as the key that corresponds to P,C 2.",
        "Repeat for some number of iterations (a) Sample spaces (word boundaries) in P according to Pr(P ) (b) Sample spaces in R according to Pr(R) (c) Sample each word in P according to",
        "3.",
        "Remove spaces and return P,R Note that every time a word in P is sampled, it induces a change in R that may not be a word or a",
        "sequence of words, and vice versa.",
        "Sampling word boundaries will also produce hypotheses containing non-words.",
        "For this reason, we use a word trigram model linearly interpolated with letter trigrams (including the space character).1 The interpolation mainly serves to smooth the search space, with the added benefit of accounting for out-of-vocabulary, misspelled, or truncated words in the actual plaintext or key.",
        "Table 1 shows an example of one sampling iteration on the ciphertext shown in Figure 1."
      ]
    },
    {
      "heading": "4 Experiments",
      "text": []
    },
    {
      "heading": "4.1 Data",
      "text": [
        "We randomly select passages from the Project Gutenberg and Wall Street Journal Corpus extracts that are included in the NLTK toolkit (Bird et al., 2009).",
        "The passages are used as plaintext and key pairs, and combined to generate synthetic ciphertext data.",
        "Unlike previous works which used constant-length ciphertexts, we study the effect of message length on decipherment by varying the ciphertext length (10, 100, and 1000 characters).",
        "Our language model is an interpolation of word trigrams and letter trigrams trained on the Brown",
        "and similarly for Pr(R).",
        "Corpus (Nelson and Kucera, 1979), with Kneser-Ney smoothing.",
        "We fixed the word language model interpolation weight to ?",
        "= 0.7."
      ]
    },
    {
      "heading": "4.2 Baseline and Evaluation",
      "text": [
        "For comparison with the previous work, we reimplement Viterbi decoding over letter 6-grams (Griffing, 2006) trained on the Brown Corpus.",
        "In addition to decipherment accuracy, we compare the running time in seconds of the two algorithms.",
        "Both decipherment programs were implemented in Python and run on the same machines.",
        "The Gibbs Sampler was run for 10000 iterations.",
        "As in the Griffing (2006) paper, since the plaintext and running key are interchangeable, we measure the accuracy of a hypothesized solution against the reference as the max of the accuracy between the hypothesized plaintext and the reference plaintext, and the hypothesized plaintext and the reference key."
      ]
    },
    {
      "heading": "4.3 Results",
      "text": [
        "Table 2 shows the average decipherment accuracy of our algorithm and the baseline on each dataset.",
        "Also shown is the number of times that the Gibbs Sampling search failed ?",
        "that is, when the algorithm did not hypothesize a solution that had a probability at least as high as the reference within 10000 iterations.",
        "It is clear that the Gibbs Sampler is orders of magnitude faster than Viterbi decoding.",
        "Performance on the short (length 10) ciphertexts is poor under both algorithms.",
        "This is expected, since the degree of message uncertainty, or message equivocation as defined by Shannon, is high for short ciphertexts: there are several possible plaintexts and keys besides the original that are likely under an English language model.",
        "Consider the ciphertext WAEEXF-PROV which was generated by the plaintext segment ON A REFEREN and key INENTAL AKI.",
        "The algorithm hypothesizes that the plaintext is THE STRAND S and key DTAME OPELD, which both receive high language model probability.",
        "ciphertext test data were extracted by starting at random points in the corpora, and selecting the following n characters.",
        "Length of Plaintext and key # Cipher-Average Accuracy Avg.",
        "running time (sec) # Failed Gibbs ciphertext source texts Viterbi Gibbs Viterbi Gibbs searches",
        "However, on the long ciphertexts, our algorithm gets close to perfect decipherment, surpassing the Viterbi algorithm by a large margin.2 Accuracies on the Wall Street Journal ciphertexts are higher than on the Gutenberg ciphertexts for our algorithm, which may be because the latter is more divergent from the Brown Corpus language model."
      ]
    },
    {
      "heading": "5 Future Work",
      "text": []
    },
    {
      "heading": "5.1 Unknown substitution functions",
      "text": [
        "Some running key ciphers also use a secret substitution function f rather than the tabula recta or another known function.",
        "In typical cases, these functions are not arbitrary, but are parameterized by a secret keyword that mutates the tabula recta table.",
        "For example, the function with the keyword CIPHER would be the substitution table shown in Table 3.",
        "Decoding a running key ciphertext under a latent substitution function is an open line of research.",
        "One possibility is to extend our approach by sampling the keyword or function in addition to the plaintext."
      ]
    },
    {
      "heading": "5.2 Exact search",
      "text": [
        "Since some the errors in Gibbs Sampling decipherment are due to search failures, a natural extension of this work would be to adapt Viterbi search 2The accuracies that we found for Viterbi decoding are lower than those reported by Griffing (2006), which might be because they use an in-domain language model.",
        "or other exact decoding algorithms like A* to use word-level language models.",
        "A naive implementation of Viterbi word-based decoding results in computationally inefficient search spaces for large vocabularies, so more sophisticated methods or heuristics will be required."
      ]
    },
    {
      "heading": "5.3 Analysis of Running Key Decipherment",
      "text": [
        "While there has been theoretical and empirical analysis of the security of letter substitution ciphers of various lengths under different language models (Shannon, 1949; Ravi and Knight, 2008), there has been no similar exposition of running key ciphers, which we reserve for future work."
      ]
    },
    {
      "heading": "6 Conclusion",
      "text": [
        "We propose a decipherment algorithm for running key ciphers that uses Blocked Gibbs Sampling and word-based language models, which shows significant speed and accuracy improvements over previous research into this problem."
      ]
    },
    {
      "heading": "Acknowledgments",
      "text": [
        "We would like to thank Sujith Ravi for initial experiments using Gibbs sampling, and the anonymous reviewers.",
        "This research was supported in part by NSF grant 0904684."
      ]
    }
  ]
}
