{
  "info": {
    "authors": [
      "Victoria Fossum",
      "Roger Levy"
    ],
    "book": "Proceedings of the 3rd Workshop on Cognitive Modeling and Computational Linguistics (CMCL 2012)",
    "id": "acl-W12-1706",
    "title": "Sequential vs. Hierarchical Syntactic Models of Human Incremental Sentence Processing",
    "url": "https://aclweb.org/anthology/W12-1706",
    "year": 2012
  },
  "references": [
    "acl-D09-1034",
    "acl-H94-1020",
    "acl-J01-2004",
    "acl-J95-2002",
    "acl-J95-4004",
    "acl-J98-4004",
    "acl-N01-1021",
    "acl-N07-1051",
    "acl-P03-1054"
  ],
  "sections": [
    {
      "heading": "Abstract",
      "text": [
        "Experimental evidence demonstrates that syntactic structure influences human online sentence processing behavior.",
        "Despite this evidence, open questions remain: which type of syntactic structure best explains observed behavior -- hierarchical or sequential, and lexi-calized or unlexicalized?",
        "Recently, Frank and Bod (2011) find that unlexicalized sequential models predict reading times better than unlexicalized hierarchical models, relative to a baseline prediction model that takes word-level factors into account.",
        "They conclude that the human parser is insensitive to hierarchical syntactic structure.",
        "We investigate these claims and find a picture more complicated than the one they present.",
        "First, we show that incorporating additional lexical n-gram probabilities estimated from several different corpora into the baseline model of Frank and Bod (2011) eliminates all differences in accuracy between those unlexicalized sequential and hierarchical models.",
        "Second, we show that lexi-calizing the hierarchical models used in Frank and Bod (2011) significantly improves prediction accuracy relative to the unlexicalized versions.",
        "Third, we show that using state-of-the-art lexicalized hierarchical models further improves prediction accuracy.",
        "Our results demonstrate that the claim of Frank and Bod (2011) that sequential models predict reading times better than hierarchical models is premature, and also that lexicalization matters for prediction accuracy."
      ]
    },
    {
      "heading": "1 Introduction",
      "text": [
        "Various factors influence human reading times during online sentence processing, including word-level factors such as word length, unigram and bigram probabilities, and position in the sentence.",
        "Yet word-level factors cannot explain many observed processing phenomena; ample experimental evidence exists for the influence of syntax on human behavior during online sentence processing, beyond what can be predicted using word-level factors alone.",
        "Examples include the English subject/object relative clause asymmetry (Gibson et al., 2005; King and Just, 1991) and anti-locality effects in German (Konieczny, 2000; Konieczny and Doring, 2003), Hindi (Vasishth and Lewis, 2006), and Japanese (Nakatani and Gibson, 2008).",
        "Levy (2008) shows that these processing phenomena can be explained by surprisal theory under a hierarchical probabilistic context-free grammar (PCFG).",
        "Other evidence of syntactic expectation in sentence processing includes the facilitation of processing at 'or' following 'either' (Staub and Clifton, 2006); expectations of heavy noun phrase shifts (Staub et al., 2006); ellipsis processing (Lau et al., 2006); and syntactic priming (Sturt et al., 2010).",
        "Experimental evidence for the influence of syntax on human behavior is not limited to experiments carefully designed to isolate a particular processing phenomenon.",
        "Several broad-coverage experimental studies have shown that surprisal under hierarchical syntactic models predicts human processing difficulty on large corpora of naturally occurring text, even after word-level factors have been taken into",
        "account (Boston et al., 2008; Demberg and Keller, 2008; Roark et al., 2009).",
        "Despite this evidence, in recent work Frank and Bod (2011) challenge the notion that hierarchical syntactic structure is strictly necessary to predict reading times.",
        "They compare per-word surprisal predictions from unlexicalized hierarchical and sequential models of syntactic structure along two axes: linguistic accuracy (how well the model predicts the test corpus) and psychological accuracy (how well the model predicts observed reading times on the test corpus).",
        "They find that, while hierarchical phrase-structure grammars (PSGs) achieve better linguistic accuracy, sequential echo state networks (ESNs) achieve better psychological accuracy on the English Dundee corpus (Kennedy and Pynte, 2005).",
        "Frank and Bod (2011) do not include lexicalized syntactic models in the comparison on the grounds that, once word-level factors have been included as control predictors in the reading times model, lexicalized syntactic models do not predict reading times better than unlexicalized syntactic models (Demberg and Keller, 2008).",
        "Based on the results of their comparisons between unlexicalized models, they conclude that the human parser is insensitive to hierarchical syntactic structure.",
        "In light of the existing evidence that hierarchical syntax influences human sentence processing, the claim of Frank and Bod (2011) is surprising.",
        "In this work, we investigate this claim, and find a picture more complicated than the one they present.",
        "We first replicate the results of Frank and Bod (2011) using the dataset provided by the authors, verifying that we obtain the same linguistic and psychological accuracies reported by the authors.",
        "We then extend their work in several ways.",
        "First, we repeat their comparisons using additional, more robustly estimated lexical n-gram probabilities as control predictors in the baseline model.1 We show that when these additional lexical n-gram probabilities are used as control predictors, any differences in psychological accuracy between the hierarchical and sequential models used in Frank and Bod (2011) vanish.",
        "Second, while they restrict their comparisons to un-1By robustly estimated, we mean that these probabilities are estimated from larger corpora and use a better smoothing method (Kneser-Ney) than the lexical n-grams of Frank and Bod (2011).",
        "lexicalized models over part-of-speech (POS) tags, we investigate the lexicalized versions of each hierarchical model, and show that lexicalization significantly improves psychological accuracy.",
        "Third, while they explore only a subset of the PSGs implemented under the incremental parser of Roark (2001), we explore a state-of-the-art lexicalized hierarchical model that conditions on richer contexts, and show that this model performs still better.",
        "Our findings demonstrate that Frank and Bod (2011)'s strong claim that sequential models predict reading times better than hierarchical models is premature, and also that lexicalization improves the psychological accuracy of hierarchical models."
      ]
    },
    {
      "heading": "2 Related Work",
      "text": [
        "Several broad-coverage experimental studies demonstrate that surprisal under a hierarchical syntactic model predicts human processing difficulty on a corpus of naturally occurring text, even after word-level factors have been taken into account.",
        "Under surprisal theory (Hale, 2001; Levy, 2008), processing difficulty at word wi is proportional to reading time at wi, which in turn is proportional to the surprisal of wi in the context in which it is observed: surprisal(wi) = ?log(pr(wi|context)).",
        "Typically, context ?",
        "w1...wi?1.",
        "Computing surprisal(wi) thus reduces to computing ?log(pr(wi|w1...wi?",
        "1)).",
        "Henceforth, we refer to this original formulation of surprisal as total surprisal.",
        "Boston et al. (2008) show that surprisal estimates from a lexicalized dependency parser (Nivre, 2006) and an unlexicalized PCFG are significant predictors of reading times on the German Potsdam Corpus.",
        "Demberg and Keller (2008) propose to isolate syntactic surprisal from total surprisal by replacing each word with its POS tag, then calculating surprisal as usual under the incremental probabilistic phrase-structure parser of Roark (2001).",
        "(Following Roark et al. (2009), we hereafter refer to this type of surprisal as POS surprisal.)",
        "They find that only POS surprisal, not total surprisal, is a significant predictor of reading time predictions on the English Dundee corpus.",
        "Demberg and Keller (2008)'s definition of POS surprisal introduces two constraints.",
        "First, by omitting lexical information from the conditioning context, they ignore differences among words within a syntactic category that can influence syntactic expectations about upcoming material.",
        "Second, by replacing words with their most likely POS tags, they treat POS tags as veridical, observed input rather than marginalizing over all possible latent POS tag sequences consistent with the observed words.",
        "Roark et al. (2009) propose a more principled way of decomposing total surprisal into its syntactic and lexical components, defining the syntactic surprisal of wi as:",
        "and the lexical surprisal of wi as:",
        "where D is the set of derivations in the parser's beam at any given point; D : yield(D) = w1...wi is the set of all derivations in D consistent with w1...wi; and D minus last step includes all steps in the derivation except for the last step, in which wi is generated by conditioning upon all previous steps of D (including ti).",
        "Roark et al. (2009) show that syntactic surprisal produces more accurate reading time predictions on an English corpus than POS surprisal, and that decomposing total surprisal into its syntactic and lexical components produces more accurate reading time predictions than total surprisal taken as a single quantity.",
        "In this work, we compare not only different types of syntactic models, but also different measures of surprisal under each of those models (total, POS, syntactic-only, and lexical-only)."
      ]
    },
    {
      "heading": "3 Models",
      "text": [
        "Estimating surprisal(wi) amounts to calculating ?log(pr(wi|w1...wi?1)).",
        "Language models differ in the way they estimate the conditional probability of the event wi given the observed context w1...wi?1.",
        "In the traditional formulation of surprisal under a hierarchical model, the event wi is conditioned not only on the observed context w1...wi?1 but also on the latent context consisting of the syntactic trees T whose yield is w1...wi?1; computing pr(wi|w1...wi?1) therefore requires marginalizing over all possible latent contexts T .",
        "In this formulation of surprisal, the context includes lexical information (w1...wi?1) as well as syntactic information",
        "itself (wi) contains lexical information.",
        "Other formulations of surprisal are also possible, in which the event, observed context, and latent context are otherwise defined.",
        "In this work, we classify syntactic models as follows: lexicalized models include lexical information in the context, in the predicted event, or both; unlexicalized models include lexical information neither in the context nor in the predicted event; hierarchical models induce a latent context of trees compatible with the input; sequential models either induce no latent context at all, or induce a latent sequence of POS tags compatible with the input.",
        "Table 1 summarizes the syntactic models and various formulations of surprisal used in this work.",
        "Following Frank and Bod (2011), we consider one type of hierarchical model (PSGs) and two types of sequential models (Markov models and ESN?s)."
      ]
    },
    {
      "heading": "3.1 Phrase-Structure Grammars",
      "text": [
        "PSGs consists of rules expanding a parent node into children nodes in the syntactic tree, with associated probabilities.",
        "Frank and Bod (2011) use PSGs that generate POS tag sequences, not words.",
        "Under such grammars, the prefix probability of a tag sequence t is the sum of the probabilities of all trees",
        "each tree T is the product of the probabilities of the rules used in the derivation of T .",
        "Vanilla PCFG?s, a special case of PSGs in which the probability of a rule depends only on the identity of the parent node, achieve suboptimal parsing accuracy relative to grammars in which the probability of each rule depends on a richer context (Charniak, 1996; Johnson, 1998; Klein and Manning, 2003).",
        "To this end, Frank and Bod (2011) explore several variants of PSGs conditioned on successively richer contexts, including ancestor models (which condition rule expansions on ancestor nodes from 1-4 levels up in the tree) and ancestor+sibling models (which condition rule expansions on the ancestor's left sibling as well).",
        "Both sets of grammars also con",
        "to trees; t refers to POS tags; and w refers to words.",
        "dition rule expansions on the current head node2.",
        "In addition to the grammars over POS tag sequences used by Frank and Bod (2011), we evaluate PSGs over word sequences.",
        "We also include the state-of-the-art Berkeley grammar (Petrov and Klein, 2007) in our comparison.",
        "Syntactic categories in the Berkeley grammar are automatically split into fine-grained subcategories to improve the likelihood of the training corpus under the model.",
        "This increased expressivity allows the parser to achieve state-of-the-art automatic parsing accuracy, but increases grammar size considerably.3"
      ]
    },
    {
      "heading": "3.2 Markov Models",
      "text": [
        "Frank and Bod (2011) use Markov models over POS tag sequences, where the prefix probability of a sequence t is ?",
        "i pr(ti|ti?n+1, ti?n+2...ti?1).",
        "They use three types of smoothing: additive, Good-Turing, and Witten-Bell, and explore values of n from 1 to 3.",
        "der the prefix probability parser, we prune away all rules with probability less than 10?4."
      ]
    },
    {
      "heading": "3.3 Echo State Networks",
      "text": [
        "Unlike Markov models, ESN's (Ja?ger, 2001) can capture long-distance dependencies.",
        "ESN's are a type of recurrent neural network (Elman, 1991) in which only the weights from the hidden layer to the output layer are trained; the weights from the input layer to the hidden layer and from the hidden layer to itself are set randomly and do not change.",
        "In recurrent networks, the activation of the hidden layer at tag ti depends not only on the activation of the input layer at tag ti, but also on the activation of the hidden layer at tag ti?1, which in turn depends on the activation of the hidden layer at tag ti?2, and so forth.",
        "The activation of the output layer at tag ti is therefore a function of all previous input symbols t1...ti?1 in the sequence.",
        "The prefix probability of a sequence t under this model is",
        "where pr(ti|t1...ti?1) is the normalized activation of the output layer at tag ti.",
        "Frank and Bod (2011) evaluate ESN's with 100, 200...600 hidden nodes."
      ]
    },
    {
      "heading": "4 Methods",
      "text": [
        "We use two incremental parsers to calculate sur-prisals under the hierarchical models.",
        "For the PSGs available under the Roark et al. (2009) parser, we use that parser to calculate approximate prefix prob",
        "abilities using beam search.",
        "For the Berkeley grammar, we use a probabilistic Earley parser modified by Levy4 to calculate exact prefix probabilities using the algorithm of Stolcke (1995).",
        "We evaluate each hierarchical model under each type of surprisal (POS, total, lexical-only, and syntactic-only), where possible."
      ]
    },
    {
      "heading": "4.1 Data Sets",
      "text": [
        "Each syntactic model is trained on sections 2-21 of the Wall Street Journal (WSJ) portion of the Penn Treebank (Marcus et al., 1994), and tested on the Dundee Corpus (Kennedy and Pynte, 2005), which contains reading time measures for 10 subjects over a corpus of 2,391 sentences of naturally occurring text.",
        "Gold-standard POS tags for the Dundee corpus are obtained automatically using the Brill tagger (Brill, 1995).",
        "Frank and Bod (2011) exclude subject/word pairs from evaluation if any of the following conditions hold true: ?the word was not fixated, was presented as the first or last on a line, was attached to punctuation, contained more than one capital letter, or contained a non-letter (this included clitics)?.",
        "This leaves 191,380 subject/word pairs in the data set published by Frank and Bod (2011).",
        "Because we consider lexicalized hierarchical models in addition to unlexicalized ones, we additionally exclude subject/word pairs where the word is ?unknown?",
        "to the model.5 This leaves us with a total of 148,829 subject/word pairs; all of our reported results refer to this data set."
      ]
    },
    {
      "heading": "4.2 Evaluation",
      "text": [
        "Following Frank and Bod (2011), we compare the per-word surprisal predictions from hierarchical and sequential models of syntactic structure along two axes: linguistic accuracy (how well the model explains the test corpus) and psychological accuracy (how well the model explains observed reading times on the test corpus).",
        "Each model provides surprisal estimates surprisal(wi).",
        "The linguistic accuracy over the test corpus is 1n",
        "is the number of words in the test corpus.",
        "We add each model's per-word surprisal predictions to a linear mixed-effects model of first-pass reading times, then measure the improvement in reading time predictions (according to the deviance information criterion) relative to a baseline model; the resulting decrease in deviance is the psychological accuracy of the language model.",
        "Using the lmer package for linear mixed-effects models in R (Baayen et al., 2008), we first fit a baseline model to first-pass readings times over the test corpus.",
        "Each baseline model contains the following control predictors for each subject/word pair: sentpos (position of the word in the sentence), nrchar (number of characters in the word), prevnonfix (whether the previous word was fixated by the subject), nextnonfix (whether the next word was fixated by the subject), logwordprob (log(pr(wi))), logforwprob (log(pr(wi|wi?1))), and logbackprob (log(pr(wi|wi+1))).",
        "When fitting each baseline model, we include all control predictors; all significant two-way interactions between them (|t |?",
        "1.96); by-subject and byword intercepts; and a by-subject random slope for the predictor that shows the most significant effect (nrchar).6 We evaluate the statistical significance of the difference in psychological accuracy between two predictors using a nested model comparison.",
        "If the model containing both predictors performs significantly better than the model containing only the first predictor under a ?2 test (p ?",
        "0.05), then the second predictor accounts for variance in reading times above and beyond the first predictor, and vice versa.",
        "6In accordance with the methods of Frank and Bod (2011), ?Surprisal was not included as a by-subject random slope because of the possibility that participants?",
        "sensitivity to surprisal varies more strongly for some sets of surprisal estimates than for others, making the comparisons between language models unreliable.",
        "Since subject variability is not currently of interest, it is safer to leave out random surprisal effects.",
        "?"
      ]
    },
    {
      "heading": "5 Results",
      "text": [
        "We first replicate the results of Frank and Bod (2011) by obtaining POS surprisal values directly from the authors?",
        "published dataset for each syntactic model, then evaluating the psychological accuracy of each of those models relative to the baseline model defined above.7 Baseline Model with Additional Lexical N-grams Next, we explore the impact of the lexical n-gram probabilities used as control predictors upon psychological accuracy.",
        "Frank and Bod (2011) state that they compute lexical unigram and bigram probabilities via linear interpolation between estimates from the British National Corpus and the Dundee corpus itself (p.c.",
        "); upon inspection, we find that the bigram probabilities released in their published data set (which are consistent with their published experimental results) more closely resemble probabilities estimated from the Dundee corpus alone.",
        "Because of the small size of the Dundee corpus, lexical bigrams from this corpus alone are unlikely to be representative of a human's language experience.",
        "We augment the lexical bigram probabilities used in the baseline model of Frank and Bod (2011) with additional lexical unigram and bigrams estimated using the SRILM toolkit (Stolcke, 2002) with Kneser-Ney smoothing from three corpora: sections 2-21 of the WSJ portion of the Penn Treebank, the Brown corpus, and the British National corpus.",
        "We include these additional predictors and all two-way interactions between them in the baseline model.",
        "Figure 1 shows that the relative differences in psychological accuracy between unlexicalized hierarchical and sequential models vanish under this stronger baseline condition.8 Unlexicalized Hierarchical Models We then calculate POS surprisal values under each of the ancestor (a1-a4) and the ancestor+sibling (s1-s4) hierarchical models ourselves, using the parser of Roark 7The only difference between our results and the original results in Figure 2 of Frank and Bod (2011) is that we evaluate accuracy over a subset of the subject/items pairs used in Frank and Bod (2011) (see Section 4.1 for details).",
        "(e4) and the best hierarchical model (s3) used in Frank and Bod (2011) relative to the stronger baseline with additional lexical n-grams are not significantly different, according to a ?2 test.",
        "et al (2009).",
        "We also calculate POS surprisal under the Berkeley grammar (b) using the Levy prefix probability parser.",
        "Figure 2 shows the accuracies of these models.9 Lexicalized Hierarchical Models Next, we lex-icalize the hierarchical models.",
        "Figure 3 shows the results of computing total surprisal under each lexicalized hierarchical model (a1-a4T, s1-s4T, and bT).",
        "The lexicalized models improve significantly upon their unlexicalized counterparts (?2 = 7.52 to 12.47, p ?",
        "0.01) in all cases; by contrast, the unlexicalized models improve significantly upon their lexicalized counterparts (?2 = 4.05 to 5.92, p ?",
        "0.05) only in some cases (s1-s4).",
        "Each lexicalized model improves significantly upon e4, the best unlexicalized model of Frank and Bod (2011) (?2 = 6.96 to 23.45, p ?",
        "0.01), though e4 also achieves a smaller but still significant improvement upon each of the lexicalized models (?2 = 4.49 to 7.58, p ?",
        "0.05).",
        "The lexicalized Berkeley grammar (bT) achieves the highest linguistic and psychological accuracy; the improvement of bT upon e4 is substantial and significant (?2(1) = 23.45, p ?",
        "0.001), while the improvement of e4 upon bT is small but still significant (?2(1) = 4.50, p ?",
        "0.1).",
        "Estimated coefficients for surprisal estimates under each lexicalized hierarchical model are shown in Table 2.10 Decomposing Total Surprisal Figure 3 shows the results of decomposing total surprisal (a1-a4T, s1-s4T) into its lexical and syntactic components, then entering both components as predictors into the mixed-effects model (a1-a4LS, s1-s4LS).11 For each grammar, the psychological accuracy of the surprisal estimates is slightly higher when both lexical and syntactic surprisal are entered as predictors, though the differences are not statistically significant.",
        "9Our POS surprisal estimates have slightly worse linguistic accuracy but slightly better psychological accuracy than Frank and Bod (2011); these differences are likely due to differences in beam settings and in the subset of the WSJ used as training data.",
        "10Each surprisal estimate predicts reading times in the expected (positive) direction.",
        "11Decomposing surprisal into its lexical and syntactic components is possible with the Levy prefix probability parser as well, but requires modifications to the parser; the Roark et al. (2009) parser computes these quantities explicitly by default.",
        "prisal estimates from unlexicalized sequential and hierarchical models of Frank and Bod (2011) relative to baseline system of Frank and Bod (2011) (shown above dotted line), and relative to a baseline system including additional lexical unigrams and bigrams (shown below dotted line).",
        "Incorporating additional lexical n-grams into baseline system virtually eliminates all differences in psychological accuracy among models.",
        "surprisal estimates from unlexicalized hierarchical models used in this work, relative to a baseline system with additional lexical unigrams and bigrams.",
        "Horizontal line indicates most psychologically accurate model of Frank and Bod (2011) for ease of comparison.",
        "POS vs. Syntactic-only Surprisal Figures 2 and 4 show the results of computing POS surprisal (a1-a4, s1-s4) and syntactic-only surprisal (a1-a4S, s1-s4S), respectively, under each of the Roark grammars.",
        "While syntactic surprisal achieves slightly higher psychological accuracy than POS surprisal for each model, the difference is statistically significant in only one case (s1)."
      ]
    },
    {
      "heading": "6 Discussion",
      "text": [
        "In the presence of additional lexical n-gram control predictors, all gaps in performance between the unlexicalized sequential and hierarchical models used in Frank and Bod (2011) vanish (Figure 1).",
        "Frank and Bod (2011) do not include lexicalized hierarchical models in their study; our results indicate that lexicalizing hierarchical models improves their psychological accuracy significantly compared to the unlexicalized versions.",
        "Overall, the lexicalized hierarchical model with the highest linguistic accuracy (Berkeley) also achieves the highest psychological accuracy.",
        "Decomposing total surprisal into its lexical-and syntactic-only components improves psychological accuracy, but this improvement is not statistically significant.",
        "Computing syntactic-only surprisal instead of POS surprisal improves psychological accuracy, but this improvement is statistically significant in only one case (s1)."
      ]
    },
    {
      "heading": "7 Conclusion and Future Work",
      "text": [
        "Frank and Bod (2011) claim that sequential unlexicalized syntactic models predict reading times better than hierarchical unlexicalized syntactic models, and conclude that the human parser is insensitive to hierarchical syntactic structure.",
        "We find that the picture is more complicated than this.",
        "We show, first, that the gap in psychological accuracy between the unlexicalized hierarchical and sequential models of Frank and Bod (2011) vanishes when additional,",
        "cal+syntactic (LS) and total (T) surprisal estimates from lexicalized hierarchical models used in this work, relative to baseline system with additional lexical unigrams and bigrams as control predictors.",
        "Decomposing total surprisal into lexical-only and syntactic-components improves psychological accuracy.",
        "Horizontal line indicates most psychologically accurate model of (Frank and Bod, 2011).",
        "lexicalized hierarchical models used in this work, relative to baseline system with additional lexical unigrams and bigrams as control predictors.",
        "On its own, syntactic-only surprisal predicts reading times better than lexical-only surprisal.",
        "Horizontal line indicates most psychologically accurate model of (Frank and Bod, 2011).",
        "prisal estimates shown in Figure 3.",
        "Coefficients are estimated by adding each surprisal estimate, one at a time, to the baseline model of reading times used in Figure 3. robustly estimated lexical n-gram probabilities are incorporated as control predictors into the baseline model of reading times.",
        "Next, we show that lexicalizing hierarchical grammars improves psychological accuracy significantly.",
        "Finally, we show that using better lexicalized hierarchical models improves psychological accuracy still further.",
        "Our results demonstrate that the claim of Frank and Bod (2011) that sequential models predict reading times better than hierarchical models is premature, and that further investigation is required.",
        "In future work, we plan to incorporate lexical information into the sequential syntactic models used in Frank and Bod (2011) so that we can compare the hierarchical lexicalized models described here against sequential lexicalized models."
      ]
    },
    {
      "heading": "Acknowledgments",
      "text": [
        "The authors thank Stefan Frank for providing the dataset of Frank and Bod (2011) and a detailed specification of their experimental configuration.",
        "This research was supported by NSF grant 0953870, NIH grant 1R01HD065829, and funding from the"
      ]
    }
  ]
}
