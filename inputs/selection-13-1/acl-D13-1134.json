{
  "info": {
    "authors": [
      "Nikos Engonopoulos",
      "Martin Villalba",
      "Ivan Titov",
      "Alexander Koller"
    ],
    "book": "EMNLP",
    "id": "acl-D13-1134",
    "title": "Predicting the Resolution of Referring Expressions from User Behavior",
    "url": "https://aclweb.org/anthology/D13-1134",
    "year": 2013
  },
  "references": [
    "acl-D10-1040",
    "acl-P07-2031",
    "acl-P13-2014",
    "acl-W10-4233",
    "acl-W12-1604"
  ],
  "sections": [
    {
      "heading": "Abstract",
      "text": [
        "We present a statistical model for predicting how the user of an interactive, situated NLP system resolved a referring expression.",
        "The model makes an initial prediction based on the meaning of the utterance, and revises it continuously based on the user's behavior.",
        "The combined model outperforms its components in predicting reference resolution and when to give feedback."
      ]
    },
    {
      "heading": "1 Introduction",
      "text": [
        "Speakers and listeners in natural communication are engaged in a highly interactive process.",
        "In order to achieve some communicative goal, the speaker will perform an utterance which they believe has a high chance of achieving that goal.",
        "They will then monitor the listener's behavior to see whether this goal is actually being achieved.",
        "This process is a core part of what is commonly called grounding in the dialogue literature (see e.g. (Clark, 1996; Traum, 1994; Paek and Horvitz, 1999; Hirst et al., 1994)).",
        "Interactive computer systems that are to carry out an effective and efficient conversation with a user must model this grounding process, and should ideally respond to the user's observed behavior in real time.",
        "For instance, if the user of a pedestrian navigation system takes a wrong turn, the system should interpret this as evidence of misunderstanding and bring the user back on track.",
        "We focus here on the problem of predicting how the user has resolved a referring expression (RE) that was generated by the system, i.e. a noun phrase that is intended to identify some object uniquely to the listener.",
        "A number of authors have recently offered statistical models for parts of this problem.",
        "Golland et al. (2010) and Garoufi and Koller (2011) have presented log-linear models for predicting how the listener will resolve a given RE in a given scene; however, these models do not update the probability model based on observing the user's reactions.",
        "Nakano et al. (2007), Buschmeier and Kopp (2012), and Koller et al. (2012) all predict what the listener understood based on their behavior, but do not consider the RE itself in the model.",
        "The models of Frank and Goodman (2012) and Vogel et al. (2013) aim at explaining the effect of implicatures on the listener's RE resolution process in terms of hypothesized interactions, but do not actually support a real-time interaction between a system and a user.",
        "In this paper, we show how to predict how the listener has resolved an RE by combining a statistical model of RE resolution based on the RE itself with a statistical model of RE resolution based on the listener's behavior.",
        "To our knowledge, this is the first approach to combine two such models explicitly.",
        "We consider the RE grounding problem in the context of interactive, situated natural language generation (NLG) for the GIVE Challenge (Koller et al., 2010a), where NLG systems must generate real-time instructions in virtual 3D environments.",
        "Our evaluation is based on interaction corpora from the GIVE-2 and GIVE-2.5 Challenges, which contain the systems?",
        "utterances along with the behavior of human hearers in response to these utterances.",
        "We find that the combined model predicts RE resolution more accurately than each of the two component models alone.",
        "We see this as a first step towards implementing an actual interactive system that performs human-like grounding based on our RE resolution model."
      ]
    },
    {
      "heading": "2 Problem definition",
      "text": [
        "In the GIVE Challenge, an interactive NLG system faces the task of guiding a human instruction follower (IF) through a treasure-hunt game in a virtual 3D environment (see Fig. 1).",
        "To complete the task, the IF must press a number of buttons in the correct order; these buttons are the colored boxes in Fig. 1, and are scattered all over the virtual environment.",
        "The IF can move around freely in the virtual environment, but has no prior knowledge about the world.",
        "The NLG system's task is to guide the IF towards the successful completion of the treasure-hunt task.",
        "To this end, it is continuously being informed about the IF's movements and visual field, and can generate written utterances at any time.",
        "As a comparative evaluation effort, the GIVE Challenges connected NLG systems to thousands of users over the Internet (see e.g. Koller et al. (2010a) for details).",
        "Many system utterances are manipulation instructions, such as ?press the blue button?, containing an RE in the form of a definite NP.",
        "We call a given part of an interaction between the system and the IF an episode of that interaction if it starts with a manipulation instruction, ends with the IF performing an action (i.e., pressing a button), and contains only IF movements and no further utterances in between.",
        "Not all manipulation instructions initiate an episode, because the system may decide to perform further utterances (not containing REs) before the IF performs their action.",
        "An NLG system will choose the RE for an instruction at runtime out of potentially many semantically valid alternatives (?the blue button?, ?the button next to the chair?, ?the button to the right of the red button?, etc.).",
        "Ideally, it will predict which of these REs has the highest chance to be understood by the IF, given the current scene, and utter an instruction that uses this RE.",
        "After uttering the manipulation instruction, the system needs to ascertain whether the IF understood the RE correctly, i.e. it must engage in grounding.",
        "A naive grounding mechanism might wait until the IF actually presses a button and check whether it was the right one.",
        "This is what many NLG systems in the GIVE Challenges actually did.",
        "However, this can make the communication ineffective (IF performs many useless actions) and risky (IF may press the wrong button and lose).",
        "Thus, it is important that the system updates its prediction of how the IF resolved the RE continuously by observing the IF's behavior, before the actual button press.",
        "For instance, if the IF walks towards the target, this might reinforce the system's belief in a correct understanding; turning away or exiting the room could be strong evidence of the opposite.",
        "The system can then exploit the updated prediction to give the IF feedback (?no, the blue button?)",
        "to prevent costly mistakes.",
        "We address these challenges by estimating the probability distribution over the possible objects to which the IF may resolve the RE.",
        "We then update this distribution in real time by observing the IF's movements.",
        "More specifically, assume that a system tries to refer to some object a?",
        "among some set A of available objects.",
        "Given an RE r generated for a?",
        "at time t0, the state of the world s at t0, and the observed behavior ?",
        "(t) of the user at t ?",
        "t0, we estimate the probability p(a|r, s, ?",
        "(t)) that the user resolved r to an object a ?",
        "A.",
        "When generating the instruction, an optimal NLG system will use the RE r that maximizes p(a?|r, s, ?(t0)).",
        "It can then track p(a|r, s, ?",
        "(t)) for time points t > t0 throughout the episode, and generate feedback when p(a?|r, s, ?",
        "(t)) exceeds p(a?|r, s, ?",
        "(t)) for some a?",
        "6= a?",
        "; that is, when the updated probability distribution predicts that the IF resolved r to an incorrect button."
      ]
    },
    {
      "heading": "3 A model of RE resolution",
      "text": [
        "In order to model the distribution over possible objects, we assume the following generative story: when receiving an instruction containing an RE r at a given world state s, the IF resolves it to an object a; depending on the object a, the IF then moves towards it, exhibiting behavior ?.",
        "These assumptions correspond to the following factorization: p(a, ?|r, s) = p(?|a)p(a|r, s)",
        "The posterior probability distribution over objects a can be obtained by applying the Bayes rule and using the above assumptions: p(a|r, s, ?)",
        "?",
        "p(a|r, s)p(a|?",
        ")/p(a) For simplicity, we assume a uniform p(a) over all objects in a world.",
        "We can thus represent p(a|r, s, ?)",
        "as the normalized product of a semantic model psem(a|r, s) and an observational model pobs(a|?).",
        "We use log-linear models for both, and train them separately.",
        "The feature functions we use only consider general properties of objects (such as color and distance), and not the identity of the objects themselves.",
        "This means that we can train a model on one virtual environment (containing a certain set of objects), and then apply the model to another virtual environment, containing a different set of objects.",
        "Semantic model The semantic model estimates for each object a in the environment the initial probability psem(a|r, s) that the IF will understand a given RE r uttered in a scene s as referring to a.",
        "It represents the meaning of r, contextualized to s, and is only ever evaluated at the time t0 of the utterance.",
        "The features used by this model are: ?",
        "Semantic features aim to encode whether r is a good description of a. IsColorModifying evaluates to 1 if a's color appears as an adjective modifying the head noun of r, e.g. ?the blue button?.",
        "IsRelPosModifying evaluates to 1 if a's relative position to the IF is mentioned as an adjective in r, e.g. ?the left button?.",
        "?",
        "Confusion features capture the hypothesis that the IF may be confused by the description of a landmark when resolving the RE; e.g. an RE like ?the button next to the red button?",
        "might confuse the IF into pressing a red button, rather than the one meant by the system.",
        "These are the same features as in the Semantic case, but looking for modifier keywords in the entire RE, including the head.",
        "?",
        "Salience features account for the fact that an IF is more likely to resolve r to a if a was visually salient in s. IsVisible evaluates to 1 if a is visible to the IF in s. IsInRoom evaluates to 1 if the IF and a are in the same room.",
        "IsTarget-InFront evaluates to 1 if the angular distance towards a, i.e. the absolute angle between the camera direction and the straight line from the IF to a, is less than pi4 .",
        "VisualSalience approximates the visual salience of Kelleher and van Genabith (2004), a weighted count of the number of pixels on which a is rendered (pixels near the center of the screen have higher weights).",
        "Observational model The observational model estimates for each object a the probability pobs(a|?)",
        "that the IF will interact with a, given the IF's recent behavior ?",
        "(t) = (?1, .",
        ".",
        ".",
        ", ?n), where ?i is the state of the world at time t?",
        "(i?",
        "1) ?",
        "500ms, and n ?",
        "1 is the length of the observed behavior.",
        "pobs is constantly re-evaluated for times t > t0 as the IF moves around.",
        "pobs uses the following features: ?",
        "Linear distance features assume that the closest button is also the one the IF understood.",
        "In-Room returns the number of frames ?i in ?",
        "in which the IF and a are in the same room.",
        "But-tonDistance returns the distance between the IF and a at ?1 divided by a constant such that the result never exceeds 1.",
        "If a is neither in the same room nor visible, the feature returns 1. ?",
        "Angular distance features analyze the direction in which the IF looks.",
        "TargetInFront returns the angular distance towards a at ?1.",
        "An-gleToTarget returns TargetInFront divided by pi, or 1 if a is neither in the same room nor visible.",
        "LinearRegAngleTo applies linear regression to a list of observed angular distances towards a over all frames ?i, and returns the slope of the regression as a measure of variation.",
        "Negative values indicate that the IF turned towards a, while positive values mean the opposite.",
        "If a is neither visible nor in the same room as the IF at ?i, the angle is set to pi.",
        "?",
        "Combined distance feature: a weighted sum of linear and angular distance towards a, called overall distance in Koller et al. (2012).",
        "?",
        "Salience features capture visual salience and its change over time.",
        "Defining VSi as the result of applying the psem feature VisualSalience to ?i and a, LastVisualSalience returns VSn.",
        "Lin-earRegVisualSalience applies linear regression to all values VSi and returns the slope as a measure of change in salience.",
        "VisualSalienceSum returns (?ni=1VSi) ?VS1.",
        "This emphasizes the contribution of VS1, which we assume is the",
        "most reliable predictor of the IF's intentions.",
        "?",
        "Binary features aim to detect concrete behavior patterns: LastIsVisible applies the psem feature IsVisible to ?1, and IsClose evaluates to 1 if the IF is close enough and correctly oriented to manipulate a in the GIVE environment at ?1."
      ]
    },
    {
      "heading": "4 Evaluation",
      "text": [
        "Data We evaluated our model using data from the GIVE-2 (Koller et al., 2010b) and the GIVE-2.5 Challenges (Striegnitz et al., 2011), obtained from GIVE Organizers (2012).",
        "These datasets constitute interaction corpora, in which the IF's activities in the virtual environment were recorded along with the utterances automatically generated by the participating NLG systems.",
        "The data consists of 1833 games for GIVE-2 and 687 games for GIVE-2.5.",
        "To extract training data for our model from the GIVE-2.5 data, we first identified moments in the recorded data where the IF pressed a button.",
        "From these, we discarded all instances from the tutorial phase of the GIVE game and those that happened within 200 ms after the previous utterance, as these clearly didn't happen in response to it.",
        "This yielded 6478 training instances for pobs, each consisting of ?",
        "at 1 second before the action, and the button a which the IF pressed.",
        "We chose n = 4 for representing ?, except to ensure that the features only considered IF behavior that happened in response to an utterance.",
        "We achieved this by reducing n for the first few frames after each utterance, such that the time of ?n was always after the time of the utterance.",
        "Finally, we selected those instances which are episodes in the sense of Section 2, i.e. those in which the last utterance before the action contained an RE r. This gave us 3414 training instances for psem, each consisting of a, r, the time t0 of the utterance, and the world state s at time t0.",
        "We obtained test instances from the GIVE-2 data in the same way.",
        "This yielded 5028 instances, each representing an episode.",
        "We chose GIVE-2 for testing because the mean episode length is higher (3.3s, vs. 2.0s in GIVE-2.5), thus making the evaluation more challenging.",
        "Feature selection was done using the training data and a similar dataset from Koller et al.",
        "(2012).",
        "Note that the test data and training data are based on distinct sets of three virtual environ",
        "successful episodes as a function of time.",
        "ments each, and were obtained with different NLG systems and users.",
        "This demonstrates the ability of our model to generalize to unseen environments.",
        "An example video showing our models?",
        "predictions on some training episodes can be found at http://tinyurl.com/re-demo-v.",
        "Prediction accuracy We first evaluated the ability of our model to predict the button to which the IF resolved each RE.",
        "For each test instance ?r, s, ?, a?, we compare the object returned by arg maxa p(a|r, s, ?",
        "(t)) to the one manipulated by the IF.",
        "We call the proportion of correctly classified instances the prediction accuracy.",
        "Fig.",
        "2a compares our model's prediction accuracy to that of several baselines.",
        "We plot prediction accuracy as a function of the time at which the model is queried for a prediction, by evaluating at 3s, 2s, 1s, and 0s before the button press.",
        "The graph is based on the 2094 test instances with an episode length of at least three seconds, to ensure that results for different prediction times are comparable.",
        "As expected, prediction accuracy increases as we approach the time of the action.",
        "Furthermore, the combined model outperforms both psem and pobs reliably.",
        "This indicates that the component models pro",
        "vide complementary useful information.",
        "Our model also outperforms two more baselines: KGSC predicts that the IF will press the button with the minimal overall distance, which is the distance metric used by the ?movement-based system?",
        "of Koller et al.",
        "(2012); random visible selects a random button from the ones that are currently visible to the IF.",
        "The fact that this last baseline does not approach 1 at action time suggests that multiple buttons tend to be visible when the IF presses one, confirming that the prediction task is not trivial.",
        "Correctly predicting the button that the IF will press is especially useful, and challenging, in those cases where the IF pressed a different button than the one the NLG system intended.",
        "Fig.",
        "2b shows a closer look at the 125 unsuccessful episodes of at least three seconds in the test data.",
        "These tend to be hard instances, and thus as expected, prediction accuracy drops for all systems.",
        "However, by integrating semantic and observational information, the combined model compensates better for this than all other systems, with an accuracy of 37.6% against 31.2% for each individual component.",
        "Feedback appropriateness Second, we evaluated the ability of our model to predict whether the user misunderstood the RE and requires feedback.",
        "For all the above models, we assumed a simple feedback mechanism which predicts that the user misunderstood the RE if p(a?)",
        "?",
        "p(a?)",
        "> ?",
        "for some object a?",
        "6= a?, where ?",
        "is a confidence threshold; we used ?",
        "= 0.1 here.",
        "We can thus test on recorded data in which no actual feedback can be given anymore.",
        "We evaluated the models on the 848 test episodes of at least 3s in which the NLG systems logged the button they tried to refer to.",
        "The results are shown in Fig. 3 in terms of F1 measure.",
        "Here precision is the proportion of instances in which the IF pressed the wrong button (i.e., where feedback should have been given) among the instances where the model actually suggested feedback.",
        "Recall is the proportion of instances in which the model suggested feedback among the instances where the IF pressed the wrong button.",
        "Again, the combined model outperforms its components and the baselines, primarily due to increased recall.",
        "The difference is particularly pronounced early on, which would be useful in giving timely feedback in an actual real-time system."
      ]
    },
    {
      "heading": "5 Conclusion and future work",
      "text": [
        "We presented a statistical model for predicting how a user will resolve the REs generated by an interactive, situated NLG system.",
        "The model continuously updates an initial estimate based on the meaning of the RE with a model of the user's behavior.",
        "It outperforms its components and two baselines on prediction and feedback accuracy.",
        "Our model captures a real-time grounding process on the part of the interactive system.",
        "We thus believe that it provides a solid foundation for detecting misunderstandings and generating suitable feedback in an end-to-end dialogue system.",
        "We have presented our model in terms of a situated dialogue setting, where clues about what the hearer understood can be observed directly.",
        "However, we believe that the fundamental mechanism should apply to other domains as well.",
        "This would amount to finding observable linguistic and non-linguistic clues of hearer understanding that can be used as features of pobs.",
        "The immediate next step for future research is to extend our model to an implemented end-to-end situated NLG system for the GIVE Challenge, and evaluate whether this actually improves task performance.",
        "This requires, in particular, to compute the RE that is optimal with respect to psem.",
        "We will furthermore improve pobs by switching to a more temporally dynamic probability model.",
        "Acknowledgments.",
        "We thank Konstantina Garoufi and the anonymous reviewers for their insightful comments and suggestions.",
        "The first two authors were supported by the SFB 632 ?Information Structure?",
        "; Titov's work was supported by the Cluster of Excellence at Saarland University."
      ]
    }
  ]
}
