{
  "info": {
    "authors": [
      "Rebecca Mason",
      "Eugene Charniak"
    ],
    "book": "WVL",
    "id": "acl-W13-1301",
    "title": "Annotation of Online Shopping Images without Labeled Training Examples",
    "url": "https://aclweb.org/anthology/W13-1301",
    "year": 2013
  },
  "references": [
    "acl-A97-1004",
    "acl-D09-1092",
    "acl-N03-1033",
    "acl-N10-1125",
    "acl-N12-1018",
    "acl-P10-1126"
  ],
  "sections": [
    {
      "heading": "Abstract",
      "text": [
        "We are interested in the task of image annotation using noisy natural text as training data.",
        "An image and its caption convey different information, but are generated by the same underlying concepts.",
        "In this paper, we learn latent mixtures of topics that generate image and product descriptions on shopping websites by adapting a topic model for multilingual data (Mimno et al., 2009).",
        "We use the trained model to annotate test images without corresponding text.",
        "We capture visual properties such as color, texture, shape, and orientation by computing low-level image features, and measure the contribution of each type of visual feature towards the accuracy of the model.",
        "Our model significantly outperforms both a competitive baseline and a previous topic model-based system."
      ]
    },
    {
      "heading": "1 Introduction",
      "text": [
        "Image annotation is a classic problem in Computer Vision.",
        "Given a query image, the task is to generate a set of textual labels that describe the visual content.",
        "The typical approach to these problems is to use supervised models, which require large numbers of hand-annotated examples for each of the labels.",
        "However, the amount of information available on the web continues to grow, the task of organizing and describing visual data becomes increasingly complex.",
        "For example, a shopping website might arrange products into broad categories such as ?shoes?",
        "and ?handbags?",
        "with each category containing tens of thousands of products that are difficult for users to search and navigate.",
        "It is often infeasible to discover all of the attributes within those categories that are relevant to users and create labeled training examples for each of them.",
        "Instead, we approach this problem by discovering visual attributes from noisy natural language captions.",
        "That is, given a collection of images and captions found on the web, we learn a model of visual and textual features.",
        "Then given a query image with no text, we can generate likely descriptive words.",
        "This is a difficult task because image captions on the web are often noisy and incomplete: some captions might not describe a particular visual feature, might use a synonym for that feature, or might describe information that is not visual in the image at all.",
        "A secondary motivation for this work is to use the image annotations as a component in language generation systems such as for automatic image captioning.",
        "We point to examples of previous work such as Feng and Lapata (2010a) where image annotations generated from a topic model are used to help generate full sentences to describe images.",
        "Much of the current research in image captioning is limited by the current technology for object recognition in Computer Vision.",
        "For example, SBU-Flickr dataset (Ordonez et al., 2011) with 1 million images and captions, is considered to be general-domain but is actually built by querying Flickr using a predefined term list related to visual attributes that there are trained recognition systems for.",
        "While these systems can accurately generate descriptions for common visual objects and attributes, they are not as well-suited for describing the ?long-tail?",
        "of visual attributes which appear in many domain-specific",
        "Two adjustable buckle straps top a classic rubber rain boot grounded by a thick lug sole for excellent wet-weather traction.",
        "uniform, while captions have more noise and variation.",
        "datasets.",
        "In this paper, we model image and text features from the training data using a generative model.",
        "We adapt the Polylingual topic model from Mimno et al.",
        "(2009) to train on multi-modal data, and then use the trained model to generate annotations for test images.",
        "We evaluate our model on two categories of shopping images using a variety of types of computed image features.",
        "For image annotation we outperform both a difficult baseline and previous work."
      ]
    },
    {
      "heading": "2 Related Work",
      "text": [
        "We use the polylingual topic model from Mimno et al.",
        "(2009), which was developed to model multilingual corpora that are topically comparable between languages ?",
        "the documents are not direct translations, but they cover the same ideas.",
        "For example, English and Finnish Wikipedia pages about skiing are roughly similar, but the subject is covered more thoroughly in Finnish.",
        "Therefore, the number of tokens assigned to the Finnish topic for skiing is much higher than it is in the English.",
        "While Mimno et al. (2009) show that the model is effective in tasks such as modeling topically comparable documents across languages, our work is the first to show that this model can be used to model data of different modalities.",
        "Another quality of the polylingual topic model is that words in different languages do not directly correspond with each other.",
        "This is a feature of other multilingual topic models but would not work for multi-modal data because a textual word can carry more meaning by itself than an image feature can.",
        "Countless approaches have been proposed for the use of topic models in image annotation, but the vast majority of these approaches consider the text modality merely as labels for the image modality.",
        "The most highly cited of these is the Correspondence LDA (corr-LDA) model of Blei et al. (2003), where topics are learned using the image modality alone, and each textual word must be generated by a specific region in the image.",
        "However, more recent work has started to recognize the textual modality as a source of information in its own right.",
        "Jia et al.",
        "(2011) present a model that allows different information to be emphasized in each modality, but it requires very clean text; they do not use documents with captions that cannot be easily parsed or processed.",
        "Then, they stem all words, and disregard sparse word tokens.",
        "This works when working with sources such as Wikipedia, where text captions are highly edited and consistently formatted.",
        "In compar-ision, our work can be trained on corpra where the text has poor or inconsistant quality.",
        "Additionally, their work was for the task of image retrieval from a text query, while we are generating text annotations for a query image.",
        "Our work is most similar to the MixLDA model of Feng and Lapata (2010b), except MixLDA mod",
        "els images and their related text as a single bag-of-features, with visual and textual features coming from the same vocabulary.",
        "This means that some topics should have a greater proportion of features from one of modalities, if there is an idea that is better expressed in one over the other.",
        "Their model was developed for finding descriptive words given both an image and a news article, and can also be used on large and noisy amounts of data, so we compare MixLDA against our model in the experiments.",
        "Although we use the Attribute Discovery Dataset of Berg et al. (2010), their work is different from ours in both problem formulation and the types of attributes discovered.",
        "Their primary interest is to characterize attributes according to how they are visually represented: global or local; color, texture, or shape.",
        "Their work does not address the task of predicting attributes for unseen images.",
        "Additionally, they do not work with individual descriptive words, but cluster them using mutual information of visual attributes, creating a smaller number of ?visual synsets?.",
        "For example, one of their visual synsets for images and descriptions of womens handbags is {mesh, interior, metal} and another is {silver, metallic}.",
        "In comparison, in the topic model the same word can be generated by more than one topic.",
        "Liu et al. (2010) examine the use of a variety of image features in a Bayesian model in order to measure which are the best for classifying diverse materials such as stone, glass, and plastic.",
        "They found that the image features they used for shape and color were better indicators of the material of an object than texture features, and their best combined model did not include texture as a feature at all.",
        "We are also interested in finding out whether our performance on generating descriptive words is affected by different types of image features."
      ]
    },
    {
      "heading": "3 Dataset",
      "text": [
        "We use the Attribute Discovery Dataset from Berg et al. (2010).1 The dataset consists of pairs of images and captions taken from the shopping website like.com.",
        "The data has four categories: women's shoes, handbags, earrings, and neckties.",
        "We run our model on two categories, shoes and handbags, due",
        "to their larger sizes ?",
        "14764 and 9145 image-caption pairs respectively ?",
        "and diversity of features.",
        "This is a reasonable amount of data in the shopping images domain; more than half of the number of comparable products sold on large retail websites such as Zappos.com or Amazon.com.",
        "Compared to general datasets such as Pascal Sentences, the images in the Attribute Discovery Dataset are more uniform.",
        "All image files are 280x280 pixel JPEGs, and images of products are typically taken from similar angles against a white or a light-colored solid background.",
        "Only rarely do the images have noisy backgrounds, such as a person wearing the item, or the same item displayed in multiple colors in one image.",
        "However, this does not necessarily make our task much easier, since the visual attributes we wish to learn are not predefined as they are in a general-domain dataset.",
        "And the lack of hand-annotated data means no negative examples of when an attribute is not present, which are typically used to train visual classifiers.",
        "Furthermore, the captions are extremely noisy in this dataset.",
        "Compared to the 20 object types in the Pascal Sentences dataset, or about one hundred in COREL, here there are thousands of words that can be used to describe features in the images, including synonyms, multiple stems of words, and misspellings.",
        "In addition to explicit visual descriptions of the products, the captions describe ?less visual?",
        "features such as details about the construction of the item, during which season or activity it would be appropriate to wear, or feelings that could be evoked by looking at the item.",
        "These features are difficult to represent as specific visual attributes, but can be identified visually by domain-experts.",
        "Captions can also include information that is non-visual such as sizing and shipping information, or whether the item is on sale.",
        "The captions can be either full English sentences, a list of features, or sometimes just a few words.",
        "Longer captions in the dataset are truncated to 250 characters in length.",
        "From our own obervations, we estimate about 10% of the captions in the shoes dataset contain few or no descriptive words.",
        "At least 3.7% of the shoes captions are entirely Javascript code, have significant portions of code, or very long URLs.",
        "Another 5-6% either contain no information besides",
        "sizing or shipping information, only the brand name or model number of the shoe, or the caption is so short that there are only one or two descriptive words that could be used in our model.",
        "In the womens?",
        "shoes category, we take some simple steps to remove URLs and code to avoid learning accidental correlation with legitimate features.2 However, we still use all image and caption pairs in the training set, including those which end up having empty captions, since they are still useful for learning topics for visual features.",
        "For the handbags captions, we did not try to remove code or long URLs since it seemed to be less of a problem in that category."
      ]
    },
    {
      "heading": "4 Feature Representation",
      "text": []
    },
    {
      "heading": "4.1 Text Features",
      "text": [
        "The bag-of-words model is used for text.",
        "We use Mxterminator (Reynar and Ratnaparkhi, 1997) to split sentences in the captions (in many instances, nothing is done in this step becuase there are no full sentences in the caption), Stanford POS Tag-ger(Toutanova et al., 2003) to tag words, then include adjectives, adverbs, verbs, and nouns in the topic model (except for proper nouns and common background English words from a stoplist).",
        "However, these tags are really more a rough estimate of parts of speech due to the number of incomplete sentences and phrases, and the fact that many of the words used to describe styles or attributes of clothing have different meanings in colloqueal English.3 All tokens are converted to lower case, but there is no stemming or lemmatization.",
        "After preprocessing, the size of the shoes text vocabulary is 9578 words, with an average of 16.33 descriptive words per image, while the bags have a text vocabulary of 6309 word types with 15.41 descriptive words per image on average."
      ]
    },
    {
      "heading": "4.2 Visual Features",
      "text": [
        "The bag-of-features model is used for visual features as well.",
        "Most of these features are standard in computer vision research, and are also used in work we cited in Section 2.",
        "image descriptions: www.zappos.com/glossary Shape: A SIFT descriptor describes which way edges are oriented at a certain point in an image (Lowe, 1999).",
        "It was develped to recognize the same object under different scales and rotations.",
        "However, it is also commonly used for recognizing more generalized types or features of objects.",
        "We use the VLFeat open source library (Vedaldi and Fulkerson, 2008) to compute SIFT features at points of interest and to cluster the SIFT features into discrete ?visual terms?",
        "using the k-means algorithm.",
        "There are 750 visual terms for SIFT features.",
        "Color: We use two representations for color, RGB (red, green, blue) and HSV (hue, saturation, value).",
        "25 pixels are sampled from the center 100x100 pixels of the image (to avoid sampling from the background of the image).",
        "Those pixel values are also clustered to visual terms using k-means, with 100 visual terms each.",
        "Texture: Images are convolved with Gabor filters at multiple orientations and scales, sampled at random locations, then clustered to form texton features for texture (Leung and Malik, 2001).",
        "We convert all images to grayscale, then sample 25 locations from the center of the image, and cluster to 100 visual terms.",
        "We also have a color texton feature, where we sample and cluster textons separately for the red, green, and blue color channels.",
        "Reflectance/Curvature:4 We use three types of related features for gradients and curvature.",
        "The first is a bag-of-HOG (histogram of gradients) feature set (Dalal and Triggs, 2005) computed over a regular grid on the image to measure changes in intensity.",
        "The most significant of those features (as determined by L2 norm) are selected for each image, and like previous features are clustered into visual terms using k-means.",
        "The second two types are derivatives of HOG which include information about the amount of curvature at each orientation of the HOG descriptor.6"
      ]
    },
    {
      "heading": "5 Model",
      "text": [
        "We model textual and visual features using the polylingual topic model by Mimno et al. (2009).",
        "In this section, we describe how the generative process and inference of this model is adapted to topically comparable multi-modal data.",
        "Figure 1 shows the original polylingual topic model.",
        "We model multi-modal data using two ?languages?",
        ": txt for the bag-of-words captions, and img for the combined visual terms.",
        "The generative process is defined for an image and caption pair, w =<",
        "First, a topic distribution for w is drawn from an asymmetric Dirichlet prior with concentration parameter ?",
        "and base measure m. Then a latent topic assignment is drawn for each word token in wtxt, and each discrete image feature in wimg.",
        "Once the topic assignments are sampled, the observed tokens are sampled according to their probability in the",
        "To find the most probable descriptive words for an unseen image, the first step is to estimate the topic distribution that generated the image.",
        "Gibbs sampling is used to sample topic assignments for visual terms in the test image dimg:",
        "Assuming that the descriptive words are independent, the probability of text word wi given dimg is:",
        "summing over all topics t ?",
        "T .",
        "For training the model, we used the Polylingual topic model implementation from the Mallet toolkit (McCallum, 2002) (with some small modifcations to use it for generation).",
        "We use 1000 iterations for inference, with hyperparameter optimization every 10 iterations.",
        "In both shoes and bags categories, the number of topics is 200, which was minimally tuned by hand on the shoes data."
      ]
    },
    {
      "heading": "6 Experimental Setup and Evaluation",
      "text": [
        "We first run our model on the larger category, shoes.",
        "For both systems and baselines, we find the 10, 15, and 20 most likely words for the test images.",
        "We evaluate by computing precision and recall against descriptive words from the held-out captions for those images.7 We compute macro-averages of these scores because there is a lot of variation between the sizes of the captions in the dataset.",
        "The split between training and test instances is 80/20%.",
        "We also evaluate the contributions of different types of image features.",
        "We evaluate the model for each image feature individually (along with the text features), as well as combinations of image features.",
        "We compare against the MixLDA system and a strong baseline.",
        "We choose MixLDA because it is relatively easy to reimplement and because it 7We find descriptive words for test instances in the exact same way we did for training instances in Section 4.1.",
        "Instances where we did not find any useable descriptive words did not count towards the evaluation.",
        "has previously outperformed other image annotation systems when trained on natural language captions.",
        "Because the MixLDA model originally only used SIFT features, we compare it against the SIFT-only version of our model, with each system using the same computed image and text features.",
        "We reimplement the MixLDA system mostly as it is described in Feng and Lapata (2010b), with a few changes to make it more comparable to our model: Obviously in our version of MixLDA the test instances are only the unseen image as there is no other surrounding text.",
        "The number of topics is 200 (the original MixLDA had more but that did not seem to help here), and the ?",
        "and ?",
        "hyperparameters are optimized every 10 iterations.8 We also compare our model against corpus frequency of words in the training set.",
        "Although this may seem like a trivial baseline, previous work 8We used the Mallet toolkit's Parallel LDA sampler for inference, while a variational approach is used in the original.",
        "However, we do not believe this would change the outcome of this experiment.",
        "We also tried MixLDA without hyperparameter optimization but we do not show those results as they are significantly worse.",
        "on image annotation from both computer vision (Mu?ller et al., 2002; Monay and Gatica-Perez, 2003; Barnard et al., 2003) and natural language processing (Mason and Charniak, 2012) has shown that a large portion of the keyword probability mass can often be accounted for by a very small number of words, allowing systems to game better-looking results by simply guessing the frequency distribution of the text vocabulary.",
        "We find this to be especially true in the domain-specific case, where common terms (eg shoe, sole, heel, upper) are used in almost every caption, and in some captions account for most words used (such as the second example in Table 1).",
        "While domain-frequent words are also needed for generating new captions, we don't want them to account for all of the words our system generates.",
        "Of course, a human evaluation would be another possible way of addressing this issue, but it would be difficult and expensive to find enough people who have sufficient knowledge of womens?",
        "clothing and would be able to accurately say whether the generated words are appropriate or not (words such as hobo, PU, stacked, upper, and vamp).",
        "Also, although the gold image captions are noisy, the num",
        "sole upper detail heel print fun fabric patent uppers soles high shoe rounded leather rubber lining elastic animal toe feet style upper heel leather strap sandal lining toe dress satin shoe comfort ankle sole adjustable outsole platform stiletto rhinestone sandals bag, leather, zip, pocket, hardware, features, shoulder, flap, main, cell, perfect, length, drop, zipper, closure, bold, phone, evening, holds, hobo This high heel platform shoe has a patent leather upper with an ornamenting bow at the toe, a leather lining, a rounded toe, and a rubber bot-tom.Available Colors: Black Patent, Cheetah Print PU.",
        "Create a timeless look with these Andie dress sandals from Col-oriffics.",
        "Dyeable white satin matte satin or metallic satin upper in a two-piece dress-sandal style with an open round toe crossing pleated vamp straps with a dazzling rhinestone clasp and a wraparound heel strap with an adjustable buckle closure.",
        "captions for the images are shown.",
        "(Note: In the third example, ?hobo?",
        "is actually the term that is used to describe that shape of handbag.)",
        "ber of test documents is very large so we can find significance on precision and recall using bootstrap resampling.",
        "We also ran the baseline system and our system on the handbags category of the dataset.",
        "We did not modify the system in any way when using the bags dataset, just gave it different file for input."
      ]
    },
    {
      "heading": "7 Results and Discussion",
      "text": [
        "The results of our evaluations are in Table 2.",
        "As we expected, the corpus frequency baseline does very well.",
        "It is comparable to MixLDA for 10 and 15 words, and significantly better than MixLDA for over 20 words.",
        "However, the Polylingual topic model using only SIFT features and text is much better than both.",
        "The trained MixLDA model has topics with both image and text features, so when estimating topics given only an image, it estimates that it was generated by topics that have a high proportion of image features.",
        "Though it also estimates some topics that have a mix of visual and text features, being able to generate good text descriptions from those topics, the topics that have less text features will be mainly determined by the smoothing parameter ?",
        "the uniform distribution, worse than guessing the corpus distribution.",
        "Out of the single attribute models, all except three of the single feaure models were significantly higher than corpus frequency on both precision and recall at 10, 15, and 20 words.",
        "The exceptions are the two color features and grayscale texture.",
        "For grayscale texture, we had expected it would correlate well with the material of the shoe; but either the low resolution of the images makes it difficult to distinguish materials by their texture, or materials don't correlate with the ?less visual?",
        "features as much as we expected.",
        "Interestingly, since the material of an item tends to correlate strongly with other attributes such as shape and color, so our model still generates correct descriptive words for material in many cases.",
        "While neither color nor texture were useful fea",
        "tures on their own, RGB Texture did very well as a single attribute, and was within signficance of both the combined color and combined texture models.",
        "This may be related to the fact that RGB Textons have a larger number of visual terms than those other features, 100 for each of the three color channels.",
        "Unlike material, we observed that the color of an object is often not mentioned in the human-written caption (as seen in the examples in Table 1), or several colors are described in the caption where only one is seen in the image (seen in some of the examples in Table 3).",
        "We also observed that our system generates very few color words.",
        "The gradient and shape-based features have the best single-attribute performance by far.",
        "Both SIFT and HOG capture shape at local points, but while SIFT features are invariant to differences in position or scale, HOG features are more sensitive to the way the item is oriented in the image.",
        "Although the curvature features TriHOG and TriHog-Polar are nearly as good as HOG on their own, combining the three HOG features does not significantly improve performance of the model over HOG alone.",
        "Not all of the single-attribute models performed as well as others, but there was no case where removing one of the features improved the performance of the combined model.",
        "The fewest number of image attributes that our model could use and still get within significance to the full combined model is three ?",
        "SIFT, RGB Texture, and HOG.",
        "However, we found that each image attribute does slightly improve, the model, even if not by a significant amount.",
        "Our results on the handbags category of the dataset are shown in Table 4.",
        "Although our scores are not as high as they were in the shoes category, the scores of the corpus frequency baseline are not as high either, and our model does about as well over the baseline in each category.",
        "But is worth reiterating that we were able to run our system on both the bags and shoes shopping categories with absolutely no modifications or tuning of parameters."
      ]
    },
    {
      "heading": "8 Conclusion and Future Work",
      "text": [
        "In conclusion, we have shown that the polylingual topic model works well for modeling topically comparable images and related text, and obtain competitive results for the image annotation task.",
        "Our model is trained on noisy image captions from the web, rather than hand-labeled data.",
        "For future work, we would like to further adapt the polylingual topic model for multi-modal data by allowing some topics to be generated only by one modality or the other.",
        "We are also interested in characterizing the image annotations in order to generate a single most likely annotation for different types of features such as texture or color.",
        "Finally, we are interested in extending this model to use with other domains of data.",
        "For natural images, we could use image segmentation algorithms to separate the object of interest from the background of the image, or we could use scene classifcation to cluster the training images by their background scene and train seprate models for each."
      ]
    }
  ]
}
