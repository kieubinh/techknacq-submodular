{
  "info": {
    "authors": [
      "Mark Johnson",
      "Stefan Riezler"
    ],
    "book": "Applied Natural Language Processing Conference and Meeting of the North American Association for Computational Linguistics",
    "id": "acl-A00-2021",
    "title": "Exploiting Auxiliary Distributions in Stochastic Unification-Based Grammars",
    "url": "https://aclweb.org/anthology/A00-2021",
    "year": 2000
  },
  "references": [
    "acl-J97-4005",
    "acl-P99-1014",
    "acl-P99-1069"
  ],
  "sections": [
    {
      "heading": "Abstract",
      "text": [
        "This paper describes a method for estimating conditional probability distributions over the parses of \"unification-based\" grammars which can utilize auxiliary distributions that are estimated by other means.",
        "We show how this can be used to incorporate information about lexical selectional preferences gathered from other sources into Stochastic \"Unification-based\" Grammars (SUBGs).",
        "While we apply this estimator to a Stochastic Lexical-Functional Grammar, the method is general, and should be applicable to stochastic versions of HPSGs, categorial grammars and transformational grammars."
      ]
    },
    {
      "heading": "1 Introduction",
      "text": [
        "\"Unification-based\" Grammars (UBGs) can capture a wide variety of linguistically important syntactic and semantic constraints.",
        "However, because these constraints can be non-local or context-sensitive, developing stochastic versions of UBGs and associated estimation procedures is not as straightforward as it is for, e.g., PCFGs.",
        "Recent work has shown how to define probability distributions over the parses of UBGs (Abney, 1997) and efficiently estimate and use conditional probabilities for parsing (Johnson et al., 1999).",
        "Like most other practical stochastic grammar estimation procedures, this latter estimation procedure requires a parsed training corpus.",
        "Unfortunately, large parsed UBG corpora are not yet available.",
        "This restricts the kinds of models one can realistically expect to be able to estimate.",
        "For example, a model incorporating lexical selectional preferences of the kind This research was supported by NSF awards 9720368, 9870676 and 9812169. described below might have tens or hundreds of thousands of parameters, which one could not reasonably attempt to estimate from a corpus with on the order of a thousand clauses.",
        "However, statistical models of lexical selectional preferences can be estimated from very large corpora based on simpler syntactic structures, e.g., those produced by a shallow parser.",
        "While there is undoubtedly disagreement between these simple syntactic structures and the syntactic structures produced by the UBG, one might hope that they are close enough for lexical information gathered from the simpler syntactic structures to be of use in defining a probability distribution over the UBG's structures.",
        "In the estimation procedure described here, we call the probability distribution estimated from the larger, simpler corpus an auxiliary distribution.",
        "Our treatment of auxiliary distributions is inspired by the treatment of reference distributions in Jelinek's (1997) presentation of Maximum Entropy estimation, but in our estimation procedure we simply regard the logarithm of each auxiliary distribution as another (real-valued) feature.",
        "Despite its simplicity, our approach seems to offer several advantages over the reference distribution approach.",
        "First, it is straightforward to utilize several auxiliary distributions simultaneously: each is treated as a distinct feature.",
        "Second, each auxiliary distribution is associated with a parameter which scales its contribution to the final distribution.",
        "In applications such as ours where the auxiliary distribution may be of questionable relevance to the distribution we are trying to estimate, it seems reasonable to permit the estimation procedure to discount or even ignore the auxiliary distribution.",
        "Finally, note that neither Jelinek's nor our estimation procedures require that an auxiliary or reference distribution Q be a prob154 ability distribution; i.e., it is not necessary that Q(12) = 1, where C2 is the set of well-formed linguistic structures.",
        "The rest of this paper is structured as follows.",
        "Section 2 reviews how exponential models can be defined over the parses of UBGs, gives a brief description of Stochastic Lexical-Functional Grammar, and reviews why maximum pseudo-likelihood estimation is both feasible and sufficient of parsing purposes.",
        "Section 3 presents our new estimator, and shows how it is related to the minimization of the Kullback-Leibler divergence between the conditional estimated and auxiliary distributions.",
        "Section 4 describes the auxiliary distribution used in our experiments, and section 5 presents the results of those experiments."
      ]
    },
    {
      "heading": "2 Stochastic Unification-based Grammars",
      "text": [
        "Most of the classes of probabilistic language models used in computational linguistic are exponential families.",
        "That is, the probability P(w) of a well-formed syntactic structure w E SI is defined by a function of the form",
        "where f (co) E Rin is a vector of feature values, A E Rin is a vector of adjustable feature parameters, Q is a function of w (which Jelinek (1997) calls a reference distribution when it is not an indicator function), and ZA = fs- Q(co)eAf(')dw is a normalization factor called the partition function.",
        "(Note that a feature here is just a real-valued function of a syntactic structure co; to avoid confusion we use the term \"attribute\" to refer to a feature in a feature structure).",
        "If Q(co) = 1 then the class of exponential distributions is precisely the class of distributions with maximum entropy satisfying the constraint that the expected values of the features is a certain specified value (e.g., a value estimated from training data), so exponential models are sometimes also called \"Maximum Entropy\" models.",
        "For example, the class of distributions obtained by varying the parameters of a PCFG is an exponential family.",
        "In a PCFG each rule or production is associated with a feature, so m is the number of rules and the jth feature value f; (w) is the number of times the j rule is used in the derivation of the tree co E [I.",
        "Simple manipulations show that PA (w) is equivalent to the PCFG distribution if A, = log pi, where pi is the rule emission probability, and Q(w) = ZA 1.",
        "If the features satisfy suitable Markovian independence constraints, estimation from fully observed training data is straightforward.",
        "For example, because the rule features of a PCFG meet \"context-free\" Markovian independence conditions, the well-known \"relative frequency\" estimator for PCFGs both maximizes the likelihood of the training data (and hence is asymptotically consistent and efficient) and minimizes the Kullback-Leibler divergence between training and estimated distributions.",
        "However, the situation changes dramatically if we enforce non-local or context-sensitive constraints on linguistic structures of the kind that can be expressed by a UBG.",
        "As Abney (1997) showed, under these circumstances the relative frequency estimator is in general inconsistent, even if one restricts attention to rule features.",
        "Consequently, maximum likelihood estimation is much more complicated, as discussed in section 2.2.",
        "Moreover, while rule features are natural for PCFGs given their context-free independence properties, there is no particular reason to use only rule features in Stochastic UBGs (SUBGs).",
        "Thus an SUBG is a triple (G, f, A), where G is a UBG which generates a set of well-formed linguistic structures f2, and f and A are vectors of feature functions and feature parameters as above.",
        "The probability of a structure w E Srl is given by (1) with Q(w) = 1.",
        "Given a base UBG, there are usually infinitely many different ways of selecting the features f to make a SUBG, and each of these makes an empirical claim about the class of possible distributions of structures."
      ]
    },
    {
      "heading": "2.1 Stochastic Lexical Functional Grammar Stochastic Lexical-Functional Grammar",
      "text": [
        "(SLFG) is a stochastic extension of Lexical-Functional Grammar (LFG), a UBG formalism developed by Kaplan and Bresnan (1982).",
        "Given a base LFG, an SLFG is constructed by defining features which identify salient constructions in a linguistic structure (in LFG this is a c-structure/f-structure pair and its associated mapping; see Kaplan (1995)).",
        "Apart from the auxiliary distributions, we based our",
        "features on those used in Johnson et al.",
        "(1999), which should be consulted for further details.",
        "Most of these feature values range over the natural numbers, counting the number of times that a particular construction appears in a linguistic structure.",
        "For example, adjunct and argument features count the number of adjunct and argument attachments, permitting SLFG to capture a general argument attachment preference, while more specialized features count the number of attachments to each grammatical function (e.g., SUBJ, OBJ, COMP, etc.).",
        "The flexibility of features in stochastic UBGs permits us to include features for relatively complex constructions, such as date expressions (it seems that date interpretations, if possible, are usually preferred), right-branching constituent structures (usually preferred) and non-parallel coordinate structures (usually dispreferred).",
        "Johnson et al.",
        "remark that they would have liked to have included features for lexical selectional preferences.",
        "While such features are perfectly acceptable in a SLFG, they felt that their corpora were so small that the large number of lexical dependency parameters could not be accurately estimated.",
        "The present paper proposes a method to address this by using an auxiliary distribution estimated from a corpus large enough to (hopefully) provide reliable estimates for these parameters."
      ]
    },
    {
      "heading": "2.2 Estimating stochastic",
      "text": [
        "unification-based grammars Suppose w = wi, , wn is a corpus of n syntactic structures.",
        "Letting fj(w) = 1fi (wi) and assuming each wi E Q, the likelihood of the corpus LA(w) is: where EA(fj) is the expected value of h under the distribution PA.",
        "The maximum likelihood estimates are the A which maximize (2), or equivalently, which make (3) zero, but as Johnson et al.",
        "(1999) explain, there seems to be no practical way of computing these for realistic SUBGs since evaluating (2) and its derivatives",
        "(3) involves integrating over all syntactic structures Q.",
        "However, Johnson et al.",
        "observe that parsing applications require only the conditional probability distribution PA (wly), where y is the terminal string or yield being parsed, and that this can be estimated by maximizing the pseudo-likelihood of the corpus PLA(CD):",
        "where Sgyi) is the set of all syntactic structures in Q with yield yi (i.e., all parses of yi generated by the base UBG).",
        "It turns out that calculating the pseudo-likelihood of a corpus only involves integrations over the sets of parses of its yields Q(yi), which is feasible for many interesting UBGs.",
        "Moreover, the maximum pseudo-likelihood estimator is asymptotically consistent for the conditional distribution P(w}y).",
        "For the reasons explained in Johnson et al.",
        "(1999) we actually estimate A by maximizing a regularized version of the log pseudo-likelihood (5), where a1 is 7 times the maximum value of f j found in the training corpus:",
        "See Johnson et al.",
        "(1999) for details of the calculation of this quantity and its derivatives, and the conjugate gradient routine used to calculate the A which maximize the regularized log pseudo-likelihood of the training corpus."
      ]
    },
    {
      "heading": "3 Auxiliary distributions",
      "text": [
        "We modify the estimation problem presented in section 2.2 by assuming that in addition to the corpus c.D and the m feature functions f we are given k auxiliary distributions Qi, , Qk whose support includes Q that we suspect may be related to the joint distribution P(w) or conditional distribution P(wly) that we wish to estia",
        "mate.",
        "We do not require that the Q3 be probability distributions, i.e., it is not necessary that Q j(w)clw = 1, but we do require that they are strictly positive (i.e., Q3(w) > 0, Vw E 0).",
        "We define k new features fni+i, , fm,k where f,i+j(w) = log Qj (w), which we call auxiliary features.",
        "The m+ k parameters associated with the resulting m+k features can be estimated using any method for estimating the parameters of an exponential family with real-valued features (in our experiments we used the pseudo-likelihood estimation procedure reviewed in section 2.2).",
        "Such a procedure estimates parameters Am+i, , \\m+k associated with the auxiliary features, so the estimated distributions take the form (6) (for simplicity we only discuss joint distributions here, but the treatment of conditional distributions is parallel).",
        "shallow parses (compared to the LFG parses) for the 117 million word British National Corpus (Carroll and Rooth, 1998).",
        "We based our auxiliary distribution on 3.7 million (g, r, a) tuples (belonging to 600,000 types) we extracted these parses, where g is a lexical governor (for the shallow parses, g is either a verb or a preposition), a is the head of one of its NP arguments and r is the the grammatical relationship between the governor and argument (in the shallow parses r is always OBJ for prepositional governors, and r is either SUBJ or OBJ for verbal governors).",
        "In order to avoid sparse data problems we smoothed this distribution over tuples as described in (Rooth et al., 1999).",
        "We assume that governor-relation pairs (g, r) and arguments a are independently generated from 25 hidden",
        "Note that the auxiliary distributions Qj are treated as fixed distributions for the purposes of this estimation, even though each Qj may itself be a complex model obtained via a previous estimation process.",
        "Comparing (6) with (1) on page 2, we see that the two equations become identical if the reference distribution Q in (1) is replaced by a geometric mixture of the auxiliary distributions Qj, i.e., if:",
        "The parameter associated with an auxiliary feature represents the weight of that feature in the mixture.",
        "If a parameter Ani+i = 1 then the corresponding auxiliary feature Qj is equivalent to a reference distribution in Jelinek's sense, while if Ani+j = 0 then Qj is effectively ignored.",
        "Thus our approach can be regarded as a smoothed version Jelinek's reference distribution approach, generalized to permit multiple auxiliary distributions."
      ]
    },
    {
      "heading": "4 Lexical selectional preferences",
      "text": [
        "The auxiliary distribution we used here is based on the probabilistic model of lexical selectional preferences described in Rooth et al.",
        "(1999).",
        "An existing broad-coverage parser was used to find where the distributions Pe are estimated from the training tuples using the Expectation-Maximization algorithm.",
        "While the hidden classes are not given any prior interpretation they often cluster semantically coherent predicates and arguments, as shown in Figure 1.",
        "The smoothing power of a clustering model such as this can be calculated explicitly as the percentage of possible tuples which are assigned a non-zero probability.",
        "For the 25-class model we get a smoothing power of 99%, compared to only 1.7% using the empirical distribution of the training data."
      ]
    },
    {
      "heading": "5 Empirical evaluation",
      "text": [
        "Hadar Shemtov and Ron Kaplan at Xerox PARC provided us with two LFG parsed corpora called the Verbmobil corpus and the Homecentre corpus.",
        "These contain parse forests for each sentence (packed according to scheme described in Maxwell and Kaplan (1995)), together with a manual annotation as to which parse is correct.",
        "The Verbmobil corpus contains 540 sentences relating to appointment planning, while the Homecentre corpus contains 980 sentences from Xerox documentation on their \"homecen-tre\" multifunction devices.",
        "Xerox did not provide us with the base LFGs for intellectual property reasons, but from inspection of the parses",
        "matrix shows at the top the 30 most probable nouns in the Pe(a116) distribution and their probabilities, and at the left the 30 most probable verbs and prepositions listed according to Pre((g,r)116) and their probabilities.",
        "Dots in the matrix indicate that the respective pair was seen in the training data.",
        "Predicates with suffix : s indicate the subject slot of an intransitive or transitive verb; the suffix : o specifies the nouns in the corresponding row as objects of verbs or prepositions.",
        "it seems that slightly different grammars were used with each corpus, so we did not merge the corpora.",
        "We chose the features of our SLFG based solely on the basis of the Verbmobil corpus, so the Homecentre corpus can be regarded as a held-out evaluation corpus.",
        "We discarded the unambiguous sentences in each corpus for both training and testing (as explained in Johnson et al.",
        "(1999), pseudo-likelihood estimation ignores unambiguous sentences), leaving us with a corpus of 324 ambiguous sentences in the Verbmobil corpus and 481 sentences in the Homecentre corpus; these sentences had a total of 3,245 and 3,169 parses respectively.",
        "The (non-auxiliary) features used in were based on those described by Johnson et al.",
        "(1999).",
        "Different numbers of features were used with the two corpora because some of the features were generated semi-automatically (e.g., we introduced a feature for every attribute-value pair found in any feature structure), and \"pseudo-constant\" features (i.e., features whose values never differ on the parses of the same sentence) are discarded.",
        "We used 172 features in the SLFG for the Verbmobil corpus and 186 features in the SLFG for the Homecentre corpus.",
        "We used three additional auxiliary features derived from the lexical selectional preference model described in section 4.",
        "These were defined in the following way.",
        "For each governing predicate g, grammatical relation r and argument a, let n(g,,,a)(w) be the number of times that the f-structure:",
        "appears as a subgraph of the f-structure of w, i.e., the number of times that a fills the",
        "grammatical role r of g. We used the lexical model described in the last section to estimate P(alg, r), and defined our first auxiliary feature as: smaller score corresponds to better performance here.",
        "The correct parses measure is most closely related to parser performance, but the pseudo-likelihood measure is more closely related to the quantity we are optimizing and may be more relevant to applications where the parser has to return a certainty factor associated with each parse.",
        "Table 1 also provides the number of indistinguishable sentences under each model.",
        "A sentence y is indistinguishable with respect to features f iff f (wc) = f (wi), where w, is the correct parse of y and we E S2(y), i.e., the feature values of correct parse of y are identical to the feature values of some other parse of y.",
        "If a sentence is indistinguishable it is not possible to assign its correct parse a (conditional) probability higher than the (conditional) probability assigned to other parses, so all else being equal we would expect a SUBG with with fewer indistinguishable sentences to perform better than one with more.",
        "Adding auxiliary features reduced the already low number of indistinguishable sentences in the Verbmobil corpus by only 11%, while it reduced the number of indistinguishable sentences in the Homecentre corpus by 24%.",
        "This probably reflects the fact that the feature set was designed by inspecting only the Verbmobil corpus.",
        "We must admit disappointment with these results.",
        "Adding auxiliary lexical features improves the correct parses measure only slightly, and degrades rather than improves performance on the pseudo-likelihood measure.",
        "Perhaps this is due to the fact that adding auxiliary features increases the dimensionality of the feature vector f , so the pseudo-likelihood scores with different numbers of features are not strictly comparable.",
        "The small improvement in the correct parses measure is typical of the improvement we might expect to achieve by adding a \"good\" non-auxiliary feature, but given the importance usually placed on lexical dependencies in statistical models one might have expected more improvement.",
        "Probably the poor performance is due in part to the fairly large differences between the parses from which the lexical dependencies were estimated and the parses produced by the LFG.",
        "LFG parses are very detailed, and many ambiguities depend on the precise grammatical",
        "where go is the predicate of the root feature structure.",
        "The justification for this feature is that if f-structures were in fact a tree, ft(w) would be the (logarithm of) a probability distribution over them.",
        "The auxiliary feature ft is defective in many ways.",
        "Because LFG f-structures are DAGs with reentrancies rather than trees we double count certain arguments, so ft is certainly not the logarithm of a probability distribution (which is why we stressed that our approach does not require an auxiliary distribution to be a distribution).",
        "The number of governor-argument tuples found in different parses of the same sentence can vary markedly.",
        "Since the conditional probabilities P(afg, r) are usually very small, we found that fi(w) was strongly related to the number of tuples found in w, so the parse with the smaller number of tuples usually obtains the higher fi score.",
        "We tried to address this by adding two additional features.",
        "We set Mu)) to be the number of tuples in w, i.e.:",
        "Then we set fn(w) = Mu)) I fc(w), i.e., fn(w) is the average log probability of a lexical dependency tuple under the auxiliary lexical distribution.",
        "We performed our experiments with 11 as the sole auxiliary distribution, and with A and fu, as three auxiliary distributions.",
        "Because our corpora were so small, we trained and tested these models using a 10-fold cross-validation paradigm; the cumulative results are shown in Table 1.",
        "On each fold we evaluated each model in two ways.",
        "The correct parses measure simply counts the number of test sentences for which the estimated model assigns its maximum parse probability to the correct parse, with ties broken randomly.",
        "The pseudo-likelihood measure is the pseudo-likelihood of test set parses; i.e., the conditional probability of the test parses given their yields.",
        "We actually report the negative log of this measure, so a",
        "features are described in the text.",
        "The column labelled \"indistinguishable\" gives the number of indistinguishable sentences with respect to each feature set, while \"correct\" and \"- log PL\" give the correct parses and pseudo-likelihood measures respectively.",
        "relationship holding between a predicate and its argument.",
        "It could also be that better performance could be achieved if the lexical dependencies were estimated from a corpus more closely related to the actual test corpus.",
        "For example, the verb feed in the Homecentre corpus is used in the sense of \"insert (paper into printer)\" , which hardly seems to be a prototypical usage.",
        "Note that overall system performance is quite good; taking the unambiguous sentences into account the combined LFG parser and statistical model finds the correct parse for 73% of the Verbmobil test sentences and 80% of the Homecentre test sentences.",
        "On just the ambiguous sentences, our system selects the correct parse for 56% of the Verbmobil test sentences and 59% of the Homecentre test sentences."
      ]
    },
    {
      "heading": "6 Conclusion",
      "text": [
        "This paper has presented a method for incorporating auxiliary distributional information gathered by other means possibly from other corpora into a Stochastic \"Unification-based\" Grammar (SUBG).",
        "This permits one to incorporate dependencies into a SUBG which probably cannot be estimated directly from the small UBG parsed corpora available today.",
        "It has the virtue that it can incorporate several auxiliary distributions simultaneously, and because it associates each auxiliary distribution with its own \"weight\" parameter, it can scale the contributions of each auxiliary distribution toward the final estimated distribution, or even ignore it entirely.",
        "We have applied this to incorporate lexical selectional preference information into a Stochastic Lexical-Functional Grammar, but the technique generalizes to stochastic versions of HPSGs, categorial grammars and transformational grammars.",
        "An obvious extension of this work, which we hope will be persued in the future, is to apply these techniques in broad-coverage feature-based TAG parsers."
      ]
    }
  ]
}
