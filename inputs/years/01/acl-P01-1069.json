{
  "info": {
    "authors": [
      "Tong Zhang",
      "Fred J. Damerau",
      "David E. Johnson"
    ],
    "book": "Annual Meeting of the Association for Computational Linguistics",
    "id": "acl-P01-1069",
    "title": "Text Chunking Using Regularized Winnow",
    "url": "https://aclweb.org/anthology/P01-1069",
    "year": 2001
  },
  "references": [
    "acl-W00-0726",
    "acl-W00-0730",
    "acl-W00-0734",
    "acl-W97-0306"
  ],
  "sections": [
    {
      "heading": "Abstract",
      "text": [
        "Many machine learning methods have recently been applied to natural language processing tasks.",
        "Among them, the Winnow algorithm has been argued to be particularly suitable for NLP problems, due to its robustness to irrelevant features.",
        "However in theory, Winnow may not converge for non-separable data.",
        "To remedy this problem, a modification called regularized Winnow has been proposed.",
        "In this paper, we apply this new method to text chunking.",
        "We show that this method achieves state of the art performance with significantly less computation than previous approaches."
      ]
    },
    {
      "heading": "1 Introduction",
      "text": [
        "Recently there has been considerable interest in applying machine learning techniques to problems in natural language processing.",
        "One method that has been quite successful in many applications is the SNoW architecture (Dagan et al., 1997; Khardon et al., 1999).",
        "This architecture is based on the Winnow algorithm (Littlestone, 1988; Grove and Roth, 2001), which in theory is suitable for problems with many irrelevant attributes.",
        "In natural language processing, one often encounters a very high dimensional feature space, although most of the features are irrelevant.",
        "Therefore the robustness of Winnow to high dimensional feature space is considered an important reason why it is suitable for NLP tasks.",
        "However, the convergence of the Winnow algorithm is only guaranteed for linearly separable data.",
        "In practical NLP applications, data are often linearly non-separable.",
        "Consequently, a direct application of Winnow may lead to numerical instability.",
        "A remedy for this, called regularized Winnow, has been recently proposed in (Zhang, 2001).",
        "This method modifies the original Winnow algorithm so that it solves a regularized optimization problem.",
        "It converges both in the linearly separable case and in the linearly non-separable case.",
        "Its numerical stability implies that the new method can be more suitable for practical NLP problems that may not be linearly separable.",
        "In this paper, we compare regularized Winnow and Winnow algorithms on text chunking (Ab-ney, 1991).",
        "In order for us to rigorously compare our system with others, we use the CoNLL2000 shared task dataset (Sang and Buchholz, 2000), which is publicly available from http://lcgwww.uia.ac.be/conll2000/chunking.",
        "An advantage of using this dataset is that a large number of state of the art statistical natural language processing methods have already been applied to the data.",
        "Therefore we can readily compare our results with other reported results.",
        "We show that state of the art performance can be achieved by using the newly proposed regularized Winnow method.",
        "Furthermore, we can achieve this result with significantly less computation than earlier systems of comparable performance.",
        "The paper is organized as follows.",
        "In Section 2, we describe the Winnow algorithm and the regularized Winnow method.",
        "Section 3 describes the CoNLL-2000 shared task.",
        "In Section 4, we give a detailed description of our system that employs the regularized Winnow algorithm for text chunking.",
        "Section 5 contains experimental results for our system on the CoNLL-2000 shared task.",
        "Some final remarks will be given in Section 6.",
        "2 Winnow and regularized Winnow for binary classification We review the Winnow algorithm and the regularized Winnow method.",
        "Consider the binary classification problem: to determine a label y E { 1,1 } associated with an input vector x.",
        "A useful method for solving this problem is through linear discriminant functions, which consist of linear combinations of the components of the input variable.",
        "Specifically, we seek a weight vector w and a threshold 0 such that w x < 0 if its label y _ 1 and wT x > 0 if its label Y = 1.",
        "For simplicity, we shall assume 0 = 0 in this paper.",
        "The restriction does not cause problems in practice since one can always append a constant feature to the input data x, which offsets the effect of 0.",
        "Given a training set of labeled data (Xi y1)(xn yn), a number of approaches to finding linear discriminant functions have been advanced over the years.",
        "We are especially interested in the Winnow multiplicative update algorithm (Littlestone, 1988).",
        "This algorithm updates the weight vector w by going through the training data repeatedly.",
        "It is mistake driven in the sense that the weight vector is updated only when the algorithm is not able to correctly classify an example.",
        "The Winnow algorithm (with positive weight) employs multiplicative update: if the linear discriminant function misclassifies an input training vector xi with true label yi, then we update each component j of the weight vector w as:",
        "where q > 0 is a parameter called the learning rate.",
        "The initial weight vector can be taken as",
        "chosen to be uniform.",
        "There can be several variants of the Winnow algorithm.",
        "One is called balanced Winnow, which is equivalent to an embedding of the input space into a higher dimensional space as: x _ [x, x].",
        "This modification allows the positive weight Winnow algorithm for the augmented input ;~ to have the effect of both positive and negative weights for the original input x.",
        "One problem of the Winnow online update algorithm is that it may not converge when the data are not linearly separable.",
        "One may partially remedy this problem by decreasing the learning rate parameter ,q during the updates.",
        "However, this is rather ad hoc since it is unclear what is the best way to do so.",
        "Therefore in practice, it can be quite difficult to implement this idea properly.",
        "In order to obtain a systematic solution to this problem, we shall first examine a derivation of the Winnow algorithm in (Gentile and Warmuth, 1998), which motivates a more general solution to be presented later.",
        "Following (Gentile and Warmuth, 1998), we consider the loss function max(wTXiyi, 0), which is often called hinge loss.",
        "For each data point (x2, Y, we consider an online update rule such that the weight wi+1 after seeing the i-th example is given by the solution to",
        "(2) Setting the gradient of the above formula to zero,",
        "In the above equation, Ow +l denotes the gradient (or more rigorously, a subgradient) of max(w(i+l)TxiY' 0), which takes the value 0 if w(i+l)TxiYi > 0, the value xiYi if w(i+l)TxiYi < 0, and a value in between if w(i+l)TxiY' = 0.",
        "The Winnow update (1) can be regarded as an approximate solution to (3).",
        "Although the above derivation does not solve the non-convergence problem of the original Winnow method when the data are not linearly separable, it does provide valuable insights which can lead to a more systematic solution of the problem.",
        "The basic idea was given in (Zhang, 2001), where the original Winnow algorithm was converted into a numerical optimization problem that can handle linearly non-separable data.",
        "The resulting formulation is closely related to (2).",
        "However, instead of looking at one example at a time as in an online formulation, we incorporate all examples at the same time.",
        "In addition, we add a margin condition into the hinge loss.",
        "Specifically, we seek a linear weight W) that solves min[E wj In wi Weye Where C > 0 is a given parameter called the regularization parameter.",
        "The optimal solution w of the above optimization problem can be derived from the solution a of the following dual optimization problem:",
        "A Winnow-like update rule can be derived for the dual regularized Winnow formulation.",
        "At each data point (x2, y'), we fix all ak with k :~ i, and update a2 to approximately maximize the dual objective functional using gradient ascent:",
        "and w by repeatedly going over the data from i ="
      ]
    },
    {
      "heading": "1 .... ,n.",
      "text": [
        "Learning bounds of regularized Winnow that are similar to the mistake bound of the original Winnow have been given in (Zhang, 2001).",
        "These results imply that the new method, while it can properly handle non-separable data, shares similar theoretical advantages of Winnow in that it is also robust to irrelevant features.",
        "This theoretical insight implies that the algorithm is suitable for NLP tasks with large feature spaces."
      ]
    },
    {
      "heading": "3 CoNLL-2000 chunking task",
      "text": [
        "The text chunking task is to divide text into syntactically related non-overlapping groups of words (chunks).",
        "It is considered an important problem in natural language processing.",
        "As an example of text chunking, the sentence Balcor, which has interests in real estate, said the position is newly created.",
        "can be divided as follows: [NP Balcor], [NP which] [VP has] [NP interests] [PP in] [NP real estate], [VP said] [NP the position] [VP is newly created].",
        "In this example, NP denotes non phrase, VP denotes verb phrase, and PP denotes prepositional phrase.",
        "The CoNLL-2000 shared task (Sang and Buch-holz, 2000), introduced last year, is an attempt to set up a standard dataset so that researchers can compare different statistical chunking methods.",
        "The data are extracted from sections of the Penn Treebank.",
        "The training set consists of WSJ sections 15-18 of the Penn Treebank, and the test set consists of WSJ sections 20.",
        "Additionally, a part-of-speech (POS) tag was assigned to each token by a standard POS tagger (Brill, 1994) that was trained on the Penn Treebank.",
        "These POS tags can be used as features in a machine learning based chunking algorithm.",
        "See Section 4 for detail.",
        "The data contains eleven different chunk types.",
        "However, except for the most frequent three types: NP (noun phrase), VP (verb phrase), and PP (prepositional phrase), each of the remaining chunks has less than 5% occurrences.",
        "The chunks are represented by the following three types of tags: BX first word of a chunk of type X IX non-initial word in an X chunk O word outside of any chunk A standard software program has been provided (which is available from http://lcgwww.uia.ac.be/conll2000/chunking) to compute the performance of each algorithm.",
        "For each chunk, three figures of merit are computed: precision (the percentage of detected phrases that are correct), recall (the percentage of phrases in the data that are found), and the F,3=1 metric which is the harmonic mean of the precision and the recall.",
        "The overall precision, recall and F=1 metric on all chunks are also computed.",
        "The overall F,3=1 metric gives a single number that can be used to compare different algorithms."
      ]
    },
    {
      "heading": "4 System description",
      "text": []
    },
    {
      "heading": "4.1 Encoding of basic features",
      "text": [
        "An advantage of regularized Winnow is its robustness to irrelevant features.",
        "We can thus include as many features as possible, and let the algorithm itself find the relevant ones.",
        "This strategy ensures that we do not miss any features that are important.",
        "However, using more features requires more memory and slows down the algorithm.",
        "Therefore in practice it is still necessary to limit the number of features used.",
        "Let tok, tok_,+1 i ... , toko.... tokc_1 i tok, be a string of tokenized text (each token is a word or punctuation).",
        "We want to predict the chunk type of the current token toko.",
        "For each word tok2, we let pose denote the associated POS tag, which is assumed to be given in the CoNLL-2000 shared task.",
        "The following is a list of the features we use as input to the regularized Winnow (where we choose c = 2): first order features: tok2 and pose (i = c, ... ,c) second order features: pose x posh (i, j = c, ... , c, i < j), and pose x tokj (i = c, ... ,c; j = 1,0,1) In addition, since in a sequential process, the predicted chunk tags t2 for tok2 are available for i < 0, we include the following extra chunk type features: first order chunk-type features: t2 (i = c, ... ,-1) second order chunk-type features: t2 x tj (i, j = c,... , 1, i < j), and POS-chunk interactions t2 x posh (i = c, ... 1; j = c, ... ,c).",
        "For each data point (corresponding to the current token toko), the associated features are encoded as a binary vector x, which is the input to Winnow.",
        "Each component of x corresponds to a possible feature value v of a feature f in one of the above feature lists.",
        "The value of the component corresponds to a test which has value one if the corresponding feature f achieves value v, or value zero if the corresponding feature f achieves another feature value.",
        "For example, since poso is in our feature list, each of the possible POS value v of poso corresponds to a component of x: the component has value one if poso = v (the feature value represented by the component is active), and value zero otherwise.",
        "Similarly for a second order feature in our feature list such as poso x pose, each possible value vo x v1 in the set {poso x pose} is represented by a component of x: the component has value one if poso = vo and pose = vi (the feature value represented by the component is active), and value zero otherwise.",
        "The same encoding is applied to all other first order and second order features, with each possible test of feature = feature value corresponds to a unique component in x.",
        "Clearly, in this representation, the high order features are conjunction features that become active when all of their components are active.",
        "In principle, one may also consider disjunction features that become active when some of their components are active.",
        "However, such features are not considered in this work.",
        "Note that the above representation leads to a sparse, but very large dimensional vector.",
        "This explains why we do not include all possible second order features since this will quickly consume more memory than we can handle.",
        "Also the above list of features are not necessarily the best available.",
        "We only included the most straightforward features and pairwise feature interactions.",
        "One might try even higher order features to obtain better results.",
        "Since Winnow is relatively robust to irrelevant features, it is usually helpful to provide the algorithm with as many features as possible, and let the algorithm pick up relevant ones.",
        "The main problem that prohibits us from using more features in the Winnow algorithm is memory consumption (mainly in training).",
        "The time complexity of the Winnow algorithm does not depend on the number of features, but rather on the average number of non-zero features per data, which is usually quite small.",
        "Due to the memory problem, in our implementation we have to limit the number of token features (words or punctuation) to 5000: we sort the tokens by their frequencies in the training set from high frequency to low frequency; we then treat tokens of rank 5000 or higher as the same token.",
        "Since the number 5000 is still reasonably large, this restriction is relatively minor.",
        "There are possible remedies to the memory consumption problem, although we have not implemented them in our current system.",
        "One solution comes from noticing that although the feature vector is of very high dimension, most dimensions are empty.",
        "Therefore one may create a hash table for the features, which can significantly reduce the memory consumption."
      ]
    },
    {
      "heading": "4.2 Using enhanced linguistic features",
      "text": [
        "We were interested in determining if additional features with more linguistic content would lead to even better performance.",
        "The ESG (English Slot Grammar) system in (McCord, 1989) is not directly comparable to the phrase structure grammar implicit in the WSJ treebank.",
        "ESG is a dependency grammar in which each phrase has a head and dependent elements, each marked with a syntactic role.",
        "ESG normally produces multiple parses for a sentence, but has the capability, which we used, to output only the highest ranked parse, where rank is determined by a system-defined measure.",
        "There are a number of incompatibilities between the treebank and ESG in tokenization, which had to be compensated for in order to transfer the syntactic role features to the tokens in the standard training and test sets.",
        "We also transferred the ESG part-of-speech codes (different from those in the WSJ corpus) and made an attempt to attach B-PP, B-NP and I-NP tags as inferred from the ESG dependency structure.",
        "In the end, the latter two tags did not prove useful.",
        "ESG is also very fast, parsing several thousand sentences on an IBM RS/6000 in a few minutes of clock time.",
        "It might seem odd to use a parser output as input to a machine learning system to find syntactic chunks.",
        "As noted above, ESG or any other parser normally produces many analyses, whereas in the kind of applications for which chunking is used, e.g., information extraction, only one solution is normally desired.",
        "In addition, due to many incompatibilities between ESG and WSJ treebank, less than 80% of ESG generated syntactic role tags are in agreement with WSJ chunks.",
        "However, the ESG syntactic role tags can be regarded as features in a statistical chunker.",
        "Another view is that the statistical chunker can be regarded as a machine learned transformation that maps ESG syntactic role tags into WSJ chunks.",
        "We denote by f2 the syntactic role tag associated with token tok2.",
        "Each tag takes one of 138 possible values.",
        "The following features are added to our system.",
        "first order features: f2 (i = c, ... , c) second order features: self interactions f2 x fj (i, j = c, ... , c, i < j), and iterations with POS-tags f2 x posh (i, j = c, ... , c)."
      ]
    },
    {
      "heading": "4.3 Dynamic programming",
      "text": [
        "In text chunking, we predict hidden states (chunk types) based on a sequence of observed states (text).",
        "This resembles hidden Markov models where dynamic programming has been widely employed.",
        "Our approach is related to ideas described in (Punyakanok and Roth, 2001).",
        "Similar methods have also appeared in other natural language processing systems (for example, in (Ku-doh and Matsumoto, 2000)).",
        "Given input vectors x consisting of features constructed as above, we apply the regularized Winnow algorithm to train linear weight vectors.",
        "Since the Winnow algorithm only produces positive weights, we employ the balanced version of Winnow with x being transformed into ;~ _ [x, 1, x, 1].",
        "As explained earlier, the constant term is used to offset the effect of threshold 0.",
        "Once a weight vector w = [w+, 0+, w_, 0_] is obtained, we let w = w+ w_ and 0 = 0+ 0_.",
        "The prediction with an incoming feature vector x is then L(w, x) = L(iu, f) = w x 0.",
        "Since Winnow only solves binary classification problems, we train one linear classifier for each chunk type.",
        "In this way, we obtain twenty-three linear classifiers, one for each chunk type t. Denote by wt the weight associated with type t, then a straightforward method to classify an incoming datum is to assign the chunk tag as the one with the highest score L(wt, x).",
        "However, there are constraints in any valid sequence of chunk types: if the current chunk is of type I-X, then the previous chunk type can only be either BX or IX.",
        "This constraint can be explored to improve chunking performance.",
        "We denote by V the set of all valid chunk sequences (that is, the sequence satisfies the above chunk type constraint).",
        "Let tokl, ... , token, be the sequence of tokenized text for which we would like to find the associated chunk types.",
        "Let x1, ... , xr,,, be the associated feature vectors for this text sequence.",
        "Let t1, ... , tr,,, be a sequence of potential chunk types that is valid: {t1i ... , t?,,,} E V. In our system, we find the sequence of chunk types that has the highest value of overall truncated score as:",
        "where L'(wti, xi) = min (1, max(-1, L(wt , xi))).",
        "The truncation onto the interval [-1, 1] is to make sure that no single point contributes too much in the summation.",
        "The optimization problem",
        "can be solved by using dynamic programming.",
        "We build a table of all chunk types for every token toki.",
        "For each fixed chunk type tk+1, we define a value It is easy to verify that we have the following recursion:",
        "We also assume the initial condition S(to) = 0 for all to.",
        "Using this recursion, we can iterate over k = 0, 1, ... , m, and compute S(tk+1) for each potential chunk type tk+1.",
        "Observe that in (5), xk+1 depends on the previous chunk-types tk, ... , tk+1_, (where c = 2).In our implementation, these chunk-types used to create the current feature vector xk+1 are determined as follows.We let tk = arg maxtk S(tk), and let tk_i = arg max tkis{tki,tki+1}EV S(tk_i) for i= 1,...c. After the computation of all S(tk) for k = 0, 1, ... m, we determine the best sequence {t1, ... , t,,,,} as follows.We assign tr,,, to the chunk type with the largest value of S(t?,,,).",
        "Each chunk type tr,,,_1i ... , t1 is then determined from the [recursion (5) as tk = arg max tk:{tk,ik+l}EV S(tk)."
      ]
    },
    {
      "heading": "5 Experimental results",
      "text": [
        "Experimental results reported in this section were obtained by using C = 1, and a uniform prior of ui = 0.1.",
        "We let the learning rate q = 0.01, and ran the regularized Winnow update formula (4) repeatedly thirty times over the training data.",
        "The algorithm is not very sensitive to these parameter choices.",
        "Some other aspects of the system design (such as dynamic programming, features used, etc) have more impact on the performance.",
        "However, due to the limitation of space, we will not discuss their impact in detail.",
        "Table 1 gives results obtained with the basic features.",
        "This representation gives a total number of 3.8 x 106 binary features.",
        "However, the number of non-zero features per datum is 48, which determines the time complexity of our system.",
        "The training time on a 400Mhz Pentium machine running Linux is about sixteen minutes, which corresponds to less than one minute per category.",
        "The time using the dynamic programming to produce chunk predictions, excluding tokenization, is less than ten seconds.",
        "There are about 7 x 104 non-zero linear weight components per chunk-type, which corresponds to a sparsity of more than 98%.",
        "Most features are thus irrelevant.",
        "All previous systems achieving a similar performance are significantly more complex.",
        "For example, the previous best result in the literature was achieved by a combination of 231 kernel support vector machines (Kudoh and Matsumoto, 2000) with an overall F,3=1 value of 93.48.",
        "Each kernel support vector machine is computationally significantly more expensive than a corresponding Winnow classifier, and they use an order of magnitude more classifiers.",
        "This implies that their system should be orders of magnitudes more expensive than ours.",
        "This point can be ver-k+1 S(tk+l) =max {tl .... tk,tk+1}EV i_1 EL'(wti, xi).",
        "ified from their training time of about one day on a 500Mhz Linux machine.",
        "The previously second best system was a combination of five different WPDV models, with an overall F,3=1 value of 93.32 (van Halteren, 2000).",
        "This system is again more complex than the regularized Winnow approach we propose (their best single classifier performance is F,3=1 = 92.47).",
        "The third best performance was achieved by using combinations of memory-based models, with an overall F,3=1 value of 92.50.",
        "The rest of the eleven reported systems employed a variety of statistical techniques such as maximum entropy, Hidden Markov models, and transformation based rule learners.",
        "Interested readers are referred to the summary paper (Sang and Buchholz, 2000) which contains the references to all systems being tested.",
        "The above comparison implies that the regularized Winnow approach achieves state of the art performance with significant less computation.",
        "The success of this method relies on regularized Winnows ability to tolerate irrelevant features.",
        "This allows us to use a very large feature space and let the algorithm to pick the relevant ones.",
        "In addition, the algorithm presented in this paper is simple.",
        "Unlike some other approaches, there is little ad hoc engineering tuning involved in our system.",
        "This simplicity allows other researchers to reproduce our results easily.",
        "In Table 2, we report the results of our system with the basic features enhanced by using ESG syntactic roles, showing that using more linguistic features can enhance the performance of the system.",
        "In addition, since regularized Winnow is able to pick up relevant features automatically, we can easily integrate different features into our system in a systematic way without concerning ourselves with the semantics of the features.",
        "The resulting overall F,3=1 value of 94.13 is appreciably better than any previous system.",
        "The overall complexity of the system is still quite reasonable.",
        "The total number of features is about 4.2 x 106, with 88 nonzero features for each data point.",
        "The training time is about thirty minutes, and the number of non-zero weight components per chunk-type is about 8 x 104.",
        "It is also interesting to compare the regularized Winnow results with those of the original Winnow method.",
        "We only report results with the basic linguistic features in Table 3.",
        "In this experiment, we use the same setup as in the regularized Winnow approach.",
        "We start with a uniform prior of u2 = 0.",
        "1, and let the learning rate be = 0.01.",
        "The Winnow update (1) is performed thirty times repeatedly over the data.",
        "The training time is about sixteen minutes, which is approximately the same as that of the regularized Winnow method.",
        "Clearly regularized Winnow method has indeed enhanced the performance of the original Winnow method.",
        "The improvement is more or less consistent over all chunk types.",
        "It can also be seen that the improvement is not dramatic.",
        "This is not too surprising since the data is very close to linearly separable.",
        "Even on the testset, the multi-class classification accuracy is around 96%.",
        "On average, the binary classification accuracy on the training set (note that we train one binary classifier for each chunk type) is close to 100%.",
        "This means that the training data is close to linearly separable.",
        "Since the benefit of regularized Winnow is more significant with noisy data, the improvement in this case is not dramatic.",
        "We shall mention that for some other more noisy problems which we have tested on, the improvement of regularized Winnow method over the original Winnow method can be much more significant."
      ]
    },
    {
      "heading": "6 Conclusion",
      "text": [
        "In this paper, we described a text chunking system using regularized Winnow.",
        "Since regularized Winnow is robust to irrelevant features, we can construct a very high dimensional feature space and let the algorithm pick up the important ones.",
        "We have shown that state of the art performance can be achieved by using this approach.",
        "Furthermore, the method we propose is computationally more efficient than all other systems reported in the literature that achieved performance close to ours.",
        "Our system is also relatively simple which does not involve much engineering tuning.",
        "This means that it will be relatively easy for other researchers to implement and reproduce our results.",
        "Furthermore, the success of regularized Winnow in text chunking suggests that the method might be applicable to other NLP problems where it is necessary to use large feature spaces to achieve good performance."
      ]
    }
  ]
}
