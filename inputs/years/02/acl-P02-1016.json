{
  "info": {
    "authors": [
      "Min Tang",
      "Xiaoqiang Luo",
      "Salim Roukos"
    ],
    "book": "Annual Meeting of the Association for Computational Linguistics",
    "id": "acl-P02-1016",
    "title": "Active Learning for Statistical Natural Language Parsing",
    "url": "https://aclweb.org/anthology/P02-1016",
    "year": 2002
  },
  "references": [
    "acl-H94-1052",
    "acl-J92-4003",
    "acl-N01-1023",
    "acl-P96-1025",
    "acl-W00-1306",
    "acl-W01-0710",
    "acl-W97-0301"
  ],
  "sections": [
    {
      "heading": "Abstract",
      "text": [
        "It is necessary to have a (large) annotated corpus to build a statistical parser.",
        "Acquisition of such a corpus is costly and time-consuming.",
        "This paper presents a method to reduce this demand using active learning, which selects what samples to annotate, instead of annotating blindly the whole training corpus.",
        "Sample selection for annotation is based upon “representativeness” and “usefulness”.",
        "A model-based distance is proposed to measure the difference of two sentences and their most likely parse trees.",
        "Based on this distance, the active learning process analyzes the sample distribution by clustering and calculates the density of each sample to quantify its representativeness.",
        "Further more, a sentence is deemed as useful if the existing model is highly uncertain about its parses, where uncertainty is measured by various entropy-based scores.",
        "Experiments are carried out in the shallow semantic parser of an air travel dialog system.",
        "Our result shows that for about the same parsing accuracy, we only need to annotate a third of the samples as compared to the usual random selection method."
      ]
    },
    {
      "heading": "1 Introduction",
      "text": [
        "A prerequisite for building statistical parsers (Jelinek et al., 1994; Collins, 1996; Ratnaparkhi, 1997; Charniak, 1997) is the availability of a (large) corpus of parsed sentences.",
        "Acquiring such a corpus is expensive and time-consuming and is often the bottleneck to build a parser for a new application or domain.",
        "The goal of this study is to reduce the amount of annotated sentences (and hence the development time) required for a statistical parser to achieve a satisfactory performance using active learning.",
        "Active learning has been studied in the context of many natural language processing (NLP) applications such as information extraction(Thompson et al., 1999), text clas-sification(McCallum and Nigam, 1998) and natural language parsing(Thompson et al., 1999; Hwa, 2000), to name a few.",
        "The basic idea is to couple tightly knowledge acquisition, e.g., annotating sentences for parsing, with model-training, as opposed to treating them separately.",
        "In our setup, we assume that a small amount of annotated sentences is initially available, which is used to build a statistical parser.",
        "We also assume that there is a large corpus of unannotated sentences at our disposal – this corpus is called active training set.",
        "A batch of sam-ples' is selected using algorithms developed here, and are annotated by human beings and are then added to training data to rebuild the model.",
        "The procedure is iterated until the model reaches a certain accuracy level.",
        "Our efforts are devoted to two aspects: first, we believe that the selected samples should reflect the underlying distribution of the training corpus.",
        "In other words, the selected samples need to be representative.",
        "To this end, a model-based structural distance is defined to quantify how “far” two sentences are apart, and with the help of this distance, the active training set is clustered so that we can define and compute the “density” of a sample; second, we propose and test several entropy-based measures to quantify the uncertainty of a sample in the active training set using an existing model, as it makes sense to ask human beings to annotate the portion of data for which the existing model is not doing well.",
        "Samples are selected from the clusters based on uncertainty scores.",
        "The rest of the paper is organized as follows.",
        "In Section 2, a structural distance is first defined based on the sequential representation of a parse tree.",
        "It is then straightforward to employ a k-means algorithm to cluster sentences in the active training set.",
        "Section 3 is devoted to confidence measures, where three uncertainty measures are proposed.",
        "Active learning results on the shallow semantic parser of an air travel dialog system are presented 'A sample means a sentence in this paper.",
        "Proceedings of the 40th Annual Meeting of the Association for Computational Linguistics (ACL), Philadelphia, July 2002, pp.",
        "120-127. in Section 4.",
        "A summary of related work is given in Section 5.",
        "The paper closes with conclusions and future work."
      ]
    },
    {
      "heading": "2 Sentence Distance and Clustering",
      "text": [
        "To characterize the “representativeness” of a sentence, we need to know how far two sentences are apart so that we can measure roughly how many similar sentences there are in the active training set.",
        "For our purpose, the distance ought to have the property that two sentences with similar structures have a small distance, even if they are lexically different.",
        "This leads us to define the distance between two sentences based on their parse trees, which are obtained by applying an existing model to the active training set.",
        "However, computing the distance of two parse trees requires a digression of how they are represented in our parser."
      ]
    },
    {
      "heading": "2.1 Event Representation of Parse Trees",
      "text": [
        "A statistical parser computes P(T I S), the probability of a parse T given a sentence S. Since the space of the entire parses is too large and cannot be modeled directly, a parse tree T is decomposed as a series of individual actions a,, a2, • • • , a,,,,.",
        "In the parser (Jelinek et al., 1994) we used in this study, this is accomplished through a bottom-up-left-most (BULM) derivation.",
        "In the BULM derivation, there are three types of parse actions: tag, label and extension.",
        "There is a corresponding vocabulary for tag or label, and there are four extension directions: RIGHT, LEFT, UP and UNIQUE.",
        "If a child node is the only node under a label, the child node is said to extend UNIQUE to its parent node; if there are multiple children under a parent node, the leftmost child is said to extend RIGHT to the parent node, the rightmost child node is said to extend LEFT to the parent node, while all the other intermediate children are said to extend UP to their parent node.",
        "The BULM derivation can be best explained by an example in Figure 1.",
        "The input sentence is fly from new york to boston.",
        "Numbers on its semantic parse tree indicate the order of parse actions while colors indicate types of actions: tags are numbered in blue boxes, extensions in red parentheses and labels in green underlines.",
        "For this example, the first action is tagging the first word fly given the sentence; the second action is extending the tag wd RIGHT, as the tag wd is the leftmost child of the constituent S; and the third action is tagging the second word from given the sentence and the two proceeding actions, and so on and so forth.",
        "We define an event as a parse action together with its context.",
        "It is clear that the BULM derivation converts a parse tree into a unique sequence of parse events, and a valid event sequence corresponds to a unique parse tree.",
        "Therefore a parse tree can be equivalently represented by a sequence of events.",
        "Let T(S) be the set of tagging actions, L(S) be the labeling actions and E(S) be the extending actions of S, and let h(a) be the sequence of actions ahead of the action a, then P (T I S) can be rewritten as:",
        "models (1) can be trained using decision trees (Jelinek et al., 1994; Breiman et al., 1984).",
        "Note that raw context space { (S, h(a)) } is too huge to store and manipulate efficiently.",
        "In our implementation, contexts are internally represented as bitstrings through a set of pre-designed questions.",
        "Answers of each question are represented as bitstrings.",
        "To support questions like “what is the previous word (or tag, label, extension)?”, word, tag, label and extension vocabularies are all encoded as bitstrings.",
        "Words are encoded through an automatic clustering algorithm (Brown et al., 1992) while tags, labels and extensions are normally encoded using diagonal bits.",
        "An example can be found in (Luo et al., 2002).",
        "In summary, a parse tree can be represented uniquely by a sequence of events, while each event can in turn be represented as a bitstring.",
        "With this in mind, we are now ready to define a structural distance for two sentences given an existing model."
      ]
    },
    {
      "heading": "2.2 Sentence Distance",
      "text": [
        "Recall that it is assumed that there is a statistical parser M trained with a small amount of annotated data.",
        "To infer structures of two sentences S1 and S2, we use M",
        "wd 1 wd 3 city5 city7 wd.",
        "13 c}ty fly from new york to bo ston to decode S1 and S2 and get their most likely parse trees T1 and T2.",
        "The distance between S1 and S2, given M, is defined as the distance between (S1, T1) and (S2, T2),",
        "To emphasize the dependency on M, we denote the distance as dm (S1, S2).",
        "Note that we assume here that S1 and S2 have similar “true” parses if they have similar structures under the current model M. We have shown in Section 2.1 that a parse tree can be represented by a sequence of events, each of which can in turn be represented as bitstrings through answering questions.",
        "Let Ei = e�1) e�2), • • • , e�L\") be the sequence representation for (Si, Ti) (i = 1, 2), where ez = (h�'), a�')), and h�') is the context and a�') is the parsing action of the jth event of the parse tree Ti.",
        "We can define the distance between two sentences S1, S2 as",
        "The distance between two sequences E1 and E2 is computed as the editing distance using dynamic programming (Rabiner and Juang, 1993).",
        "We now describe the distance between two individual events.",
        "We take advantage of the fact that contexts {h�') I can be encoded as bitstrings, and define the distance between two contexts as the Hamming distance between their bitstring representations.",
        "We further define the distance between two parsing actions as follows: it is either 0 or a constant c if two parse actions are of the same type (recall there are three types of parsing actions: tag, label and extension), and infinity if different types.",
        "We choose c to be the number of bits in h�') to emphasize the importance of parsing actions in distance computation.",
        "Formally, let Y(a) be the type of action a, then",
        "where H(h1'), h2k)) is the Hamming distance, and",
        "Computing the editing distance (3) requires dynamic programming and it is computationally extensive.",
        "To speed up computation, we can choose to ignore the difference in contexts, or in other words, (4) becomes",
        "The distance dm (•, •) makes it possible to characterize how dense a sentence is.",
        "Given a set of sentences S =",
        "That is, the sample density is defined as the inverse of its average distance to other samples.",
        "We also define the centroid2 7rs of S as",
        "Si"
      ]
    },
    {
      "heading": "2.3 K-Means Clustering",
      "text": [
        "With the model-based distance measure defined above, we can use the K-means algorithm to cluster sentences.",
        "A sketch of the algorithm (Jelinek, 1997) is as follows.",
        "Let S = {S1, S2, ..., SN I be the set of sentences to be",
        "clustered.",
        "1.",
        "Initialization.",
        "Partition { S1i S2, ..., SN } into k initial clusters Y°(j = 1, ..., k).",
        "Let t = 0.",
        "2.",
        "Find the centroid 7rj' for each collection – Vjl , that is:",
        "gorithm converges (e.g., relative change of the total distortion is smaller than a threshold).",
        "For each iteration we need to compute:",
        "• the distance between samples Si and cluster centers 7ri, • the pairwise distances within each cluster.",
        "The basic operation here is to compute the distance between two sentences, which involves a dynamic programming process and is time-consuming.",
        "The complexity of this algorithm is, if we assume the N samples are uniformly distributed between the k clusters, approximately O(2 + Nk), or O( k2) when N » k. In our experiments N :; 2 x 104 and k � 100, we need to call the dynamic programming routine O (106) times each itera",
        "To speed up, dynamic programming is constrained so that only the band surrounding the diagonal line (Rabiner and Juang, 1993) is allowed, and repeated sentences are stored as a unique copy with its count so that computation for the same sentence pair is never repeated.",
        "The latter is a quite effective for dialog systems as a sentence is often seen more than once in the training corpus."
      ]
    },
    {
      "heading": "3 Uncertainty Measures",
      "text": [
        "Intuitively, we would like to select samples that the current model is not doing well.",
        "The current model’s uncertainty about a sentence could be because similar sentences are under-represented in the (annotated) training set, or similar sentences are intrinsically difficult.",
        "We take advantage of the availability of parsing scores from the existing statistical parser and propose three entropy-based uncertainty scores."
      ]
    },
    {
      "heading": "3.1 Change of Entropy",
      "text": [
        "After decision trees are grown, we can compute the entropy of each leaf node l as:",
        "where i sums over either tag, label or extension vocabulary, and pi(i) is simply NI(i) , where NI(i) is the",
        "where Nl = �i N, (i).",
        "Note that H is the log probability of training events.",
        "After seeing an unlabeled sentence S, we can decode it using the existing model and get its most probable parse T. The tree T can then be represented by a sequence of events, which can be “poured” down the grown trees, and the count Nl (i) can be updated accordingly – denote the updated count as N, (i).",
        "A new model entropy H' can be computed based on N, (i), and the absolute difference, after it is normalized by the number of events nT in T, is the change of entropy we are after:",
        "It is worth pointing out that Ho is a “local” quantity in that the vast majority of N, (i) is equal to Nl (i), and thus we only have to visit leaf nodes where counts change.",
        "In other words, Ho can be computed efficiently.",
        "Ho characterizes how a sentence S “surprises” the existing model: if the addition of events due to S changes a lot of {pl (•) }, and consequently, H, the sentence is probably not well represented in the initial training set and Ho will be large.",
        "We would like to annotate these sentences."
      ]
    },
    {
      "heading": "3.2 Sentence Entropy",
      "text": [
        "Now let us consider another measurement which seeks to address the intrinsic difficulty of a sentence.",
        "Intuitively, we can consider a sentence more difficult if there are potentially more parses.",
        "We calculate the entropy of the distribution over all candidate parses as the sentence entropy to measure the intrinsic ambiguity.",
        "Given a sentence S, the existing model M could generate the top K most likely parses {Ti : i = 1, 2, �K",
        "where Ti is the ith possible parse and qi is its associated score.",
        "Without confusion, we drop qi’s dependency on"
      ]
    },
    {
      "heading": "3.3 Word Entropy",
      "text": [
        "As we can imagine, a long sentence tends to have more possible parsing results not because it is difficult but simply because it is long.",
        "To counter this effect, we can normalize the sentence entropy by the length of sentence to calculate per word entropy of a sentence: _ H. HS LS where LS is the number of words in S.",
        "longer sentences more.",
        "This can be explained as follows: longer sentences tend to have more complex structures ( extension and labeling ) than shorter sentences.",
        "And the models for these complex structures are relatively less trained as compared with models for tagging.",
        "As a result, longer sentences would have higher change of entropy, in other words, larger impact on models.",
        "As explained above, longer sentences also have larger sentence entropy.",
        "After normalizing, this trend is reversed in word entropy."
      ]
    },
    {
      "heading": "4 Experimental Results and Analysis",
      "text": [
        "All experiments are done with a shallow semantic parser (a.k.a.",
        "classer (Davies et al., 1999)) of the natural language understanding part in DARPA Communicator (DARPA Communicator Website, 2000).",
        "We built an initial model using 1000 sentences.",
        "We have 20951 unlabeled sentences for the active learner to select samples.",
        "An independent test set consists of 4254 sentences.",
        "A fixed batch size B = 100 is used through out our experiments.",
        "Exact match is used to compute the accuracy, i.e., the accuracy is the number of sentences whose decoding trees are exactly the same as human annotation divided by the number of sentences in the test set.",
        "The effectiveness of active learning is measured by comparing learning curves (i.e., test accuracy vs. number of training sentences ) of active learning and random selection."
      ]
    },
    {
      "heading": "4.1 Sample Selection Schemes",
      "text": [
        "We experimented two basic sample selection algorithms.",
        "The first one is selecting samples based solely on uncertainty scores, while the second one clusters sentences, and then selects the most uncertain ones from each cluster.",
        "• Uncertainty Only: at each active learning iteration, the most uncertain B sentences are selected.",
        "The drawback of this selection method is that it risks selecting outliers because outliers are likely to get high uncertainty scores under the existing models.",
        "Figure 3 shows the test accuracy of this selection method against the number of samples selected from the active training set.",
        "Short sentences tends to have higher value of Hu, while sentence-based uncertainty scores (in terms of HA or HS) are low.",
        "Since we use the sentences as the basic units, it is not surprising that H„-based method performs poorly while the other two perform very well.",
        "• Most Uncertain Per Cluster: In our implementation, we cluster the active training set so that",
        "the number of clusters equals the batch size.",
        "This scheme selects the sentence with the highest uncertain score from each cluster.",
        "We expect that restricting sample selection to each cluster would fix the problem that Hu, tends to be large for short sentences, as short sentences are likely to be in one cluster and long sentences will get a fair chance to be selected in other clusters.",
        "This is verified by the learning curves in Figure 4.",
        "Indeed, Hu, performs as well as Hs most of the time.",
        "And all active learning algorithms perform better than random selection."
      ]
    },
    {
      "heading": "4.2 Weighting Samples",
      "text": [
        "In the sample selection process we calculated the density of each sample.",
        "For those samples selected, we also have the knowledge of their correct annotations, which can be used to evalutate the model’s performance on them.",
        "We exploit this knowledge and experiment two weighting schemes.",
        "• Weight by Density:",
        "A sample with higher density should be assigned greater weights because the model can benefit more by learning from this sample as it has more neighbors.",
        "We calculate the density of a sample inside its cluster so we need to adjust the density by cluster size to avoid the unwanted bias toward small clusters.",
        "For cluster Y = {Si } � �1, the weight for sample Skis proportional to I Y I * p (SO .",
        "• Weight by Performance: The idea of weight by performance is to focus the model on its weakness when it knows about it.",
        "The model can test itself on its training set where the truth is known and assign greater weights to sentences it parses incorrectly.",
        "In our experiment, weights are updated as follows: the initial weight for a sentence is its count; and if the human annotation of a selected sentence differs from the current model output, its weight is multiplied by 1.5.",
        "We did not experiment more complicated weighting scheme (like AdaBoost) since we only want to see if weighting has any effect on active learning result.",
        "Figure 5 and Figure 6 are learning curves when selected samples are weighted by density and performance, which are described in Section 4.2.",
        "The effect of weighting samples is highlighted in Table 1, where results are obtained after 1000 samples are selected using the same uncertainty score Hu, but with different weighting schemes.",
        "Weighting samples by density leads to the best performance.",
        "Since weighting samples by density is a way to tweak sample distribution of",
        "training set toward the distribution of the entire sample space, including unannotated sentences, it indicates that it is important to ensure the distribution of training set matches that of the sample space.",
        "Therefore, we believe that clustering is a necessary and useful step."
      ]
    },
    {
      "heading": "4.3 Effect of Clustering",
      "text": [
        "tering and the word entropy Hu,.",
        "It is clear that clustering results in a better learning curve."
      ]
    },
    {
      "heading": "4.4 Summary Result",
      "text": [
        "Figure 8 shows the best active learning result compared with that of random selection.",
        "The learning curve for active learning is obtained using H,, as uncertainty measure and selected samples are weighted by density.",
        "Both active learning and random selection are run 40 times, each time selecting 100 samples.",
        "The horizontal line on the graph is the performance if all 20K sentences are used.",
        "It is remarkable to notice that active learning can use far less samples ( usually less than one third ) to achieve the same level of performance of random selection.",
        "And after only about 2800 sentences are selected, the active learning result becomes very close to the best possible accuracy."
      ]
    },
    {
      "heading": "5 Previous Work",
      "text": [
        "While active learning has been studied extensively in the context of machine learning (Cohn et al., 1996; Freund",
        "et al., 1997), and has been applied to text classification (McCallum and Nigam, 1998) and part-of-speech tagging (Dagan and Engelson, 1995), there are only a handful studies on natural language parsing (Thompson et al., 1999) and (Hwa, 2000; Hwa, 2001).",
        "(Thompson et al., 1999) uses active learning to acquire a shift-reduce parser, and the uncertainty of an unparseable sentence is defined as the number of operators applied successfully divided by the number of words.",
        "It is more natural to define uncertainty scores in our study because of the avail-bility of parse scores.",
        "(Hwa, 2000; Hwa, 2001) is related closely to our work in that both use entropy-based uncertainty scores, but Hwa does not characterize the distribution of sample space.",
        "Knowing the distribution of sample space is important since uncertainty measure, if used alone for sample selection, will be likely to select outliers.",
        "(Stolcke, 1998) used an entropy-based criterion to reduce the size of backoff n-gram language models.",
        "The major contribution of this paper is that a model-based distance measure is proposed and used in active learning.",
        "The distance measures structural difference of two sentences relative to an existing model.",
        "Similar idea is also exploited in (McCallum and Nigam, 1998) where authors use the divergence between the unigram word distributions of two documents to measure their difference.",
        "This distance enables us to cluster the active training set and a sample is then selected and weighted based on both its uncertainty score and its density.",
        "(Sarkar, 2001) applied co-training to statistical parsing, where two component models are trained and the most confident parsing outputs of the existing model are incorporated into the next training.",
        "This is a different venue for reducing annotation work in that the current model output is directly used and no human annotation is assumed.",
        "(Luo et al., 1999; Luo, 2000) also aimed to making use of unlabeled data to improve statistical parsers by transforming model parameters."
      ]
    },
    {
      "heading": "6 Conclusions and Future Work",
      "text": [
        "We have examined three entropy-based uncertainty scores to measure the “usefulness” of a sample to improving a statistical model.",
        "We also define a distance for sentences of natural languages.",
        "Based on this distance, we are able to quantify concepts such as sentence density and homogeneity of a corpus.",
        "Sentence clustering algorithms are also developed with the help of these concepts.",
        "Armed with uncertainty scores and sentence clusters, we have developed sample selection algorithms which has achieved significant savings in terms of labeling cost: we have shown that we can use one-third of training data of random selection and reach the same level of parsing accuracy.",
        "While we have shown the importance of both confidence score and modeling the distribution of sample space, it is not clear whether or not it is the best way to combine or reconcile the two.",
        "It would be nice to have a single number to rank candidate sentences.",
        "We also want to test the algorithms developed here on other domains (e.g., Wall Street Journal corpus).",
        "Improving speed of sentence clustering is also worthwhile."
      ]
    },
    {
      "heading": "7 Acknowledgments",
      "text": [
        "We thank Kishore Papineni and Todd Ward for many useful discussions.",
        "The anonymous reviewer’s suggestions to improve the paper is greatly appreciated.",
        "This work is partially supported by DARPA under SPAWAR contract number N66001-99-2-8916."
      ]
    }
  ]
}
