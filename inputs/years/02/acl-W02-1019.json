{
  "info": {
    "authors": [
      "Shankar Kumar",
      "William Byrne"
    ],
    "book": "Conference on Empirical Methods in Natural Language Processing",
    "id": "acl-W02-1019",
    "title": "Minimum Bayes-Risk Word Alignments of Bilingual Texts",
    "url": "https://aclweb.org/anthology/W02-1019",
    "year": 2002
  },
  "references": [
    "acl-C00-2163",
    "acl-J93-2003",
    "acl-P00-1056",
    "acl-P02-1050",
    "acl-W96-0213"
  ],
  "sections": [
    {
      "heading": "Abstract",
      "text": [
        "We present Minimum Bayes-Risk word alignment for machine translation.",
        "This statistical, model-based approach attempts to minimize the expected risk of alignment errors under loss functions that measure alignment quality.",
        "We describe various loss functions, including some that incorporate linguistic analysis as can be obtained from parse trees, and show that these approaches can improve alignments of the English-French Hansards."
      ]
    },
    {
      "heading": "1 Introduction",
      "text": [
        "The automatic determination of word alignments in bilingual corpora would be useful for Natural Language Processing tasks such as statistical machine translation, automatic dictionary construction, and multilingual document retrieval.",
        "The development of techniques in all these areas would be facilitated by automatic performance metrics, and alignment and translation quality metrics have been proposed (Och and Ney, 2000b; Papineni et al., 2002).",
        "However, given the difficulty of judging translation quality, it is unlikely that a single, global metric will be found for any of these tasks.",
        "It is more likely that specialized metrics will be developed to measure specific aspects of system performance.",
        "This is even desirable, as these specialized metrics could be used in tuning systems for particular applications.",
        "We have applied Minimum Bayes-Risk (MBR) procedures developed for automatic speech recognition (Goel and Byrne, 2000) to word alignment of bitexts.",
        "This is a modeling approach that can be used with statistical models of speech and language to develop algorithms that are optimized for specific loss functions.",
        "We will discuss loss functions that can be used for word alignment and show how the overall alignment process can be improved by the use of loss functions that incorporate linguistic features, such as parses and part-of-speech tags."
      ]
    },
    {
      "heading": "2 Word-to-Word Bitext Alignment",
      "text": [
        "We will study the problem of aligning an English sentence to a French sentence and we will use the word alignment of the IBM statistical translation models (Brown et al., 1993).",
        "Let and denote a pair of translated English and French sentences.",
        "An English word is defined as an ordered pair , where the index refers to the position of the word in the English sentence; is the vocabulary of English; and the word at position is the NULL word to which “spurious” French words may be aligned.",
        "Similarly, a French word is written as ."
      ]
    },
    {
      "heading": "3 Alignment Loss Functions",
      "text": [
        "In this section we introduce loss functions to measure the quality of automatically produced alignments.",
        "Suppose we wish to compare an automatically produced alignment to a reference alignment , which we assume was produced by a competent translator.",
        "We will define various loss functions that measure the quality of relative to through their link sets and .",
        "The desirable qualities in translation are fluency .",
        "An alignment between and is defined to be a sequence where .",
        "Under the alignment , the French word is connected to the English word .",
        "For every alignment , we define a link set defined as whose elements are given by the alignment links and adequacy.",
        "We assume here that both word sequences are fluent and adequate translations but that the word and phrase correspondences are unknown.",
        "It is these correspondences that we wish to determine and evaluate automatically.",
        "We now present two general classes of loss functions that measure alignment quality.",
        "In subsequent sections, we will give specific examples of these and show how to construct decoders that are optimized for each loss function."
      ]
    },
    {
      "heading": "3.1 Alignment Error",
      "text": [
        "The Alignment Error Rate (AER) introduced by Och and Ney (2000b) measures the fraction of links by which the automatic alignment differs from the reference alignment.",
        "Links to the NULL word are ignored.",
        "This is done by defining modified link sets for the reference alignment and the automatic alignment .",
        "The reference annotation procedure allowed the human transcribers to identify which links in they judged to be unambiguous.",
        "In addition to the reference alignment, this gives a set of sure links (S) which is a subset of .",
        "AER is defined as (Och and Ney, 2000b) Since our modeling techniques require loss functions rather than error rates, we introduce the Alignment Error loss function We consider error rates to be “normalized” loss functions.",
        "We also note that, unlike AER, does not distinguish between ambiguous and unambiguous links.",
        "However, if a decoder generates an alignment for which is zero, the AER is also zero.",
        "Therefore if AER is the metric of interest, we will design alignment procedures to minimize ."
      ]
    },
    {
      "heading": "3.2 Generalized Alignment Error",
      "text": [
        "We are interested in extending the Alignment Error loss function to incorporate various linguistic features into the measurement of alignment quality.",
        "The Generalized Alignment Error loss is defined as where and Here we have introduced the word-to-word distance measure which compares the links and as a function of the words in the translation.",
        "refers to all loss functions that have the form of Equation 3.",
        "Specific loss functions are determined through the choice of .",
        "To see the value in this, suppose is a verb in the French sentence and that it is aligned in the reference alignment to , the verb in the English sentence.",
        "If our goal is to ensure verb alignment, then can be constructed to penalize any link in the automatic alignment in which is not a verb.",
        "We will later give examples of distances in which is based on Part-of-Speech (POS) tags, parse tree distances, and automatically determined word clusters.",
        "We note that the can almost be reduced to , except for the treatment of NULL in the English sentence."
      ]
    },
    {
      "heading": "4 Minimum Bayes-Risk Decoding For Automatic Word Alignment",
      "text": [
        "We present the Minimum Bayes-Risk alignment formulation and derive MBR alignment procedures under the loss functions of Section 3.",
        "Given a translated pair of English-French sentences , the decoder produces an alignment .",
        "Relative to a reference alignment , the decoder performance is measured as .",
        "Our goal is to find the decoder that has the best performance over all translated sentences.",
        "This is measured through the Bayes Risk .",
        "The expectation is taken with respect to the true distribution that describes “human quality” alignments of translations as they are found in bitext.",
        "Given a loss function and a probability distribution, it is well known that the decision rule which minimizes the Bayes Risk is given by the following expression (Bickel and Doksum, 1977; Goel and",
        "Several modeling assumptions have been made to obtain this form of the decoder.",
        "We do not have access to the true distribution over translations.",
        "We therefore use statistical MT models to approximate .",
        "We furthermore assume that the space of alignment alternatives can be restricted to an alignment lattice , which is a compact representation of the most likely word alignments of the sentence pair under the baseline models.",
        "It is clear from Equation 5 that the MBR decoder is determined by the loss function.",
        "The Sentence Alignment Error refers to the loss function that gives a penalty of 1 for any errorful alignment: , where is the indicator function of the set .",
        "The MBR decoder under this loss can easily be seen to be the Maximum Likelihood (ML) alignment under the MT models: .",
        "This illustrates why we are interested in MBR decoders based on other loss functions: the ML decoder is optimal with respect to a loss function that is overly harsh.",
        "It does not distinguish between different types of alignment errors and good alignments receive the same penalty as poor alignments.",
        "Moreover, such a harsh penalty is particularly inappropriate when unambiguous word-to-word alignments cannot be provided in all cases even by human translators who produce the reference alignments.",
        "The AER makes an explicit distinction between ambiguous and unambiguous word alignments.",
        "Ideally, the decoder should be able to do so as well.",
        "Motivated by this, the MBR hypothesis can be thought of as the consensus hypothesis under a particular loss function: Equation 5 selects the hypothesis that is, in an average sense, close to the other likely hypotheses.",
        "In this way, ambiguity can be reduced by selecting the hypothesis that is “most similar” to the collection of most likely competing hypotheses.",
        "We now describe the alignment lattice (Section 4.1) and introduce the lattice based probabilities required for the MBR alignment (Section 4.2).",
        "The derivation of the MBR alignment under the AE and GAE loss functions is presented in Sections 4.3 and 4.4."
      ]
    },
    {
      "heading": "4.1 Alignment Lattice",
      "text": [
        "The lattice is represented as a Weighted Finite State Transducer (WFST) (Mohri et al., 2000) with a finite set of states , a set of transition labels , an initial state , the set of final states , and a finite set of transitions .",
        "A transition in this WFST is given by where is the starting state, is the ending state, is the alignment link and is the weight.",
        "For an English sentence of length and a French sentence of length , we define as .",
        "A complete path through the WFST is a sequence of transitions given by such that and .",
        "Each complete path defines an alignment link set .",
        "When we write , we mean that is derived from a complete path through .",
        "This allows us to use alignment models in which the probability of an alignment can be written as a sum over alignment link weights, i.e. ."
      ]
    },
    {
      "heading": "4.2 Alignment Link Posterior Probability",
      "text": [
        "We first introduce the lattice transition posterior probability of each transition in the lattice where is if and otherwise.",
        "The lattice transition posterior probability is the sum of the posterior probabilities of all lattice paths passing through the transition .",
        "This can be computed very efficiently with a forward-backward algorithm on the alignment lattice (Wessel et al., 1998).",
        "is the posterior probability of an alignment link set which can be written as We now define the alignment linkposteriorprob-ability for a link (8) where .",
        "This is the probability that any two words are aligned given all the alignments in the lattice .",
        "For an alignment link we note that .",
        "Therefore, the MBR alignment (Equation 9) can be found in terms of the modified link weight for each alignment link",
        "We now derive MBR alignment under the Generalized Alignment Error loss function (Equation 3).",
        "The optimal decoder has the form (Equation 5)",
        "The MBR alignment procedures under the and loss functions begin with a WFST that contains the alignment probabilities as described in Section 4.1.",
        "To build the MBR decoder for each loss function the weights on the transitions ( ) of the WFST are modified according to either Equation 11 ( ) or Equation 13 ( ).",
        "Once the weights are modified, the search procedure for the MBR alignment is the same in each case.",
        "The search is carried out using a shortest-path algorithm (Mohri et al., 2000).",
        "5 Word Alignment Experiments We present here examples of Generalized Alignment Error loss functions based on three types of linguistic features and show how they can be incorporated into a statistical MT system to obtain automatic alignments.",
        "4.3 MBR Alignment Under In this section we derive MBR alignment under the Alignment Error loss function (Equation 2).",
        "The optimal decoder has the form (Equation 5)",
        "If is the subset of transitions ( ) that do not contain links with the NULL word, we can simplify the bracketed term as The summation can be rewritten as where and .",
        "The MBR alignment (Equation 12) can be found in terms of the modified link weight for each alignment link where and .",
        "We can simplify the bracketed term as The summation is equal to We can rewrite the above equation as"
      ]
    },
    {
      "heading": "5.1 Syntactic Distances From Parse-Trees",
      "text": [
        "Suppose a parser is available that generates a parse-tree for the English sentence.",
        "Our goal is to construct an alignment loss function that incorporates features from the parse.",
        "One way to do this is to define a graph distance"
      ]
    },
    {
      "heading": "5.2 Distances Derived From Part-of-Speech Labels",
      "text": [
        "Suppose a Part-of-Speech(POS) tagger is available to tag each word in the English sentence.",
        "If POS denotes the POS of the English word , we can define the word-to-word distance measure (Equation 4) as",
        "Here and are the parse-tree leaf nodes corresponding to the English words and .",
        "This quantity is computed as the sum of the distances from each node to their closest common ancestor.",
        "It gives a syntactic distance between any pair of English words based on the parse-tree.",
        "This distance has been used to measure word association for information retrieval (Mittendorfer and Winiwarter, 2001).",
        "It reflects how strongly the words and are bound together by the syntactic structure of the English sentence as determined by the parser.",
        "Figure 1 shows the parse tree for an English sentence in the test data with the pairwise syntactic distances between the English words corresponding to the leaf nodes.",
        "To obtain these distances, Ratnaparkhi’s part-of-speech (POS) tagger (Ratnaparkhi, 1996) and Collins’ parser (Collins, 1999) were used to obtain parse trees for the English side of the test corpus.",
        "With defined as in Equation 14, the Generalized Alignment Error loss function (Equation 3) is called the Parse-Tree Syntactic Distance ( ).",
        "Ratnaparkhi’s POS tagger (Ratnaparkhi, 1996) was used to obtain POS tags for each word in the English sentence.",
        "With specified by Equation 15, the Generalized Alignment Error loss function (Equation 3) is called the Part-Of-Speech Distance ( )."
      ]
    },
    {
      "heading": "5.3 Automatic Word Cluster Distances",
      "text": [
        "Suppose we are working in a language for which parsers and POS taggers are not available.",
        "In this situation we might wish to construct the loss functions based on word classes determined by automatic clustering procedures.",
        "If specifies the word cluster for the English word , then we define the distance",
        "In our experiments we obtained word clusters for English words using a statistical learning procedure (Kneser and Ney, 1991) where the total number of word classes is restricted to be 100.",
        "With as defined in Equation 16, the Generalized Alignment Error loss function (Equation 3) is called the Automatic Word Class Distance ( )."
      ]
    },
    {
      "heading": "5.4 IBM-3 Word Alignment Models",
      "text": [
        "Since the true distribution over alignments is not known, we used the IBM-3 statistical translation model (Brown et al., 1993) to approximate .",
        "This model is specified through four components: Fertility probabilities for words; Fertility probabilities for NULL; Word Translation probabilities; and Distortion probabilities.",
        "We used a modified version of the IBM-3 distortion model (Knight and Al-Onaizan, 1998) in which each of the possible permutations of the French",
        "sentence is equally likely.",
        "The IBM-3 models were trained on a subset of the Canadian Hansards French-English data which consisted of 50,000 parallel sentences (Och and Ney, 2000b).",
        "The vocabulary size was 18,499 for English and 24,198 for French.",
        "The GIZA++ toolkit (Och and Ney, 2000a) was used for training the IBM-3 models (as in (Och and Ney, 2000b))."
      ]
    },
    {
      "heading": "5.5 Word Alignment Lattice Generation",
      "text": [
        "We obtained word alignments under the modified IBM-3 models using the finite state translation framework introduced by Knight and Al-Onaizan (1998).",
        "The finite state operations were carried out using the AT&T Finite State Machine Toolkit (Mohri et al., 2001; Mohri et al., 2000).",
        "The WFST framework involves building a transducer for each constituent of the IBM-3 Alignment Models: the word fertility model ; the NULL fertility model ; and the word translation model (Section 5.4).",
        "For each sentence pair we also built a finite state acceptor that accepts the English sentence and another acceptor which accepts all legal permutations of the French sentence.",
        "The alignment lattice for the sentence pair was then obtained by the following weighted finite state composition .",
        "In practice, the WFST obtained by the composition was pruned to a maximum of 10,000 states using a likelihood based pruning operation.",
        "In terms of AT&T Finite State Toolkit shell commands, these operations are given as: fsmcompose E M fsmcompose - N fsmcompose - T fsmcompose - F fsmprune n 10000 The finite state composition and pruning were performed using lazy implementations of algorithms provided in AT&T Finite State libraries (Mohri et al., 2000).",
        "This made the computation efficient because even though five WFSTs are composed into a potentially huge transducer, only a small portion of it is actually searched during the pruning used to generate the final lattice.",
        "A heavily pruned alignment lattice for a sentence-pair from the test data is shown in Figure 2.",
        "For clarity of presentation, each alignment link in the lattice is shown as an ordered pair where and are the English and French words on the link.",
        "For each sentence, we also computed the lattice path with the highest probability .",
        "This gives the ML alignment under the statistical MT models that will give our baseline performance under the various loss functions."
      ]
    },
    {
      "heading": "5.6 Performance Under The Alignment Error Rates",
      "text": [
        "Our unseen test data consisted of 207 French-English sentence pairs from the Hansards corpus (Och and Ney, 2000b).",
        "These sentence pairs had at most 16 words in the French sentence; this restriction on the sentence length was necessary to control the memory requirements of the composition."
      ]
    },
    {
      "heading": "5.6.1 MBR Consensus Alignments",
      "text": [
        "In the previous sections we introduced a total of four loss functions: , ,and .",
        "Using either Equation 11 or 13, an MBR decoder can be constructed for each.",
        "These decoders are called MBR-AE, MBR-PTSD, MBR-POSD, and MBR-AWCD, respectively.",
        "The performance of the four decoders was measured with respect to the alignments provided by human experts (Och and Ney, 2000b).",
        "The first evaluation metric used was the Alignment Error Rate (Equation 1).",
        "We also evaluated each decoder under the Generalized Alignment Error Rates (GAER).",
        "These are defined as:",
        "There are six variants of GAER.",
        "These arise when is specified by , or .",
        "There are two versions of each of these: one version is sensitive only to sure (S) links.",
        "The other version considers all (A) links in the reference alignment.",
        "We therefore have the following six Generalized Alignment Error Rates: PTSD-S, POSD-S, AWCD-S, and PTSD-A, POSD-A, AWCD-A.",
        "We say we have a matched condition when the same loss function is used in both the error rate and the decoder design."
      ]
    },
    {
      "heading": "5.6.3 Decoder Performance",
      "text": [
        "The performance of the decoders under various loss functions is given in Table 1.",
        "We observe that in none of these experiments was the ML decoder found to be optimal.",
        "In all instances, the MBR decoder tuned for each loss function was the best performing decoder under the corresponding error rate.",
        "In particular, we note that alignment performance as measured under the AER metric can be improved by using MBR instead of ML alignment.",
        "This demonstrates the value of finding decoding procedures matched to the performance criterion of interest.",
        "We observe some affinity among the loss functions.",
        "In particular, the ML decoder performs better under the AER than any of the MBR-GAE decoders.",
        "This is because the loss, for which the ML decoder is optimal, is closer to the loss than any of the loss functions.",
        "The NULL symbol is treated quite differently under and , and this leads to a large mismatch between the MBR-GAE decoders and the AER metric.",
        "Similarly, the performance of the MBR-POS decoder degrades significantly under the AWCD-S and AWCD-A metrics.",
        "Since there are more word clusters (100) than POS tags (55), the MBR-POS decoder is therefore incapable of producing hypotheses that can match the word clusters used in the AWCD metrics."
      ]
    },
    {
      "heading": "6 Discussion And Conclusions",
      "text": [
        "We have presented a Minimum Bayes-Risk decoding strategy for obtaining word alignments of bilingual texts.",
        "MBR decoding is a general formulation that allows the construction of specialized decoders from general purpose models.",
        "The strategy aims at direct minimization of the expected risk of alignment errors under a given alignment loss function.",
        "We have introduced several alignment loss functions to measure the alignment quality.",
        "These incorporate information from varied analyses, such as parse trees, POS tags, and automatically derived word clusters.",
        "We have derived and implemented lattice based MBR consensus decoders under these loss functions.",
        "These decoders rescore the lattices produced by maximum likelihood decoding to produce the optimal MBR alignments.",
        "We have chosen to present MBR decoding using the IBM-3 statistical MT models implemented via WFSTs.",
        "However MBR decoding is not restricted to this framework.",
        "It can be applied more broadly using other MT model architectures that might be selected for reasons of modeling fidelity or computational efficiency.",
        "We have presented these alignment loss functions to explore how linguistic knowledge might be incorporated into machine translation systems without building detailed statistical models of these linguistic features.",
        "However we stress that the MBR decoding procedures described here do not preclude the construction of complex MT models that incorporate linguistic features.",
        "The application of such models, which could be trained using conventional maximum likelihood estimation techniques, should still benefit by the application of MBR decoding techniques.",
        "In future work we will investigate loss functions that incorporate French and English parse-tree information into the alignment decoding process.",
        "Our ultimate goal, towards which this work is the first step, is to construct loss functions that take advantage of linguistic structures such as syntactic dependencies found through monolingual analysis of the sentences to be aligned.",
        "Recent work (Hwa et al., 2002) suggests that translational corresponence of linguistic structures can indeed be useful in projecting parses across languages.",
        "Our ideal would be to construct MBR decoders based on loss functions that are sensitive both to word alignment as well as to agreement in higher level structures such as parse trees.",
        "In this way ambiguity present in word-to-word alignments will be resolved by the alignment of linguistic structures.",
        "MBR alignment is a promising modeling framework for the detailed linguistic annotation of bilingual texts.",
        "It is a simple model rescoring formalism that improves well trained statistical models by tuning them for particular performance criteria.",
        "Ideally, it will be used to produce decoders optimized for the loss functions that actually measure the qualities that we wish to see in newly developed automatic systems."
      ]
    },
    {
      "heading": "Acknowledgments",
      "text": [
        "We would like to thank F. J. Och of RWTH, Aachen for providing us the GIZA++ SMT toolkit, the mk-cls toolkit to train word classes, the Hansards 50K training and test data, and the reference word alignments and AER metric software.",
        "We would also like to thank P. Resnik, R. Hwa and O. Kolak of the Univ.",
        "of Maryland for useful discussions and help with the GIZA++ setup.",
        "We thank AT&T Labs - Research for use of the FSM Toolkit.",
        "This work was supported by an ONR MURI grant N00014-01-1-0685."
      ]
    }
  ]
}
