{
  "info": {
    "authors": [
      "Yoshimasa Tsuruoka",
      "Jun'ichi Tsujii"
    ],
    "book": "Conference on Computational Natural Language Learning CoNLL",
    "id": "acl-W03-0417",
    "title": "Training a Naive Bayes Classifier Via the EM Algorithm With a Class Distribution Constraint",
    "url": "https://aclweb.org/anthology/W03-0417",
    "year": 2003
  },
  "references": [
    "acl-A00-2009",
    "acl-J96-1002",
    "acl-P01-1005",
    "acl-P94-1013",
    "acl-P95-1026",
    "acl-W97-1011",
    "acl-W99-0613"
  ],
  "sections": [
    {
      "heading": "Abstract",
      "text": [
        "Combining a naive Bayes classifier with the EM algorithm is one of the promising approaches for making use of unlabeled data for disambiguation tasks when using local context features including word sense disambiguation and spelling correction.",
        "However, the use of unlabeled data via the basic EM algorithm often causes disastrous performance degradation instead of improving classification performance, resulting in poor classification performance on average.",
        "In this study, we introduce a class distribution constraint into the iteration process of the EM algorithm.",
        "This constraint keeps the class distribution of unlabeled data consistent with the class distribution estimated from labeled data, preventing the EM algorithm from converging into an undesirable state.",
        "Experimental results from using 26 confusion sets and a large amount of unlabeled data show that our proposed method for using unlabeled data considerably improves classification performance when the amount of labeled data is small."
      ]
    },
    {
      "heading": "1 Introduction",
      "text": [
        "Many of the tasks in natural language processing can be addressed as classification problems.",
        "State-of-the-art machine learning techniques including Support Vector Machines (Vapnik, 1995), AdaBoost (Schapire and Singer, 2000) and Maximum Entropy Models (Ratna-parkhi, 1998; Berger et al., 1996) provide high performance classifiers if one has abundant correctly labeled examples.",
        "However, annotating a large set of examples generally requires a huge amount of human labor and time.",
        "This annotation cost is one of the major obstacles to applying machine learning techniques to real-world NLP applications.",
        "Recently, learning algorithms called minimally supervised learning or unsupervised learning that can make use of unlabeled data have received much attention.",
        "Since collecting unlabeled data is generally much easier than annotating data, such techniques have potential for solving the problem of annotation cost.",
        "Those approaches include a naive Bayes classifier combined with the EM algorithm (Dempster et al., 1977; Nigam et al., 2000; Pedersen and Bruce, 1998), Co-training (Blum and Mitchell, 1998; Collins and Singer, 1999; Nigam and Ghani, 2000), and Transductive Support Vector Machines (Joachims, 1999).",
        "These algorithms have been applied to some tasks including text classification and word sense disambiguation and their effectiveness has been demonstrated to some extent.",
        "Combining a naive Bayes classifier with the EM algorithm is one of the promising minimally supervised approaches because its computational cost is low (linear to the size of unlabeled data), and it does not require the features to be split into two independent sets unlike co-training.",
        "However, the use of unlabeled data via the basic EM algorithm does not always improve classification performance.",
        "In fact, this often causes disastrous performance degradation resulting in poor classification performance on average.",
        "To alleviate this problem, we introduce a class distribution constraint into the iteration process of the EM algorithm.",
        "This constraint keeps the class distribution of unlabeled data consistent with the class distribution estimated from labeled data, preventing the EM algorithm from converging into an undesirable state.",
        "In order to assess the effectiveness of the proposed method, we applied it to the problem of semantic disambiguation using local context features.",
        "Experiments were conducted with 26 confusion sets and a large number of unlabeled examples collected from a corpus of one hundred million words.",
        "This paper is organized as follows.",
        "Section 2 briefly reviews the naive Bayes classifier and the EM algorithm as means of using unlabeled data.",
        "Section 3 presents the idea of using a class distribution constraint and how to impose this constraint on the learning process.",
        "Section 4 describes the problem of confusion set disambiguation and the features used in the experiments.",
        "Experimental results are presented in Section 5.",
        "Related work is discussed in Section 6.",
        "Section 7 offers some concluding remarks."
      ]
    },
    {
      "heading": "2 Naive Bayes Classifier",
      "text": [
        "The naive Bayes classifier is a simple but effective classifier which has been used in numerous applications of information processing such as image recognition, natural language processing, information retrieval, etc.",
        "(Escud-ero et al., 2000; Lewis, 1998; Nigam and Ghani, 2000; Pedersen, 2000).",
        "In this section, we briefly review the naive Bayes classifier and the EM algorithm that is used for making use of unlabeled data."
      ]
    },
    {
      "heading": "2.1 Naive Bayes Model",
      "text": [
        "Let x� be a vector we want to classify, and ck be a possible class.",
        "What we want to know is the probability that the vector x� belongs to the class ck.",
        "We first transform the probability P(ck I�x) using Bayes’ rule,",
        "Class probability P(ck) can be estimated from training data.",
        "However, direct estimation of P(ck I �x) is impossible in most cases because of the sparseness of training data.",
        "By assuming the conditional independence of the elements of a vector, P(�xI ck) is decomposed as follows,",
        "With this equation, we can calculate P(ck I �x) and classify x� into the class with the highest P(ck I �x).",
        "Note that the naive Bayes classifier assumes the conditional independence of features.",
        "This assumption however does not hold in most cases.",
        "For example, word occurrence is a commonly used feature for text classification.",
        "However, obvious strong dependencies exist among word occurrences.",
        "Despite this apparent violation of the assumption, the naive Bayes classifier exhibits good performance for various natural language processing tasks.",
        "There are some implementation variants of the naive Bayes classifier depending on their event models (Mc-Callum and Nigam, 1998).",
        "In this paper, we adopt the multivariate Bernoulli event model.",
        "Smoothing was done by replacing zero-probability with a very small constant (1.0 x 10-4)."
      ]
    },
    {
      "heading": "2.2 EM Algorithm",
      "text": [
        "The Expectation Maximization (EM) algorithm (Demp-ster et al., 1977) is a general framework for estimating the parameters of a probability model when the data has missing values.",
        "This algorithm can be applied to minimally supervised learning, in which the missing values correspond to missing labels of the examples.",
        "The EM algorithm consists of the E-step in which the expected values of the missing sufficient statistics given the observed data and the current parameter estimates are computed, and the M-step in which the expected values of the sufficient statistics computed in the E-step are used to compute complete data maximum likelihood estimates of the parameters (Dempster et al., 1977).",
        "In our implementation of the EM algorithm with the naive Bayes classifier, the learning process using unlabeled data proceeds as follows:",
        "1.",
        "Train the classifier using only labeled data.",
        "2.",
        "Classify unlabeled examples, assigning probabilistic labels to them.",
        "3.",
        "Update the parameters of the model.",
        "Each probabilistically labeled example is counted as its probability instead of one.",
        "4.",
        "Go back to (2) until convergence."
      ]
    },
    {
      "heading": "3 Class Distribution Constraint",
      "text": []
    },
    {
      "heading": "3.1 Motivation",
      "text": [
        "As described in the previous section, the naive Bayes classifier can be easily extended to exploit unlabeled data by using the EM algorithm.",
        "However, the use of unlabeled data for actual tasks exhibits mixed results.",
        "The performance is improved for some cases, but not in all cases.",
        "In our preliminary experiments, using unlabeled data by means of the EM algorithm often caused significant deterioration of classification performance.",
        "To investigate the cause of this, we observed the change of class distribution of unlabeled data occuring in the process of the EM algorithm.",
        "What we found is that sometimes the class distribution of unlabeled data greatly diverges from that of the labeled data.",
        "For example, when the proportion of class A examples in labeled data was",
        "about 0.9, the EM algorithm would sometimes converge into states where the proportion of class A is about 0.7.",
        "This divergence of class distribution clearly indicated the EM algorithm converged into an undesirable state.",
        "One of the possible remedies for this phenomenon is that of forcing class distribution of unlabeled data not to diverge from the class distribution estimated from labeled data.",
        "In this work, we introduce a class distribution constraint (CDC) into the training process of the EM algorithm.",
        "This constraint keeps the class distribution of unlabeled data consistent with that of labeled data."
      ]
    },
    {
      "heading": "3.2 Calibrating Probabilistic Labels",
      "text": [
        "We implement class distribution constraints by calibrating probabilistic labels assigned to unlabeled data in the process of the EM algorithm.",
        "In this work, we consider only binary classification: classes A and B.",
        "Let pi be the probabilistic label of the ith example representing the probability that this example belongs to class A.",
        "Let θ be the proportion of class A examples in the labeled data L. If the proportion of the class A examples (the proportion of the examples whose pi is greater than 0.5) in unlabeled data U is different from θ, we consider that the values of the probabilistic labels should be calibrated.",
        "The basic idea of the calibration is to shift all the probability values of unlabeled data to the extent that the class distribution of unlabeled data becomes identical to that of labeled data.",
        "In order for the shifting of the probability values not to cause the values to go outside of the range from 0 to 1, we transform the probability values by an inverse sigmoid function in advance.",
        "After the shifting, the values are returned to probability values by a sigmoid function.",
        "The whole calibration process is given below:",
        "1.",
        "Transform the probabilistic labels p,, ...p,,, by the inverse function of the sigmoid function, 2.",
        "Sort q,, ...q,,, in descending order.",
        "Then, pick up the value qborder that is located at the position of proportion θ in these n values.",
        "3.",
        "Since qborder is located at the border between the examples of label A and those of label B, the value should be close to zero (= probability is 0.5).",
        "Thus we calibrate all qi by subtracting qborder.",
        "4.",
        "Transform q,, ...q,,, by a sigmoid function back into probability values.",
        "This calibration process is conducted between the E-step and the M-step in the EM algorithm."
      ]
    },
    {
      "heading": "4 Confusion Set Disambiguation",
      "text": [
        "We applied the naive Bayes classifier with the EM algorithm to confusion set disambiguation.",
        "Confusion set disambiguation is defined as the problem of choosing the correct word from a set of words that are commonly confused.",
        "For example, quite may easily be mistyped as quiet.",
        "An automatic proofreading system would need to judge which is the correct use given the context surrounding the target.",
        "Example confusion sets include: {principle, principal}, {then, than}, and {weather, whether}.",
        "Until now, many methods have been proposed for this problem including winnow-based algorithms (Golding and Roth, 1999), differential grammars (Powers, 1998), transformation based learning (Mangu and Brill, 1997), decision lists (Yarowsky, 1994).",
        "Confusion set disambiguation has very similar characteristics to a word sense disambiguation problem in which the system has to identify the meaning of a pol-ysemous word given the surrounding context.",
        "The merit of using confusion set disambiguation as a test-bed for a learning algorithm is that since one does not need to annotate the examples to make labeled data, one can conduct experiments using an arbitrary amount of labeled data."
      ]
    },
    {
      "heading": "4.1 Features",
      "text": [
        "As the input of the classifier, the context of the target must be represented in the form of a vector.",
        "We use a binary feature vector which contains only the values of 0 or 1 for each element.",
        "In this work, we use the local context surrounding the target as the feature of an example.",
        "The features of a target are the two preceding words and the two following words.",
        "For example, if the disambiguation target is quiet and the system is given the following sentence “...between busy and quiet periods and it...” the contexts of this example are represented as follows: busy-2, and-,, periods+,, and+2 In the input vector, only the elements corresponding to these features are set to 1, while all the other elements are set to 0. into real value ranging from −∞ to ∞.",
        "Let the transformed values be q,, ...q,,,."
      ]
    },
    {
      "heading": "5 Experiment",
      "text": [
        "To conduct large scale experiments, we used the British National Corpus 1 that is currently one of the largest corpora available.",
        "The corpus contains roughly one hundred million words collected from various sources.",
        "The confusion sets used in our experiments are the same as in Golding’s experiment (1999).",
        "Since our algorithm requires the classification to be binary, we decomposed three-class confusion sets into pairwise binary classifications.",
        "Table 1 shows the resulting confusion sets used in the following experiments.",
        "The baseline performances, achieved by simply selecting the majority class, are shown in the second column.",
        "The number of unlabeled data are shown in the rightmost column.",
        "The 1,000 test sets were randomly selected from the corpus for each confusion set.",
        "They do not overlap the labeled data or the unlabeled data used in the learning process.",
        "The results are shown in Table 2 through Table 5.",
        "These four tables correspond to the cases in which the number of labeled examples is 32, 64, 128 and 256 as indicated by the table captions.",
        "The first column shows the confusion sets.",
        "The second column shows the classification performance of the naive Bayes classifier with which only labeled data was used for training.",
        "The third column shows the performance of the naive Bayes classifier with which unlabeled data was used via the basic EM algorithm.",
        "The rightmost column shows the performance of the EM algorithm that was extended with our proposed calibration process.",
        "Notice that the effect of unlabeled data were very different for each confusion set.",
        "As shown in Table 2, the precision was significantly improved for some confusion sets including {I, me}, {accept, except} and {affect, effect} .",
        "However, disastrous performance deterioration can be observed, especially that of the basic EM algorithm, in some confusion sets including {among, between}, {country, county}, and {site, cite}.",
        "On average, precision was degraded by the use of un",
        "raise, rise sight, site site, cite than, then their, there there, they’re they’re, their weather, whether your, you’re AVERAGE labeled data via the basic EM algorithm (from 83.3% to 82.9%).",
        "On the other hand, the EM algorithm with the class distribution constraint improved average classification performance (from 83.3% to 85.4%).",
        "This improved precision nearly reached the performance achieved by twice the size of labeled data without unlabeled data (see the average precision of NB in Table 3).",
        "This performance gain indicates that the use of unlabeled data effectively doubles the labeled training data.",
        "In Table 3, the tendency of performance improvement (or degradation) in the use of unlabeled data is almost the same as in Table 2.",
        "The basic EM algorithm degraded the performance on average, while our method improved average performance (from 85.7% to 87.7%).",
        "This performance gain effectively doubled the size of labeled data.",
        "The results with 128 labeled examples are shown in Table 4.",
        "Although the use of unlabeled examples by means of our proposed method still improved average performance (from 87.6% to 88.6%), the gain is smaller than that for a smaller amount of labeled data.",
        "With 256 labeled examples (Table 5), the average performance gain was negligible (from 89.2% to 89.3%).",
        "Figure 1 summarizes the average precisions for different number of labeled examples.",
        "Average peformance was improved by the use of unlabeled data with our proposed method when the amount of labeled data was small (from 32 to 256) as shown in Table 2 through Table 5.",
        "However, when the number of labeled examples was large (more than 512), the use of unlabeled data degraded average performance."
      ]
    },
    {
      "heading": "5.1 Effect of the amount of unlabeled data",
      "text": [
        "When the use of unlabeled data improves classification performance, the question of how much unlabeled data are needed becomes very important.",
        "Although unlabeled data are generally much more obtainable than labeled data, acquiring more than several-thousand unlabeled examples is not always an easy task.",
        "As for confusion set disambiguation, Table 1 indicates that it is sometimes impossible to collect tens of thousands examples even in a very large corpus.",
        "In order to investigate the effect of the amount of un",
        "more than billions of words) appears to be beneficial for infrequent words."
      ]
    },
    {
      "heading": "6 Related Work",
      "text": [
        "Nigam et al.",
        "(2000) reported that the accuracy of text classification can be improved by a large pool of unlabeled documents using a naive Bayes classifier and the EM algorithm.",
        "They presented two extensions to the basic EM algorithm.",
        "One is a weighting factor to modulate the contribution of the unlabeled data.",
        "The other is the use of multiple mixture components per class.",
        "With these extensions, they reported that the use of unlabeled data reduces classification error by up to 30%.",
        "Pedersen et al.",
        "(1998) employed the EM algorithm and Gibbs Sampling for word sense disambiguation by using a naive Bayes classifier.",
        "Although Gibbs Sampling results in a small improvement over the EM algorithm, the results for verbs and adjectives did not reach baseline per",
        "labeled data, we conducted experiments by varying the amount of unlabeled data for some confusion sets that exhibited significant performance gain by using unlabeled data.",
        "Figure 2 shows the relationship between the classification performance and the amount of unlabeled data for three confusion sets: {I, me}, {principal, principle}, and {passed, past}.",
        "The number of labeled examples in all cases was 64.",
        "Note that performance continued to improve even when the number of unlabeled data reached more than ten thousands.",
        "This suggests that we can further improve the performance for some confusion sets by using a very large corpus containing more than one hundred million words.",
        "Figure 2 also indicates that the use of unlabeled data was not effective when the amount of unlabeled data was smaller than one thousand.",
        "It is often the case with minor words that the number of occurrences does not reach one thousand even in a one-hundred-million word corpus.",
        "Thus, constructing a very very large corpus (containing NB NB+EM NB+EM+CDC formance on average.",
        "The amount of unlabeled data used in their experiments was relatively small (from several hundreds to a few thousands).",
        "Yarowsky (1995) presented an approach that significantly reduces the amount of labeled data needed for word sense disambiguation.",
        "Yarowsky achieved accuracies of more than 90% for two-sense polysemous words.",
        "This success was likely due to the use of “one sense per discourse” characteristic of polysemous words.",
        "Yarowsky’s approach can be viewed in the context of co-training (Blum and Mitchell, 1998) in which the features can be split into two independent sets.",
        "For word sense disambiguation, the sets correspond to the local contexts of the target word and the “one sense per discourse” characteristic.",
        "Confusion sets however do not have the latter characteristic.",
        "The effect of a huge amount of unlabeled data for confusion set disambiguation is discussed in (Banko and Brill, 2001).",
        "Bank and Brill conducted experiments of committee-based unsupervised learning for two confusion sets.",
        "Their results showed that they gained a slight improvement by using a certain amount of unlabeled data.",
        "However, test set accuracy began to decline as additional data were harvested.",
        "As for the performance of confusion set disambiguation, Golding (1999) achieved over 96% by a winnow-based approach.",
        "Although our results are not directly comparable with their results since the data sets are different, our results does not reach the state-of-the-art performance.",
        "Because the performance of a naive Bayes classifier is significantly affected by the smoothing method used for paramter estimation, there is a chance to improve our performance by using a more sophisticated smoothing technique."
      ]
    },
    {
      "heading": "7 Conclusion",
      "text": [
        "The naive Bayes classifier can be combined with the well-established EM algorithm to exploit the unlabeled data .",
        "However, the use of unlabeled data sometimes causes disastrous degradation of classification performance.",
        "In this paper, we introduce a class distribution constraint into the iteration process of the EM algorithm.",
        "This constraint keeps the class distribution of unlabeled data consistent with the true class distribution estimated from labeled data, preventing the EM algorithm from converging into an undesirable state.",
        "Experimental results using 26 confusion sets and a large amount of unlabeled data showed that combining the EM algorithm with our proposed constraint consistently reduced the average classification error rates when the amount of labeled data is small.",
        "The results also showed that use of unlabeled data is especially advantageous when the amount of labeled data is small (up to about one hundred)."
      ]
    },
    {
      "heading": "7.1 Future Work",
      "text": [
        "In this paper, we empirically demonstrated that a class distribution constraint reduced the chance of undesirable convergence of the EM algorithm.",
        "However, the theoretical justification of this constraint should be clarified in future work."
      ]
    }
  ]
}
