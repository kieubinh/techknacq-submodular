{
  "info": {
    "authors": [
      "Jun'ichi Kazama",
      "Jun'ichi Tsujii"
    ],
    "book": "Conference on Empirical Methods in Natural Language Processing",
    "id": "acl-W03-1018",
    "title": "Evaluation and Extension of Maximum Entropy Models With Inequality Constraints",
    "url": "https://aclweb.org/anthology/W03-1018",
    "year": 2003
  },
  "references": [
    "acl-J96-1002",
    "acl-W02-2018",
    "acl-W96-0213"
  ],
  "sections": [
    {
      "heading": "Abstract",
      "text": [
        "A maximum entropy (ME) model is usually estimated so that it conforms to equality constraints on feature expectations.",
        "However, the equality constraint is inappropriate for sparse and therefore unreliable features.",
        "This study explores an ME model with box-type inequality constraints, where the equality can be violated to reflect this unreliability.",
        "We evaluate the inequality ME model using text categorization datasets.",
        "We also propose an extension of the inequality ME model, which results in a natural integration with the Gaussian MAP estimation.",
        "Experimental results demonstrate the advantage of the inequality models and the proposed extension."
      ]
    },
    {
      "heading": "1 Introduction",
      "text": [
        "The maximum entropy model (Berger et al., 1996; Pietra et al., 1997) has attained great popularity in the NLP field due to its power, robustness, and successful performance in various NLP tasks (Ratnaparkhi, 1996; Nigam et al., 1999; Borthwick, 1999).",
        "In the ME estimation, an event is decomposed into features, which indicate the strength of certain aspects in the event, and the most uniform model among the models that satisfy:",
        "for each feature.",
        "E˜p[fZ] represents the expectation of feature fZ in the training data (empirical expectation), and Ep[fZ] is the expectation with respect to the model being estimated.",
        "A powerful and robust estimation is possible since the features can be as specific or general as required and does not need to be independent of each other, and since the most uniform model avoids overfitting the training data.",
        "In spite of these advantages, the ME model still suffers from a lack of data as long as it imposes the equality constraint (1), since the empirical expectation calculated from the training data of limited size is inevitably unreliable.",
        "A careful treatment is required especially in NLP applications since the features are usually very sparse.",
        "In this study, text categorization is used as an example of such tasks with sparse features.",
        "Previous work on NLP proposed several solutions for this unreliability such as the cut-off, which simply omits rare features, the MAP estimation with the Gaussian prior (Chen and Rosenfeld, 2000), the fuzzy maximum entropy model (Lau, 1994), and fat constraints (Khudanpur, 1995; Newman, 1977).",
        "Currently, the Gaussian MAP estimation (combined with the cut-off) seems to be the most promising method from the empirical results.",
        "It succeeded in language modeling (Chen and Rosenfeld, 2000) and text categorization (Nigam et al., 1999).",
        "As described later, it relaxes constraints like E˜p[ fZ] – Ep [ fZ] = Ai �2, where λZ is the model’s parameter.",
        "This study follows this line, but explores the following box-type inequality constraints:",
        "Here, the equality can be violated by the widths AZ and BZ.",
        "We refer to the ME model with the above inequality constraints as the inequality ME model.",
        "This inequality constraint falls into a type of fat constraints, ai ≤ Ep [ fi] ≤ bi, as suggested by (Khudanpur, 1995).",
        "However, as noted in (Chen and Rosenfeld, 2000), this type of constraint has not yet been applied nor evaluated for NLPs.",
        "The inequality ME model differs from the Gaussian MAP estimation in that its solution becomes sparse (i.e., many parameters become zero) as a result of optimization with inequality constraints.",
        "The features with a zero parameter can be removed from the model without changing its prediction behavior.",
        "Therefore, we can consider that the inequality ME model embeds feature selection in its estimation.",
        "Recently, the sparseness of the solution has been recognized as an important concept in constructing robust classifiers such as SVMs (Vapnik, 1995).",
        "We believe that the sparse solution improves the robustness of the ME model as well.",
        "We also extend the inequality ME model so that the constraint widths can move using slack variables.",
        "If we penalize the slack variables by their 2 norm, we obtain a natural integration of the inequality ME model and the Gaussian MAP estimation.",
        "While it incorporates the quadratic stabilization of the parameters as in the Gaussian MAP estimation, the sparseness of the solution is preserved.",
        "We evaluate the inequality ME models empirically, using two text categorization datasets.",
        "The results show that the inequality ME models outperform the cut-off and the Gaussian MAP estimation.",
        "Such high accuracies are achieved with a fairly small number of active features, indicating that the sparse solution can effectively enhance the performance.",
        "In addition, the 2-norm extended model is shown to be more robust in several situations."
      ]
    },
    {
      "heading": "2 The Maximum Entropy Model",
      "text": [
        "The ME estimation of a conditional model p(y|x) from the training examples {(xi, yi)} is formulated as the following optimization problem .1",
        "The empirical expectations and model expectations in the equality constraints are defined as follows./",
        "where c(·) indicates the number of times · occurred in the training data, and L is the number of training examples.",
        "By the Lagrange method, p(y |x) is found to have the following parametric form:",
        "where Z(x) = Ey exp(Ei λifi(x, y)).",
        "The dual objective function( becomes:",
        "This optimization can be solved using algorithms such as the GIS algorithm (Darroch and Rat-cliff, 1972) and the IIS algorithm (Pietra et al., 1997).",
        "In addition, gradient-based algorithms can be applied since the objective function is concave.",
        "Malouf (2002) compares several algorithms for the ME estimation including GIS, IIS, and the limited-memory variable metric (LMVM) method, which is a gradient-based method, and shows that the LMVM method requires much less time to converge for real NLP datasets.",
        "We also observed that the LMVM method converges very quickly for the text categorization datasets with an improvement in accuracy.",
        "Therefore, we use the LMVM method (and its variant for the inequality models) throughout the experiments.",
        "Thus, we only show the gradient when mentioning the training.",
        "The gradient of the objective function (8) is computed as:"
      ]
    },
    {
      "heading": "3 The Inequality ME Model",
      "text": [
        "The maximum entropy model with the box-type inequality constraints (2) can be formulated as the fol",
        "By using the Lagrange method for optimization problems with inequality constraints, the following parametric form is derived.",
        "where parameters αi and βi are the Lagrange multipliers corresponding to constraints (10) and (11).",
        "The Karush-Kuhn-Tucker conditions state that, at the optimal point,",
        "These conditions mean that the equality constraint is maximally violated when the parameter is non-zero, and if the violation is strictly within the widths, the parameter becomes zero.",
        "We call a feature upper active when αi > 0, and lower active when βi > 0.",
        "When αi – βi =� 0, we call that feature active.2 Inactive features can be removed from the model without changing its behavior.",
        "Since Ai > 0 and Bi > 0, any feature should not be upper active and lower active at the same time .3 The inequality constraints together with the constraints Ey p(ylx) – 1 = 0 define the feasible region in the original probability space, on which the entropy varies and can be maximized.",
        "The larger the widths, the more the feasible region is enlarged.",
        "Therefore, it can be implied that the possibility of a feature becoming inactive (the global maximal point is strictly within the feasible region with respect to that feature’s constraints) increases if the corresponding widths become large.",
        "The solution for the inequality ME model would become sparse if the optimization determines many features as inactive with given widths.",
        "The relation between the widths and the sparseness of the solution is shown in the experiment.",
        "The dual objective function becomes:",
        "Unlike the optimization in the standard maximum entropy estimation, we now have bound constraints on parameters which state that parameters must be non-negative.",
        "In addition, maximizing L(α, β) is no longer equivalent to maximizing the log-likelihood LL (α, β).",
        "Instead, we maximize:",
        "Although we can use many optimization algorithms to solve this dual problem since the objective function is still concave, a method that supports bounded parameters must be used.",
        "In this study, we use the BLMVM algorithm (Benson and Mor´e, ), a variant of the limited-memory variable metric (LMVM) algorithm, which supports bound constraints.",
        "The gradient of the objective function is:"
      ]
    },
    {
      "heading": "4 Soft Width Extension",
      "text": [
        "In this section, we present an extension of the inequality ME model, which we call soft width.",
        "The soft width allows the widths to move as Ai + δi and – Bi – γi using slack variables, but with some penalties in the objective function.",
        "This soft width extension is analogous to the soft margin extension of the SVMs, and in fact, the mathematical discussion is similar.",
        "If we penalize the slack variables 4 Although we consider only the gradient-based method here as noted earlier, an extension of GIS or IIS to support bounded parameters would also be possible.",
        "by their 2-norm, we obtain a natural combination of the inequality ME model and the Gaussian MAP estimation.",
        "We refer to this extension using 2-norm penalty as the 2-norm inequality ME model.",
        "As the Gaussian MAP estimation has been shown to be successful in several tasks, it should be interesting empirically, as well as theoretically, to incorporate the Gaussian MAP estimation into the inequality model.",
        "We first review the Gaussian MAP estimation in the following, and then we describe our extension."
      ]
    },
    {
      "heading": "4.1 The Gaussian MAP estimation",
      "text": [
        "In the Gaussian MAP ME estimation (Chen and Rosenfeld, 2000), the objective function is:",
        "which is derived as a consequence of maximizing the log-likelihood of the posterior probability, using a Gaussian distribution centered around zero with the variance σ2i as a prior on parameters.",
        "The gradient becomes:",
        "Therefore, the Gaussian MAP estimation can also be considered as relaxing the equality constraints.",
        "The significant difference between the inequality ME model and the Gaussian MAP estimation is that the parameters are stabilized quadratically in the Gaussian MAP estimation (16), while they are stabilized linearly in the inequality ME model (14)."
      ]
    },
    {
      "heading": "4.2 2-norm penalty extension",
      "text": [
        "Our 2-norm extension to the inequality ME model is as follows .5 where C1 and C2 is the penalty constants.",
        "The parametric form is identical to the inequality ME model (12).",
        "However, the dual objective function becomes: LL(α, β) – Ei (αiAi + αC2 ) – Ei ( + 4C2 ) Accordingly, the gradient becomes:",
        "It can be seen that this model is a natural combination of the inequality ME model and the Gaussian MAP estimation.",
        "It is important to note that the solution sparseness is preserved in the above model."
      ]
    },
    {
      "heading": "5 Calculation of the Constraint Width",
      "text": [
        "The widths, Ai and Bi, in the inequality constraints are desirably widened according to the unreliability of the feature (i.e., the unreliability of the calculated empirical expectation).",
        "In this paper, we examine two methods to determine the widths.",
        "The first is to use a common width for all features fixed by the following formula.",
        "where W is a constant, width factor, to control the widths.",
        "This method can only capture the global reliability of all the features.",
        "That is, only the reliability of the training examples as a whole can be captured.",
        "We call this method single.",
        "The second, which we call bayes, is a method that determines the widths based on the Bayesian framework to differentiate between the features depending on their reliabilities.",
        "For many NLP applications including text categorization, we use the following type of features.",
        "maximize H(p) – C1 Ei δi2 – C2 Ei γ2i, fj,i(x, y) = hi (x) if y = yj, 0 otherwise.",
        "(22) p,δ,γ",
        "Here, a source of unreliability is ˜p(y |hi (x) > 0).",
        "We consider ˜p(y |hi(x) > 0) as the parameter θ of the Bernoulli trials.",
        "That is, p(y |hi(x) > 0) = θ and p(¯y |hi (x) > 0) = 1 − θ.",
        "Then, we estimate the posterior distribution of θ from the training examples by Bayesian estimation and utilize the variance of the distribution.",
        "With the uniform distribution as the prior, k times out of n trials give the posterior distribution: p(θ) = Be(1+k, 1+n−k), where Be(α, β) is the beta distribution.",
        "The variance is calculated as follows.",
        "Letting k = c(fj,i(x, y) > 0) and n = c(hi(x) > 0), we obtain fine-grained variances narrowed according to c(hi(x) > 0) instead of a single value, which just captures the global reliability.",
        "Assuming the independence of training examples, the variance of the empirical expectation becomes: V [E˜p[fj,i]] = [Ex:hi(x)>0{˜p(x)hi (x)}2 I V [θj,i].",
        "Then, we calculate the widths as follows:"
      ]
    },
    {
      "heading": "6 Experiments",
      "text": [
        "For the evaluation, we use the “Reuters-21578, Distribution 1.0” dataset and the “OHSUMED” dataset.",
        "The Reuters dataset developed by David D. Lewis is a collection of labeled newswire articles.7 We adopted “ModApte” split to split the collection, and we obtained 7,048 documents for training, and 2,991 documents for testing.",
        "We used 112 “TOPICS” that actually occurred in the training set as the target categories.",
        "The OHSUMED dataset (Hersh et al., 1994) is a collection of clinical paper abstracts from the MED-LINE database.",
        "Each abstract is manually assigned MeSH terms.",
        "We simplified a MeSH term, like “A/B/C �→ A”, and used the most frequent 100 simplified terms as the target categories.",
        "We extracted 9, 947 abstracts for training, and 9, 948 abstracts for testing from the file “ohsumed.9 1.” A documents is converted to a bag-of-words vector representation with TFIDF values, after the stop",
        "words are removed and all the words are downcased.",
        "Since the text categorization task requires that multiple categories are assigned if appropriate, we constructed a binary categorizer, pc(y ∈ {+1, −1}|d), for each category c. If the probability pc(+1|d) is greater than 0.5, the category is assigned.",
        "To construct a conditional maximum entropy model, we used the feature function of the form (22), where hi (d) returns the TFIDF value of the i-th word of the document vector.",
        "We implemented the estimation algorithms as an extension of an ME estimation tool, Amis,8 using the Toolkit for Advanced Optimization (TAO) (Benson et al., 2002), which provides the LMVM and the BLMVM optimization modules.",
        "For the inequality ME estimation, we added a hook that checks the KKT conditions after the normal convergence test.9 We compared the following models:",
        "• ME models only with cut-off (cut-off), • ME models with cut-off and the Gaussian MAP estimation (gaussian), • Inequality ME models (ineq), • Inequality ME models with 2-norm extension described in Section 4 (2-norm),10",
        "For the inequality ME models, we compared the two methods to determine the widths, single and bayes, as described in Section 5.",
        "Although the Gaussian MAP estimation can use different σi for each feature, we used a common variance σ for gaussian.",
        "Thus, gaussian roughly corresponds to single in the way of dealing with the unreliability of features.",
        "Note that, for inequality models, we started with all possible features and rely on their ability to remove unnecessary features automatically by solution sparseness.",
        "The average maximum number of features in a categorizer is 63,150.0 for the Reuters dataset and 116, 452.0 for the OHSUMED dataset."
      ]
    },
    {
      "heading": "6.1 Results",
      "text": [
        "We first found the best values for the control parameters of each model, W, σ, and the cut-off threshold, by using the development set.",
        "We show that the inequality models outperform the other methods in the development set.",
        "We then show that these values are valid for the evaluation set.",
        "We used the first half of the test set as the development set, and the second half as the evaluation set.",
        "Figure 1 shows the accuracies of the inequality ME models for various width factors.",
        "The accuracies are presented by the “micro averaged” F-score.",
        "The horizontal lines show the highest accuracies of cut-off and gaussian models found by exhaustive search.",
        "For cut-off, we varied the cut-off threshold and found the best threshold.",
        "For gaussian, we varied σ with each cut-off threshold, and found the best σ and cut-off combination.",
        "We can see that the inequality models outperform the cut-off method and the Gaussian MAP estimation with an appropriate value for W in both datasets.",
        "Although the OHSUMED dataset seems harder than the Reuters dataset, the improvement in the OHSUMED dataset is greater than that in the Reuters dataset.",
        "This may be because the OHSUMED dataset is more sparse than the Reuters dataset.",
        "The 2-norm extension boosts the accuracies, especially for bayes, at the moderate Ws (i.e., with the moderate numbers of active features).",
        "However, we can not observe the apparent advantage of the 2-norm extension in terms of the highest accuracy here.",
        "Figure 2 shows the average number of active features of each inequality ME model for various width factors.",
        "We can see that active features increase",
        "when the widths become small as expected.",
        "Figure 3 shows the accuracy of each model as a function of the number of active features.",
        "We can see that the inequality ME models achieve the highest accuracy with a fairly small number of active features, removing unnecessary features on their own.",
        "Besides, they consistently achieve much higher accuracies than the cut-off and the Gaussian MAP estimation with a small number of features.",
        "Table 1 summarizes the above results including the best control parameters for the development set, and shows how well each method performs for the evaluation set with these parameters.",
        "We can see that the best parameters are valid for the evaluation sets, and the inequality ME models outperform the other methods in the evaluation set as well.",
        "This means that the inequality ME model is generally superior to the cut-off method and the Gaussian MAP estimation.",
        "At this point, the 2-norm extension shows the advantage of being robust, especially for the Reuters dataset.",
        "That is, the 2-norm models outperform the normal inequality models in the evaluation set.",
        "To see the reason for this, we show the average cross entropy of each inequality model as a function of the width factor in Figure 4.",
        "The average cross entropy was calculated as −c E, i EZ log p,(yZ|dZ), where C is the number of categories.",
        "The cross entropy of the 2-norm model is consistently more stable than that of the normal inequality model.",
        "Although there is no simple relation between the absolute accuracy and the cross entropy, this consistent difference can be one explanation for the advantage of the 2-norm extension.",
        "Besides, it is possible that the effect of 2-norm extension appears more clearly in the Reuters dataset because the robustness is more important in the Reuters dataset since the development set is rather small and easy to overfit.",
        "Lastly, we could not observe the advantage of bayes method in these experiments.",
        "However, since our method is still in development, it is premature to conclude that the idea of using different widths according to its unreliability is not successful.",
        "It is possible that the uncertainty of ˜p(x), which were not concerned about, is needed to be modeled, or the Bernoulli trial assumption is inappropriate.",
        "Further investigation on these points must be done."
      ]
    },
    {
      "heading": "7 Conclusion and Future Work",
      "text": [
        "We have shown that the inequality ME models outperform the cut-off method and the Gaussian MAP estimation, using the two text categorization datasets.",
        "Besides, the inequality ME models achieved high accuracies with a small number of features due to the sparseness of the solution.",
        "However, it is an open question how the inequality ME model differs from other sophisticated methods of feature selection based on other criteria.",
        "Future work will investigate the details of the inequality model including the effect of the penalty constants of the 2-norm extension.",
        "Evaluations on other NLP tasks are also planned.",
        "In addition, we need to analyze the inequality ME model further to",
        "clarify the reasons for its success.",
        "Acknowledgments We would like to thank Yusuke Miyao, Yoshimasa Tsuruoka, and the anonymous reviewers for many helpful comments."
      ]
    }
  ]
}
