{
  "info": {
    "authors": [
      "Manabu Sassano"
    ],
    "book": "Conference on Empirical Methods in Natural Language Processing",
    "id": "acl-W03-1027",
    "title": "Virtual Examples for Text Classification With Support Vector Machines",
    "url": "https://aclweb.org/anthology/W03-1027",
    "year": 2003
  },
  "references": [
    "acl-N01-1025",
    "acl-P02-1064",
    "acl-P95-1026",
    "acl-W02-2016"
  ],
  "sections": [
    {
      "heading": "Abstract",
      "text": [
        "We explore how virtual examples (artificially created examples) improve performance of text classification with Support Vector Machines (SVMs).",
        "We propose techniques to create virtual examples for text classification based on the assumption that the category of a document is unchanged even if a small number of words are added or deleted.",
        "We evaluate the proposed methods by Reuters-21758 test set collection.",
        "Experimental results show virtual examples improve the performance of text classification with SVMs, especially for small training sets."
      ]
    },
    {
      "heading": "1 Introduction",
      "text": [
        "Corpus-based supervised learning is now a standard approach to achieve high-performance in natural language processing.",
        "However, the weakness of supervised learning approach is to need an annotated corpus, the size of which is reasonably large.",
        "Even if we have a good supervised-learning method, we cannot get high-performance without an annotated corpus.",
        "The problem is that corpus annotation is labor intensive and very expensive.",
        "In order to overcome this, several methods are proposed, including minimally-supervised learning methods (e.g., (Yarowsky, 1995; Blum and Mitchell, 1998)), and active learning methods (e.g., (Thompson et al., 1999; Sassano, 2002)).",
        "The spirit behind these methods is to utilize precious labeled examples maximally.",
        "Another method following the same spirit is one using virtual examples (artificially created examples) generated from labeled examples.",
        "This method has been rarely discussed in natural language processing.",
        "In terms of active learning, Lewis and Gale (1994) mentioned the use of virtual examples in text classification.",
        "They did not, however, take forward this approach because it did not seem to be possible that a classifier created virtual examples of documents in natural language and then requested a human teacher to label them.",
        "In the field of pattern recognition, some kind of virtual examples has been studied.",
        "The first report of methods using virtual examples with Support Vector Machines (SVMs) is that of Sch¨olkopf et al.",
        "(1996), who demonstrated significant improvement of the accuracy in handwritten digit recognition (Section 3).",
        "They created virtual examples from labeled examples based on prior knowledge of the task: slightly translated (e.g., 1 pixel shifted to the right) images have the same label (class) of the original image.",
        "Niyogi et al.",
        "(1998) also discussed the use of prior knowledge by creating virtual examples and thereby expanding the effective training set size.",
        "The purpose of this study is to explore the effectiveness of virtual examples in NLP, motivated by the results of Sch¨olkopf et al.",
        "(1996).",
        "To our knowledge, use of virtual examples in corpus-based NLP has never been studied so far.",
        "It is, however, important to investigate this approach by which it is expected that we can alleviate the cost of corpus annotation.",
        "In particular, we focus on virtual examples with Support Vector Machines, introduced by Vap-nik (1995).",
        "The reason for this is that SVM is one of most successful machine learning methods in NLP.",
        "For example, NL tasks to which SVMs have been applied are text classification (Joachims, 1998; Du-mais et al., 1998), chunking (Kudo and Matsumoto, 2001), dependency analysis (Kudo and Matsumoto, 2002) and so forth.",
        "In this study, we choose text classification as a first case of the study of virtual examples in NLP because text classification in real world requires minimizing annotation cost, and it is not too complicated to perform some non-trivial experiments.",
        "Moreover, there are simple methods, which we propose, to generate virtual examples from labeled examples (Section 4).",
        "We show how virtual examples can improve the performance of a classifier with SVM in text classification, especially for small training sets."
      ]
    },
    {
      "heading": "2 Support Vector Machines",
      "text": [
        "In this section we give some theoretical definitions of SVMs.",
        "Assume that we are given the training data",
        "The decision function g in SVM framework is de subject to di : 0 < ai < C and �t aigi = 0. fined as: i=1",
        "where K is a kernel function, b C R is a threshold, and ai are weights.",
        "Besides, the weights ai satisfy the following constraints:",
        "where C is a misclassification cost.",
        "The vectors xi with non-zero ai are called Support Vectors.",
        "For linear SVMs, the kernel function K is defined as:",
        "where w = �ti=1 giaixi.",
        "To train an SVM is to find ai and b by solving the following optimization The solution gives an optimal hyperplane, which is a decision boundary between the two classes.",
        "Figure 1 illustrates an optimal hyperplane and its support vectors."
      ]
    },
    {
      "heading": "3 Virtual Examples and Virtual Support Vectors",
      "text": [
        "Virtual examples are generated from labeled examples.1 Based on prior knowledge of a target task, the label of a generated example is set to the same value as that of the original example.",
        "For example, in handwritten digit recognition, virtual examples can be created on the assumption that the label of an example is unchanged even if the example is shifted by one pixel in the four principal directions (Sch¨olkopf et al., 1996; DeCoste and Sch¨olkopf, 2002).",
        "Virtual examples that are generated from support vectors are called virtual support vectors (Sch¨olkopf",
        "et al., 1996).",
        "Reasonable virtual support vectors are expected to give a better optimal hyperplane.",
        "Assuming that virtual support vectors represent natural variations of examples of a target task, the decision boundary should be more accurate.",
        "Figure 2 illustrates the idea of virtual support vectors.",
        "Note that after virtual support vectors are given, the hyperplane is different from that in Figure 1."
      ]
    },
    {
      "heading": "4 Virtual Examples for Text Classification",
      "text": [
        "We assume on text classification the following: Assumption 1 The category of a document is unchanged even if a small number of words are added or deleted.",
        "This assumption is reasonable.",
        "In typical cases of text classification most of the documents usually contain two or more keywords which may indicate the categories of the documents.",
        "Following Assumption 1, we propose two methods to create virtual examples for text classification.",
        "One method is to delete some portion of a document.",
        "The label of a virtual example is given from the original document.",
        "The other method is to add a small number of words to a document.",
        "The words to be added are taken from documents, the label of which is the same as that of the document.",
        "Although one can invent various methods to create virtual examples based on Assumption 1, we propose here very simple ones.",
        "Feature Vector (x) Label (y)",
        "Before describing our methods, we describe text representation which we used in this study.",
        "We tokenize a document to words, downcase them and then remove stopwords, where the stopword list of freeWAIS-sf2is used.",
        "Stemming is not performed.",
        "We adopt binary feature vectors where word frequency is not used.",
        "Now we describe the two proposed methods: GenerateByDeletion and GenerateByAddition.",
        "Assume that we are given a feature vector (a document) x and x' is a generated vector from x. GenerateByDeletion algorithm is:",
        "1.",
        "Copy x to x'.",
        "2.",
        "For each binary feature f of x', if rand() < t then remove the feature f, where rand() is",
        "a function which generates a random number from 0 to 1, and t is a parameter to decide how many features are deleted.",
        "For example, suppose that we have a set of documents as in Table 1.",
        "Some possible virtual examples generated from Document 1 by GenerateByDeletion algorithm are (f2, f3, f4, f5, +1), (f1, f3, f4, +1), or (f1, f2, f4, f5, +1).",
        "On the other hand, GenerateByAddition algorithm is:",
        "1.",
        "Collect from a training set documents, the label of which is the same as that of x.",
        "2.",
        "Concatenate all the feature vectors (documents) to create an array a of features.",
        "Each element of a is a feature which represents a word.",
        "3.",
        "Copy x to x'.",
        "4.",
        "For each binary feature f of x', if rand() < t then select a feature randomly from a and put it to x1.",
        "For example, when we want to generate a virtual example from Document 2 in Table 1 by GenerateByAddition algorithm, first we create an array a = (f1, f2, f3, f4, f5, f2, f4, f5, f6, f2, f3, f5, f6, f7).",
        "In this case, some possible virtual examples by (GenerateByAddition are (/(f1, f2, f4, f5, f6, +1), (f2, f3, f4, f5, f6, +1), or (f2, f4, f5, f6, f7, +1).",
        "An example such as (f2, f4, f5, f6, f10, +1) is never generated from Document 2 because there are no positive documents which have f10."
      ]
    },
    {
      "heading": "5 Experimental Results and Discussion",
      "text": []
    },
    {
      "heading": "5.1 Test Set Collection",
      "text": [
        "We used the Reuters-21578 dataset3 to evaluate the proposed methods.",
        "The dataset has several splits of a training set and a test set.",
        "We used here “ModApte” split, which is most widely used in the literature on text classification.",
        "This split has 9,603 training examples and 3,299 test examples.",
        "More than 100 categories are in the dataset.",
        "We use, however, only the most frequent 10 categories.",
        "Table 2 shows the 10 categories and the number of training and test examples in each of the categories."
      ]
    },
    {
      "heading": "5.2 Performance Measures",
      "text": [
        "We use F-measure (van Rijsbergen, 1979; Lewis and Gale, 1994) as a primal performance measure",
        "to evaluate the result.",
        "F-measure is defined as:",
        "where p is precision and q is recall and 0 is a parameter which decides the relative weight of precision and recall.",
        "The p and the q are defined as: number of positive and correct outputs p= number of positive outputs number of positive and correct outputs q= number of positive examples In Equation 4, usually 0 = 1 is used, which means it gives equal weight to precision and recall.",
        "When we evaluate the performance of a classifier to a multiple category dataset, there are two ways to compute F-measure: macro-averaging and micro-averaging (Yang, 1999).",
        "The former way is to first compute F-measure for each category and then average them, while the latter way is to first compute precision and recall for all the categories and use them to calculate the F-measure."
      ]
    },
    {
      "heading": "5.3 SVM setting",
      "text": [
        "Through our experiments we used our original SVM tools, the algorithm of which is based on SMO (Sequential Minimal Optimization) by Platt (1999).",
        "We used linear SVMs and set a misclassification cost C to 0.016541 which is 1 � (the average of x • x) where x is a feature vector in the 9,603 size training set.",
        "For simplicity, we fixed C through all the experiments.",
        "We built a binary classifier for each of the 10 categories shown in Table 2."
      ]
    },
    {
      "heading": "5.4 Results",
      "text": [
        "First, we carried out experiments using GenerateByDeletion and GenerateByAddition separately to create virtual examples, where a virtual example was created per Support Vector.",
        "We did not generate virtual examples from non support vectors.",
        "We set the parameter t to 0.054 for GenerateByDeletion and GenerateByAddition for all the experiments.",
        "To build an SVM with virtual examples we use the following steps: 4We first tried t = 0.01, 0.05, and 0.10 with GenerateByDeletion using the 9603 size training set.",
        "The value t = 0.05 yielded best micro-average F-measure for the test set.",
        "We used the same value also for GenerateByAddition.",
        "1.",
        "Train an SVM.",
        "2.",
        "Extract Support Vectors.",
        "3.",
        "Generate virtual examples from the Support Vectors.",
        "4.",
        "Train another SVM using both the original labeled examples and the virtual examples.",
        "We evaluated the performance of the two methods depending on the size of a training set.",
        "We created subsamples by selecting randomly from the 9603 size training set.",
        "We prepared seven sizes: 9603, 4802, 2401, 1200, 600, 300, and 150.5 Micro-average F-measures of the two methods are shown in Table 3.",
        "We see from Table 3 that both the methods give better performance than that of the original SVM.",
        "The smaller the number of examples in the training set is, the larger the gain is.",
        "For the 9603 size training set, the gain of GenerateByDeletion is 0.75 (= 90.17 – 89.42), while for the 150 size set, the gain is 6.88 (= 60.16 – 53.28).",
        "These results suggest that in the smaller training sets there are not enough various examples to give a accurate decision boundary and therefore the effect of virtual examples is larger at the smaller training sets.",
        "It is reasonable to conclude that GenerateByDeletion and GenerateByAddition generated good virtual examples for the task and this led to the performance gain.",
        "After we found that the simple two methods to generate virtual support vectors were effective, we examined a combined method which is to use both GenerateByDeletion and GenerateByAddition.",
        "Two virtual examples are generated per Support Vector.",
        "The performance of the combined method is also shown in Table 3.",
        "The performance gain of the combined method is larger than that with either GenerateByDeletion or GenerateByAddition.",
        "Furthermore, we carried out another experiment with a combined method to create two virtual examples with GenerateByDeletion and GenerateByAddition respectively.",
        "That is, four virtual examples were generated from a Support Vector.",
        "The performance of that setting is shown in Table 3.",
        "The best",
        "result is achieved by the combined method to create four virtual examples per Support Vector.",
        "For the rest of this section, we limit our discussion to the comparison of the results of the original SVM and SVM with four virtual examples per SV (SVM with 4 VSVs).",
        "The learning curves of the original SVM and SVM with 4 VSVs are shown in Figures 3 and 4.",
        "It is clear that SVM with 4 VSVs outperforms the original SVM considerably in terms of both micro-average F-measure and macro-average F-measure.",
        "SVM with 4 VSVs achieves a given level of performance with roughly half of the labeled examples which the original SVM requires.",
        "One might suppose that the improvement of F-measure",
        "is realized simply because the recall gets highly improved while the error rate increases.",
        "We plot changes of the error rate for 32990 tests (3299 tests for each of the 10 categories) in Figure 5.",
        "SVM with 4 VSVs still outperforms the original SVM significantly.",
        "The performance changes for each of the 10 categories are shown in Tables 4 and 5.",
        "SVM with 4 VSVs is better than the original SVM for almost all the categories and all the sizes except for “interest” and “wheat” at the 9603 size training set.",
        "For low frequent categories such as “ship”, “wheat” and “corn”, the classifiers of the original SVM perform poorly.",
        "There are many cases where they never output ‘positive’, i.e. the recall is zero.",
        "It suggests that the original SVM fails to find a good hyperplane due to the imbalanced training sets which have very few",
        "positive examples.",
        "In contrast, SVM with 4 VSVs yields better results for such harder cases."
      ]
    },
    {
      "heading": "6 Conclusion and Future Directions",
      "text": [
        "We have explored how virtual examples improve the performance of text classification with SVMs.",
        "For text classification, we have proposed methods to create virtual examples on the assumption that the label of a document is unchanged even if a small number of words are added or deleted.",
        "The experimental results have shown that our proposed methods improve the performance of text classification with SVMs, especially for small training sets.",
        "Although the proposed methods are not readily applicable to NLP tasks other than text classification, it is notable that the use of virtual examples, which has been very little studied in NLP, is empirically evaluated.",
        "In the future, it would be interesting to employ virtual examples with methods to use both labeled and unlabeled examples (e.g., (Blum and Mitchell, 1998; Nigam et al., 1998; Joachims, 1999)).",
        "The combined approach may yield better results with a small number of labeled examples.",
        "Another interesting direction would be to develop methods to create virtual examples for the other tasks (e.g., named entity recognition, POS tagging, and parsing) in NLP.",
        "We believe we can use prior knowledge on these tasks to create effective virtual examples."
      ]
    }
  ]
}
