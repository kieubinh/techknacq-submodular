{
  "info": {
    "authors": [
      "Fuchun Peng",
      "Fangfang Feng",
      "Andrew McCallum"
    ],
    "book": "International Conference on Computational Linguistics",
    "id": "acl-C04-1081",
    "title": "Chinese Segmentation and New Word Detection Using Conditional Random Fields",
    "url": "https://aclweb.org/anthology/C04-1081",
    "year": 2004
  },
  "references": [
    "acl-J00-3004",
    "acl-N03-1028",
    "acl-N04-1042",
    "acl-N04-4028",
    "acl-P03-1035",
    "acl-W00-1207",
    "acl-W02-2018",
    "acl-W03-1709",
    "acl-W03-1719",
    "acl-W03-1727"
  ],
  "sections": [
    {
      "heading": "Abstract",
      "text": [
        "Chinese word segmentation is a difficult, important and widely-studied sequence modeling problem.",
        "This paper demonstrates the ability of linear-chain conditional random fields (CRFs) to perform robust and accurate Chinese word segmentation by providing a principled framework that easily supports the integration of domain knowledge in the form of multiple lexicons of characters and words.",
        "We also present a probabilistic new word detection method, which further improves performance.",
        "Our system is evaluated on four datasets used in a recent comprehensive Chinese word segmentation competition.",
        "State-of-the-art performance is obtained."
      ]
    },
    {
      "heading": "1 Introduction",
      "text": [
        "Unlike English and other western languages, many Asian languages such as Chinese, Japanese, and Thai, do not delimit words by white-space.",
        "Word segmentation is therefore a key precursor for language processing tasks in these languages.",
        "For Chinese, there has been significant research on finding word boundaries in unsegmented sequences (see (Sproat and Shih, 2002) for a review).",
        "Unfortunately, building a Chinese word segmentation system is complicated by the fact that there is no standard definition of word boundaries in Chinese.",
        "Approaches to Chinese segmentation fall roughly into two categories: heuristic dictionary-based methods and statistical machine learning methods.",
        "In dictionary-based methods, a predefined dictionary is used along with hand-generated rules for segmenting input sequence (Wu, 1999).",
        "However these approaches have been limited by the impossibility of creating a lexicon that includes all possible Chinese words and by the lack of robust statistical inference in the rules.",
        "Machine learning approaches are more desirable and have been successful in both unsupervised learning (Peng and Schuurmans, 2001) and supervised learning (Teahan et al., 2000).",
        "Many current approaches suffer from either lack of exact inference over sequences or difficulty in incorporating domain knowledge effectively into segmentation.",
        "Domain knowledge is either not used, used in a limited way, or used in a complicated way spread across different components.",
        "For example, the N-gram generative language modeling based approach of Teahan et al. (2000) does not use domain knowledge.",
        "Gao et al. (2003) uses class-based language for word segmentation where some word category information can be incorporated.",
        "Zhang et al. (2003) use a hierarchical hidden Markov Model to incorporate lexical knowledge.",
        "A recent advance in this area is Xue (2003), in which the author uses a sliding-window maximum entropy classifier to tag Chinese characters into one of four position tags, and then covert these tags into a segmentation using rules.",
        "Maximum entropy models give tremendous flexibility to incorporate arbitrary features.",
        "However, a traditional maximum entropy tagger, as used in Xue (2003), labels characters without considering dependencies among the predicted segmentation labels that is inherent in the state transitions of finite-state sequence models.",
        "Linear-chain conditional random fields (CRFs) (Lafferty et al., 2001) are models that address both issues above.",
        "Unlike heuristic methods, they are principled probabilistic finite state models on which exact inference over sequences can be efficiently performed.",
        "Unlike generative N-gram or hidden Markov models, they have the ability to straightforwardly combine rich domain knowledge, for example in this paper, in the form of multiple readily-available lexicons.",
        "Furthermore, they are discriminatively-trained, and are often more accurate than generative models, even with the same features.",
        "In their most general form, CRFs are arbitrary undirected graphical models trained to maximize the conditional probability of the desired outputs given the corresponding inputs.",
        "In the linear-chain special case we use here, they can be roughly understood as discriminatively-trained hidden Markov models with next-state transition functions represented by exponential models (as in maximum entropy classifiers), and with great flexibility to view the observation sequence in terms of arbitrary, overlapping features, with long-range dependencies, and at multiple levels of granularity.",
        "These beneficial properties suggests that CRFs are a promising approach for Chinese word segmentation.",
        "New word detection is one of the most important problems in Chinese information processing.",
        "Many machine learning approaches have been proposed (Chen and Bai, 1998; Wu and Jiang, 2000; Nie et al., 1995).",
        "New word detection is normally considered as a separate process from segmentation.",
        "However, integrating them would benefit both segmentation and new word detection.",
        "CRFs provide a convenient framework for doing this.",
        "They can produce not only a segmentation, but also confidence in local segmentation decisions, which can be used to find new, unfamiliar character sequences surrounded by high-confidence segmentations.",
        "Thus, our new word detection is not a standalone process, but an integral part of segmentation.",
        "Newly detected words are reincorporated into our word lexicon, and used to improve segmentation.",
        "Improved segmentation can then be further used to improve new word detection.",
        "Comparing Chinese word segmentation accuracy across systems can be difficult because many research papers use different data sets and different ground-rules.",
        "Some published results claim 98% or 99% segmentation precision and recall, but these either count only the words that occur in the lexicon, or use unrealistically simple data, lexicons that have extremely small (or artificially non-existant) out-of-vocabulary rates, short sentences or many numbers.",
        "A recent Chinese word segmentation competition (Sproat and Emerson, 2003) has made comparisons easier.",
        "The competition provided four datasets with significantly different segmentation guidelines, and consistent train-test splits.",
        "The performance of participating system varies significantly across different datasets.",
        "Our system achieves top performance in two of the runs, and a state-of-the-art performance on average.",
        "This indicates that CRFs are a viable model for robust Chinese word segmentation."
      ]
    },
    {
      "heading": "2 Conditional Random Fields",
      "text": [
        "Conditional random fields (CRFs) are undirected graphical models trained to maximize a conditional probability (Lafferty et al., 2001).",
        "A common special-case graph structure is a linear chain, which corresponds to a finite state machine, and is suitable for sequence labeling.",
        "A linear-chain CRF with parameters Λ = {λ1, ...} defines a conditional probability for a state (label) sequence y = y1 ... yT (for example, labels indicating where words start or have their interior) given an input sequence x = x1 ... xT (for example, the characters of a Chinese sentence) to be",
        "where Zx is the per-input normalization that makes the probability of all state sequences sum to one; fk(yt-1, yt, x, t) is a feature function which is often binary-valued, but can be real-valued, and λk is a learned weight associated with feature fk.",
        "The feature functions can measure any aspect of a state transition, yt-1 → yt, and the entire observation sequence, x, centered at the current time step, t. For example, one feature function might have value 1 when yt-1 is the state START, yt is the state NOT-START, and xt is a word appearing in a lexicon of people’s first names.",
        "Large positive values for λk indicate a preference for such an event; large negative values make the event unlikely.",
        "The most probable label sequence for an input x,",
        "can be efficiently determined using the Viterbi algorithm (Rabiner, 1990).",
        "An N-best list of labeling sequences can also be obtained using modified Viterbi algorithm and A* search (Schwartz and Chow, 1990).",
        "The parameters can be estimated by maximum likelihood – maximizing the conditional probability of a set of label sequences, each given their corresponding input sequences.",
        "The log-likelihood of training set {(xi, yi) : i = 1, ...M} is written",
        "Traditional maximum entropy learning algorithms, such as GIS and IIS (della Pietra et al., 1995), can be used to train CRFs.",
        "However, our implementation uses a quasi-Newton gradient-climber BFGS for optimization, which has been shown to converge much faster (Malouf, 2002; Sha and Pereira, 2003).",
        "The gradient of the likelihood is ∂PΛ(y|x)/∂λk =",
        "CRFs share many of the advantageous properties of standard maximum entropy classifiers, including their convex likelihood function, which guarantees that the learning procedure converges to the global maximum."
      ]
    },
    {
      "heading": "2.1 Regularization in CRFs",
      "text": [
        "To avoid over-fitting, log-likelihood is usually penalized by some prior distribution over the parameters.",
        "A commonly used prior is a zero-mean Gaussian.",
        "With a Gaussian prior, log-likelihood is penalized as follows.",
        "where σ2k is the variance for feature dimension k. The variance can be feature dependent.",
        "However for simplicity, constant variance is often used for all features.",
        "We experiment an alternate version of Gaussian prior in which the variance is feature dependent.",
        "We bin features by frequency in the training set, and let the features in the same bin share the same variance.",
        "The discounted value is set to be λk where c is the count of features M is",
        "the bin size set by held out validation, and ra] is the ceiling function.",
        "See Peng and McCallum (2004) for more details and further experiments."
      ]
    },
    {
      "heading": "2.2 State transition features",
      "text": [
        "Varying state-transition structures with different Markov order can be specified by different CRF feature functions, as determined by the number of output labels y examined together in a feature function.",
        "We define four different state transition feature functions corresponding to different Markov orders.",
        "Higher-order features capture more long-range dependencies, but also cause more data sparseness problems and require more memory for training.",
        "The best Markov order for a particular application can be selected by held-out cross-validation.",
        "1.",
        "First-order: Here the inputs are examined in the context of the current state only.",
        "The",
        "feature functions are represented as f (yt, x).",
        "There are no separate parameters for state transitions.",
        "2.",
        "First-order+transitions: Here we add parameters corresponding to state transitions.",
        "The feature functions used are f (yt, x), f (yt-1, yt).",
        "3.",
        "Second-order: Here inputs are examined in the context of the current and previous states.",
        "Feature function are represented as f (yt-1, yt, x).",
        "4.",
        "Third-order: Here inputs are examined in the context of the current, and two previous states.",
        "Feature function are represented as",
        "f (yt-2, yt-1, yt, x) ."
      ]
    },
    {
      "heading": "3 CRFs for Word Segmentation",
      "text": [
        "We cast the segmentation problem as one of sequence tagging: Chinese characters that begin a new word are given the START tag, and characters in the middle and at the end of words are given the NONSTART tag.",
        "The task of segmenting new, unsegmented test data becomes a matter of assigning a sequence of tags (labels) to the input sequence of Chinese characters.",
        "Conditional random fields are configured as a linear-chain (finite state machine) for this purpose, and tagging is performed using the Viterbi algorithm to efficiently find the most likely label sequence for a given character sequence."
      ]
    },
    {
      "heading": "3.1 Lexicon features as domain knowledge",
      "text": [
        "One advantage of CRFs (as well as traditional maximum entropy models) is its flexibility in using arbitrary features of the input.",
        "To explore this advantage, as well as the importance of domain knowledge, we use many open features from external resources.",
        "To specifically evaluate the importance of domain knowledge beyond the training data, we divide our features into two categories: closed features and open features, (i.e., features allowed in the competition’s “closed test” and “open test” respectively).",
        "The open features include a large word list (containing single and multiple-character words), a character list, and additional topic or part-of-speech character lexicons obtained from various sources.",
        "The closed features are obtained from training data alone, by intersecting the character list obtained from training data with corresponding open lexicons.",
        "Many lexicons of Chinese words and characters are available from the Internet and other sources.",
        "Besides the word list and character list, our lexicons include 24 lists of Chinese words and characters obtained from several Internet sites1 cleaned and augmented by a local native Chinese speaker independently of the competition data.",
        "The list of lexicons used in our experiments is shown in Figure 1."
      ]
    },
    {
      "heading": "3.2 Feature conjunctions",
      "text": [
        "Since CRFs are log-linear models, feature conjunctions are required to form complex, non-linear decision boundaries in the original feature space.",
        "We",
        "Constrained forward-backward algorithm calculates ZZ,,,, total likelihood of all paths passing through a constrained segment (in our case, a sequence of characters starting with a START tag followed by a few NONSTART tags before the next START tag).",
        "The confidence in this segment is then Z. , a real number between 0 and 1.",
        "In order to increase recall of new words, we consider not only the most likely (Viterbi) segmentation, but the segmentations in the top N most likely segmentations (an N-best list), and detect new words according to the above criteria in all N second previous character in lexicon segmentations.",
        "Many errors can be corrected by new word detection.",
        "For example, person name “R )8 4-r” happens four times.",
        "In the first pass of segmentation, two of them are segmented correctly and the other two are mistakenly segmented as “R )84-r” (they lexicon are segmented differently because Viterbi algorithm decodes based on context.).",
        "However, ”RE IP” is identified as a new word and added to the word list lexicon.",
        "In the second pass of segmentation, the other two mistakes are corrected.",
        "use feature conjunctions in both the open and closed tests, as listed Figure 2."
      ]
    },
    {
      "heading": "4 Probabilistic New Word Identification",
      "text": [
        "Since no vocabulary list could ever be complete, new word (unknown word) identification is an important issue in Chinese segmentation.",
        "Unknown words cause segmentation errors in that these out-of-vocabulary words in input text are often incorrectly segmented into single-character or other overly-short words (Chen and Bai, 1998).",
        "Traditionally, new word detection has been considered as a standalone process.",
        "We consider here new word detection as an integral part of segmentation, aiming to improve both segmentation and new word detection: detected new words are added to the word list lexicon in order to improve segmentation; improved segmentation can potentially further improve new word detection.",
        "We measure the performance of new word detection by its improvements on segmentation.",
        "Given a word segmentation proposed by the CRF, we can compute a confidence in each segment.",
        "We detect as new words those that are not in the existing word list, yet are either highly confident segments, or low confident segments that are surrounded by high confident words.",
        "A confidence threshold of 0.9 is determined by cross-validation.",
        "Segment confidence is estimated using constrained forward-backward (Culotta and McCallum, 2004).",
        "The standard forward-backward algorithm (Rabiner, 1990) calculates Z, the total likelihood of all label sequences y given a sequence x."
      ]
    },
    {
      "heading": "5 Experiments and Analysis",
      "text": [
        "To make a comprehensive evaluation, we use all four of the datasets from a recent Chinese word segmentation bake-off competition (Sproat and Emerson, 2003).",
        "These datasets represent four different segmentation standards.",
        "A summary of the datasets is shown in Table 1.",
        "The standard bake-off scoring program is used to calculate precision, recall, F1, and OOV word recall."
      ]
    },
    {
      "heading": "5.1 Experimental design",
      "text": [
        "Since CTB and PK are provided in the GB encoding while AS and HK use the Big5 encoding, we convert AS and HK datasets to GB in order to make cross-training-and-testing possible.",
        "Note that this conversion could potentially worsen performance slightly due to a few conversion errors.",
        "We use cross-validation to choose Markov-order and perform feature selection.",
        "Thus, each training set is randomly split – 80% used for training and the remaining 20% for validation – and based on validation set performance, choices are made for model structure, prior, and which word lexicons to include.",
        "The choices of prior and model structure shown in Table 2 are used for our final testing.",
        "We conduct closed and open tests on all four datasets.",
        "The closed tests use only material from the training data for the particular corpus being tested.",
        "Open tests allows using other material, such as lexicons from Internet.",
        "In open tests, we use lexicons obtained from various resources as described",
        "in Section 3.1.",
        "In addition, we conduct cross-dataset tests, in which we train on one dataset and test on other datasets."
      ]
    },
    {
      "heading": "5.2 Overall results",
      "text": [
        "Final results of CRF based segmentation with new word detection are summarized in Table 3.",
        "The upper part of the table contains the closed test results, and the lower part contains the open test results.",
        "Each entry is the performance of the given metric (precision, recall, F1, and Roov) on the test set.",
        "To compare our results against other systems, we summarize the competition results reported in (Sproat and Emerson, 2003) in Table 4.",
        "XXc and XXo indicate the closed and open runs on dataset XX respectively.",
        "Entries contain the F1 performance of each participating site on different runs, with the best performance in bold.",
        "Our results are in the last row.",
        "Column SITE-AVG is the average F 1 performance over the datasets on which a site reported results.",
        "Column OUR-AVG is the average F1 performance of our system over the same datasets.",
        "Comparing performance across systems is difficult since none of those systems reported results on all eight datasets (open and closed runs on 4 datasets).",
        "Nevertheless, several observations could be made from Table 4.",
        "First, no single system achieved best results in all tests.",
        "Only one site (S0 1) achieved two best runs (CTBc and PKc) with an average of 91.8% over 6 runs.",
        "S01 is one of the best segmentation systems in mainland China (Zhang et al., 2003).",
        "We also achieve two best runs (ASo and HKc), with a comparable average of 91.9% over the same 6 runs, and a 92.7% average over all the 8 runs.",
        "Second, performance varies significantly across different datasets, indicating that the four datasets have different characteristics and use very different segmentation guidelines.",
        "We also notice that the worst results were obtained on CTB dataset for all systems.",
        "This is due to significant inconsistent segmentation in training and testing (Sproat and Emerson, 2003).",
        "We verify this by another test.",
        "We randomly split the training data into 80% training and 20% testing, and run the experiments for 3 times, resulting in a testing F1 of 97.13%.",
        "Third, consider a comparison of our results with site S12, who use a sliding-window maximum entropy model (Xue, 2003).",
        "They participated in two datasets, with an average of 93.8%.",
        "Our average over the same two runs is 94.2%.",
        "This gives some empirical evidence of the advantages of linear-chain CRFs over sliding-window maximum entropy models, however, this comparison still requires further investigation since there are many factors that could affect the performance such as different features used in both systems.",
        "To further study the robustness of our approach to segmentation, we perform cross-testing – that is, training on one dataset and testing on other datasets.",
        "Table 5 summarizes these results, in which the rows are the training datasets and the columns are the testing datasets.",
        "Not surprisingly, cross testing results are worse than the results using the same",
        "competition; the second to the ninth columns contain their results on the 8 runs, where a bold entry is the winner of that run; column SITE-AVG contains the average performance of the site over the runs in which it participated, where a bold entry indicates that this site performs better than our system; column OUR-AVG is the average of our system over the same runs, where a bolded entry indicates our system performs better than the other site; the last row is the performance of our system over all the runs and the overall average.",
        "source as training due to different segmentation policies, with an exception on CTB where models trained on other datasets perform better than the model trained on CTB itself.",
        "This is due to the data problem mentioned above.",
        "Overall, CRFs perform robustly well across all datasets.",
        "From both Table 3 and 5, we see, as expected, improvement from closed tests to open tests, indicating the significant contribution of domain knowledge lexicons."
      ]
    },
    {
      "heading": "5.3 Effects of new word detection",
      "text": [
        "Table 6 shows the effect of new word detection on the closed tests.",
        "An interesting observation is",
        "the results without new word detection and NWD is the results with new word detection.",
        "that the improvement is monotonically related to the OOV rate (OOV rates are listed in Table 1).",
        "This is desirable because new word detection is most needed in situations that have high OOV rate.",
        "At low OOV rate, noisy new word detection can result in worse performance, as seen in the AS dataset."
      ]
    },
    {
      "heading": "5.4 Error analysis and discussion",
      "text": [
        "Several typical errors are observed in error analysis.",
        "One typical error is caused by inconsistent segmentation labeling in the test set.",
        "This is most notorious in CTB dataset.",
        "The second most typical error is in new, out-of-vocabulary words, especially proper names.",
        "Although our new word detection fixes many of these problems, it is not effective enough to recognize proper names well.",
        "One solution to this problem could use a named entity extractor to recognize proper names; this was found to be very helpful in Wu (2003).",
        "One of the most attractive advantages of CRFs (and maximum entropy models in general) is its the flexibility to easily incorporate arbitrary features, here in the form domain-knowledge-providing lexicons.",
        "However, obtaining these lexicons is not a trivial matter.",
        "The quality of lexicons can affect the performance of CRFs significantly.",
        "In addition, compared to simple models like n-gram language models (Teahan et al., 2000), another shortcoming of CRF-based segmenters is that it requires significantly longer training time.",
        "However, training is a one-time process, and testing time is still linear in the length of the input."
      ]
    },
    {
      "heading": "6 Conclusions",
      "text": [
        "The contribution of this paper is threefold.",
        "First, we apply CRFs to Chinese word segmentation and find that they achieve state-of-the art performance.",
        "Second, we propose a probabilistic new word detection method that is integrated in segmentation, and show it to improve segmentation performance.",
        "Third, as far as we are aware, this is the first work to comprehensively evaluate on the four benchmark datasets, making a solid baseline for future research on Chinese word segmentation."
      ]
    },
    {
      "heading": "Acknowledgments",
      "text": [
        "This work was supported in part by the Center for Intelligent Information Retrieval, in part by The Central Intelligence Agency, the National Security Agency and National Science Foundation under NSF grant #IIS0326249, and in part by SPAWARSYSCEN-SD grant number N66001-02-1-8903."
      ]
    }
  ]
}
