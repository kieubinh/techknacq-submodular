{
  "info": {
    "authors": [
      "Daichi Mochihashi",
      "Genichiro Kikui",
      "Kenji Kita"
    ],
    "book": "SIGDAT Conference on Empirical Methods in Natural Language Processing",
    "id": "acl-W04-3244",
    "title": "Learning Nonstructural Distance Metric by Minimum Cluster Distortions",
    "url": "https://aclweb.org/anthology/W04-3244",
    "year": 2004
  },
  "references": [
    "acl-A00-2004",
    "acl-P03-1005",
    "acl-P94-1002"
  ],
  "sections": [
    {
      "heading": "Abstract",
      "text": [
        "Much natural language processing still depends on the Euclidean (cosine) distance function between two feature vectors, but this has severe problems with regard to feature weightings and feature correlations.",
        "To answer these problems, we propose an optimal metric distance that can be used as an alternative to the cosine distance, thus accommodating the two problems at the same time.",
        "This metric is optimal in the sense of global quadratic minimization, and can be obtained from the clusters in the training data in a supervised fashion.",
        "We confirmed the effect of the proposed metric distance by a synonymous sentence retrieval task, document retrieval task and the K-means clustering of general vectorial data.",
        "The results showed constant improvement over the baseline method of Euclid and tf.idf, and were especially prominent for the sentence retrieval task, showing a 33% increase in the 11-point average precision."
      ]
    },
    {
      "heading": "1 Introduction",
      "text": [
        "Natural language processing involves many kinds of linguistic expressions, such as sentences, phrases, documents and the collection of documents.",
        "Comparing these expressions based on semantic proximity is a fundamental task and has many applications.",
        "Generally, two basic approaches exist to compare two expressions: (a) structural and (b) nonstructural.",
        "Structural approaches make use of syntactic parsing or dependency analysis to make a rigorous comparison; nonstructural approaches use vector representation and provide a rough but fast comparison that is required for search/retrieval from a vast amount of corpora.",
        "While structural approaches have recently become available in a kernel-based sophisticated treatment (Collins and Duffy, 2001; Suzuki et al., 2003), here we concentrate on nonstructural comparison.",
        "This is not only because nonstructural comparison constitutes an integral part in structural methods (that is, even in hierarchical methods the leaf comparison is still atomic),",
        "but because it is frequently embedded in many applications where structural parsings are not available or computationally too expensive.",
        "For example, information retrieval has long used the ‘bag of words’ approach (Baeza-Yates and Ribeiro-Neto, 1999; Sch¨utze, 1992) mainly due to a lack of scalable segmentation algorithms and the huge amount of data involved.",
        "While segmentation algorithms, such as TEXTTILING (Hearst, 1994) and its recent successors using the inter-paragraph similarity matrix (Choi, 2000), all themselves use nonstructural cosine similarity as a measure of semantic proximity between paragraphs.",
        "However, the distance function so far has been largely defined and used ad hoc, usually by a tf.idf weighting scheme (Salton and Yang, 1973) and a simple cosine similarity, equivalently, an Euclidean dot product.",
        "In this paper, we propose an optimal distance function that is parameterized by a global metric matrix.",
        "This metric is optimal in the sense of global quadratic minimization, and can be learned from the given clusters in the training data.",
        "These clusters are often attributable with many forms, such as paragraphs, documents or document collections, as long as the items in the training data are not completely independent.",
        "This paper is organized as follows.",
        "In section 2 we describe the issue of traditional Euclidean distances, and section 3 places it into general perspective with related works in machine learning.",
        "Section 4 introduces the proposed metric, and section 5 validates its effect on the task of sentence retrieval, document retrieval and the K-means clustering.",
        "Sections 6 and 7 present discussions and the conclusion."
      ]
    },
    {
      "heading": "2 Issues with Euclidean distances",
      "text": [
        "When we address nonstructural matching, linguistic expressions are often modeled by a feature vector x� E R', with its elements x1... x,, corresponding to the number of occurrences of i’th feature.",
        "If features are simply words, this is called a ‘bag of words’; but in general, features are not restricted to this kind, and we will use the general term “feature” in the rest of the paper.",
        "To measure the distance between two vectors 4u, 4J, a dot product or Euclidean distance",
        "(where T denotes a transposition) has been employed so far 1, with a heuristic feature weighting such as tf.idf in a preprocessing stage.",
        "However, there are two main problems with this distance:",
        "(1) The correlation between features is ignored.",
        "(2) Feature weighting is inevitably arbitrary.",
        "Problem (1) is especially important in languages, because linguistic features (e.g., words) generally have strong correlations between them, such as collocations or typical constructions.",
        "But this correlation cannot be considered in a simple dot product.",
        "While it is possible to address this with a specific kernel function, such as polynomials (M¨uller et al., 2001), this is not available for many problems, such as information retrieval or question answering, that do not fit classifications or cannot be easily “kernel-ized”.",
        "Problem (2) is a more subtle but inherent one: while tf.idf often works properly in practice, there are several options, especially in tf such as logs or square roots, but we have no principle with which to choose from.",
        "Further, it has no theoretical basis that gives any optimality as a distance function."
      ]
    },
    {
      "heading": "3 Related Works",
      "text": [
        "The issues above of feature correlations and feature weightings can be summarized as a problem of defining an appropriate metric in the feature space, based on the distribution of data.",
        "This problem has recently been highlighted in the field of machine learning research.",
        "(Xing et al., 2002) has an objective that is quite similar to that of this paper, and gives a metric matrix that resembles ours based on sample pairs of “similar points” as training data.",
        "(Bach and Jordan, 2004) and (Schultz and Joachims, 2004) seek to answer the same problem with an additional scenario of spectral clustering and relative comparisons in Support Vector Machines, respectively.",
        "In this aspect, our work is a straight successor of (Xing et al., 2002) where its general usage in vector space is preserved.",
        "We offer a discussion on the similarity to our method and our advantages 'When we normalize the length of the vectors I �iI = I VI = 1 as commonly adopted, (�i – ��)T (�i – v) = I�iI2 + IVI2 – 2�i • V a – �i • v = – cos (�i, v) ; therefore, this includes a cosine similarity (Manning and Sch ¨utze, 1999).",
        "in section 6.",
        "Finally, we note that the Fisher kernel of (Jaakkola and Haussler, 1999) has the same concept that gives an appropriate similarity of two data through the Fisher information matrix obtained from the empirical distribution of data.",
        "However, it is often approximated by a unit matrix because of its heavy computational demand.",
        "In the field of information retrieval, (Jiang and Berry, 1998) proposes a Riemannian SVD (R-SVD) from the viewpoint of relevance feedback.",
        "This work is close in spirit to our work, but is not aimed at defining a permanent distance function and does not utilize cluster structures existent in the training data."
      ]
    },
    {
      "heading": "4 Defining an Optimal Metric",
      "text": [
        "To solve the problems in section 2, we note the function that synonymous clusters play.",
        "There are many levels of (more or less) synonymous clusters in linguistic data: phrases, sentences, paragraphs, documents, and, in a web environment, the site that contains the document.",
        "These kinds of clusters can often be attributed to linguistic expressions because they nest in general so that each expression has a parent cluster.",
        "Since these clusters are synonymous, we can expect the vectors in each cluster to concentrate in the ideal feature space.",
        "Based on this property, we can introduce an optimal weighting and correlation in a supervised fashion.",
        "We will describe this method below."
      ]
    },
    {
      "heading": "4.1 The Basic Idea",
      "text": [
        "As stated above, vectors in the same cluster must have a small distance between each other in the ideal geometry.",
        "When we measure an L2-distance between u4 and J4 by a Mahalanobis distance parameterized by M:",
        "where symmetric metric matrix M gives both corresponding feature weights and feature correlations.",
        "When we take M = I (unit matrix), we recover the original Euclidean distance (1).",
        "Equation (2) can be rewritten as (3) because M is symmetric:",
        "Therefore, this distance amounts to a Euclidean distance in M1/2-mapped space (Xing et al., 2002).",
        "Note that this distance is global, and different from the ordinary Mahalanobis distance in pattern recognition (for example, (Duda et al., 2000)) that is defined for each cluster one by one, using a cluster-specific covariance matrix.",
        "That type of distance cannot be generalized to new kinds of data; therefore, it has been used for local classifications.",
        "What we want is a global distance metric that is generally useful, not a measure for classification to predefined clusters.",
        "In this respect, (Xing et al., 2002) shares the same objective as ours.",
        "Therefore, we require an optimization over all the clusters in the training data.",
        "Generally, data in the clusters are distributed as in figure 1(a), comprising ellipsoidal forms that have high (co)variances for some dimensions and low (co)variances for other dimensions.",
        "Further, the cluster is not usually aligned to the axes of coordinates.",
        "When we find a global metric matrix M that minimizes the cluster distortions, namely, one that reduces high variances and expands low variances for the data to make a spherical form as good as possible in the M1/2-mapped space (figure 1(b)), we can expect it to capture necessary and unnecessary variations and correlations on the features, combining information from many clusters to produce a more reliable metric that is not locally optimal.",
        "We will find this optimal M below."
      ]
    },
    {
      "heading": "4.2 Global optimization over clusters",
      "text": [
        "Suppose that each data (for example, sentences or documents) is a vector s� E ][8n, and the whole corpus can be divided into N clusters, X1 ... XN.",
        "That is, each vector has a dimension n, and the number of clusters is N. For each cluster Xi, cluster centroid ci is calculated as �ci = 1/IXiI ��sEXi s�, where I X I denotes the number of data in X.",
        "When necessary, each element in �sj or �ci is referenced as sjk or cik (k = 1... n).",
        "The basic idea above is formulated as follows.",
        "We seek the metric matrix M that minimizes the distance between each data �sj and the cluster centroid �ci, dM(�sj, �ci) for all clusters X1 ... XN.",
        "Mathematically, this is formulated as a quadratic minimization problem",
        "Scale constraint (5) is necessary for excluding a degenerate solution M = O.",
        "1 is an arbitrary constant: when we replace 1 by c, c 2 M becomes a new solution.",
        "This minimization problem is an extension to the method of MindReader (Ishikawa et al., 1998) to multiple clusters, and has a unique solution below.",
        "where A = [akl] is defined by",
        "When A is singular, we can use as A – 1 a Moore-Penrose matrix pseudoinverse A+.",
        "Generally, A consists of linguistic features and is very sparse, and often singular.",
        "Therefore, A+ is nearly always necessary for the above computation.",
        "For details, see Appendix B."
      ]
    },
    {
      "heading": "4.3 Generalization",
      "text": [
        "While we assumed through the above construction that each cluster is equally important, this is not the case in general.",
        "For example, clusters with a small number of data may be considered weak, and in the hierarchical clustering situation, a “grandmother” cluster may be weaker.",
        "If we have confidences t 1... t N for the strength of clustering for each cluster X1 ... XN, this information can be incorporated into (4) by a set of normalized cluster weights t *i :",
        "where t *i = t i/ EN j=1 t j , and we obtain a respectively weighted solution in (7).",
        "Further, we note that when N = 1, this metric recovers the ordinary Mahalanobis distance in pattern recognition.",
        "However, we used equal weights for the experiments below because the number of data in each cluster was approximately equal."
      ]
    },
    {
      "heading": "5 Experiments",
      "text": [
        "We evaluated our metric distance on the three tasks of synonymous sentence retrieval, document retrieval, and the K-means clustering of general vectorial data.",
        "After calculating M on the training data of clusters, we applied it to the test data to see how well its clusters could be recovered.",
        "As a measure of cluster recovery, we use 11-point average precision and R-precision for the distribution of items of the same cluster in each retrieval result.",
        "Here, R equals the cardinality of the cluster; therefore, R-precision shows the precision of cluster recovery."
      ]
    },
    {
      "heading": "5.1 Synonymous sentence retrieval 5.1.1 Sentence cluster corpus",
      "text": [
        "We used a paraphrasing corpus of travel conversations (Sugaya et al., 2002) for sentence retrieval.",
        "This corpus consists of 33,723,164 Japanese translations, each of which corresponds to one of the original English sentences.",
        "By way of this correspondence, Japanese sentences are divided into 10,610 clusters.",
        "Therefore, each cluster consists of Japanese sentences that are possible translations from the same English seed sentence that the cluster has.",
        "From this corpus, we constructed 10 sets of data.",
        "Each set contains random selection of 200 training clusters and 50 test clusters, and each cluster contains a maximum of 100 sentences 2.",
        "Experiments were conducted on these 10 datasets for each level of dimensionality reduction (see below) to produce average statistics.",
        "As a feature of a sentence, we adopted unigrams of all words and bigrams of functional words from the part-of-speech tags, because the sequence of functional words is important in the conversational corpus.",
        "While the lexicon is limited for travel conversations, the number of features exceeds several thousand or more.",
        "This may be prohibitive for the calculation of the metric matrix, therefore, we additionally compressed the features with SVD, the same method used in Latent Semantic Indexing (Deer-wester et al., 1990)."
      ]
    },
    {
      "heading": "5.1.3 Sentence retrieval results",
      "text": [
        "Qualitative result Figure 5 (last page) shows a sample retrieval result.",
        "A sentence with (*) mark at the end is the correct answer, that is, a sentence from the same original cluster as the query.",
        "We can see that the results with the metric distance contain",
        "less noise than a standard Euclid baseline with tf.idf weighting, achieving a high-precision retrieval.",
        "Although the high rate of dimensionality reduction in figure 6 shows degradation due to the dimension contamination, the effect of metric distance is still apparent despite bad conditions.",
        "Quantitative result Figure 2 shows the averaged precision-recall curves of retrieval and figure 3 shows 11-point average precisions, for each rate of dimensionality reduction.",
        "Clearly, our method achieves higher precision than the standard method, and does not degrade much with feature compressions unless we reduce the dimension too much, i.e., to < 5%."
      ]
    },
    {
      "heading": "5.2 Document retrieval",
      "text": [
        "As a method of tackling clusters of texts, the text classification task has recently made great advances with a Naive Bayes or SVM classifiers (for example, (Joachims, 1998)).",
        "However, they all aim at classifying texts into a few predefined clusters, and cannot deal with a document that fits neither of the clusters.",
        "For example, when we regard a website as a cluster of documents, the possible clusters are numerous and constantly increasing, which precludes classificatory approaches.",
        "For these circumstances, document clustering or retrieval will benefit from a global distance metric that exploits the multitude of cluster structures themselves.",
        "For this purpose, we used the 20-Newsgroup dataset (Lang, 1995).",
        "This is a standard text classification dataset that has a relatively large number of classes,",
        "20.",
        "Among the 20 newsgroups, we selected 16 clusters of training data and 4 clusters of test data, and performed 5-fold cross validation.",
        "The maximum number of documents per cluster is 100, and when it exceeds this limit, we made a random sampling of 100 documents as the sentence retrieval experiment.",
        "Because our proposed metric is calculated from the distribution of vectors in high-dimensional feature space, it becomes inappropriate if the norm of the vectors (largely proportional to document length) differs much from document to document.",
        "3 Therefore, we used subsampling/oversampling to form a median length (130 words) on training documents.",
        "Further, we preprocessed them with tf.idf as a baseline method."
      ]
    },
    {
      "heading": "5.2.2 Results",
      "text": [
        "Table 1 shows R-precision and 11-point average precision.",
        "Since the test data contains 4 clusters, the baselines of precision are 0.25.",
        "We can see from both results that metric distance produces a better retrieval over the tf.idf and dot product.",
        "However, refinements in precision are certain (average p = 0.0243) but subtle.",
        "This can be thought of as the effect of the dimensionality reduction performed.",
        "We first decompose data matrix X by SVD: X = USV-1 and build a k-dimensional compressed representation Xk = VkX; where Vk denotes a k-largest submatrix of V. From the equation (3), this means a Euclidean distance of M1/2Xk = M1/2VkX.",
        "Therefore, Vk may subsume the effect of M in a preprocessing stage.",
        "Close inspection of table 1 shows this effect as a tradeoff between M and Vk.",
        "To make the most of metric distance, we should consider metric induction and dimensionality reduction simultaneously, or reconsider the problem in kernel Hilbert space."
      ]
    },
    {
      "heading": "5.3 K-means clustering and general vectorial data",
      "text": [
        "Metric distance can also be used for clustering or general vectorial data.",
        "Figure 4 shows the K-means clustering result of applying our metric distance to some of the UCI Machine Learning datasets (Blake and Merz, 1998).",
        "K-means clustering was conducted 100 times with a random start, where K equals the known number of classes in the data 4.",
        "Clustering precision was measured as an average probability that a randomly picked pair of data will conform to the true clustering (Xing et al., 2002).",
        "We also conducted the same clustering for documents of the 20-Newsgroup dataset to get a small increase in precision like the document retrieval experiment in section 5.2.",
        "Figure 4: K-means clustering of UCI Machine Learning dataset results.",
        "The horizontal axis shows compressed dimensions (rightmost is original).",
        "The right bar shows clustering precision using Metric distance, and the left bar shows that using Euclidean distance."
      ]
    },
    {
      "heading": "6 Discussion",
      "text": [
        "In this paper, we proposed an optimal distance metric based on the idea of minimum cluster distortion in training data.",
        "Although vector distances have frequently been used in natural language processing, this is a rather neglected but recently highlighted problem.",
        "Unlike recently proposed methods with spectral methods or SVMs, our method assumes no such additional scenarios and can be considered as",
        "a straight successor to (Xing et al., 2002)’s work.",
        "Their work has the same perspective as ours, and they calculate a metric matrix A that is similar to ours based on a set 5 of vector pairs (�xi, �xj) that can be regarded as similar.",
        "They report that the effectiveness of A increases as the number of the training pairs 5 increases; this requires O(n 2) sample points from n training data, and must be optimized by a computationally expensive Newton-Raphson iteration.",
        "On the other hand, our method uses only linear algebra, and can induce an ideal metric using all the training data at the same time.",
        "We believe this metric can be useful for many vector-based language processing methods that have used cosine similarity.",
        "There remains some future directions for research.",
        "First, as we stated in section 4.3, the effect of a cluster weighted generalized metric must be investigated and optimal weighting must be induced.",
        "Second, as noted in section 5.2.1, the dimensionality reduction required for linguistic data may constrain the performance of the metric distance.",
        "To alleviate this problem, simultaneous dimensionality reduction and metric induction may be necessary, or the same idea in a kernel-based approach is worth considering.",
        "The latter obviates the problem of dimensionality, while it restricts the usage to a situation where the kernel-based approach is available."
      ]
    },
    {
      "heading": "7 Conclusion",
      "text": [
        "We proposed a global metric distance that is useful for clustering or retrieval where Euclidean distance has been used.",
        "This distance is optimal in the sense of quadratic minimization over all the clusters in the training data.",
        "Experiments on sentence retrieval, document retrieval and K-means clustering all showed improvements over Euclidean distance, with a significant refinement with tight training clusters in sentence retrieval."
      ]
    },
    {
      "heading": "Acknowledgement",
      "text": [
        "The research reported here was supported in part by a contract with the National Institute of Information and Communications Technology entitled ”A study of speech dialogue translation technology based on a large corpus”."
      ]
    },
    {
      "heading": "References",
      "text": []
    },
    {
      "heading": "Appendix A.",
      "text": []
    },
    {
      "heading": "Derivation of the metric matrix",
      "text": [
        "Here we prove theorem 1, namely deriving M that satisfies the condition",
        "where Mkl denotes an adjugate matrix of mkl .",
        "Therefore, we come to minimize (10) under the constraint (11).",
        "By introducing the Lagrange multiplier a, we define Differentiating by mkl and setting to zero, we obtain",
        "Let us define M-1 = [m-1",
        "and from (9), for all k",
        "...I AI = �nIM-1I I = an ...a= IAI1/n where A is defined by (14), (15)."
      ]
    },
    {
      "heading": "Appendix B.",
      "text": []
    },
    {
      "heading": "Moore-Penrose Matrix Pseudoinverse",
      "text": [
        "The Moore-Penrose matrix pseudoinverse A+ of A is a unique matrix that has a property of normal inverse in that x = A+y is a shortest length least squares solution to Ax = y even if A is singular (Weisstein, 2004).",
        "A+ can be calculated simply by a MATLAB function piny.",
        "Or alternatively (Ishikawa et al., 1998), we can decompose A as A= UEUT , where U is an orthonormal n x n matrix and E="
      ]
    }
  ]
}
