{
  "info": {
    "authors": [
      "Lin-Yi Chou"
    ],
    "book": "International Conference on Computational Linguistics and Annual Meeting of the Association for Computational Linguistics – Poster Sessions",
    "id": "acl-P06-2016",
    "title": "Techniques to Incorporate the Benefits of a Hierarchy in a Modified Hidden Markov Model",
    "url": "https://aclweb.org/anthology/P06-2016",
    "year": 2006
  },
  "references": [
    "acl-J93-1003",
    "acl-J95-4004",
    "acl-P98-1115"
  ],
  "sections": [
    {
      "heading": "Abstract",
      "text": [
        "This paper explores techniques to take advantage of the fundamental difference in structure between hidden Markov models (HMM) and hierarchical hidden Markov models (HHMM).",
        "The HHMM structure allows repeated parts of the model to be merged together.",
        "A merged model takes advantage of the recurring patterns within the hierarchy, and the clusters that exist in some sequences of observations, in order to increase the extraction accuracy.",
        "This paper also presents a new technique for reconstructing grammar rules automatically.",
        "This work builds on the idea of combining a phrase extraction method with HHMM to expose patterns within English text.",
        "The reconstruction is then used to simplify the complex structure of an HHMM The models discussed here are evaluated by applying them to natural language tasks based on CoNLL-20041 and a sub-corpus of the Lancaster Treebank2."
      ]
    },
    {
      "heading": "1 Introduction",
      "text": [
        "Hidden Markov models (HMMs) were introduced in the late 1960s, and are widely used as a probabilistic tool for modeling sequences of observations (Rabiner and Juang, 1986).",
        "They have proven to be capable of assigning semantic labels to tokens over a wide variety of input types.",
        "This is useful for text-related tasks that involve some uncertainty, including part-of-speech tagging (Brill, 1995), text segmentation (Borkar et al., 2001), named entity recognition (Bikel et al., 1999) and information extraction tasks (McCal-lum et al., 1999).",
        "However, most natural language processing tasks are dependent on discovering a hierarchical structure hidden within the source information.",
        "An example would be predicting semantic roles from English sentences.",
        "HMMs are less capable of reliably modeling these tasks.",
        "In contrast hierarchical hidden Markov models (HH-MMs) are better at capturing the underlying hierarchy structure.",
        "While there are several difficulties inherent in extracting information from the patterns hidden within natural language information, by discovering the hierarchical structure more accurate models can be built.",
        "HHMMs were first proposed by Fine (1998) to resolve the complex multi-scale structures that pervade natural language, such as speech (Rabiner and Juang, 1986), handwriting (Nag et al., 1986), and text.",
        "Skounakis (2003) described the HHMM as multiple “levels” of HMM states, where lower levels represents each individual output symbol, and upper levels represents the combinations of lower level sequences.",
        "Any HHMM can be converted to a HMM by creating a state for every possible observation, a process called “flattening”.",
        "Flattening is performed to simplify the model to a linear sequence of Markov states, thus decreasing processing time.",
        "But as a result of this process the model no longer contains any hierarchical structure.",
        "To reduce the models complexity while maintaining some hierarchical structure, our algorithm uses a “partial flattening” process.",
        "In recent years, artificial intelligence re",
        "searchers have made strenuous efforts to reproduce the human interpretation of language, whereby patterns in grammar can be recognised and simplified automatically.",
        "Brill (1995) describes a simple rule-based approach for learning by rewriting the bracketing rule – a method for presenting the structure of natural language text – for linguistic knowledge.",
        "Similarly, Krotov (1999) puts forward a method for eliminating redundant grammar rules by applying a compaction algorithm.",
        "This work draws upon the lessons learned from these sources by automatically detecting situations in which the grammar structure can be reconstructed.",
        "This is done by applying the phrase extraction method introduced by Pantel (2001) to rewrite the bracketing rule by calculating the dependency of each possible phrase.",
        "The outcome of this restructuring is to reduce the complexity of the hierarchical structure and reduce the number of levels in the hierarchy.",
        "This paper considers the tasks of identifying the syntactic structure of text chunking and grammar parsing with previously annotated text documents.",
        "It analyses the use of HHMMs – both before and after the application of improvement techniques – for these tasks, then compares the results with HMMs.",
        "This paper is organised as follows: Section 2 describes the method for training HHMMs.",
        "Section 3 describes the flattening process for reducing the depth of hierarchical structure for HHMMs.",
        "Section 4 discusses the use of HHMMs for the text chunking task and the grammar parser.",
        "The evaluation results of the HMM, the plain HHMM and the merged and partially flattened HHMM are presented in Section 5.",
        "Finally, Section 6 discusses the results."
      ]
    },
    {
      "heading": "2 Hierarchical Hidden Markov Model",
      "text": [
        "A HHMM is a structured multilevel stochastic process, and can be visualised as a tree structured HMM (see Figure 1(b)).",
        "There are two types of states:",
        "• Production state: a leaf node of the tree structure, which contains only observations (represented in Figure 1(b) as the empty circle Q).",
        "• Internal state: contains several production states or other internal states (represented in Figure 1(b) as a circle with a cross inside (D).",
        "The output of a HHMM is generated by a process of traversing some sequence of states within the model.",
        "At each internal state, the automation traverses down the tree, possibly through further internal states, until it encounters a production state where an observation is contained.",
        "Thus, as it continues through the tree, the process generates a sequence of observations.",
        "The process ends when a final state is entered.",
        "The difference between a standard HMM and a hierarchical HMM is that individual states in the hierarchical model can traverse to a sequence of production states, whereas each state in the standard model corresponds is a production state that contains a single observation."
      ]
    },
    {
      "heading": "2.1 Merging",
      "text": [
        "of reconstructing a HMM as a HHMM.",
        "Figure 1(a) shows a HMM with 11 states.",
        "The two dashed boxes (A) indicate regions of the model that have a repeated structure.",
        "These regions are furthermore independent of the other states in the model.",
        "Figure 1(b) models the same structure as a hierarchical HMM, where each repeated structure is now grouped under an internal state.",
        "This HHMM uses a two level hierarchical structure to expose more information about the transitions and probabilities within the internal states.",
        "These states, as discussed earlier, produce no observation of their own.",
        "Instead, that is left to the child production states within them.",
        "Figure 1(b) shows that each internal state contains four production states.",
        "In some cases, different internal states of a HHMM correspond to exactly the same structure in the output sequence.",
        "This is modelled by making them share the same sub-models.",
        "Using a HHMM allows for the merging of repeated parts of the structure, which results in fewer states needing to be identified – one of the three fundamental problems of HMM construction (Rabiner and",
        "Juang, 1986)."
      ]
    },
    {
      "heading": "2.2 Sub-model Calculation",
      "text": [
        "Estimating the parameters for multilevel HHMMs is a complicated process.",
        "This section describes a probability estimation method for internal states, which transforms each internal state into three production states.",
        "Each internal state Si in the HHMM is transformed by resolving each child production state Si,j, into one of three transformed states, Si ⇒ {s� ), s(t) y, s�?t}.",
        "The transformation requires recalculating the new observational and transition probabilities for each of these transformed states.",
        "Figure 2 shows the internal states of S2 have been transformed into sin), stay, stay and soot.",
        "The procedure to transform internal states is: I) calculate the transformed observation (¯O) for each internal state; II) apply the forward algorithm to estimate the state probabilities (¯b) for the three transformed states; III) reform the transition matrix by including estimated values for additional transformed internal states (¯A).",
        "II.",
        "Apply forward algorithm to estimate the transform observation value ¯b: The transformed observation values are simplified to {0 ) t , Q)ay,t , b� )t,t }, which are then given as the observation values for the three productions states (s� ), s(t) y, s(i) out).",
        "The observational probability of entering state Si at time t, i.e. production state s� ), is given by:",
        "where 7rj represents the transition probabilities of entering child state Sj.",
        "The second probability of staying in state Si at time t, i.e. production state, s(ta y, is given by:",
        "where ˆj* is the state corresponding to jˆ calculated at previous time t−1, and Aˆj*,j represents the transition probability from state Sˆj* to state to Sj.",
        "The third probability of exiting state Si at time t, i.e. production state, s(i) out, is given by: bo )t t = jmaNi [Aˆj*,j x Oj,t x Tj] , (4) where Tj is the transition probabilities for leaving the state Sj.",
        "III.",
        "Reform transition probability ¯A(i): Each internal state Si reforms a new 3 x 3 transition probability matrix ¯A, which records the transition status for the transform matrix.",
        "The formula for the estimated cells in A¯ are: S1 Sim S-* S-* So.",
        "S3 S2,1 S2,2 S2,3 S2,4 I.",
        "Calculate the observation probabilities O: ¯A(i) = Ni 7rj (5) Every observation in each internal state Si is in,stay E 7rj2 (6) recalculated by summing up all the observa- ¯A(i) j=1 tion probabilities in each production state Sj in,out = Ni as: E j=1",
        "where time t corresponds to a position in the sequence, O is an observation sequence over t, Oj,t is the observation probability for state Sj at time t, and Ni represents the number of production states for internal state Si.",
        "where Ni is the number of child states for state Si, A�) stay is estimated by summing",
        "up all entry state probabilities for state Si, A�) opt is estimated from the observation that 50% of sequences transit from state s�) directly to state s(i) opt, A(t) y,stay is the sum of all the internal transition probabilities within state Si, and ¯A(i) sta y,opt is the sum of all exit state probabilities.",
        "The rest of the probabilities for transition matrix A¯ are set to zero to prevent illegal transitions.",
        "Each internal state is implemented by a bottom-up algorithm using the values from equations (1)- (8), where lower levels of the hierarchy tree are calculated first to provide information for upper level states.",
        "Once all the internal states have been calculated, the system then need only to use the top-level of the hierarchy tree to estimate the probability sequences.",
        "This means the model will now become a linear HMM for the final Viterbi search process (Viterbi, 1967)."
      ]
    },
    {
      "heading": "3 Partial flattening",
      "text": [
        "Partial flattening is a process for reducing the depth of hierarchical structure trees.",
        "The process involves moving sub-trees from one node to another.",
        "This section presents an interesting automatic partial flattening process that makes use of the term extractor method (Pantel and Lin, 2001).",
        "The method discovers ways of more tightly coupling observation sequences within sub-models thus eliminating rules within the HHMM.",
        "This results in more accurate model.",
        "This process involves calculating dependency values to measure the dependency between the elements in the state sequence (or observation sequence).",
        "This method uses mutual information and log-likelihood, which Dunning (1993) used to calculate the dependency value between words.",
        "Where there is a higher dependency value between words they are more likely to be treat as a term.",
        "The process involves collecting bigram frequencies from a large dataset, and identifying the possible two word candidates as terms.",
        "The first measurement used is mutual information, which is calculated using the formula:",
        "where x and y are words adjacent to each other in the training corpus, C(x, y) to be the frequency of the two words, and * represents all the words in entire training corpus.",
        "The log-likelihood ratio of x and y is defined as:",
        "The system computes dependency values between states (tree nodes) or observations (tree leaves) in the tree in the same way.",
        "The mutual information and log-likelihood values are highest when the words are adjacent to each other throughout the entire corpus.",
        "By using these two values, the method is more robust against low frequency events.",
        "Figure 3 is a tree representation of the HHMM, the figure illustrates the flattening process for the sentence:",
        "where only the part-of-speech tags and grammar information are considered.",
        "The left hand side of the figure shows the original structure of the sentence, and the right hand side shows the transformed structure.",
        "The model’s hierarchy is reduced by one level, where the state P* has become a sub-state of state S instead of N*.",
        "The process is likely to be useful when state P* is highly dependent on state N*.",
        "The flattening process can be applied to the model based on two types of sequence depen-dancy; observation dependancy and state depen-dancy.",
        "• Observation dependency: The observation dependency value is based upon the observa",
        "tion sequence, which in Figure 3 would be the sequence of part-of-speech tags {AT1 JJ NN1 IO JJ CC JJ NN2}.",
        "Given observations NN1 and IO’s as terms with a high dependency value, the model then reconstruct the sub-tree at IO parent state P* moving it to the same level as state N*, where the states of P* and N* now share the same parent, state S.",
        "• State dependency : The state dependency",
        "value is based upon the state sequence, which in Figure 3 would be {N*, P*, N}.",
        "The flattening process occurs when the current state has a high dependency value with the previous state, say N* and P*.",
        "This paper determines the high dependency values by selecting the top n values from a list of all possible terms ranked by either observation or state dependency values, where n is a parameter that can be configured by the user for better performance.",
        "Table 1 shows the observation dependency values of terms for part-of-speech tags for Figure 3.",
        "The term NN1 IO has a higher dependency value than JJ NN1, therefore state P* is joined as a sub-tree of state S. States P* and N remain unchanged since state P* has already been moved up a level of the tree.",
        "After the flattening process, the state P* no longer belongs to the child state of state N*, and is instead joined as the sub-tree to state S as shown in Figure 3."
      ]
    },
    {
      "heading": "4 Application",
      "text": []
    },
    {
      "heading": "4.1 Text Chunking",
      "text": [
        "Text chunking involves producing non-overlapping segments of low-level noun groups.",
        "The system uses the clause information to construct the hierarchical structure of text chunks, where the clauses represent the phrases within the sentence.",
        "The clauses can be embedded in other clauses but cannot overlap one another.",
        "Furthermore each clause contains one or more text chunks.",
        "Consider a sentence from a CoNLL-2004 corpus: (S (NP He PRP) (VP reckons VBZ) (S (NP the DT current JJ account NN deficit NN) (VP will MD narrow VB) (PP to TO) (NP only RB # # 1.8 CD billion D) (PP in IN) (NP September NNP)) (O .",
        ".))",
        "where the part-of-speech tag associated with each word is attached with an underscore, the clause information is identified by the S symbol and the chunk information is identified by the rest of the symbols NP (noun phrase), VP (verb phrase), PP (prepositional phrase) and O (null complemen-tizer).",
        "The brackets are in Penn Treebank II style3.",
        "The sentence can be re-expressed just as its part-of-speech tags thusly: {PRP VBZ DT JJ NN NN MD VB TO RB # CD D IN NNP}, where only the part-of-speech tags and grammar information are to be considered for the extraction tasks.",
        "This is done so the system can minimise the computation cost inherent in learning a large number of unrequired observation symbols.",
        "Such an approach",
        "also maximises the efficiency of trained data by learning the pattern that is hidden within words (syntax) rather than the words themselves (semantics).",
        "Figure 4 represents an example of the tree representation of an HHMM for the text chunking task.",
        "This example involves a hierarchy with a depth of three.",
        "Note that state NP appears in two different levels of the hierarchy.",
        "In order to build an HHMM, the sentence shown above must be restructured as:",
        "where the model makes no use of the word information contained in the sentence."
      ]
    },
    {
      "heading": "4.2 Grammar Parsing",
      "text": [
        "Creation of a parse tree involves describing language grammar in a tree representation, where each path of the tree represents a grammar rule.",
        "Consider a sentence from the Lancaster Treebank4:",
        "where the part-of-speech tag associated with each word is attached with an underscore, and the syntactic tag for each phrase occurs immediately after the opening square-bracket.",
        "In order to build the",
        "models from the parse tree, the system takes the part-of-speech tags as the observation sequences, and learns the structure of the model using the information expressed by the syntactic tags.",
        "During construction, phrases, such as the noun phrase “( strange JJ and CC peculiar JJ )”, are grouped under a dummy state (N d).",
        "Figure 5 illustrates the model in the tree representation with the structure of the model based on the previous sentence from Lancaster Treebank."
      ]
    },
    {
      "heading": "5 Evaluation",
      "text": [
        "The first evaluation presents preliminary evidence that the merged hierarchical hidden Markov Model (MHHMM) is able to produce more accurate results either a plain HHMM or a HMM during the text chunking task.",
        "The results suggest that the partial flattening process is capable of improving model accuracy when the input data contains complex hierarchical structures.",
        "The evaluation involves analysing the results over two sets of data.",
        "The first is a selection of data from CoNLL2004 and contains 8936 sentences.",
        "The second dataset is part of the Lancaster Treebank corpus and contains 1473 sentences.",
        "Each sentence contains hand-labeled syntactic roles for natural language text.",
        "against the number of training sentences during text chunking (A: MHHMM, B: HHMM and C: HMM) The first finding is that the size of training data dramatically affects the prediction accuracy.",
        "A model with an insufficient number of observations",
        "typically has poor accuracy.",
        "In the text chunking task the number of observation symbol relies on the number of part-of-speech tags contained in training data.",
        "Figure 6 plots the relationship of micro-average F-measure for three types of models (A: MHHMM, B: HHMM and C: HMM) on 10-fold cross validation with the number of training sentences ranging from 200 to 1400.",
        "The result shows that the MHHMM has the better performance in accuracy over both the HHMM and HMM, although the difference is less marked for the latter.",
        "number of sentences",
        "for testing (in seconds) for the 10-fold cross validation.",
        "The test were carried out on a dual P4-D computer running at 3GHz and with 1Gb RAM.",
        "The results indicate that the MHHMM gains efficiency, in terms of computation cost, by merging repeated sub-models, resulting in fewer states in the model.",
        "In contrast the HMM has lower efficiency as it is required to identify every single path, leading to more states within the model and higher computation cost.",
        "The extra costs of constructing a HHMM, which will have the same number of production states as the HMM, make it the least efficient.",
        "The second evaluation presents preliminary evidence that the partially flattened hierarchical hidden Markov model (PFHHMM) can assign propositions to language texts (grammar parsing) at least as accurately as the HMM.",
        "This is assignment is a task that HHMMs are generally not well suited to.",
        "Table 2 shows the Fl-measures of identified semantic roles for each different model on the Lancaster Treebank data set.",
        "The models used in this evaluation were trained with observation data from the Lancaster Treebank training set.",
        "The training set and testing set are subdivided from the corpus in proportions of 3 and 13 .",
        "The PFHHMMs had extra training conditions as follows: PFHHMM obs 2000 made use of the partial flattening process, with the high dependency parameter determined by considering the highest 2000 dependency values from observation sequences from the corpus.",
        "PFHHMM state 150 again uses partial flattening, however this time the highest 150 dependency values from state sequences were utilized in discovering the high dependency threshold.",
        "The n values of 2000 and 150 were determined to be the optimal values when applied to the training set.",
        "The results show that applying the partial flattening process to a model using observation sequences to determine high dependency values reduces the complexity of the model’s hierarchy and consequently improves the model’s accuracy.",
        "The state dependency method is shown to be less favor-able for this particular task, but the micro-average result is still comparable with the HMM’s performance.",
        "The results also show no significant re",
        "lationship between the occurance count of a state against the various models prediction accuracy."
      ]
    },
    {
      "heading": "6 Discussion and Future Work",
      "text": [
        "Due to the hierarchical structure of a HHMM, the model has the advantage of being able to reuse information for repeated sub-models.",
        "Thus the HHMM can perform more accurately and requires less computational time than the HMM in certain situations.",
        "The merging and flattening techniques have been shown to be effective and could be applied to many kinds of data with hierarchical structures.",
        "The methods are especially appealing where the model involves complex structure or there is a shortage of training data.",
        "Furthermore, they address an important issue when dealing with small datasets: by using the hierarchical model to uncover less obvious structures, the model is able to increase model performance even over more limited source materials.",
        "The experimental results have shown the potential of the merging and partial flattening techniques in building hierarchical models and providing better handling of states with less observation counts.",
        "Further research in both experimental and theoretical aspects of this work is planned, specifically in the area of reconstructing hierarchies where recursive formations are present and formal analysis and testing of techniques."
      ]
    }
  ]
}
