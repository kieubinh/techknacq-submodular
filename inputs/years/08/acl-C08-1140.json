{
  "info": {
    "authors": [
      "Deyu Zhou",
      "Yulan He"
    ],
    "book": "International Conference on Computational Linguistics",
    "id": "acl-C08-1140",
    "title": "A Hybrid Generative/Discriminative Framework to Train a Semantic Parser from an Un-annotated Corpus",
    "url": "https://aclweb.org/anthology/C08-1140",
    "year": 2008
  },
  "references": [
    "acl-P94-1016"
  ],
  "sections": [
    {
      "text": [
        "We propose a hybrid generative/discriminative framework for semantic parsing which combines the hidden vector state (HVS) model and the hidden Markov support vector machines (HM-SVMs).",
        "The HVS model is an extension of the basic discrete Markov model in which context is encoded as a stack-oriented state vector.",
        "The HM-SVMs combine the advantages of the hidden Markov models and the support vector machines.",
        "By employing a modified K-means clustering method, a small set of most representative sentences can be automatically selected from an un-annotated corpus.",
        "These sentences together with their abstract annotations are used to train an HVS model which could be subsequently applied on the whole corpus to generate semantic parsing results.",
        "The most confident semantic parsing results are selected to generate a fully-annotated corpus which is used to train the HM-SVMs.",
        "The proposed framework has been tested on the DARPA Communicator Data.",
        "Experimental results show that an improvement over the baseline HVS parser has been observed using the hybrid framework.",
        "When compared with the HM-SVMs trained from the fully-annotated corpus, the hybrid framework gave a comparable performance with only a small set of lightly annotated sentences."
      ]
    },
    {
      "heading": "1. Introduction",
      "text": [
        "Semantic parsing maps the natural language sentences to complete formal meaning representations.",
        "Traditionally, research in the field of semantic parsing can be divided into two categories: rule-based approaches and statistical approaches.",
        "Based on hand-crafted semantic grammar rules, rule-based approaches fill slots in semantic frames using word pattern and semantic tokens (Dowding et al., 1994; Ward and Issar, 1994).",
        "Such rule-based approaches are typically domain-specific and often fragile.",
        "Statistical approaches are generally based on stochastic models.",
        "They can be further categorized into three types: generative approaches, discriminative approaches and a hybrid of the two.",
        "Generative approaches learn the joint probability model, P(W,C), of input sentence W and its semantic tag sequence C, compute P{C\\W) using the Bayes rule, and then take the most probable tag sequence C. The hidden Morkov model (HMM), being a generative model, has been predominantly used in statistical semantic parsing.",
        "It models sequential dependencies by treating a semantic parse sequence as a Markov chain, which leads to an efficient dynamic programming formulation for inference and learning.",
        "The hidden vector state (HVS) model (He and Young, 2005) is a discrete HMM model in which each HMM state represents the state of a pushdown automaton with a finite stack size.",
        "State transitions are factored into separate stack pop and push operations constrained to give a tractable search space.",
        "The result is a model which is complex enough to capture hierarchical structure but which can be trained automatically from only lightly annotated data.",
        "Discriminative approaches directly model posterior probability P{C\\W) and learn mappings from W to C. One representative example is support vector machines (SVMs) (Vapnik, 1995).",
        "More recently, the hidden Markov support vector machines (HM-SVMs) (Altun et al., 2003) have been proposed which combine the flexibility of kernel methods with the idea of HMMs to predict a label sequence given an input sequence.",
        "However, HM-SVMs require full annotated corpora for training which are difficult to obtain in practical applications.",
        "On the other hand, the HVS model can be easily trained from only lightly annotated corpora.",
        "It is thus interesting to explore the feasibility to combine the advantages of the HVS model and the HM-SVMs.",
        "We propose a hybrid generative/discriminative framework here where a modified K-means clustering method is first applied to select a small set of the most representative sentences automatically from an un-annotated corpus.",
        "These sentences together with their abstract annotations are used to train an HVS model which could be subsequently applied on the whole corpus to generate semantic parsing results.",
        "The most confident semantic parsing results are selected to generate a fully-annotated corpus which is used to train the HM-SVMs.",
        "Experimental results show that an improvement over the baseline HVS parser has been achieved using the hybrid framework.",
        "When compared with the HM-SVMs trained from the fully-annotated corpus, the hybrid framework gave a comparable performance with only a small set of lighted annotated sentences.",
        "The rest of this paper is organized as follows.",
        "Section 2 reviews other proposed hybrid generative/discriminative frameworks in recent years.",
        "Section 3 briefly describes the HVS model and the HM-SVMs followed by the presentation of the proposed hybrid framework.",
        "In Section 4, experimental setup and results are discussed.",
        "Finally, Section 5 concludes the paper."
      ]
    },
    {
      "heading": "2. Related Work",
      "text": [
        "Combination of generative and discriminative models for data classification has recently attracted much interests in the machine learning community.",
        "It has been shown theoretically and experimentally in (laakkola and Haussler, 1998; Ng and lordan, 2002; Bouchard and Triggs, 2004) that the hybrid model combines the complementary powers of the both models.",
        "The first extensive study on hybrid models were discussed in (laakkola and Haussler, 1998) where discriminative features were extracted using generative models and were later used in discriminative models.",
        "More recently, the HM-SVMs (Altun et al., 2003) have been proposed which incorporate kernel methods into HMMs to predict a label sequence given an input sequence.",
        "There have also been several studies on exploring the hybrid generative/discriminative frameworks which combine the generative and discriminative models in a pipelined way.",
        "One example is the hybrid framework proposed in (Abou-Moustafa et al., 2004) for sequential data classification.",
        "The framework employs HMMs to map the variable length sequential data into a fixed size P-dimensional vector that can be classified using any discriminative model.",
        "Experiments were conducted on the NIST database for handwritten digits and results showed a better recognition rate than that of standard HMMs.",
        "Another example is the hybrid generative/discriminative approach proposed in (Holub et al., 2008) for detecting and classifying object categories in the machine version domain.",
        "In this approach, \"Fisher Kernels\" were used to retain most of the desirable properties of generative methods and a discriminative setting was used to increase the classification performance.",
        "Experimental results showed significant performance improvement over the generative counterpart."
      ]
    },
    {
      "heading": "3. Methodologies",
      "text": [
        "This section first introduces the hidden vector state (HVS) model and the hidden Markov support vector machines (HM-SVMs) followed by the presentation of the proposed hybrid generative/discriminative framework.",
        "Given a model and an observed word sequence W = {w\\ ■ ■ ■ wt), semantic parsing can be viewed as a pattern recognition problem and the most likely semantic representation can be found through statistical decoding.",
        "If assuming that the hidden data take the form of a semantic parse tree C then the model should be a push-down automata which can generate the pair (W,C) through some canonical sequence of moves D = (d\\ ■ ■ ■ dy).",
        "That is,",
        "For the general case of an unconstrained hierarchical model, D will consist of three types of probabilistic move:"
      ]
    },
    {
      "heading": "1.. popping semantic category labels off the stack;",
      "text": [
        "2. pushing one or more non-terminal semantic category label onto the stack; 3. generating the next word.",
        "When considering a constrained form of automata where the stack is finite depth and (W,C) is built by repeatedly popping 0 to n labels off the stack, pushing exactly one new label onto the stack and then generating the next word, it defines the Hidden Vector State (HVS) model in which conventional grammar rules are replaced by three probability tables.",
        "Given a word sequence W, concept vector sequence C and a sequence of stack pop operations N, the joint probability of P(W, C, N) can be decomposed as where ct, the vector state at word position t, is a vector of Dt semantic concept labels (tags), i.e. ct = [ct[l], ct[2], ..ct[Dt\\] where ct[l] is the preterminal concept label and ct [Dt] is the root concept label, fit is the vector stack shift operation at word position t and take values in the range 0,..., Dt-\\ and ct[l] – cWt is the new preterminal semantic tag assigned to word wt at word position t.",
        "To learn a function that assigns to a sequence of words W = {w\\ ■ ■ ■ wx),Wi G W, i = 1,... T a sequence of semantic tags C = c\\c2 ... ct, Cj e C,i = 1,... T, a common approach is to determine a discriminant function F:WxC^R that assigns a score to every input W G W := W* and every semantic tag sequence C e C := C*, where W* denotes the Kleene closure of W. In order to obtain a prediction f(W) G C, the function is maximized with respect to f(W) = argmaxF(I^, C).",
        "In particular, the function F(W, C) is assumed to be linear in some combined feature representation of W and C in HM-SVMs (Altun et al., 2003), F(W,C) := (w,$(W,C)).",
        "Given a set of training data (Wj, Ci),i = 1,... N, the parameters w are adjusted so that the true semantic tag sequence Cj scores higher than all other tag sequences C G Ci := C\\Ci with a large margin.",
        "To achieve the goal, the following optimization problem is solved instead.",
        "where £j is non-negative slack variables allowing one to increase the global margin by paying a local penalty on some outlying examples, and Cons dictates the desired trade off between margin size and outliers.",
        "To solve the equation 3, the dual of the equation is solved instead.",
        "The solution w* can be written as where cti(C) is the Lagrange multiplier of the constraint associated with example i and Cj.",
        "3.3 A Hybrid Generative/Discriminative Framework for Semantic Parsing",
        "The framework of combining the HVS model and the HM-SVMs is illustrated in Figure 1.",
        "It consists of three main stages, Representative Sentences Selection, Fully Annotated Corpus Generation, and HM-SVM Training and Testing.",
        "Each of them is discussed in details below.",
        "• Representative Sentences Selection.",
        "Given an un-annotated corpus, the modified K-means clustering algorithm is first employed to select the most representative sentences for annotation.",
        "This is to avoid annotating the whole corpus and hopefully the model trained from the subset of the original corpus would still give a similar performance when compared with the model trained from the full corpus.",
        "The modified K-means clustering algorithm is described in Figure 3.3.",
        "Initially, k different sentences are randomly selected as the initial centroids.",
        "Then, each sentence Si in the training data is assigned to one of the k clusters based on the similarity measurement which will be discussed later.",
        "Un-annotated I__i . /Representative",
        "After that, the centroids of the k clusters are recalculated.",
        "The above process repeats until there are no further changes in the centroids.",
        "Here s(a,i, bj) is the score of aligning with bj and is defined as:",
        "where, p(a,i) denotes the occurrence probability of the word a» and p(a,i,bj) denotes the probability that a% and bj appear at the same position in two aligned sequences.",
        "To ensure that content words containing key information are weighted more heavily than the less relevant words such as function words, a score matrix can then be built and dynamic programming is used to find the largest score between two sequences.",
        "The distance between the two sentences is defined as the negation of the similarity between them.",
        "• Fully Annotated Corpus Generation.",
        "An HVS model is trained from the annotated corpus constructed in the previous stage which is then applied to the original un-annotated corpus to generate a semantic tag sequence for each sentence.",
        "The generated semantic tag sequences essentially define the explicit word/tag alignments which could serve as the full annotation required by HM-SVMs training.",
        "However, the HVS model does not guarantee to parse the sentences with 100% accuracy.",
        "Based on a user-defined parse probabil-",
        "sequences ot length ot n and m, defined as the score of the op-;nt between the initial segment of a and the initial segment from , where Sim(i, j) is recursively follows:",
        "After generating k clusters, the centroid in each of the clusters is selected as the representative sentence for annotation.",
        "This results in an exactly k sentences being selected.",
        "There are however two ways to construct the annotated corpus depending on the neighborhood threshold value d. When d = 1, the annotated corpus only contains k sentences.",
        "When d < 1, both the centroid and some of its nearest neighboring sentences in each cluster will receive the same abstract annotation.",
        "Thus, the annotated corpus will contain more than k sentences.",
        "It has to be noted that in both cases, only k sentences (centroids) need to be annotated.",
        "The similarity between two sentences is calculated based on sequence alignment.",
        "Suppose a = aia2 • • • an and b = &1&2 • • • bm are the two word Sim(i,j) is timal alignmi from a\\ to a» b\\ to bj of b, calculated as",
        "Input: A set of sentences S = {sit i = 1,..., N}, a distance threshold a, a neighborhood threshold d Output: A set of representative sentences R = {rj,j = 1,..., M}, and a set of the centroids of the",
        "generated clusters Cent Algorithm:",
        "1.",
        "For each st £ S, set Flagt = 1.",
        "Initialize R and Cent to be empty sets.",
        "2.",
        "Select sentences from S with Flag equal to 1 , then reconstruct S = {sj\\Flagj = l,j = 1,..., N}, N is the number of sentences with Flag equal to 1 in S.",
        "3.",
        "Randomly select k different sentences cy.",
        "from S, the default value of k is 1000.",
        "Construct k clusters C = {q}, I = 1,..., k. Set NumOfFlag = ||S||"
      ]
    },
    {
      "heading": "4.. Loop for each sentences s t e S",
      "text": [
        "Loop for each cluster c;",
        "Calculate the distance between Sj and the centroid of q. Distu = Distance^, c;).",
        "If < a, then q = c; (J si; set Flag, = 0, ExitLoop.",
        "If \\\\{si\\si e S,Flagj = 1}|| <NumOfFlag, then set NumOfFlag = \\\\{si\\si £ S,Flagj = 1}||, go to Step 4.",
        "Cent = Cent [j Centu I = 1, ..., k, ||q || ^ 0."
      ]
    },
    {
      "heading": "5.. If NumOfFlag > 0 then Go to step 2. Else",
      "text": [
        "R = RIJ Cent.",
        "Construct ||Ce«i|| clusters C = {ci},l = 1,..., ||Certt||.",
        "Loop for each sentences s; e S",
        "If Distai < d, then R = R [j s, EndLoop Endlf",
        "ity threshold, the most confident parse results are selected for the construction of the fully annotated corpus.",
        "• HM-SVMs Training and Testing.",
        "Given the fully annotated corpus generated in the previous stage, the HM-SVMs can then be trained which could later be used to derive the semantic tag sequences for the test data."
      ]
    },
    {
      "heading": "4. Experiment",
      "text": [
        "Experiments have been conducted on the DARPA Communicator data (CUData, 2004) which are available to the public as open source download.",
        "The data contain utterance transcriptions and the semantic parse results from the rule-based Phoenix parser.",
        "The DARPA Communicator data were collected in 461 days.",
        "From these, 46 days were randomly selected for use as test set data and the remainder were used for training.",
        "After cleaning up the data, the training set consist of 12702 utterances while the test set contains 1178 utterances.",
        "The abstract annotation used for training and the reference annotation needed for testing were derived by hand correcting the Phoenix parse results.",
        "For example, for the sentence \"Show me flights from Boston to New York\", the abstract annotation would be",
        "FLIGHT(FROMLOC(CITY) TOLOC (CITY) ) .",
        "Such an annotation need only list a set of valid semantic concepts and the dominance relationships between them without considering the actual realized concept sequence or attempting to identify explicit word/concept pairs.",
        "Thus, it avoids the need for expensive treebank style annotations.",
        "To evaluate the performance of the model, a reference frame structure was derived for every test set sentence consisting of slot/value pairs.",
        "An example of a reference frame is:",
        "Show me flights from Boston to New York.",
        "Frame: FLIGHT",
        "Slots: FROMLOC.CITY = Boston TOLOC.CITY = New York",
        "Performance was then measured in terms of F measure on slot/value pairs, which combines",
        "Table 1: Feature templates used in HM-SVMs.",
        "Wi is the current word, and W\\,... ,wn is the entire sentence.",
        "the precision (P) and recall (R) values with equal weight and is defined as F = {P + R)/2PR.",
        "In all the subsequent experiments, the open source SFMfcmm(Tsochantaridis et al., 2005) has been used to train and test the HM-SVMs.",
        "The features used in the HM-SVMs are listed in Table 1.",
        "In the modified K-means clustering algorithm described in Figure 3.3, the number of representative sentences depends on both the distance threshold a and the neighborhood threshold d. Table 2 shows the number of representative sentences obtained by varying a and d.",
        "First, a set of experiments were conducted to compare the performance of the HVS model with the HM-SVMs only without incorporating the hybrid framework.",
        "Based on the different values of d and a, we constructed different sets of the annotated corpus.",
        "For example, when a = 0.5, there are 350 clusters generated from a total of 12702 sentences in the un-annotated corpus.",
        "The centroid from each of the cluster is then selected for annotation.",
        "These 350 sentences were annotated with abstract annotation for the HVS model training.",
        "And they were also fully annotated by providing word-level annotations for HM-SVMs training.",
        "Since only abstract annotations need to be provided for the HVS model training, it is possible to automatically enlarge the annotated corpus by including some of the neighboring sentences if the same annotation of the centroid can be assigned to them.",
        "This is controlled by varying the neighborhood threshold d. If d = 1, then the annotated corpus only contains 350 sentences with their abstract annotations.",
        "If varying d to 0.6, then for each cluster, some of the neighboring sentences also receive the same abstract annotation as that of the centroid, thus the annotated corpus is enlarged to contain 6878 sentences.",
        "The performance comparison of the HVS and the HM-SVMs is shown in Figure 3.",
        "It can be observed that in general, HM-SVMs outperforms HVS.",
        "This is not surprising as HM-SVMs was trained from the fully annotated corpus.",
        "The HVS model based on d = 0.6 achieved better performance over the one based on d = 1 since the enlarged annotated corpus was used for training.",
        "The best performance given by HM-SVMs is 92.5% of F-measure when a = 0.9 and 2793 annotated sentences were used for training, while the HVS model gave an F-measure of 86.9%.",
        "Though HM-SVMs outperforms HVS by 5.5%, it should be noted that the time consumed for preparing the fully annotated corpus for HM-SVMs is far more than the time spent for abstract annotation for HVS as shown in Figure 4.",
        "When a = 0.5, annotating 350 sentences with the explicit word/semantic tag mappings took about 17.5 hours while abstract annotation only took about 3 hours.",
        "When a = 0.9, the time spent on fully annotating 2763 sentences is almost six times that of",
        "Current word",
        "Wi",
        "Previous word",
        "Wi-",
        "-1",
        "Word two back",
        "Wi-",
        "-2",
        "Next word",
        "Wi^",
        "-1",
        "Word two ahead",
        "Wi^",
        "-2",
        "Bigram features",
        "Wi-",
        "-2,",
        "Wi-l",
        "Wi-",
        "-I,",
        "Wi,",
        "W",
        "t+1",
        "-I,",
        "Wi+2",
        "d",
        "a",
        "0.5",
        "0.6",
        "0.7",
        "0.8",
        "0.9",
        "1",
        "350",
        "663",
        "1068",
        "1743",
        "2763",
        "0.6",
        "6878",
        "7596",
        "9810",
        "9640",
        "11872",
        "Figure 4: Comparison of time Consuming in preparing training data for the HVS model and the HM-SVMs.",
        "4.2 Comparison between HVS and the Hybrid Framework with Clustering",
        "Figure 5 shows the performance comparison between the HVS model and the hybrid framework by varying a.",
        "It can be observed that when the size of the annotated corpus is small, the HVS model outperforms the hybrid framework.",
        "However, with increased number of annotated sentences, the hybrid framework achieves the better performance.",
        "For both the HVS model and the hybrid framework, improved performance is observed by training the model/framework from the augmented annotated corpus with the neighboring sentences automatically added in (cf.",
        "Figure 5(a) and (b)).",
        "We notice from Figure 5(a) that when the number of annotated sentences increases from 1743 to 2763, the performances of both the HVS model and the hybrid framework decrease.",
        "By analyzing the clustering results generated from the modified K-means algorithm, we found that some of the clusters formed actually contain those rare sentences and they represent the outliers of the original training set.",
        "This therefore leads to the decreased performance of the HVS model and the hybrid framework.",
        "With only 2763 annotated sentences, the hybrid framework trained under d = 0.6 achieves 88.5% in F-measure which results in a relative error reduction of 12% when compared with the HVS model where the F-measure value of 87.0% was obtained.",
        "4.3 Comparison between HVS and the Hybrid Framework without Clustering",
        "Experiments have also been conducted to compare the performance of the HVS model and the hy(a) d = l.",
        "(b) d = 0.6.",
        "brid framework without employing the modified K-means clustering algorithm to automatically select the most representative sentences for annotation.",
        "That is, the whole corpus of 12702 sentences were provided with abstract annotations.",
        "Both the HVS model and the hybrid framework were trained from the training set which was formed by randomly selecting the annotated sentences from the original corpus.",
        "Figure 6 illustrates the performance of the HVS model and the hybrid framework versus the varying sizes of the training data.",
        "Here 10-fold cross validation was performed and the F-measure value at each point of the curve in Figure 6 was calculated by averaging the performance of the 10 experiments each time with different training set of the same size.",
        "It can be observed that the performance of both the HVS model and the proposed hybrid framework increases with the increased size of the training data.",
        "The hybrid framework outperforms the HVS model when the size of the training data is beyond 6000.",
        "The improvement is more substantial by incorporating more training data.",
        "The best performance achieved by the HVS model and the proposed hybrid framework is listed in Table 3.",
        "It can be observed that the hybrid framework gives the relative error reduction of 22% when compared with the performance of the HVS model where only 87.97% was achieved.",
        "-",
        " – ",
        "_ m",
        "■",
        "It should also be noted that the best performance of 87.97% in F-measure was obtained when the HVS model was trained on the whole annotated corpus of 12702 sentences.",
        "By employing the clustering method to select the most representative sentences, the hybrid framework trained with less than one fourth of the original training data (2763 annotated sentences) achieves 88.53% in F-measure, which is better than that of the HVS model."
      ]
    },
    {
      "heading": "5. Conclusions",
      "text": [
        "This paper presented a hybrid framework by combining the HVS model and the HM-SVMs for semantic parsing.",
        "Experimental results show that 22% relative error reduction in F-measure was obtained using the hybrid framework on the DARPA Communicator Data when compared with the performance of the HVS model.",
        "Furthermore, employing the modified K-means clustering algorithm to automatically select the most representative sentences for annotation greatly reduces the human effort for annotation.",
        "With only 2763 annotated sentences, the hybrid framework gives the better performance compared with the HVS model trained on the full 12702 annotated sentences.",
        "Also, the hybrid framework gives the comparable performance with that of the HM-SVMs but without the use of the expensive word-level annotations.",
        "Measurement",
        "HVS",
        "Hybrid Framework",
        "Recall",
        "87.81%",
        "90.99 %",
        "Precision",
        "88.13%",
        "90.25%",
        "F-measure",
        "87.97%",
        "90.62%"
      ]
    }
  ]
}
