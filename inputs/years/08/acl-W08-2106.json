{
  "info": {
    "authors": [
      "Hemant Misra",
      "Olivier Cappé",
      "François Yvon"
    ],
    "book": "CoNLL 2008: Proceedings of the Twelfth Conference on Computational Natural Language Learning",
    "id": "acl-W08-2106",
    "title": "Using LDA to detect semantically incoherent documents",
    "url": "https://aclweb.org/anthology/W08-2106",
    "year": 2008
  },
  "references": [
    "acl-J97-1003",
    "acl-W06-1644"
  ],
  "sections": [
    {
      "text": [
        "Hemant Misra and Olivier Cappé François Yvon",
        "LTCI/CNRS and TELECOM ParisTech Univ Paris-Sud 11 and LMISI-CNRS {misra,cappe}@enst.fr yvon@limsi.fr",
        "Detecting the semantic coherence of a document is a challenging task and has several applications such as in text segmentation and categorization.",
        "This paper is an attempt to distinguish between a 'semantically coherent' true document and a 'randomly generated' false document through topic detection in the framework of latent Dirichlet analysis.",
        "Based on the premise that a true document contains only a few topics and a false document is made up of many topics, it is asserted that the entropy of the topic distribution will be lower for a true document than that for a false document.",
        "This hypothesis is tested on several false document sets generated by various methods and is found to be useful for fake content detection applications."
      ]
    },
    {
      "heading": "1. Introduction",
      "text": [
        "The \"Internet revolution\" has dramatically increased the monetary value of higher ranking on the web search engines index, fostering the expansion of techniques, collectively known as \"Web Spam\", that fraudulently help to do so.",
        "Internet is indeed \"polluted\" with fake Web sites whose only purpose is to deceive the search engines by artificially pushing up the popularity of commercial sites, or sites promoting illegal content l. These fake sites are often forged using very crude content generation techniques, ranging from web scrapping (blending of chunks of actual contents) to simple-minded text generation techniques based",
        "©2008.",
        "Some rights reserved.",
        "'The annual AirWeb challenge http://airweb.",
        "cse .",
        "lehigh.",
        "edu gives a state-of-the art on current Web Spam detection techniques.",
        "on random sampling of words (\"word salads\"), or randomly replacing words in actual documents (\"word stuffing\") .",
        "Among these, the latter two are easy to detect using simple statistical models of natural texts, but the former is more challenging, it being made up of actual sentences: recognizing these texts as forged requires either to resort to plagiarism detection techniques, or to automatically identify their lack of semantic consistency.",
        "Detecting the consistency of texts or of text chunks has many applications in Natural Language Processing.",
        "So far, it has been used mainly in the context of automatic text segmentation, where a change in vocabulary is often the mark of topic change (Hearst, 1997), and, to a lesser extent, in discourse studies (see, e.g., (Foltz et al., 1998)).",
        "It could also serve to devise automatic metrics for text summarization or machine translation tasks.",
        "This paper is an attempt to address the issue of differentiating between 'true' and 'false' documents on the basis of their consistency through topic modeling approach.",
        "We have used Latent Dirichlet allocation (LDA) (Blei et al., 2002) model as our main topic modeling tool.",
        "One of the aims of LDA and similar methods, including probabilistic latent semantic analysis (PLSA) (Hof-mann, 2001), is to produce low dimensionality representations of texts in a \"semantic space\" such that most of their inherent statistical characteristics are preserved.",
        "A reduction in dimensionality facilitates storage as well as faster retrieval.",
        "Modeling discrete data has many applications in classification, categorization, topic detection, data mining, information retrieval (IR), summarization and collaborative filtering (Buntine and Jakulin, 2004).",
        "The aim of this paper is to test LDA for establishing the semantic coherence of a document based on the premise that a real (coherent) document should discuss only a few number of topics, a property hardly granted for forged documents which are often made up of random assemblage of words or sentences.",
        "As a consequence, the coherence of a document may reflect in the entropy of its posterior topic distribution or in its perplexity for the model.",
        "The entropy of the estimated topic distribution of a true document is expected to be lower than that of a fake document.",
        "Moreover, the length normalized log-likelihood of a true and coherent document may be higher as compared to that of a false and incoherent document.",
        "In this paper, we compare two methods to estimate the posterior topic distribution of test documents, and this study is also an attempt to investigate the role of different parameters on the efficiency of these methods.",
        "This paper is organized as follows: In Section 2, the basics of the LDA model are set.",
        "We then discuss and contrast several approaches to the problem of inferring the topic distribution of a new document in Section 3.",
        "In Section 4, we describe the corpus and experimental set-up that are used to produce the results presented in Section 5.",
        "We summarize our main findings and draw perspectives for future research in Section 6."
      ]
    },
    {
      "heading": "2. Latent Dirichlet Allocation 2.1 Basics",
      "text": [
        "LDA is a probabilistic model of text data which provides a generative analog of PLSA (Blei et al., 2002), and is primarily meant to reveal hidden topics in text documents.",
        "In (Griffiths and Steyvers, 2004), the authors used LDA for identifying \"hot topics\" by analyzing the temporal dynamics of topics over a period of time.",
        "More recently LDA has also been used for unsupervised language model (LM) adaptation in the context of automatic speech recognition (ASR) (Hsu and Glass, 2006; Tam and Schultz, 2007; Heidel et al., 2007).",
        "Several extensions of the LDA model, such as hierarchical LDA (Blei et al., 2004), HMM-LDA (Griffiths et al., 2005), correlated topic models (Blei and Lafferty, 2005) and hidden topic Markov models (Gruber et al., 2007), have been proposed, that introduce more complex dependency patterns in the model.",
        "Like most of the text mining techniques, LDA assumes that documents are made up of words and the ordering of the words within a document is unimportant (\"bag-of-words\" assumption).",
        "Contrary to the simpler Multinomial Mixture Model (see, e.g., (Nigam et al., 2000) and Section 2.4), LDA assumes that every document is represented by a topic distribution and that each topic defines an underlying distribution on words.",
        "The generative history of a document (a bag-of-words) collection is the following: Assuming a fixed and known number of topics tit, for each topic t, a distribution [3t over the indexing vocabulary (w = 1... nw) is drawn from a Dirichlet distribution.",
        "Then, for each document d, a distribution 0d over the topics (t = 1... ut) is drawn from a Dirichlet distribution.",
        "For a document d, the document length Id being an exogenous variable, the next step consists of drawing a topic U from 0d for each position i = I...Id- Finally, a word is selected from the chosen topic U.",
        "Given the topic distribution, each word is thus drawn independently from every other word using a document specific mixture model.",
        "The probability of word token is thus:",
        "Conditioned on (3 and 9d, the likelihood of document d is a mere product of terms such as (2), which can be rewritten as:",
        "where Cdm is the count of word w in d.",
        "LDA training consists of estimating the following two parameter vectors from a text collection: the topic distribution in each document d (6dt, t = l...riT,d = L.-Ud) and the word distribution in each topic (j3tw, t = 1...ut,w = l...nw)- Both 0d and [3t define discrete distributions, respectively over the set of topics and over the set of words.",
        "Various methods have been proposed to estimate LDA parameters, such as variational method (Blei et al., 2002), expectation propagation (Minka and Lafferty, 2002) and Gibbs sampling (Griffiths and Steyvers, 2004).",
        "In this paper, we have used the latter approach, which boils down to repeatedly going through the training data and sampling the topic assigned to each word token conditioned on the topic assigned to all the other word tokens.",
        "Given a particular Gibbs sample, the posteriors for 0 and [3 are : Dirichlet with parameters (Kti+X,..., Ktnw+X) and Dirichlet with parameters (Jdi + a,..., JdnT + ot), respectively, where Ktw is the number of times word w is assigned to topic t and Jdt is the number of times topic t is assigned to some word token in document d. Hence,",
        "During the Gibbs sampling phase, [3t and Od are sampled from the above posteriors while the final estimates for these parameters are obtained by averaging the posterior means over the complete set of Gibbs iteration.",
        "Training LDA model on a text collection already provides interesting insights regarding the thematic structure of the collection.",
        "This has been the primary application of LDA in (Blei et al., 2002; Griffiths and Steyvers, 2004).",
        "Even better, being a generative model, LDA can be used to make prediction regarding novel documents (assuming they use the same vocabulary as the training corpus).",
        "In a typical IR setting, where the main focus is on computing the similarity between a document d and a query d', a natural similarity measure is given by P(Cd> \\0d, /?",
        "), computed according to (3) (Buntine et al., 2004).",
        "An alternative would be to compute the KL divergence between the topic distribution in d and d!, which however requires to infer the latter quantity.",
        "As the topic distribution of a (new) document gives its representation along the latent semantic dimensions, computing this value is helpful for many applications, including text segmentation and text classification.",
        "Methods for efficiently and accurately estimating topic distribution for text documents are presented and evaluated in Section 3.",
        "The performance of LDA model is compared with that of the simpler multinomial mixture model (Nigam et al., 2000; Rigouste et al., 2007).",
        "In this model, every word in a document belongs to the same topic, as if the document specific topic distribution 0d in LDA were bound to lie on one vertex of the [0, l]nT simplex.",
        "Using the same notations as before (except for 0t, which now denotes the position independent probability of topic t in the collection), the probability of a document is:",
        "This model can be trained through expectation maximization (EM), using the following reestimation formulas, where (7) defines the E-step; (8) and (9) define the M-step.",
        "0tUZZMJCd-",
        "As suggested in (Rigouste et al., 2007), we initialize the EM algorithm by drawing initial topic distributions from a prior Dirichlet distribution with hyper-parameter a = 1.",
        "[3 = 0.1 in all the experiments.",
        "During testing, the parameters of the multinomial models are used to estimate the posterior topic distribution in each document using (7).",
        "The likelihood of a test document is given by (6)."
      ]
    },
    {
      "heading": "3. Inferring the Topic Distribution of Test Documents",
      "text": [
        "P(Cd\\0d), the conditional probability of a document d given 0d is obtained using (3) .",
        "Computing the likelihood of a test document requires to integrate this quantity over 0; likewise for the computation of the posterior distribution of 0.",
        "This integral has no close form solution, but can be approximated using Monte-Carlo sampling techniques as:",
        "where 0^ denotes the sample from the",
        "Dirichlet prior, and M is the number of Monte",
        "Carlo samples.",
        "Given the typical length of documents and the large vocabulary size, small scale experiments convinced us that a cruder approximation was in order, as the sum in (10) is dominated by the maximum value.",
        "We thus contend ourselves to solve:",
        "and use this value to approximate P{Cd) using (3).",
        "The maximization program (11) has no close form solution.",
        "However, the objective function is differentiable and log-concave, and can be optimized in a number of ways.",
        "We considered two different algorithms: an EM-like approach, initially introduced in (Heidel et al., 2007), and an exponentiated gradient approach (Kivinen and War-muth, 1997; Globerson et al., 2007).",
        "The first approach implements an iterative procedure based on the following update rule:",
        "Although no justification was given in (Heidel et al., 2007), it can be shown that this update rule converges towards a global optimum of the likelihood.",
        "Let 9 and 9' be two topic distributions in the ny-dimensional simplex, L{9) = \\ogP{Cd\\9), and pt{w,9) = .",
        "We define an auxiliary function Q(9J9f) = J2W Cw(52t Pt(w, 6) log(0O).",
        "Q{9,9>) is concave in 9', and performs the role played by the auxiliary function in the EM algorithm.",
        "Simple calculus suffices to prove that (i) the update (12) maximizes in 9' the function Q(9,9'), and (ii) Q{9, 9') - Q{9,9) > L{9') - L{9), which stems from the concavity of the log.",
        "At an optimum of Q(9, 9') the positivity of the first term implies the positivity of the second.",
        "Maximizing Q using the update rule (12) thus increases the likelihood and repeating this update converges towards the optimum value.",
        "We experimented both with an un-smoothed (12) and with a smoothed version of this update rule.",
        "The unsmoothed version yielded a slightly better result than the smoothed one.",
        "Exponentiated gradient (Kivinen and Warmuth, 1997; Globerson et al., 2007) yields an alternative update rule:",
        "where rj defines the convergence rate.",
        "In this form, the update rule does not preserve the normalization of 9, which needs to be performed after every iteration.",
        "A systematic comparison of these rules was carried out, yielding the following conclusions:",
        "• the convergence of the EM-like method is very fast.",
        "Typically, it requires less than half a dozen iterations to converge.",
        "After convergence, the topic distribution estimated by this method for a subset of train documents was always very close (as measured by the KL-divergence) to the respective topic distribution of the same documents observed at the end of the LDA training.",
        "Taking tit = 50, the average KL divergence for a set of 4,500 documents was found to be less than 0.5.",
        "• exponentiated gradient has a more erratic behaviour, and requires a careful tuning of rj on a per document basis.",
        "For large values of rj, the update rule (13) sometimes fails to converge; smaller values of rj allowed to consistently reach convergence, but required more iterations (typically 20-30).",
        "On a positive side, on an average, the topic distributions estimated by this method are better than the ones obtained with the EM-like algorithm.",
        "Based on these findings, we decided to use the EM-like algorithm in all our subsequent experiments."
      ]
    },
    {
      "heading": "4. Experimental protocol",
      "text": [
        "The Reuters Corpus Volume 1 (RCV1) (Lewis et al., 2004) is a collection of over 800,000 news items in English from August 1996 to August 1997.",
        "Out of the entire RCV1 dataset, we selected 27,672 documents (news items) for training (TrainReuters) and 23,326 documents for testing (TestReuters).",
        "The first 4000 documents from the TestReuters dataset were used as true documents (TrueReuters) in the experiments reported in this paper.",
        "The vocabulary size in the train set, after removing the function words, is 93, 214.",
        "Along with these datasets of \"true\" documents, three datasets of fake documents were also created.",
        "Document generation techniques are many: here we consider documents made by mixing short passages from various texts and documents made by assembling randomly chosen words (sometimes called as \"word salads\").",
        "In addition, we also consider the case of documents generated with a stochastic language model (LM).",
        "Our \"fake\" test documents are thus composed of:",
        "• (SentenceSalad) obtained by randomly picking sentences from TestReuters.",
        "• (WordSalad) created by generating random sentences from a conventional unigram LM trained on TrainReuters.",
        "• (Markovian) created by generating random sentences from a conventional 3-gram LM trained on TrainReuters.",
        "Each of these forged document set contains 4,000 documents.",
        "To assess the performance on out-of-domain data, we replicated the same tests using 2,000 Medline abstracts (Ohta et al., 2002).",
        "1,500 documents were used either to generate fake documents by picking sentences randomly or to train an LM and then using the LM to generate fake documents.",
        "The remaining 500 abstracts were set aside as \"true\" documents (TrueMedline).",
        "The entropy of the topic distribution is computed as H = – YlJ=i @dj log^j.",
        "The other measure of interest is the average 'log-likelihood per word' (LLPW).",
        "While evaluating the performance of our system, two types of errors are encountered: false acceptance (FA) when a false document is accepted as a true document and false rejection (FR) when a true document is rejected as a false document.",
        "The rate of FA and FR is dependent on the threshold used for taking the decision, and usually the performance of a system is shown by its receiver operating characteristic (ROC) curve which is a plot between FA and FR rates for different values of threshold.",
        "Instead of reporting the performance of a system based on two error rates (FA and FR), the general practice is to report the performance in terms of equal-error-rate (EER).",
        "The EER is the error rate at the threshold where FA rate = FR rate.",
        "In our system, a threshold on entropy (or LLPW) is used for taking the decision, and all the documents having their entropy (or LLPW) below (or above) the threshold are accepted as true documents.",
        "The EER is obtained on the test set by changing the threshold on the test set itself, and the best results thus obtained are reported."
      ]
    },
    {
      "heading": "5. Detecting semantic inconsistency",
      "text": [
        "In the first set of experiments, the LLPW and entropy of the topic distribution (the two measures) of the Multinomial mixture and LDA models were compared to check the ability of these two measures and models in discriminating between true and false documents.",
        "These results are summarized in Table 1.",
        "Table 1: Performance of the Multinomial Mixture and LDA",
        "For the multinomial mixture model, the LLPW measure is able to discriminate between true and false documents to a certain extent.",
        "As expected (not shown here), the LLPW of the true documents is usually higher than that of the false documents.",
        "In contrast, the entropy of the posterior topic distribution does not help much in discriminating between true and false documents.",
        "In fact it remains close to zero (meaning that only one topic is \"active\") both for true and false documents.",
        "The behaviour of the LDA scores is entirely different.",
        "The perplexity scores (LLPW) of true and fake texts are comparable, and do not make useful predictors.",
        "In contrast, the entropy of the topic distribution allows to sort true documents from fake ones with a very high accuracy for all kinds of fake texts considered in this paper.",
        "Both results stem from the ability of LDA to assign a different topic to each word occurrence.",
        "Similar pattern is observed for our three false test sets (against the TrueReuters set) with small variations The texts generated with a Markov model, no matter the order, have the highest entropy, reflecting the absence of long range correlation in the generation model.",
        "Though the texts generated by mixing sentences are more confusing with the true documents, the performance is still less than 1% EER.",
        "Texts mixing a high number of topics (e.g., Sentence Salads) are almost as likely as natural texts that address only a few topics.",
        "However, the former has much higher entropy of the topic distribution due to a large number of topics being active in such texts (see also Figure 1).",
        "TrueReuters vs.",
        "Multinomial",
        "LLPW",
        "Entropy",
        "SentenceSalad",
        "15.3%",
        "48.8%",
        "WordSalad",
        "9.3%",
        "35.8%",
        "Markovian",
        "17.6%",
        "38.9%",
        "TrueReuters vs.",
        "LDA",
        "LLPW",
        "Entropy",
        "SentenceSalad",
        "18.9%",
        "0.88%",
        "WordSalad",
        "9.9%",
        "0.13%",
        "Markovian",
        "25.0%",
        "0.28%",
        "It is noteworthy that both the predictors (LLPW and Entropy) give complementary clues regarding a text category.",
        "A linear combination of these two scores (the weight to the LLPW score is 0.1) allows to substantially improve over these baseline results, yielding a relative improvement (in EER) of+20.0% for the sentence salads, +20.8% for the word salads, and +27.3% for the Markov Models.",
        "In this part, we investigate the performance of LDA in detecting false documents when the number of topics is changed.",
        "Increasing the number of topics means higher memory requirements both during training and testing.",
        "Though the results are shown only for SentenceSalad, similar trend is observed for WordSalad and Markovian.",
        "The numbers in Table 2 show that the performance obtained with the LLPW score consistently improve with an increase in the number of topics, though the % improvement obtained when the number of topics exceeds 200 is marginal.",
        "In contrast, the best performance in case of entropy is achieved at 50 topics and slowly degrades when a more complex model is used.",
        "Table 2: EER from LLPW and Entropy distribution for PrueReuters against SentenceSalad.",
        "In this section, we study fake documents produced by randomly changing words in true documents (the TrueReuters dataset).",
        "In each document, a fixed percentage of content words is randomly replaced by any other word from the training vocabulary .",
        "This percentage was varied from 5 to 100 and EER for these corrupted document sets is computed at each % corruption level (Figure 2).",
        "As",
        "Noise level (% words changed)",
        "Figure 2: EER at various noise levels expected, the EER is very high at low noise levels, and as the noise level is increased, EER gets lower.",
        "When only a few words are changed in a true document, it retrains the properties of a true document (high LLPW and low entropy).",
        "However, as more number of words are changed in a true document, it starts showing the characteristics of a false document (low LLPW and high entropy).",
        "These results suggest that our semantic consistency tests are too crude a measure to detect a small number of inconsistencies, such as the ones found in the state-of-the-art OCR or ASR systems' outputs.",
        "On the other hand, it confirms the numerous studies that have shown that topic detection (and topic adaptation) or text categorization tasks can be performed with the same accuracy for moderately noisy texts and clean texts, a finding which warrants the topic-based LM adaptation strategies deployed in (Hei-del et al., 2007; Tam and Schultz, 2007).",
        "Number of Topics",
        "LLPW",
        "Entropy",
        "10",
        "27.9",
        "1.88",
        "50",
        "18.9",
        "0.88",
        "100",
        "16.0",
        "0.93",
        "200",
        "14.8",
        "0.90",
        "300",
        "13.8",
        "1.05",
        "400",
        "13.6",
        "1.10",
        "-LLPW",
        "---Entropy -",
        "\\ :",
        "___",
        "The difference in the behavior of our two predictors is striking.",
        "The EER obtained using LLPW drops more quickly than the one obtained with entropy of the topic distribution.",
        "It suggests that the influence of \"corrupting\" content words (mostly with low /3tw) is heavy on the LLPW, but the topic information is not lost till a majority of the \"uncor-rupted\" content words belong to the same topic.",
        "In this section, we study the robustness of our two predictors with respect to the document length by progressively increasing the number of content words in a document (true or fake).",
        "As can be seen from Figure 3, the entropy of the posterior topic distribution starts to provide a reasonable discrimination (5% EER) when the test documents contain about 80 to 100 content words, and attains results comparable to those reported earlier in this paper when this number doubles.",
        "This definitely rules out this method as a predictor of the semantic consistency of a sentence: we need to consider at least a paragraph to get acceptable results.",
        "In this section, we study the robustness of our predictors on out-of-domain data using a small excerpt of abstracts from the Medline database.",
        "Both true and fake documents are from this dataset.",
        "The results are summarized in Table 3.",
        "The per-",
        "TrueReuters against False sets"
      ]
    },
    {
      "heading": "3. – Entropy: SentenceSalad",
      "text": [
        "Table 3: Performance of LDA on PubMed abstracts formance on out-of-domain documents is poor,",
        "Number of content words",
        "Figure 3: EER with change in number of content words used for LDA analysis.",
        "EER based on: LLPWofPrueReuters and false document sets (solid line) and Entropy of topic distribution of PrueReuters andfalse document sets (dashed line).",
        "though the entropy of the topic distribution is still the best predictor.",
        "The reasons for this failure are obvious: a majority of the words occurring in these documents (true or fake) are, from the perspective of the model, characteristic of one single Reuters topic (health and medicine).",
        "They cannot be distinguished either in terms of perplexity or in terms of topic distribution (the entropy is low for all the documents).",
        "It is interesting to note that all the out-of-domain Medline data can be separated from the in-domain TrueReuters data with good accuracy on the basis of the lower LLPW of the former as compared to the higher LLPW of the latter."
      ]
    },
    {
      "heading": "6. Conclusion",
      "text": [
        "In the LDA framework, this paper investigated two methods to infer the topic distribution in a test document.",
        "Further, the paper suggested that the coherence of a document can be evaluated based on its topic distribution and average LLPW, and these measures can help to discriminate between true and false documents.",
        "Indeed, through experimental results, it was shown that entropy of the topic distribution is lower and average LLPW of true documents is higher for true documents and the former measure was found to be more effective.",
        "However, the poor performance of this method on out-of-domain data suggests that we need to use a much larger training corpus to build a robust fake document detector.",
        "This raises the issue of training LDA model with very large collections.",
        "In future we would like to explore the potential of this method for text segmentation tasks.",
        "TrueMedline vs.",
        "LLPW",
        "Entropy",
        "SentenceSalad",
        "31.23%",
        "22.13%",
        "WordS alad",
        "30.03%",
        "19.46%",
        "Markovian",
        "36.51%",
        "23.63%",
        "Acknowledgment",
        "This research was supported by the European Commission under the contract FP6-027026-K-Space.",
        "The views expressed in this paper are those of the authors and do not necessarily represent the views of the commission."
      ]
    }
  ]
}
