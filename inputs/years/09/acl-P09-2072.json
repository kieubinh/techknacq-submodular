{
  "info": {
    "authors": [
      "Fang-Lan Huang",
      "Cho-Jui Hsieh",
      "Kai-Wei Chang",
      "Chih-Jen Lin"
    ],
    "book": "ACL-IJCNLP: Short Papers",
    "id": "acl-P09-2072",
    "title": "Iterative Scaling and Coordinate Descent Methods for Maximum Entropy",
    "url": "https://aclweb.org/anthology/P09-2072",
    "year": 2009
  },
  "references": [
    "acl-P02-1002",
    "acl-W02-2018"
  ],
  "sections": [
    {
      "text": [
        "Fang-Lan Huang, Cho-Jui Hsieh, Kai-Wei Chang, and Chih-Jen Lin",
        "Maximum entropy (Maxent) is useful in many areas.",
        "Iterative scaling (IS) methods are one of the most popular approaches to solve Maxent.",
        "With many variants of IS methods, it is difficult to understand them and see the differences.",
        "In this paper, we create a general and unified framework for IS methods.",
        "This framework also connects IS and coordinate descent (CD) methods.",
        "Besides, we develop a CD method for Maxent.",
        "Results show that it is faster than existing iterative scaling methods."
      ]
    },
    {
      "heading": "1. Introduction",
      "text": [
        "Maximum entropy (Maxent) is widely used in many areas such as natural language processing (NLP) and document classification.",
        "Maxent models the conditional probability as:",
        "Sw(x, y)=e^ wtft(-x'y\\ Tw(x) = Zy Sw(x, y), where x indicates a context, y is the label of the context, and w £ Rn is the weight vector.",
        "A function ft(x, y) denotes the i-th feature extracted from the context x and the label y.",
        "Given an empirical probability distribution P(x, y) obtained from training samples, Maxent minimizes the following negative log-likelihood:",
        "= ExP(x)logTw(x) -ZtwtP(ft), where P{x) = J2y P(x, y) is the marginal probability of x, and P(ft) = Y,x,y P(x, y)ft(x, y) is the expected value of ft(x,y).",
        "To avoid overfit-ting the training samples, some add a regularization term and solve:",
        "'A complete version of this work is at http: //www.csie.ntu.edu.tw/~cj1in/papers/ maxent_journal .pelf.",
        "where a is a regularization parameter.",
        "We focus on (3) instead of (2) because (3) is strictly convex.",
        "Iterative scaling (IS) methods are popular in training Maxent models.",
        "They all share the same property of solving a one-variable sub-problem at a time.",
        "Existing IS methods include generalized iterative scaling (GIS) by Darroch and Rat-cliff (1972), improved iterative scaling (IIS) by Delia Pietra et al.",
        "(1997), and sequential conditional generalized iterative scaling (SCGIS) by Goodman (2002).",
        "In optimization, coordinate descent (CD) is a popular method which also solves a one-variable sub-problem at a time.",
        "With these many IS and CD methods, it is uneasy to see their differences.",
        "In Section 2, we propose a unified framework to describe IS and CD methods from an optimization viewpoint.",
        "Using this framework, we design a fast CD approach for Maxent in Section 3.",
        "In Section 4, we compare the proposed CD method with IS and LBFGS methods.",
        "Results show that the CD method is more efficient.",
        "Notation n is the number of features.",
        "The total number of nonzeros in samples and the average number of nonzeros per feature are respectively",
        "faEEI,!/Et:/i(i[,y)/0 and l = #D2/n."
      ]
    },
    {
      "heading": "2. A Framework for IS Methods 2.1 The Framework",
      "text": [
        "The one-variable sub-problem of IS methods is related to the function reduction L(w+zet) – L(w), where et = [0,..., 0,1, 0,..., 0]T. IS methods differ in how they approximate the function reduction.",
        "They can also be categorized according to whether w's components are sequentially or par-allely updated.",
        "In this section, we create a framework in Figure 1 for these methods.",
        "Sequential update For a sequential-update algorithm, once a one-variable sub-problem is solved, the corresponding element in w is updated.",
        "The new w is then used to construct the next sub-problem.",
        "The procedure is sketched in",
        "Sequential update Find At{z) to approximate Let At{z) =",
        "Iterative scaling.__",
        "Parallel update l",
        "Find a separable function A(z) to",
        "-L(w) approximate L(w + z) GIS, IIS",
        "Algorithm 1 A sequential-update IS method While w is not optimal For t = 1,..., n",
        "1.",
        "Find an approximate function At{z) satisfying (4)."
      ]
    },
    {
      "heading": "2.. Approximately min^ A t {z) to get Zf",
      "text": [
        "Algorithm 1.",
        "If the i-th component is selected for update, a sequential IS method solves the following one-variable sub-problem:",
        "min^ At{z), where At{z) bounds the function difference: At(z) > L(w + zet) - L(w)",
        "An approximate function At{z) satisfying (4) does not ensure that the function value is strictly decreasing.",
        "That is, the new function value L(w + zet) may be only the same as L(w).",
        "Therefore, we can impose an additional condition on the approximate function At{z).",
        "If A't(0) / 0 and assume zt = argmin^ At(z) exists, with the condition At(0) = 0, we have At{zt) < 0.",
        "This inequality and (4) then imply L(w + Ztet) < L(w).",
        "If 4(0) = VtL(w) = 0, the convexity of L(w) implies that we cannot decrease the function value by modifying wt.",
        "Then we should move on to modify other components of w.",
        "A CD method can be viewed as a sequential IS method.",
        "It solves the following sub-problem: min^ AfD(z) = L(w + zet) – L(w) without any approximation.",
        "Existing IS methods consider approximations as At(z) may be simpler for minimization.",
        "Parallel update A parallel IS method simultaneously constructs n independent one-variable sub-problems.",
        "After (approximately) solving all of them, the whole vector w is updated.",
        "Algorithm 2 gives the procedure.",
        "The differentiable function A(z), z e Rn, is an approximation of L(w + z) – L(w) satisfying A(z) > L(w + z) - L(w), A(0)=0, and Algorithm 2 A parallel-update IS method While w is not optimal",
        "1.",
        "Find approximate functions At{zt) Vi satisfying (7).",
        "Approximately mmZt At{zt) to get Zt.",
        "sure that the function value is strictly decreasing.",
        "The last condition shows thatA(z)is separable, so",
        "minz A{z) = £t min^ At(zt).",
        "That is,we can minimize At{zt) ,Vi simultaneously, and then update wt Vt together.",
        "A parallel-update method possesses nice implementation properties.",
        "However, since it less aggressively updates w, it usually converges slower.",
        "If A(z) satisfies (7), taking z = ztet implies that (4) and (6) hold for any At{zt).",
        "A parallel method could thus be transformed to a sequential method using the same approximate function, but not vice versa.",
        "We introduce GIS, IIS and SCGIS via the proposed framework.",
        "GIS and IIS use a parallel update, but SCGIS is sequential.",
        "Their approximate functions aim to bound the function reduction where Tw(x) and Qt(zt) are defined in (1) and (5), respectively.",
        "Then GIS, IIS and SCGIS use similar inequalities to get approximate functions.",
        "They apply log a < a – 1 Ma > 0 to get",
        "^)<TJHx)Pvly\\x){eX'^^y)-i)+YJQt{zt).",
        "GIS defines we obtain n independent one-variable functions:",
        "4GIS(^) =e-^ Ex,y P(x)pw(y\\x)ft(x, y) + Qt(zt).",
        "IIS applies Jensen's inequality on (9) to get the approximate function",
        "+ Qt(zt).",
        "SCGIS is a sequential-update method.",
        "It replaces f* in GIS with ff = max^ ft(x, y).",
        "Using ztetas z in (8), a derivation similar to (10) gives",
        "The approximate function of SCGIS is",
        "4SCGIS(^) =^^Zx,yP(x)Pw(y\\x)ft(x, y) + Qt(zt).",
        "We prove the linear convergence of existing IS methods (proof omitted):",
        "Theorem 1 Assume each sub-problem Af(zt) is exactly minimized, where sis IIS, GIS, SCGIS, or CD.",
        "The sequence {wk} generated by any of these four methods linearly converges.",
        "That is, there is a constant /j, e (0,1) such that L(wk+1)-L(w*) < (l-ii)(L(wk)-L(w*)),Vk, where w* is the global optimum of (3).",
        "Without the regularization term, by A't{zt) = 0, GIS and SCGIS both have a simple closed-form solution of the sub-problem.",
        "With the regularization term, the sub-problems no longer have a closed-form solution.",
        "We discuss the cost of solving sub-problems by the Newton method, which iteratively updates zt by",
        "zt^zt-Af{zt)/Af{zt).",
        "(11) Here s indicates an IS or a CD method.",
        "Below we check the calculation of Af(zt) as the cost of Af'(zt) is similar.",
        "We have Af{zi)=YJX>yP{x)Pw{y\\x)!t{x,y)e^a^y) where f/#ifsisGIS,",
        "!s{x,y) = I ff if s is SCGIS, {f^(x,y) if s is IIS.",
        "A^\\zi) = Q[{zi) + YJX,yP{x)P^Ztet{y\\x)ft{x,y).",
        "The main cost is on calculating Pw(y\\x) Vx,y, whenever w is updated.",
        "Parallel-update approaches calculate Pw{y\\x) once every n sub-problems, but sequential-update methods evaluates Pw{y\\x) after every sub-problem.",
        "Consider the situation of updating w to w + Ztet.",
        "By (1),",
        "CD GIS SCGIS IIS 1st Newton direction",
        "Each subsequent Newton direction obtaining P (9(#nz) operations to evaluate Sw+Ztet(x,y) and Tw-\\-Ztet(x) Vx,y.",
        "A trick to trade memory for time is to store all Sw(x, y) and Tw(x),",
        "Tw+Ztet{x)=TUx) + T,ySw{x,y){eZt^-l).",
        "Since Sw+Ztet(x,y) = Sw(x, y) if ft(x, y) = 0, this procedure reduces the the (9(#nz) operations to 0(#nz/n) = 0(1).",
        "However, it needs extra spaces to store all Sw(x,y) and Tw(x).",
        "This trick for updating Pw(y\\x) has been used in SCGIS (Goodman, 2002).",
        "Thus, the first Newton iteration of all methods discussed here takes 0(1) operations.",
        "For each subsequent Newton iteration, CD needs 0(l) as it calculates Pw+Ztet(y\\x) whenever zt is changed.",
        "For GIS and SCGIS, if J2x,y P(x)Pw(y\\x)ft(x,y) is stored at the first Newton iteration, then (12) can be done in 0(1) time.",
        "For IIS, because f^(x, y) of (12) depends on x and y, we cannot store TJx,yP(x)Pw{y\\x)ft{x,y) as in GIS and SCGIS.",
        "Hence eachNewton direction needs 0(1).",
        "We summarize the cost for solving sub-problems in Table 1.",
        "3 Comparison and a New CD Method 3.1 Comparison of IS/CD methods",
        "From the above discussion, an IS or a CD method falls into a place between two extreme designs: At(zt) a loose bound At(zt) a tight bound Easy to minimize At(zt) Hard to minimize At(zt) There is a tradeoff between the tightness to bound the function difference and the hardness to solve the sub-problem.",
        "To check how IS and CD methods fit into this explanation, we obtain relationships of their approximate functions:",
        "A™{zf) < 4ls(zt) < A?s(zt) Vzt.",
        "The derivation is omitted.",
        "From (14), CD considers more accurate sub-problems than SCGIS and GIS.",
        "However, to solve each sub-problem, from Table 1, CD's each Newton step takes more time.",
        "The same situation occurs in comparing IIS and GIS.",
        "Therefore, while a tight At{zt) can",
        "give faster convergence by handling fewer sub-problems, the total time may not be less due to the higher cost of each sub-problem.",
        "We develop a CD method which is cheaper in solving each sub-problem but still enjoys fast final convergence.",
        "This method is modified from Chang et al.",
        "(2008), a CD approach for linear SVM.",
        "We approximately minimize AfD(z) by applying only one Newton iteration.",
        "The Newton direction at z = 0 is now",
        "d = -A™\\0)/A™\"(0).",
        "(15) As taking the full Newton direction may not decrease the function value, we need a line search procedure to find A > 0 such that z = Xd satisfies the following sufficient decrease condition: ACD(z)-AtCD(0) = A™(z) < 7^4tCD,(0), (16) where 7 is a constant in (0,1/2).",
        "A simple way to find A is by sequentially checking A = 1, /?, /3,..., where [3 e (0,1).",
        "The line search procedure is guaranteed to stop (proof omitted).",
        "We can further prove that near the optimum two results hold: First, the Newton direction (15) satisfies the sufficient decrease condition (16) with A = 1.",
        "Then the cost for each sub-problem is 0(l), similar to that for exactly solving sub-problems of GIS or SCGIS.",
        "This result is important as otherwise each trial of z = Xd expensively costs 0(J) for calculating AfD(z).",
        "Second, taking one Newton direction of the tighter A^D(zt) reduces the function L(w) more rapidly than exactly minimizing a loose At(zt) of GIS, IIS or SCGIS.",
        "These two results show that the new CD method improves upon the traditional CD by approximately solving sub-problems, while still maintains fast convergence."
      ]
    },
    {
      "heading": "4. Experiments",
      "text": [
        "We apply Maxent models to part of speech (POS) tagging for BROWN corpus (http://www.nltk.org) and chunking tasks for CoNLL2000 (http://www.",
        "cnts .ua.",
        "ac .be/conll2 000/chunking).",
        "We randomly split the BROWN corpus to 4/5 training and 1/5 testing.",
        "Our implementation is built upon OpenNLP (http : //maxent.",
        "sourcef orge .",
        "net).",
        "We implement CD (the new one in Section 3.2), GIS, SCGIS, and LBFGS for comparisons.",
        "We include LBFGS as Malouf (2002) reported that it is better than other approaches including GIS",
        "(a) BROWN",
        "Figure 2: First row: time versus the relative function value difference (17).",
        "Second row: time versus testing accuracy/Fl.",
        "Time is in seconds, and IIS.",
        "We use a = 10, and set f3 = 0.5 and 7 = 0.001 in (16).",
        "We begin at checking time versus the relative difference of the function value to the optimum:",
        "L{w)-L{w*)/L{w*).",
        "(17) Results are in the first row of Figure 2.",
        "We check in the second row of Figure 2 about testing accuracy/Fl versus training time.",
        "Among the three IS/CD methods compared, the new CD approach is the fastest.",
        "SCGIS comes the second, while GIS is the last.",
        "This result is consistent with the tightness of their approximation functions; see (14).",
        "LBFGS has fast final convergence, but it does not perform well in the beginning."
      ]
    },
    {
      "heading": "5. Conclusions",
      "text": [
        "In summary, we create a general framework for explaining IS methods.",
        "Based on this framework, we develop a new CD method for Maxent.",
        "It is more efficient than existing IS methods."
      ]
    }
  ]
}
