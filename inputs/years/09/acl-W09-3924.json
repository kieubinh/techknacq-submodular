{
  "info": {
    "authors": [
      "Sebastian Varges",
      "Silvia Quarteroni",
      "Giuseppe Riccardi",
      "Alexei V. Ivanov",
      "Pierluigi Roberti"
    ],
    "book": "Proceedings of the SIGDIAL 2009 Conference",
    "id": "acl-W09-3924",
    "title": "Leveraging POMDPs Trained with User Simulations and Rule-based Dialogue Management in a Spoken Dialogue System",
    "url": "https://aclweb.org/anthology/W09-3924",
    "year": 2009
  },
  "references": [],
  "sections": [
    {
      "text": [
        "Leveraging POMDPs trained with User Simulations and Rule-based Dialogue Management in a Spoken Dialogue System",
        "Sebastian Varges, Silvia Quarteroni, Giuseppe Riccardi, Alexei V. Ivanov, Pierluigi Roberti",
        "{varges|silviaq|riccardi|ivanov|roberti}@disi.unitn.it",
        "We have developed a complete spoken dialogue framework that includes rule-based and trainable dialogue managers, speech recognition, spoken language understanding and generation modules, and a comprehensive web visualization interface.",
        "We present a spoken dialogue system based on Reinforcement Learning that goes beyond standard rule based models and computes on-line decisions of the best dialogue moves.",
        "Bridging the gap between handcrafted (e.g. rule-based) and adaptive (e.g. based on Partially Observable Markov Decision Processes - POMDP) dialogue models, this prototype is able to learn high rewarding policies in a number of dialogue situations."
      ]
    },
    {
      "heading": "1. Reinforcement Learning in Dialogue",
      "text": [
        "Machine Learning techniques, and particularly Reinforcement Learning (RL), have recently received great interest in research on dialogue management (DM) (Levin et al., 2000; Williams and Young, 2006).",
        "A major motivation for this choice is to improve robustness in the face of uncertainty due for example to speech recognition errors.",
        "A second important motivation is to improve adaptivity w.r.t.",
        "different user behaviour and application/recognition environments.",
        "The RL approach is attractive because it offers a statistical model representing the dynamics of the interaction between system and user.",
        "This contrasts with the supervised learning approach where system behaviour is learnt based on a fixed corpus.",
        "However, exploration of the range of dialogue management strategies requires a simulation environment that includes a simulated user (Schatzmann et al., 2006) in order to avoid the prohibitive cost of using human subjects.",
        "We demonstrate various parameters that influence the learnt dialogue management policy by using pre-trained policies (section 5).",
        "The application domain is a tourist information system for accommodation and events in the local area.",
        "The domain of the trained DMs is identical to that of a rule-based DM that was used by human users (section 4), allowing us to compare the two directly."
      ]
    },
    {
      "heading": "2. POMDP demonstration system",
      "text": [
        "The POMDP DM implemented in this work is shown in figure 1: at each turn at time t, the incoming N user act hypotheses ara>u split the state space St to represent the complete set of interpretations from the start state (N=2).",
        "A belief update is performed resulting in a probability assigned to each state.",
        "The resulting ranked state space is used as a basis for action selection.",
        "In our current implementation, belief update is based on probabilistic user responses that include SLU confidences.",
        "Action selection to determine system action aTO;S is based on the best state (m is a counter for actions in action set A).",
        "In each turn, the system uses an e-greedy action selection strategy to decide probabilistically if to exploit the policy or explore any other action at random.",
        "(An alternative would be softmax, for example.)",
        "At the end of each dialogue/session a reward is assigned and policy entries are added or updated for each state-action pair involved.",
        "These pairs are stored in tabular form.",
        "We perform Monte Carlo updating similar where n is the number of sessions, R the reward and Q the estimate of the state-action value.",
        "At the beginning of each dialogue, a user goal Uq (a set of concept-value pairs) is generated randomly and passed to a user simulator.",
        "The user simulator takes Ug and the current dialogue context to produce plausible SLU hypotheses.",
        "These",
        "user goal UG state space Sa state space Sa",
        "are a subset of the concept-value pairs in Uq along with a confidence estimate bootstrapped from a small corpus of 74 in-domain dialogs.",
        "We assume that the user 'runs out of patience' after 15 turns and ends the call.",
        "The system visualizes POMDP-related information live for the ongoing dialogue (figure 2).",
        "The visualization tool shows the internal representation of the dialogue manager including the the N best dialogue states after each user utterance and the reranking of the action set.",
        "At the end of each dialogue session, the reward and the policy updates are shown, i.e. new or updated state entries and action values.",
        "Moreover, the system generates a plot that relates the current dialogue's reward to the reward of previous dialogues."
      ]
    },
    {
      "heading": "3. User Simulation",
      "text": [
        "To conduct thousands of simulated dialogues, the DM needs to deal with heterogeneous but plausible user input.",
        "We designed a User Simulator (US) which bootstraps likely user behaviors starting from a small corpus of 74 in-domain dialogs, acquired using a rule-based version of the system (section 4).",
        "The role of the US is to simulate the output of the SLU module to the DM during the whole interaction, fully replacing the ASR and SLU modules.",
        "This differs from other user simulation approaches where n-gram models of user dialog acts are represented.",
        "For each simulated dialogue, one or more user goals are randomly selected from a list of possible user goals stored in a database table.",
        "A goal is represented as the set of concept-value pairs defining a task.",
        "Simulation of the user's behaviour happens in two stages.",
        "First, a user model, i.e. a model of the user's intentions at the current stage of the dialogue, is created.",
        "This is done by mining the previous system move to obtain the concepts required by the DM and their corresponding values (if any) from the current user goal.",
        "Then, the output of the user model is passed to an error model that simulates the \"noisy channel\" recognition errors based on statistics from the dialogue corpus.",
        "Errors produce perturbations of concept values as well as phenomena such as nolnput, noMatch and hangUp.",
        "If the latter phenomena occur, they are directly propagated to the DM; otherwise, plausible confidences (based on the dialogue corpus) are attached to concept-value pairs.",
        "The probability of a given concept-value observation at time t + 1 given the system move at time t, as,t, and the session user goal gu, called P(ot-\\-i\\as,t, 9u), is obtained by combining the outputs of the error model and the user model:",
        "where aUtt+i is the true user action.",
        "Finally, concept-value pairs are combined in an SLU hypothesis and, as in the regular SLU module, a cumulative utterance-level confidence is computed, determining the rank of each of the N hypotheses output to the DM."
      ]
    },
    {
      "heading": "4. Rule-based Dialogue Management",
      "text": [
        "A rule-based DM was developed as a meaningful comparison to the trained DM, to obtain training data from human-system interaction for the US, and to understand the properties of the domain.",
        "Rule-based dialog management works in two stages: retrieving and preprocessing facts (tuples) taken from a dialogue state database, and inferencing over those facts to generate a system response.",
        "We distinguish between the 'context model' of the first phase - essentially allowing more recent values for a concept to override less recent ones - and the 'dialog move engine' of the second phase.",
        "In the second stage, acceptor rules match SLU results to dialogue context, for example perceived user concepts to open questions.",
        "This may result in the decision to verify the application parameter in question, and the action is verbalized by language generation rules.",
        "If the parameter is accepted, application dependent task",
        "Figure 2: A screenshot of the online visualization tool.",
        "Left: user goal (top), evolving ranked state space (bottom).",
        "Center: per state action distribution at turn tj.",
        "Right: consequent reward computation (top) and policy updates (bottom).",
        "See video at http://www.youtube.com/watch?v=6 9QR0tKKhCw.",
        "Figure 3: Left Pane: overview of a selection of dialogues in our visualization tool.",
        "Right Pane: visualization of a system opening prompt followed by the user's activity request.",
        "All distinct SLU hypotheses (concept-value combinations) deriving from ASR are ranked based on concept-level confidence (2 in this turn).",
        "rules determine the next parameter to be acquired, resulting in the generation of an appropriate request.",
        "See (Varges et al., 2008) for more details."
      ]
    },
    {
      "heading": "5. Visualization Tool",
      "text": [
        "In addition to the POMDP-related visualization tool (figure 2), we developed another web-based dialogue tool for both rule-based and POMDP system that displays ongoing and past dialogue utterances, semantic interpretation confidences and distributions of confidences for incoming user acts (see dialogue logs in figure 3).",
        "Users are able to talk with several systems (via SIP phone connection to the dialogue system server) and see their dialogues in the visualization tool.",
        "They are able to compare the rule-based system, a randomly exploring learner that has not been trained yet, and several systems that use various pre-trained policies.",
        "The web tool is available at http://cicerone.dit.unitn.it/ DialogStatistics/."
      ]
    },
    {
      "heading": "Acknowledgments",
      "text": [
        "This work was partially supported by the European Commission Marie Curie Excellence Grant for the ADAMACH project (contract No.",
        "022593) and by LUNA STREP project (contract No.",
        "33549).",
        "ServerVoxnauta DialogID",
        "Asiens« Record ngID",
        ": :",
        "Details",
        "17:58:01",
        "voxnauU.dil.uniln.it 123635BG77",
        "tmp_Fr Mar6 17:58:00 CET 2009 [IN' OUTI IMIXl",
        "3",
        "&",
        "14.56.61",
        "voxnauU.dit umtn.it ' L j.l :.",
        ": J _■ 1 J",
        "1236088611.1385",
        "[IN' 'OUTI 1^1X1",
        "» &",
        "145140",
        "voxnauta.ditunitn.il 123BD8B3C6",
        "1236088308.1381",
        "UNI [OUT!",
        "IMIXl",
        "66 ft%",
        "14:47:09",
        "voxnauta.dit.unitn.il 123638B028",
        "\"3,FJ:SBl2j IV,'.'",
        "[IN' OUT\"!",
        "IMIXl",
        "52",
        "14.46.14",
        "voxnauU.dit unitn.1 'ZiFJLlc .",
        "\"j/i",
        "1236087974.1375 [\\k 'OUTI IMIXl",
        "-12",
        "14 44 30",
        "voxnauta.ditunitn.il 123E.387SG9",
        "1236087870.1373",
        "iin: \"OUTI IMIXl",
        "69",
        "14:43:41",
        "voxnauta.dit.unitn.il 1236387Ö20",
        "1236087821.1371",
        "[IN' OUTI IMIXl",
        "37",
        "14.35.39",
        "voxnaula.dit.unitn.it",
        "1236087339.1361 [IK OUTI IMIXl",
        "87",
        "14.34.06",
        "voxnauta.dit unitn.il '2'jË3ë72-'-5",
        "1236087245.1359 UNI [OUTI IMIXl",
        "\" g",
        "17:57:42",
        "voxnauU.dit.unitn.it 1235013061",
        "1236013062.1337 UN' 'OUTI IMIXl",
        "17.55-22",
        "voxnauU.dit.unitn.it 123831292\"",
        "1236012921.1335 [IN\" 'OUI I ll.",
        "'IXl",
        "86",
        "12 44 52",
        "123G9942B1.1313",
        "DM OUTI IMIXl",
        "32",
        "12:4350",
        "voxnauU.dit.unitn.it 1235994230",
        "1235994230.1311 [IN' OUTI IMIXl",
        "56",
        "124208",
        "voxnauU.dit.unitn.it",
        "' L j.:j :J .",
        "'* ' 2 L'",
        "1235994128.1309 [IN' 'OUT I ITs'lXl",
        "SO",
        "1229 17",
        "voxnâjla.d t untn ' '2j53S3jG7",
        "1235993357.1307 UN!",
        "OUTI IMIXl",
        "IS",
        "ad",
        "12:27:05",
        "voxnauU.dit.unitn.it 1235993225",
        "1235993225.1305 UN' 'OUTI IMIXl",
        "118",
        "1224.13",
        "voxnauU.dit.unitn.it 1235993053",
        "1235993053.1303 [IN' 'OUI I ll.",
        "'IXl",
        "123",
        "12.2252",
        "voxnauU.dit unitn.il \"23&3')2972",
        "1235992972 1301",
        "UN!",
        "[OUTI IMIXl",
        "- &",
        "12:20:07",
        "voxnauU.dit.unitn.it",
        "1235992807.1299",
        "56",
        "Data",
        "r™",
        "Sa -ve 'Vox na jta Vox rauta DWogD",
        "MB",
        "Du'ation (sec|",
        "( Print Page ) ( Save Page )",
        "02/03/2009",
        "17:57:42",
        "voxnauta.dit.unitn.it 1236013061",
        "1236013062.1337 UNI [OUTI IMIXl",
        "36",
        "Included in Statistics",
        "[Reap* Linda 12/03/2009 12:57:40]yea [Qua-teron, Si'via 16/03/2009 17 57_23]yfl",
        "TURN Start Time",
        "Task/Action",
        "Grammar",
        "Levels Confidence",
        "Sensilvity",
        "Speed .",
        "'S",
        "17:57:42 (0)",
        "/Start QuestonHMIHY",
        "---;.",
        "■.",
        ".",
        "-,- 1 .",
        "- ■- -.it -,-",
        "''ca^oDenoromDlNoDateNoAddreBsDetai led Events en-US",
        "0.33-0.66",
        "0.60",
        "ASR Rank",
        "ASR Utterance",
        "ASR Utteraroe Confidence",
        "ASR Concept",
        "ASR lnterpreUt«n",
        "ASH Irleroretat on Confidence",
        "Surface",
        "Word Lattjoe",
        "1",
        "0.615553",
        "Actv ty_actvrtyName",
        "bote Reservat on",
        "0.520528",
        "book a hote I",
        "[SHÜWl IHIDE'",
        "2",
        "note",
        "0.572455",
        "Acii vity_a ct vityNa me",
        "hotel Reservaten",
        "0.499250",
        "booking a notel",
        "[SHUWj IHIDE'",
        "9",
        "b o. hoi-:",
        "0.557984",
        "Acti v ty_act vrtyName",
        "hole Reservat on",
        "0.392611",
        "-.L i--.",
        ": -.L-i-",
        "I SHOW [HIDE!",
        "4",
        "book rooms booking",
        "0.488593",
        "Acti v ty _a ct vityNa me",
        "hotel Reservaten",
        "0.46125",
        "booh rooms",
        "[SHUWj",
        "[hide:",
        "S",
        "bookings hc:c •c-cj™",
        "0.522627",
        "Activ ty_act vityNa me",
        "bote Reservat on",
        "hole -oom",
        "[SHOW]",
        "[hide:",
        "G",
        "book a room booking",
        "0.486067",
        "Act vi ty _a ct vityNa me",
        "bote'Reservation",
        "0.36<7I0",
        "book a room",
        "MBB",
        "7",
        "0.46467",
        "Actv ty_ act vityNa me",
        "bote Reservat on",
        "0.430206",
        "booUna",
        "Ihide:",
        "S",
        "oookirg",
        "0.461608",
        "Activ ty_ act vityNa me",
        "bote Reservat on",
        "0.311835",
        "booTg",
        "[SHOWl [HIDE!",
        "g",
        "-ojnd_Ub e",
        "0.458709",
        "Acti v ty _a ct vityNa me",
        "aventEnquiry",
        "■Ounc lis;",
        "rsHuw:",
        "IHIDEl",
        "Event_type",
        "conference",
        "0.458709",
        "rounejable",
        "SLU Ran«",
        "Reference Utterance",
        "SLU Utterance Confidence",
        "SLU Concept",
        "SLU Interpretation",
        "SLU lnta-p-etator Confiée nee",
        "Surface",
        "Source",
        "i",
        "boc -: a notel",
        "C 5205",
        "Activ tyad ■, tyNamt",
        "hoteRese rvaten",
        "0 52C5",
        "book a note",
        "2",
        ",;t:",
        "0.4587",
        "Act v ly_ad tyNa~*",
        "eventEnqjiry",
        "0.4567",
        "-ouncjarjle",
        "Event_type",
        "conference",
        "0 4 58 t",
        "•ou nejaole"
      ]
    }
  ]
}
