{
  "info": {
    "authors": [
      "Jeffrey Heinz",
      "James Rogers"
    ],
    "book": "ACL",
    "id": "acl-P10-1091",
    "title": "Estimating Strictly Piecewise Distributions",
    "url": "https://aclweb.org/anthology/P10-1091",
    "year": 2010
  },
  "references": [
    "acl-J94-3001",
    "acl-J95-4004",
    "acl-W97-1107"
  ],
  "sections": [
    {
      "text": [
        "Jeffrey Heinz James Rogers",
        "Newark, Delaware, USA Richmond, Indiana, USA",
        "Strictly Piecewise (SP) languages are a subclass of regular languages which encode certain kinds of long-distance dependencies that are found in natural languages.",
        "Like the classes in the Chomsky and Subregular hierarchies, there are many independently converging characterizations of the SP class (Rogers et al., to appear).",
        "Here we define SP distributions and show that they can be efficiently estimated from positive data."
      ]
    },
    {
      "heading": "1. Introduction",
      "text": [
        "Long-distance dependencies in natural language are of considerable interest.",
        "Although much attention has focused on long-distance dependencies which are beyond the expressive power of models with finitely many states (Chomsky, 1956; Joshi, 1985; Shieber, 1985; Kobele, 2006), there are some long-distance dependencies in natural language which permit finite-state characterizations.",
        "For example, although it is well-known that vowel and consonantal harmony applies across any arbitrary number of intervening segments (Ringen, 1988; Bakovic, 2000; Hansson, 2001; Rose and Walker, 2004) and that phonological patterns are regular (Johnson, 1972; Kaplan and Kay, 1994), it is less well-known that harmony patterns are largely characterizable by the Strictly Piecewise languages, a subregular class of languages with independently-motivated, converging characterizations (see Heinz (2007, to appear) and especially",
        "Rogers et al.",
        "(2009)).",
        "As shown by Rogers et al.",
        "(to appear), the Strictly Piecewise (SP) languages, which make distinctions on the basis of (potentially) discontiguous subsequences, are precisely analogous to the Strictly Local (SL) languages (McNaughton and Papert, 1971; Rogers and Pullum, to appear), which make distinctions on the basis of contiguous subsequences.",
        "The Strictly Local languages are the formal-language theoretic foundation for n-gram models (Garcia et al., 1990), which are widely used in natural language processing (NLP) in part because such distributions can be estimated from positive data (i.e. a corpus) (Jurafsky and Martin, 2008).",
        "N-gram models describe probability distributions over all strings on the basis of the Markov assumption (Markov, 1913): that the probability of the next symbol only depends on the previous contiguous sequence of length n – 1.",
        "From the perspective of formal language theory, these distributions are perhaps properly called Strictly k-Local distributions (SLk) where k = n. It is well-known that one limitation of the Markov assumption is its inability to express any kind of long-distance dependency.",
        "This paper defines Strictly k-Piecewise (SPk) distributions and shows how they too can be efficiently estimated from positive data.",
        "In contrast with the Markov assumption, our assumption is that the probability of the next symbol is conditioned on the previous set of discontiguous subsequences of length k – 1 in the string.",
        "While this suggests the model has too many parameters (one for each subset of all possible subsequences), in fact the model has on the order of |S|fc+1 parameters because of an independence assumption: there is no interaction between different subsequences.",
        "As a result, SP distributions are efficiently computable even though they condition the probability of the next symbol on the occurrences of earlier (possibly very distant) discontiguous subsequences.",
        "Essentially, these SP distributions reflect a kind of long-term memory.",
        "On the other hand, SP models have no short-term memory and are unable to make distinctions on the basis of contiguous subsequences.",
        "We do not intend SP models to replace n-gram models, but instead expect them to be used alongside of them.",
        "Exactly how this is to be done is beyond the scope of this paper and is left for future research.",
        "Since SP languages are the analogue ofSL languages, which are the formal-language theoretical foundation for n-gram models, which are widely used in NLP, it is expected that SP distributions and their estimation will also find wide application.",
        "Apart from their interest to problems in theoretical phonology such as phonotactic learning (Coleman and Pierrehumbert, 1997; Hayes and Wilson, 2008; Heinz, to appear), it is expected that their use will have application, in conjunction with n-gram models, in areas that currently use them; e.g. augmentative communication (Newell et al., 1998), part of speech tagging (Brill, 1995), and speech recognition (Jelenik, 1997).",
        "§2 provides basic mathematical notation.",
        "§3 provides relevant background on the subregular hierarchy.",
        "§4 describes automata-theoretic characterizations of SP languages.",
        "§5 defines SP distributions.",
        "§6 shows how these distributions can be efficiently estimated from positive data and provides a demonstration.",
        "§7 concludes the paper."
      ]
    },
    {
      "heading": "2. Preliminaries",
      "text": [
        "We start with some mostly standard notation.",
        "S denotes a finite set of symbols and a string over 5 is a finite sequence of symbols drawn from that set.",
        "Sk, S^k, S^k, and S* denote all strings over this alphabet of length k, of length less than or equal to k, of length greater than or equal to k, and of any finite length, respectively.",
        "e denotes the empty string.",
        "|w| denotes the length of string w. The prefixes of a string w are Pfx(w) = {v : 3u G S* such that vu = w}.",
        "When discussing partial functions, the notation j and | indicates that the function is undefined, respectively is defined, for particular arguments.",
        "A language L is a subset of S*.",
        "A stochastic language V is a probability distribution over S*.",
        "The probability p of word w with respect to V is written PrD (w) = p. Recall that all distributions V must satisfy PrD(w) = 1.",
        "If L is language then Prv (L) = £weL Prv(w).",
        "A Deterministic Finite-state Automaton (DFA) is a tuple M = (Q, S, q0,6, F) where Q is the state set, S is the alphabet, qo is the start state, 6 is a deterministic transition function with domain Q x S and codomain Q, F is the set of accepting states.",
        "Let d : Q x S* – Q be the (partial) path function of M, i.e., d(q,w) is the (unique) state reachable from state q via the sequence w, if any, or d(q,w)j otherwise.",
        "The language recognized by a DFA M is L(M) = {w G S* | d(qo,w)|G F}.",
        "A state is useful iff for all q G Q, there exists w G S* such that 6(q0, w) = q and there exists w G S* such that 6(q, w) G F. Useless states are not useful.",
        "DFAs without useless states are trimmed.",
        "Two strings w and v over S are distinguished by a DFA Miff d (qo, w) = d (qo, v).",
        "They are Nerode equivalent with respect to a language L if and only if wu G L vu G L for all u G S*.",
        "All DFAs which recognize L must distinguish strings which are inequivalent in this sense, but no DFA recognizing L necessarily distinguishes any strings which are equivalent.",
        "Hence the number of equivalence classes of strings over S modulo Nerode equivalence with respect to L gives a (tight) lower bound on the number ofstates required to recognize L.",
        "A DFA is minimal if the size of its state set is minimal among DFAs accepting the same language.",
        "The product of n DFAs M1... Mn is given by the standard construction over the state space Q1 x ... x Qn (Hopcroft et al., 2001).",
        "A Probabilistic Deterministic Finite-state Automaton (PDFA) is a tuple M = (Q, S,q0,6, F,T) where Q is the state set, S is the alphabet, q0 is the start state, 6 is a deterministic transition function, F and T are the final-state and transition probabilities.",
        "In particular, T : Q x S – R+ and F : Q – R+ such that",
        "Like DFAs, for all w G S*, there is at most one state reachable from q0.",
        "PDFAs are typically represented as labeled directed graphs as in Figure 1.",
        "A PDFA M generates a stochastic language Vm .",
        "If it exists, the (unique) path for a word w = o0 .",
        ".",
        ".",
        "ok belonging to S* through a PDFA is a sequence ((q0,00), (qi, oi ),..., (qk, Ok )), where qi+1 = 6(qj, Oi).",
        "The probability a PDFA assigns to w is obtained by multiplying the transition probabilities with the final probability along w's path if be the normalization term; and",
        "Figure 1: A picture of a PDFA with states labeled A and B.",
        "The probabilities of T and F are located to the right of the colon.",
        "it exists, and zero otherwise.",
        "A probability distribution is regular deterministic iff there is a PDFA which generates it.",
        "The structural components of a PDFA M are its states Q, its alphabet S, its transitions 6, and its initial state q0.",
        "By structure of a PDFA, we mean its structural components.",
        "Each PDFA M defines a family of distributions given by the possible instantiations of T and F satisfying Equation 1.",
        "These distributions have |Q|- (|S| + 1) independent parameters (since for each state there are | S| possible transitions plus the possibility of finality.)",
        "We define the product of PDFA in terms of co-emission probabilities (Vidal et al., 2005a).",
        "Definition 1 Let A be a vector of PDFAs and let |A| = n. For each 1 < i < n let Mi = (Qi; S, q0i, 6i; Fi, Ti) be the ith PDFA in A.",
        "The probability that a is co-emitted from q1,..., qn in Qb ..., Qn, respectively, is",
        "CT((a,q1 ... qn)) = JITi(qi,a).",
        "Similarly, the probability that a word simultaneously ends at q1 G Q1 .",
        ".",
        ".",
        "qn G Qn is",
        "CF ((q1 ... qn)) = Il Fi(qi).",
        "1.",
        "Q, q0, and 6 are defined as with DFAproduct.",
        "(b) for all a G S, let",
        "In other words, the numerators of T and F are defined to be the co-emission probabilities (Vidal et al., 2005a), and division by Z ensures that M defines a well-formed probability distribution.",
        "Statistically speaking, the co-emission product makes an independence assumption: the probability of a being co-emitted from q1;..., qn is exactly what one expects if there is no interaction between the individual factors; that is, between the probabilities of a being emitted from any qi.",
        "Also note order of product is irrelevant up to renaming of the states, and so therefore we also speak of taking the product of a set of PDFAs (as opposed to an ordered vector).",
        "Estimating regular deterministic distributions is well-studied problem (Vidal et al., 2005a; Vidal et al., 2005b; de la Higuera, in press).",
        "We limit discussion to cases when the structure of the PDFA is known.",
        "Let S be a finite sample of words drawn from a regular deterministic distribution V. The problem is to estimate parameters T and F of M so that Vm approaches V. We employ the widely-adopted maximum likelihood (ML) criterion for this estimation.",
        "It is well-known that if V is generated by some PDFA M' with the same structural components as M, then optimizing the ML estimate guarantees that Vm approaches V as the size of S goes to infinity (Vidal et al., 2005a; Vidal et al., 2005b; de la Higuera, in press).",
        "The optimization problem (3) is simple for deterministic automata with known structural components.",
        "Informally, the corpus is passed through the PDFA, and the paths of each word through the corpus are tracked to obtain counts, which are then normalized by state.",
        "Let M = (Q, S, 6, q0, F, T) be the PDFA whose parameters F and T are to be estimated.",
        "For all states q G Q and symbols o G S, The ML estimation of the probability of T (q, o) is obtained by dividing the number of times this transition is used in parsing the sample S by the",
        "S = {ob, 660, e, cob, ocb, cc}.",
        "LT PT Prop",
        "number of times state q is encountered in the parsing of S. Similarly, the ML estimation of F(q) is obtained by calculating the relative frequency of state q being final with state q being encountered in the parsing of S. For both cases, the division is normalizing; i.e. it guarantees that there is a well-formed probability distribution at each state.",
        "Figure 2 illustrates the counts obtained for a machine M with sample S = {ob,bbo,e,cob,ocb,cc}.Figure 1 shows the PDFA obtained after normalizing these counts."
      ]
    },
    {
      "heading": "3. Subregular Hierarchies",
      "text": [
        "Within the class of regular languages there are dual hierarchies of language classes (Figure 3), one in which languages are defined in terms of their contiguous substrings (up to some length k, known as k-factors), starting with the languages that are Locally Testable in the Strict Sense (SL), and one in which languages are defined in terms of their not necessarily contiguous subsequences, starting with the languages that are Piecewise Testable in the Strict Sense (SP).",
        "Each language class in these hierarchies has independently motivated, converging characterizations and each has been claimed to correspond to specific, fundamental cognitive capabilities (McNaughton and Pa-pert, 1971; Brzozowski and Simon, 1973; Simon, 1975; Thomas, 1982; Perrin and Pin, 1986; Garcia and Ruiz, 1990; Beauquier and Pin, 1991; Straub-ing, 1994; Garcia and Ruiz, 1996; Rogers and Pul-lum, to appear; Kontorovich et al., 2008; Rogers et al., to appear).",
        "Languages in the weakest of these classes are defined only in terms of the set of factors (SL) or subsequences (SP) which are licensed to occur in the string (equivalently the complement of that set with respect to S-k, the forbidden factors or forbidden subsequences).",
        "For example, the set containing the forbidden 2-factors {ob, bo} defines a Strictly 2-Local language which includes all strings except those with contiguous substrings { ob, bo}.",
        "Similarly since the parameters of n-gram models (Jurafsky and Martin, 2008) assign probabilities to symbols given the preceding contiguous substrings up to length n – 1, we say they describe Strictly n-Local distributions.",
        "These hierarchies have a very attractive model-theoretic characterization.",
        "The Locally Testable (LT) and Piecewise Testable languages are exactly those that are definable by propositional formulae in which the atomic formulae are blocks of symbols interpreted factors (LT) or subsequences (PT) of the string.",
        "The languages that are testable in the strict sense (SL and SP) are exactly those that are definable by formulae of this sort restricted to conjunctions of negative literals.",
        "Going the other way, the languages that are definable by First-Order formulae with adjacency (successor) but not precedence (less-than) are exactly the Locally Threshold Testable (LTT) languages.",
        "The Star-Free languages are those that are First-Order definable with precedence alone (adjacency being FO definable from precedence).",
        "Finally, by extending to Monadic Second-Order formulae (with either signature, since they are MSO definable from each other), one obtains the full class of Regular languages (McNaughton and Papert, 1971; Thomas, 1982; Rogers and Pullum, to appear; Rogers et al., to appear).",
        "The relation between strings which is fundamental along the Piecewise branch is the subse- quence relation, which is a partial order on S*:",
        "w Ç v 4del- w = e or w = a1 • • • an and (3w0, ...,wn G S*)[v = w0a1w1 • • • anwn].",
        "in which case we say w is a subsequence of v.",
        "For w G S*, let the set of subsequences of length k, respectively length no greater than k, of w. Let Pk(L) and P-k(L) be the natural extensions of these to sets of strings.",
        "Note that P0 (w) = {e}, for all w G S*, that P1 (w) is the set of symbols occurring in w and that P-k(L) is finite, for all L Ç S*.",
        "Similar to the Strictly Local languages, Strictly Piecewise languages are defined only in terms of the set of subsequences (up to some length k) which are licensed to occur in the string.",
        "Definition 2 (SPk Grammar, SP) A SPk grammar is a pair G = (S,G) where G Ç Sk.",
        "The language licensed by a SPk grammar is",
        "L(G ) =f {w G S* | Pk (w) Ç Pk (G)}.",
        "A language is SPk iff it is L(G) for some SPk grammar G. It is SP iff it is SPk for some k.",
        "This paper is primarily concerned with estimating Strictly Piecewise distributions, but first we examine in greater detail properties of SP languages, in particular DFA representations."
      ]
    },
    {
      "heading": "4. DFA representations of SP Languages",
      "text": [
        "we call the set of strings that contain w as a subsequence the principal shuffle ideal of w:",
        "SI(w) = {v G S* | w Ç v}.",
        "The shuffle ideal of a set of strings is defined as",
        "Rogers et al.",
        "(to appear) establish that the SP languages have a variety of characteristic properties.",
        "Theorem 1 The following are equivalent:",
        "4. w G L and v Ç w => v G L (L is subsequence closed),",
        "5.",
        "L = SI(X), X Ç S* (L is the complement of a shuffle ideal).",
        "The DFA representation of the complement of a shuffle ideal is especially important.",
        "qi otherwise.",
        "Then -MS1^ is a minimal, trimmed DFA that recognizes the complement of Sl(w), i.e., Sl(w) =",
        "Figure 4 illustrates the DFA representation of the complement ofSI(oo) with S = {o, b, c}.",
        "It is easy to verify that the machine in Figure 4 accepts all and only those words which do not contain an oo subsequence.",
        "For any SPk language L = L((S,G)) = S*, the first characterization (1) in Theorem 1 above yields a non-deterministic finite-state representation of L, which is a set A of DFA representations of complements of principal shuffle ideals of the elements of G. The trimmed automata product of this set yields a DFA, with the properties below (Rogers et al., to appear).",
        "Lemma 2 Let M be a trimmed DFA recognizing a SPk language constructed as described above.",
        "1.",
        "All states ofM are accepting states: F = Q.",
        "Figure 5 : The DFA representation of the of the SP language given by G = ({a,b,c}, {aa,bc}).",
        "Names of the states reflect subsets of subsequences up to length 1 of prefixes of the language.",
        "Note this DFA is trimmed, but not minimal.",
        "2.",
        "For all q1,q2 G Q and a G S, if d(q^a)j and d(q1,w) = q2 for some w G S* then d(q2, a)j.",
        "(Missing edges propagate down.)",
        "Figure 5 illustrates with the DFA representation of the of the SP2 language given by G = ({a, b, c}, {aa, be}).",
        "It is straightforward to verify that this DFA is identical (modulo relabeling of state names) to one obtained by the trimmed product of the DFA representations of the complement of the principal shuffle ideals of oo and bc, which are the prohibited subsequences.",
        "States in the DFA in Figure 5 correspond to the subsequences up to length 1 of the prefixes of the language.",
        "With this in mind, it follows that the",
        "DFA of S* = L(S, Sk) has states which correspond to the subsequences up to length k – 1 of the prefixes of S*.",
        "Figure 6 illustrates such a DFA when k = 2 and S = {o, b, c}.",
        "In fact, these DFAs reveal the differences between SP languages and PT languages: they are exactly those expressed in Lemma 2.",
        "Within the state space defined by the subsequences up to length k – 1 of the prefixes of the language, if the conditions in Lemma 2 are violated, then the DFAs describe languages that are PT but not SP.",
        "Pictorially, PT2 languages are obtained by arbitrarily removing arcs, states, and the finality of states from the DFA in Figure 6, and SP2 ones are obtained by non-arbitrarily removing them in accordance with Lemma 2.",
        "The same applies straightforwardly for any k (see Definition 3 below).",
        "Figure 6: A DFA representation of the of the SP2 language given by G = ({o, b, c}, S).",
        "Names of the states reflect subsets of subsequences up to length 1 of prefixes of the language.",
        "Note this DFA is trimmed, but not minimal."
      ]
    },
    {
      "heading": "5. SP Distributions",
      "text": [
        "In the same way that SL distributions (n-gram models) generalize SL languages, SP distributions generalize SP languages.",
        "Recall that SP languages are characterizable by the intersection of the complements of principal shuffle ideals.",
        "SP distributions are similarly characterized.",
        "We begin with Piecewise-Testable distributions.",
        "Definition 3 A distribution V is k-Piecewise Testable (written V G PTDk) V can be described by a PDFA M = (Q, S, q0, 6, F, T) with 4.",
        "F and T satisfy Equation 1.",
        "In other words, a distribution is k-Piecewise Testable provided it can be represented by a PDFA whose structural components are the same (modulo renaming of states) as those of the DFA discussed earlier where states corresponded to the subsequences up to length k – 1 of the prefixes of the language.",
        "The DFA in Figure 6 shows the structure of a PDFA which describes a PT2 distribution as long as the assigned probabilities satisfy Equation 1.",
        "The following lemma follows directly from the finite-state representation of PTk distributions.",
        "Lemma 3 Let V belong to PTDk and let A4 =",
        "( Q, S , q0 , 6, F, T) be a PDFA representing V defined according to Definition 3.",
        "PTk distributions have 2lslfc (|S| + 1) parameters (since there are 2'sl states and |S| + 1 possible events, i.e. transitions and finality).",
        "Let Pr(a | #) and Pr(# | P-k(w)) denote the probability (according to some V G PTDk) that a word begins with a and ends after observing P-k(w).",
        "Then Equation 4 can be rewritten in terms of conditional probability as",
        "Thus, the probability assigned to a word depends not on the observed contiguous sequences as in a Markov model, but on observed subsequences.",
        "Like SP languages, SP distributions can be defined in terms of the product of machines very similar to the complement of principal shuffle ideals.",
        "distinguishing PDFA (w-SD-PDFA) iff 6(u, a) = ua iffua G Pfx(w) and u otherwise and F and T satisfy Equation 1.",
        "Figure 7 shows the structure of Ma which is almost the same as the complement of the principal shuffle ideal in Figure 4.",
        "The only difference is the additional self-loop labeled o on the rightmost state labeled o. Ma defines a family of distributions over S*, and its states distinguish those",
        "Figure 7: The structure of PDFA Ma.",
        "It is the same (modulo state names) as the DFA in Figure 4 except for the self-loop labeled o on state o.",
        "strings which contain o (state o) from those that do not (state e).",
        "A set of PDFAs is a k-set ofSD-PDFAs iff, for each w G S-k_, it contains exactly one w-SD-PDFA.",
        "In the same way that missing edges propagate down in DFA representations of SP languages (Lemma 2), the final and transitional probabilities must propagate down in PDFA representations of SPk distributions.",
        "In other words, the final and transitional probabilities at states further along paths beginning at the start state must be determined by final and transitional probabilities at earlier states non-increasingly.",
        "This is captured by defining SP distributions as a product of k-sets of SD-PDFAs (see Definition 5 below).",
        "While the standard product based on co-emission probability could be used for this purpose, we adopt a modified version of it defined for k-sets of SD-PDFAs: the positive co-emission probability.",
        "The automata product based on the positive co-emission probability not only ensures that the probabilities propagate as necessary, but also that such probabilities are made on the basis of observed subsequences, and not unobserved ones.",
        "This idea is familiar from n-gram models: the probability of an given the immediately preceding sequence a1 .",
        ".",
        ".",
        "an_1 does not depend on the probability of an given the other (n – 1)-long sequences which do not immediately precede it, though this is a logical possibility.",
        "Let A be a k-set of SD-PDFAs.",
        "For each w G S-k_, let Mw = (Qw, S,q0w,6«,,F«,T«) be the w-subsequence-distinguishing PDFA in A.",
        "The positive co-emission probability that a is simultaneously emitted from states qe,..., qu from the statesets Qe,... Qu, respectively, of each SD-",
        "PDFA in A is",
        "Similarly, the probability that a word simultaneously ends at n states qe G Qe,..., qu G Qu is",
        "In other words, the positive co-emission probability is the product of the probabilities restricted to those assigned to the maximal states in each Mw.",
        "For example, consider a 2-set of SD-PDFAs A with S = { o, b, c} .",
        "A contains four PDFAs Me, Ma, Mb, Mc.",
        "Consider state q = ( e, e, b, c) G A (this is the state labeled e, b, c in Figure 6).",
        "Then since in PDFA Ma, the state e is not the maximal state.",
        "The positive co-emission product (<g>+) is defined just as with co-emission probabilities, substituting PCT and PCF for CT and CF, respectively, in Definition 1.",
        "The definition of ®+ ensures that the probabilities propagate on the basis of observed subsequences, and not on the basis of unobserved ones.",
        "Lemma 4 Let k > 1 and let A be a k-set of SD-PDFAs.",
        "Then ®+S defines a well-formed probability distribution over S*.",
        "Proof Since Me belongs to A, it is always the case that PCT and PCF are defined.",
        "Well-formedness follows from the normalization term as in Definition 1.",
        "H Definition 5 A distribution V is k-Strictly Piecewise (written V G SPDfc) V can be described by a PDFA which is the positive co-emission product ofa k-set ofsubsequence-distinguishing PDFAs.",
        "By Lemma 4, SP distributions are well-formed.",
        "Unlike PDFAs for PT distributions, which distinguish 2|S| states, the number of states in a k-set of SD-PDFAs is £i<k(i + 1)|S|i, which is 9(|S|k+).",
        "Furthermore, since each SD-PDFA only has one state contributing | S| +1 probabilities to the product, and since there are |£- | = many SD-PDFAs in a k-set, there are",
        "lslfc+l + lslfc_lsl_1",
        "parameters, which is 6(|S|k).",
        "Lemma 5 Let V G SPDk.",
        "Then V G PTDk.",
        "Proof Since V G SPDk, there is a k-set of subsequence-distinguishing PDFAs.",
        "The product of this set has the same structure as the PDFA given in Definition 3.",
        "H Theorem 2 A distribution V G SPDk ifV can be described by a PDFA M = (Q, S, q0, 6, F, T) satisfying Definition 3 and the following.",
        "For all w G S* and all a G S, let (This is the normalization term.)",
        "Then T must satisfy: T(P-k_1(w),a) = Proof That SPDk satisfies Definition 3 Follows directly from Lemma 5.",
        "Equations 8-10 follow from the definition of positive co-emission probability.",
        "H",
        "The way in which final and transitional probabilities propagate down in SP distributions is reflected in the conditional probability as defined by Equations 9 and 10.",
        "In terms of conditional probability, Equations 9 and 10 mean that the probability that ai follows a sequence a1 .",
        ".",
        ".",
        "ai_1 is not only a function of P-k_1(a1... ai_1) (Equation 4) but further that it is a function of each subsequence in a1... ai_1 up to length k – 1.",
        "In particular, Pr(ai | P-k_1(a1 .",
        ".",
        ".",
        "ai_1)) is obtained by substituting Pr(ai | P k_1(s)) for T(P- k_1(s),a) and Pr(# | P k_1(s)) for F(P-k_1(s)) in Equations 8, 9 and 10.",
        "For example, for a SP2 distribution, the probability of o given P-1(bc) (state e, b, c in Figure 6) is the normalized product of the probabilities of o given P-1(e), o given P-1(b), and o given P-1 (c).",
        "To summarize, SP and PT distributions are regular deterministic.",
        "Unlike PT distributions, however, SP distributions can be modeled with only 9(|S|k) parameters and 9(|S|k+) states.",
        "This is true even though SP distributions distinguish 2|S| states!",
        "Since SP distributions can be represented by a single PDFA, computing Pr(w) occurs in only 0(|w|) for such PDFA.",
        "While such PDFA might be too large to be practical, Pr(w) can also be computed from the k-set ofSD-PDFAs in 6(|w|k) (essentially building the path in the product machine on the fly using Equations 4, 8, 9 and 10)."
      ]
    },
    {
      "heading": "6. Estimating SP Distributions",
      "text": [
        "The problem of ML estimation of SPk distributions is reduced to estimating the parameters ofthe SD-PDFAs.",
        "Training (counting and normalization) occurs over each of these machines (i.e. each machine parses the entire corpus), which gives the ML estimates ofthe parameters ofthe distribution.",
        "It trivially follows that this training successfully estimates any V G SPDk.",
        "Theorem 3 For any V G SPDk, let V generate sample S. Let A be the k-set ofSD-PDFAs which describes exactly V. Then optimizing the MLE of S with respect to each M G A guarantees that the distribution described by the positive co-emission product of + A approaches V as | S| increases.",
        "Proof The MLE estimate of S with respect to SPDk returns the parameter values that maximize the likelihood of S. The parameters of V G SPDk are found on the maximal states of each M G A.",
        "By definition, each M G A describes a probability distribution over S*, and similarly defines a family of distributions.",
        "Therefore finding the MLE of S with respect to SPDk means finding the MLE estimate of S with respect to each of the family of distributions which each M G A defines, respectively.",
        "Optimizing the ML estimate of S for each M G A means that as |S | increases, the estimates Tm and Fm approach the true values Tm and",
        "Fm.",
        "It follows that as |S | increases, A and F(g>+ a approach the true values of A and F(g>+ a and consequently V^+ a approaches V. H",
        "We demonstrate learning long-distance dependencies by estimating SP2 distributions given a corpus from Samala (Chumash), a language with sibilant harmony.",
        "There are two classes of sibilants in Samala: [-anterior] sibilants like [s] and [ts] and [+anterior] sibilants like [f] and [tf].Samala words are subject to a phonological process wherein the last sibilant requires earlier sibilants to have the same value for the feature [anterior], no matter how many sounds intervene (Applegate, 1972).",
        "As a consequence of this rule, there are generally no words in Samala where [-anterior] sibilants follow [+anterior].",
        "E.g. [ftojonowonowaf] 'it stood upright' (Applegate 1972:72) is licit but not *[f tojonowonowas].",
        "The results of estimating V G SPD2 with the corpus is shown in Table 6.",
        "The results clearly demonstrate the effectiveness ofthe model: the probability of a [a anterior] sibilant given P-1([-a anterior]) sounds is orders of magnitude less than given P-1(a anterior]) sounds."
      ]
    },
    {
      "heading": "7. Conclusion",
      "text": [
        "SP distributions are the stochastic version of SP languages, which model long-distance dependencies.",
        "Although SP distributions distinguish 2|S|states, they do so with tractably many parameters and states because of an assumption that distinct subsequences do not interact.",
        "As shown, these distributions are efficiently estimable from positive data.",
        "As previously mentioned, we anticipate these models to find wide application in NLP.",
        "X",
        "Pr(x 1 P<i(y))",
        "s",
        "ts",
        "J",
        "?",
        "s",
        "0.0335",
        "0.0051",
        "0.0011",
        "0.0002",
        "ts",
        "0.0218",
        "0.0113",
        "0.0009",
        "0.",
        "y",
        "J",
        "0.0009",
        "0.",
        "0.0671",
        "0.0353",
        "tf",
        "0.0006",
        "0.",
        "0.0455",
        "0.0313"
      ]
    }
  ]
}
