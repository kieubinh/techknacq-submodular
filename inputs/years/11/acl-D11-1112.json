{
  "info": {
    "authors": [
      "Mark-Jan Nederhof",
      "Giorgio Satta"
    ],
    "book": "EMNLP",
    "id": "acl-D11-1112",
    "title": "Computation of Infix Probabilities for Probabilistic Context-Free Grammars",
    "url": "https://aclweb.org/anthology/D11-1112",
    "year": 2011
  },
  "references": [
    "acl-C92-2065",
    "acl-C92-2066",
    "acl-J91-3004",
    "acl-J95-2002",
    "acl-J98-2005",
    "acl-J99-1004",
    "acl-P87-1015",
    "acl-P99-1070"
  ],
  "sections": [
    {
      "text": [
        "of Information Engineering University of Padua Italy",
        "satta@dei.unipd.it",
        "The notion of infix probability has been introduced in the literature as a generalization of the notion of prefix (or initial substring) probability, motivated by applications in speech recognition and word error correction.",
        "For the case where a probabilistic context-free grammar is used as language model, methods for the computation of infix probabilities have been presented in the literature, based on various simplifying assumptions.",
        "Here we present a solution that applies to the problem in its full generality."
      ]
    },
    {
      "heading": "1. Introduction",
      "text": [
        "Probabilistic context-free grammars (PCFGs for short) are a statistical model widely used in natural language processing.",
        "Several computational problems related to PCFGs have been investigated in the literature, motivated by applications in modeling of natural language syntax.",
        "One such problem is the computation of prefix probabilities for PCFGs, where we are given as input a PCFG G and a string w, and we are asked to compute the probability that a sentence generated by G starts with w, that is, has w as a prefix.",
        "This quantity is defined as the possibly infinite sum of the probabilities of all strings of the form wx, for any string x over the alphabet of G.",
        "The problem of computation of prefix probabilities for PCFGs was first formulated by Persoon and Fu (1975).",
        "Efficient algorithms for its solution have been proposed by Jelinek and Lafferty (1991) and Stolcke (1995).",
        "Prefix probabilities can be used to compute probability distributions for the next word or part-of-speech, when a prefix of the input has already been processed, as discussed by Jelinek and Lafferty (1991).",
        "Such distributions are useful for speech recognition, where the result of the acoustic processor is represented as a lattice, and local choices must be made for a next transition.",
        "In addition, distributions for the next word are also useful for applications of word error correction, when one is processing 'noisy' text and the parser recognizes an error that must be recovered by operations of insertion, replacement or deletion.",
        "Motivated by the above applications, the problem of the computation of inix probabilities for PCFGs has been introduced in the literature as a generalization of the prefix probability problem.",
        "We are now given a PCFG G and a string w, and we are asked to compute the probability that a sentence generated by G has w as an infix.",
        "This probability is defined as the possibly infinite sum of the probabilities of all strings of the form xwy, for any pair of strings x and y over the alphabet of G. Besides applications in computation of the probability distribution for the next word token and in word error correction, infix probabilities can also be exploited in speech understanding systems to score partial hypotheses in algorithms based on beam search, as discussed by Corazzaetal.",
        "(1991).",
        "Corazza et al.",
        "(1991) have pointed out that the computation of infix probabilities is more difficult than the computation of prefix probabilities, due to the added ambiguity that several occurrences of the given infix can be found in a single string generated by the PCFG.",
        "The authors developed solutions for the case where some distribution can be defined on the distance of the infix from the sentence boundaries, which is a simplifying assumption.",
        "The problem is also considered by Fred (2000), which provides algorithms for the case where the language model is a probabilistic regular grammar.",
        "However, the algorithm in (Fred, 2000) does not apply to cases with multiple occurrences of the given infix within a string in the language, which is what was pointed out to be the problematic case.",
        "In this paper we adopt a novel approach to the problem of computation of inix probabilities, by removing the ambiguity that would be caused by multiple occurrences of the given inix.",
        "Although our result is obtained by a combination of well-known techniques from the literature on PCFG parsing and pattern matching, as far as we know this is the irst algorithm for the computation of inix probabilities that works for general PCFG models without any restrictive assumption.",
        "The remainder of this paper is structured as follows.",
        "In Section 2 we explain how the sum of the probabilities of all trees generated by a PCFG can be computed as the least ixed-point solution of a non-linear system of equations.",
        "In Section 3 we recall the construction of a new PCFG out of a given PCFG and a given inite automaton, such that the language generated by the new grammar is the intersection of the languages generated by the given PCFG and the automaton, and the probabilities of the generated strings are preserved.",
        "In Section 4 we show how one can eficiently construct an unambiguous inite automaton that accepts all strings with a given inix.",
        "The material from these three sections is combined into a new algorithm in Section 5, which allows computation of the infix probability for PCFGs.",
        "This is the main result of this paper.",
        "Several extensions of the basic technique are discussed in Section 6.",
        "Section 7 discusses implementation and some experiments."
      ]
    },
    {
      "heading": "2. Sum of probabilities of all derivations",
      "text": [
        "Assume a probabilistic context-free grammar G, represented by a 5-tuple (E, N, S, R, p), where E and N are two finite disjoint sets of terminals and nonterminals, respectively, S G N is the start symbol, R is a finite set of rules, each of the form A – a, where A G N and a G (EU N)*, and p is a function from rules in R to real numbers in the interval [0,1].",
        "The concept of leftmost derivation in one step is represented by the notation a ==g ß, which means that the leftmost occurrence of any nonterminal in a G (E U N)* is rewritten by means of some rule n G R. If the rewritten nonterminal is A, then n must be of the form (A – 7) and ß is the result of replacing the occurrence of A in a by 7.",
        "A leftmost derivation with any number of steps, using a sequence d of rules, is denoted as a ==g ß.",
        "We omit the subscript G when the PCFG is understood.",
        "We also write a =* ß when the involved sequence of rules is of no relevance.",
        "Henceforth, all derivations we discuss are implicitly left-most.",
        "A complete derivation is either the empty sequence of rules, or a sequence d = n\\ • • • nm, m > 1, of rules such that A == w for some A G N and w G E*.",
        "In the latter case, we say the complete derivation starts with A, and in the former case, with d an empty sequence of rules, we assume the complete derivation starts and ends with a single terminal, which is left unspeciied.",
        "It is well-known that there exists a bijective correspondence between leftmost complete derivations starting with nonterminal A and parse trees derived by the grammar with root A and a yield composed of terminal symbols only.",
        "The depth of a complete derivation d is the length of the longest path from the root to a leaf in the parse tree associated with d. The length of a path is defined as the number of nodes it visits.",
        "Thus if d = n for some rule n = (A – w) with w G E*, then the depth of d is 2.",
        "The probability p(d) of a complete derivation d = n\\ • • • nm, m > 1, is:",
        "We also assume that p(d) = 1 when d is an empty sequence of rules.",
        "The probability p(w) of a string w is the sum of all complete derivations deriving that string from the start symbol:",
        "P(w) = E P(d).",
        "With this notation, consistency of a PCFG is defined as the condition:",
        "1.",
        "In other words, a PCFG is consistent if the sum of probabilities of all complete derivations starting with S is 1.",
        "An equivalent definition of consistency considers the sum of probabilities of all strings:",
        "See (Booth and Thompson, 1973) for further discussion.",
        "In practice, PCFGs are often required to satisfy the additional condition:",
        "for each A G N. This condition is called properness.",
        "PCFGs that naturally arise by parameter estimation from corpora are generally consistent; see (Sanchez and Benedi, 1997; Chi and Geman, 1998).",
        "However, in what follows, neither properness nor consistency is guaranteed.",
        "We define the partition function of G as the function Z that assigns to each A G N the value",
        "Z(A) = E P(A 4 w).",
        "For each k with 1 < k < |N|, the generating function associated with Ak is defined as",
        "Furthermore, for each i > 1 we recursively define functions gAk(zi, Z2,..., Z|n|) by",
        "gAi2~1)(Zl,Z2,...,Z|N |),.. gA-v1)(Z1,Z2,...,Z|N|) ).",
        "Using induction it is not difficult to show that, for each k and i as above, gAk (0,0,..., 0) is the sum of the probabilities of all complete derivations from Akhaving depth not exceeding i.",
        "This implies that, for i = 0,1,2,..the sequence of the (0,0,..., 0) monotonically converges to Z (Ak ).",
        "For each k with 1 < k < | N| we can now write = gAk (Z (A1),...,Z (A|n |)).",
        "The above shows that the values of the partition function provide a solution to the system of the following equations, for 1 < k < | N| :",
        "Note that Z(S) = 1 means that G is consistent.",
        "More generally, in later sections we will need to compute the partition function for non-consistent",
        "PCFGs.",
        "We can characterize the partition function of a PCFG as a solution of a speciic system of equations.",
        "Following the approach in (Harris, 1963; Chi, 1999), we introduce generating functions associated with the nonterminals of the grammar.",
        "For A G N and a G (N U we write f (A, a) to denote the number of occurrences of symbol A within string a.",
        "Let N = {A1, A2,..., A|N|}.",
        "For each Ak G N,let mk be the number of rules in R with left-hand side Ak, and assume some fixed order for these rules.",
        "For each i with 1 < i < mk, let Ak – > ak;i be the i-th rule with left-hand side Ak.",
        "gAk (Z1,Z2 ,...,Z|N |).",
        "In the case of a general PCFG, the above equations are non-linear polynomials with positive (real) coeficients.",
        "We can represent the resulting system in vector form and write X = g(X).",
        "These systems are called monotone systems of polynomial equations and have been investigated by Etessami and Yannakakis (2009) and Kiefer et al.",
        "(2007).",
        "The sought solution, that is, the partition function, is the least ixed point solution of X = g(X).",
        "For practical reasons, the set of nonterminals of a grammar is usually divided into maximal subsets of mutually recursive nonterminals, that is, for each A and B in such a subset, we have A == uBa and B = vAß, for some u, v, a, ß.",
        "This corresponds to a strongly connected component if we see the connection between the left-hand side of a rule and a nonterminal member in its right-hand side as an edge in a directed graph.",
        "For each strongly connected component, there is a separate system of equations of the form X = g(X).",
        "Such systems can be solved one by one, in a bottom-up order.",
        "That is, if one strongly connected component contains nonterminal A, and another contains nonterminal B, where A == uBa for some u, a, then the system for the latter component must be solved irst.",
        "The solution for a system of equations such as those described above can be irrational and non-expressible by radicals, even if we assume that all the probabilities of the rules in the input PCFG are rational numbers, as observed by Etessami and Yan-nakakis (2009).",
        "Nonetheless, the partition function can still be approximated to any degree of precision by iterative computation of the relation in (4), as done for instance by Stolcke (1995) and by Ab-ney et al.",
        "(1999).",
        "This corresponds to the so-called ixed-point iteration method, which is well-known in the numerical calculus literature and is frequently applied to systems of non-linear equations because it can be easily implemented.",
        "When a number of standard conditions are met, each iteration of (4) adds a ixed number of bits to the precision of the solution; see Kelley (1995, Chapter 4).",
        "Since each iteration can easily be implemented to run in polynomial time, this means that we can approximate the partition function of a PCFG in polynomial time in the size of the PCFG itself and in the number of bits of the desired precision.",
        "In practical applications where large PCFGs are empirically estimated from data sets, the standard conditions mentioned above for the polynomial time approximation of the partition function are usually met.",
        "However, there are some degenerate cases for which these standard conditions do not hold, resulting in exponential time behaviour of the ixed-point iteration method.",
        "This has been irstly observed in (Etessami and Yannakakis, 2005).",
        "An alternative iterative algorithm for the approximation of the partition function has been proposed by Etessami and Yannakakis (2009), based on Newton's method for the solution of non-linear systems of equations.",
        "From a theoretical perspective, Kiefer et al.",
        "(2007) have shown that, after a certain number of initial iterations, Newton's method adds a ixed number of bits to the precision of the approximated solution, even in the above mentioned cases in which the ixed-point iteration method shows exponential time behaviour.",
        "However, these authors also show that, in some degenerate cases, the number of iterations needed to compute the irst bit of the solution can be at least exponential in the size of the system.",
        "Experiments with Newton's method for the approximation of the partition functions of PCFGs have been carried out in several application-oriented settings, by Wojtczak and Etessami (2007) and by Nederhof and Satta (2008), showing considerable improvements over the ixed-point iteration method."
      ]
    },
    {
      "heading": "3. Intersection of PCFG and FA",
      "text": [
        "It was shown by Bar-Hillel et al.",
        "(1964) that context-free languages are closed under intersection with regular languages.",
        "Their proof relied on the construction of a new CFG out of an input CFG and an input inite automaton.",
        "Here we extend that construction by letting the input grammar be a probabilistic CFG.",
        "We refer the reader to (Nederhof and Satta, 2003) for more details.",
        "To avoid a number of technical complications, we assume the inite automaton has no epsilon transitions, and has only one inal state.",
        "In the context of our use of this construction in the following sections, these restrictions are without loss of generality.",
        "Thus, a finite automaton (FA) M is represented by a 5-tuple (E, Q, q0, qf, A), where E and Q are two inite sets of terminals and states, respectively, q0 is the initial state, qf is the final state, and A is a finite set of transitions, each of the form s – – t, where s, t G Q and a G E.",
        "A complete computation of M accepting string w = ai ■ ■ ■ an is a sequence c = n • • • r„ of transitions such that Tj = (si_i – s^) for each i (1 < i < n), for some s0, si, ..., sn with s0 = q0 and sn = qf.",
        "The language of all strings accepted by M is denoted by L(M).",
        "A FA is unambiguous if at most one complete computation exists for each accepted string.",
        "A FA is deterministic if there is at most one transition s – – t for each s and a.",
        "For a FA M as above and a PCFG G = (E, N, S, R, p) with the same set of terminals, we construct a new PCFG G' = (E, N', S', R', p'), where N' = Q x (E U N) x Q, S' = (q0, S, qf ), and R' is the set of rules that is obtained as follows.",
        "• For each A – > Xi ■ ■ ■ Xm in R and each sequence s0, ..., sm with si G Q, 0 < i < m, and m > 0, let (s0,A,sm) – (so,Xi,si) ■ ■ ■ ( sm_ i , Xm, sm) be in R'; if m = 0, the new rule is of the form (s0, A, s0) – e. Function p' assigns the same probability to the new rule as p assigned to the original rule.",
        "• For each s – – t in A, let (s, a,t) – a be in R'.",
        "Function p' assigns probability 1 to this rule.",
        "Intuitively, a rule of G' is either constructed out of a rule of G or out of a transition of M. On the basis of this correspondence between rules and transitions of G', G and M, it is not difficult to see that each derivation dd in G' deriving string w corresponds to a unique derivation d in G deriving the same string and a unique computation c in M accepting the same string.",
        "Conversely, if there is a derivation d in G deriving string w, and some computation c in M accepting the same string, then the pair of d and c corresponds to a unique derivation d' in G' deriving the same string w. Furthermore, the probabilities of d and dd are equal, by definition of p'.",
        "Let us now assume that each string w is accepted by at most one computation, i.e. M is unambiguous.",
        "If a string w is accepted by M, then there are as many derivations deriving w in G' as there are in G. If w is not accepted by M, then there are zero derivations deriving w in G'.",
        "Consequently:",
        "or more succinctly:",
        "p'(w) = p(w).",
        "Note that the above construction ofG' is exponential in the largest value of m in any rule from G. For this reason, G is usually brought in binary form before the intersection, i.e. the input grammar is transformed to let each right-hand side have at most two members.",
        "Such a transformation can be realized in linear time in the size ofthe grammar.",
        "We will return to this issue in Section 7."
      ]
    },
    {
      "heading": "4. Obtaining unambiguous FAs",
      "text": [
        "In the previous section, we explained that unambiguous finite automata have special properties with respect to the grammar G' that we may construct out of a FA M and a PCFG G. In this section we discuss how unambiguity can be obtained for the special case of finite automata accepting the language of all strings with given infix w G E* :",
        "Linfix(w) = {xwy | x,y G E*}.",
        "Any deterministic automaton is also unambiguous.",
        "Furthermore, there seem to be no practical algorithms that turn FAs into equivalent unambiguous FAs other than the algorithms that also determinize them.",
        "Therefore, we will henceforth concentrate on deterministic rather than unambiguous automata.",
        "Given a string w = ai ■ ■ ■ an, a finite automaton accepting Linfix (w) can be straightforwardly constructed.",
        "This automaton has states s0, .",
        ".",
        ".",
        ", sn, transitions s0 – – s0 and sn – – sn for each a G E, and transition sj_i – si for each i (1 < i < n).",
        "The initial state is s0 and the final state is sn.",
        "Clearly, there is nondeterminism in state s0.",
        "One way to make this automaton deterministic is to apply the general algorithm of determinization of finite automata; see e.g. (Aho and Ullman, 1972).",
        "This algorithm is exponential for general FAs.",
        "An alternative approach is to construct a deterministic finite automaton directly from w, in line with the Knuth-Morris-Pratt algorithm (Knuth et al., 1977; Gusfield, 1997).",
        "Both approaches result in the same deterministic FA, which we denote by Iw.",
        "However, the latter approach is easier to implement in such a way that the time complexity of constructing the automaton is linear in | w |.",
        "The automaton Iw is described as follows.",
        "There are n + 1 states to, • • •, tn, where as before n is the length of w. The initial state is t0 and the final state is tn.",
        "The intuition is that Iw reads a string x = bi • • • bm from left to right, and when it has read the prefix bi • • • bj (0 < j < m), it is in state ti (0 < i < n) if and only if ai • • • ai is the longest prefix of w that is also a suffix of bi • • • bj.",
        "If the automaton is in state tn, then this means that w is an infix of bi • • • bj.",
        "In more detail, for each i (1 < i < n) and each a G E, there is a transition ti-i A tj, where j is the length of the longest string that is both a prefix of w and a suffix of ai • • • ai-ia.",
        "If a = ai, then clearly j = i, and otherwise j < i.",
        "To ensure that we remain in the final state once an occurrence of infix w has been found, we also add transitions tn A tnfor each a G E. This construction is illustrated in Figure 1."
      ]
    },
    {
      "heading": "5. Infix probability",
      "text": [
        "With the material developed in the previous sections, the problem of computing the infix probabilities can be effectively solved.",
        "Our goal is to compute for given infix w G E* and PCFG G = (E, N, S, R, p):",
        "<7infix (w, G) = £ P(z).",
        "In Section 4 we have shown the construction of finite automaton Iw accepting Llnfix (w), by which we obtain:",
        "Omfix(w, G) = £ P(z).",
        "As Iw is deterministic and therefore unambiguous, the results from Section 3 apply and if G' = (E, N', p') is the PCFG constructed out of G and Iw",
        "Omfix(w, G) = £p'(z).",
        "Finally, we can compute the above sum by applying the iterative method discussed in Section 2."
      ]
    },
    {
      "heading": "6. Extensions",
      "text": [
        "The approach discussed above allows for a number of generalizations.",
        "First, we can replace the infix w by a sequence of infixes wi; ..., wm, which have to occur in the given order, one strictly after the other, with arbitrary infixes in between:",
        "£ p(xowiXi ••• wmXm).",
        "This problem was discussed before by (Corazza et al., 1991), who mentioned applications in speech recognition.",
        "Further applications are found in computational biology, but their discussion is beyond the scope of this paper; see for instance (Apostolico et al., 2005) and references therein.",
        "In order to solve the problem, we only need a small addition to the procedures we discussed before.",
        "First we construct separate automata lWj (1 < j < m) as explained in Section 4.",
        "These automata are then composed into a single automaton I(W1 ,_,Wm).",
        "In this composition, the outgoing transitions of the final state of IWj, for each j (1 < j < m), are removed and that final state is merged with the initial state of the next automaton 2Wj+1.",
        "The initial state of the composed automaton is the initial state of IW1, and the final state is the final state of 2Wm.",
        "The time costs of constructing I{Wl^^,wm) are linear in the sum of the lengths of the strings wj.",
        "Another way to generalize the problem is to replace w by a finite set L = {wi,..., wm}.",
        "The objective is to compute:",
        "Again, this can be solved by first constructing a deterministic FA, which is then intersected with G. This FA can be obtained by determinizing a straightforward nondeterministic FA accepting L, or by directly constructing a deterministic FA along the lines of the Aho-Corasick algorithm (Aho and Corasick, 1975).",
        "Construction of the automaton with the latter approach takes linear time.",
        "Further straightforward generalizations involve formalisms such as probabilistic tree adjoining grammars (Schabes, 1992; Resnik, 1992).",
        "The technique from Section 3 is also applicable in this case, as the construction from Bar-Hillel et al.",
        "(1964) carries over from context-free grammars to tree adjoining grammars, and more generally to the linear context-free rewriting systems of Vijay-Shanker et al.",
        "(1987)."
      ]
    },
    {
      "heading": "7. Implementation",
      "text": [
        "We have conducted experiments with the computation of infix probabilities.",
        "The objective was to identify parts of the computation that have a high time or space demand, and that might be improved.",
        "The experiments were run on a desktop with a 3.0 GHz Pentium 4 processor.",
        "The implementation language is C++.",
        "The set-up of the experiments is similar to that in (Nederhof and Satta, 2008).",
        "A probabilistic context-free grammar was extracted from sections 2-21 of the Penn Treebank version II.",
        "Subtrees that generated the empty string were systematically removed.",
        "The result was a CFG with 10,035 rules, 28 nonterminals and 36 parts-of-speech.",
        "The rule probabilities were determined by maximum likelihood estimation.",
        "The grammar was subsequently binarized, to avoid exponential behaviour, as explained in Section 3.",
        "We have considered 10 strings of length 7, randomly generated, assuming each of the parts-of-speech has the same probability.",
        "For all prefixes of those strings from length 2 to length 7, we then computed the infix probability.",
        "The duration of the full computation, averaged over the 10 strings of length 7, is given in the first row of Table 1.",
        "In order to solve the non-linear systems of equations, we used Broyden's method.",
        "It can be seen as an approximation of Newton's method.",
        "It requires more iterations, but seems to be faster overall, and more scalable to large problem sizes, due to the avoidance of matrix inversion, which sometimes makes Newton's method prohibitively expensive.",
        "In our experiments, Broyden's method was generally faster than Newton's method and much faster than the simple iteration method by the relation in (4).",
        "For further details on Broyden's method, we refer the reader to (Kelley, 1995).",
        "The main obstacle to computation for infixes substantially longer than 7 symbols is the memory consumption rather than the running time.",
        "This is due to the required square matrices, the dimension of which is the number of nonterminals.",
        "The number of nonterminals (of the intersection grammar) naturally grows as the infix becomes longer.",
        "As explained in Section 2, the problem is divided into smaller problems by isolating disjoint sets of mutually recursive nonterminals, or strongly connected components.",
        "We found that for the application to the automata discussed in Section 4, there were exactly three strongly connected components that contained more than one element, throughout the experiments.",
        "For an infix of length n, these components are:",
        "• Ci, which consists of nonterminals of the form (ti, A, tj), where i < n and j < n,",
        "• C2, which consists of nonterminals of the form (ti, A, tj), where i = j = n, and",
        "• C3, which consists of nonterminals of the form ( ti , A, tj ) , where i < j = n.",
        "This can be easily explained by looking at the structure of our automata.",
        "See for example Figure 1, with cycles running through states t0,..., tn-i, and cycles through state tn.",
        "Furthermore, the grammar extracted from the Penn Treebank is heavily recursive,",
        "Table 1: Running time for infixes from length 2 to length 7.",
        "The infixes are prefixes of 10 random strings of length 7, and reported CPU times (in seconds) are averaged over the 10 strings.",
        "so that almost every nonterminal can directly or indirectly call any other.",
        "The strongly connected component C2 is always the same, consisting of 2402 nonterminals, for each inix of any length.",
        "(Note that binarization of the grammar introduced artiicial nonterminals.)",
        "The last three rows of Table 1 present the time costs of Broyden s method, for the three strongly connected components.",
        "The strongly connected component C3 happens to correspond to a linear system of equations.",
        "This is because a rule in the intersection grammar with a left-hand side (ti,A,tj), where i < j = n, must have a right-hand side of the form (ti; A', tj), or of the form (ti, Ai, tk) (tk, A2, tj), with k < n. If k < n, then only the second member can be in C3.",
        "If k = n, only first member can be in C3.",
        "Hence, such a rule corresponds to a linear equation within the system of equations for the entire grammar.",
        "A linear system of equations can be solved analytically, for example by Gaussian elimination, rather than approximated through Newton ' s method or Broyden s method.",
        "This means that the running times in the last row of Table 1 can be reduced by treating C3 differently from the other strongly connected components.",
        "However, the running time for Ci dominates the total time consumption.",
        "The above investigations were motivated by two questions, namely whether any part of the computation can be precomputed, and second, whether inix probabilities can be computed incrementally, for in-ixes that are extended to the left or to the right.",
        "The irst question can be answered afirmatively for C2, as it is always the same.",
        "However, as we can see in Table 1, the computation of C2 amounts to a small portion of the total time consumption.",
        "The second question can be rephrased more precisely as follows.",
        "Suppose we have computed the infix probability of a string w and have kept intermediate results in memory.",
        "Can the computation of the infix probability of a string of the form aw or wa, a G E, be computed by relying on the existing results, so that the computation is substantially faster than if the computation were done from scratch?",
        "Our investigations so far have not found a positive answer to this second question.",
        "In particular, the systems of equations for Ci and C3 change fundamentally if the inix is extended by one more symbol, which seems to at least make incremental computation very dificult, if not impossible.",
        "Note that the algorithms for the computation of preix probabilities by Jelinek and Lafferty (1991) and Stolcke (1995) do allow incrementality, which contributes to their practical usefulness for speech recognition."
      ]
    },
    {
      "heading": "8. Conclusions",
      "text": [
        "We have shown that the problem of infix probabilities for PCFGs can be solved by a construction that intersects a context-free language with a regular language.",
        "An important constraint is that the inite automaton that is input to this construction be unambiguous.",
        "We have shown that such an automaton can be eficiently constructed.",
        "Once the input probabilistic PCFG and the FA have been combined into a new probabilistic CFG, the inix probability can be straightforwardly solved by iterative algorithms.",
        "Such algorithms include Newton s method, and Broyden ' s method, which was used in our experiments.",
        "Our discussion ended with an open question about the possibility of incremental computation of inix probabilities.",
        "infix length",
        "2",
        "3",
        "4",
        "5",
        "6",
        "7",
        "total running time",
        "1.07",
        "1.95",
        "5.84",
        "11.38",
        "23.93",
        "45.91",
        "Broyden's method for C1",
        "0.46",
        "0.90",
        "3.42",
        "6.63",
        "12.91",
        "24.38",
        "Broyden's method for C2",
        "0.08",
        "0.04",
        "0.07",
        "0.04",
        "0.03",
        "0.09",
        "Broyden ' s method for C3",
        "0.20",
        "0.36",
        "0.81",
        "1.74",
        "5.30",
        "9.02"
      ]
    }
  ]
}
