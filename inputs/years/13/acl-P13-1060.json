{
  "info": {
    "authors": [
      "Malte Nuhn",
      "Hermann Ney"
    ],
    "book": "ACL",
    "id": "acl-P13-1060",
    "title": "Decipherment Complexity in 1:1 Substitution Ciphers",
    "url": "https://aclweb.org/anthology/P13-1060",
    "year": 2013
  },
  "references": [
    "acl-D08-1085",
    "acl-D12-1025",
    "acl-P06-2065",
    "acl-P10-1106",
    "acl-P11-1002",
    "acl-P12-1017",
    "acl-W99-0906"
  ],
  "sections": [
    {
      "heading": "Abstract",
      "text": [
        "In this paper we show that even for the case of 1:1 substitution ciphers?which encipher plaintext symbols by exchanging them with a unique substitute?finding the optimal decipherment with respect to a bigram language model is NP-hard.",
        "We show that in this case the decipherment problem is equivalent to the quadratic assignment problem (QAP).",
        "To the best of our knowledge, this connection between the QAP and the decipherment problem has not been known in the literature before."
      ]
    },
    {
      "heading": "1 Introduction",
      "text": [
        "The decipherment approach for MT has recently gained popularity for training and adapting translation models using only monolingual data.",
        "The general idea is to find those translation model parameters that maximize the probability of the translations of a given source text in a given language model of the target language.",
        "In general, the process of translation has a wide range of phenomena like substitution and reordering of words and phrases.",
        "In this paper we only study models that substitute tokens?i.e.",
        "words or letters?with a unique substitute.",
        "It therefore serves as a very basic case for decipherment and machine translation.",
        "Multiple techniques like integer linear programming (ILP), A?",
        "search, genetic algorithms, and Bayesian inference have been used to tackle the decipherment problem for 1:1 substitution ciphers.",
        "The existence of such a variety of different approaches for solving the same problem already shows that there is no obvious way to solve the problem optimally.",
        "In this paper we show that decipherment of 1:1 substitution ciphers is indeed NP-hard and thus explain why there is no single best approach to the problem.",
        "The literature on decipherment provides surprisingly little on the analysis of the complexity of the decipherment problem.",
        "This might be related to the fact that a statistical formulation of the decipherment problem has not been analyzed with respect to n-gram language models: This paper shows the close relationship of the decipherment problem to the quadratic assignment problem.",
        "To the best of our knowledge the connection between the decipherment problem and the quadratic assignment problem was not known.",
        "The remainder of this paper is structured as follows: In Section 2 we review related work.",
        "Section 3 introduces the decipherment problem and describes the notation and definitions used throughout this paper.",
        "In Section 4 we show that decipherment using a unigram language model corresponds to solving a linear sum assignment problem (LSAP).",
        "Section 5 shows the connection between the quadratic assignment problem and decipherment using a bigram language model.",
        "Here we also give a reduction of the traveling salesman problem (TSP) to the decipherment problem to highlight the additional complexity in the decipherment problem."
      ]
    },
    {
      "heading": "2 Related Work",
      "text": [
        "In recent years a large number of publications on the automatic decipherment of substitution ciphers has been published.",
        "These publications were mostly dominated by rather heuristic methods and did not provide a theoretical analysis of the complexity of the decipherment problem: (Knight and Yamada, 1999) and (Knight et al., 2006) use the EM algorithm for various decipherment problems, like e.g. word substitution ciphers.",
        "(Ravi and Knight, 2008) and (Corlett and Penn, 2010) are able to obtain optimal (i.e. without search errors) decipherments of short cryptograms given an n",
        "gram language model.",
        "(Ravi and Knight, 2011), (Nuhn et al., 2012), and (Dou and Knight, 2012) treat natural language translation as a deciphering problem including phenomena like reordering, insertion, and deletion and are able to train translation models using only monolingual data.",
        "In this paper we will show the connection between the decipherment problem and the linear sum assignment problem as well as the quadratic assignment problem: Regarding the linear sum assignment problem we will make use of definitions presented in (Burkard and ela, 1999).",
        "Concerning the quadratic assignment problem we will use basic definitions from (Beckmann and Koopmans, 1957).",
        "Further (Burkard et al., 1998) gives a good overview over the quadratic assignment problem, including different formulations, solution methods, and an analysis of computational complexity.",
        "The paper also references a vast amount of further literature that might be interesting for future research."
      ]
    },
    {
      "heading": "3 Definitions",
      "text": [
        "In the following we will use the machine translation notation and denote the ciphertext with",
        "with ?$?",
        "being a special sentence boundary token.",
        "We use the abbreviations V e = Ve ?",
        "{$} and V f respectively.",
        "A general substitution cipher uses a table s(e|f) which contains for each cipher token f a probability that the token f is substituted with the plaintext token e. Such a table for substituting cipher tokens {A,B,C,D} with plaintext tokens {a, b, c, d} could for example look like",
        "The 1:1 substitution cipher encrypts a given plaintext into a ciphertext by replacing each plaintext token with a unique substitute: This means that the table s(e|f) contains all zeroes, except for one ?1.0?",
        "per f ?",
        "Vf and one ?1.0?",
        "per e ?",
        "Ve.",
        "For example the text abadcab would be enciphered to"
      ]
    },
    {
      "heading": "BCBADBC",
      "text": [
        "when using the substitution",
        "We formalize the 1:1 substitutions with a bijective function ?",
        ": Vf ?",
        "Ve.",
        "The general decipherment goal is to obtain a mapping ?",
        "such that the probability of the deciphered text is maximal:",
        "Here p(.",
        ".",
        ". )",
        "denotes the language model.",
        "Depending on the structure of the language model Equation 2 can be further simplified.",
        "Given a ciphertext fN1 , we define the unigram count Nf of f ?",
        "V f as1",
        "This implies that Nf are integer counts > 0.",
        "We similarly define the bigram count Nff ?",
        "of f, f ?",
        "?",
        "This definition implies that",
        "(a) Nff ?",
        "are integer counts > 0 of bigrams found in the ciphertext fN1 .",
        "(b) Given the first and last token of the cipher f1 and fN , the bigram counts involving the sentence boundary token $ need to fulfill",
        "Similarly, we define language model matrices S for the unigram and the bigram case.",
        "The unigram language model Sf is defined as"
      ]
    },
    {
      "heading": "4.1 Problem Definition",
      "text": [
        "When using a unigram language model, Equation 2 simplifies to finding",
        "When defining cff ?",
        "= Nf log p(f ?",
        "), for f, f ?",
        "?",
        "Vf , Equation 16 can be brought into the form of",
        "cipher with Ve = {a, b, c}, Vf = {A,B,C}, unigram counts Nf , and unigram probabilities p(e)."
      ]
    },
    {
      "heading": "4.2 The Linear Sum Assignment Problem",
      "text": [
        "The practical problem behind the linear sum assignment problem can be described as follows: Given jobs {j1, .",
        ".",
        ".",
        ", jn} and workers {w1, .",
        ".",
        ".",
        ", wn}, the task is to assign each job ji to a worker wj .",
        "Each assignment incurs a cost cij and the total cost for assigning all jobs and workers is to be minimized.",
        "This can be formalized as finding the assign",
        "The general LSAP can be solved in polynomial time using the Hungarian algorithm (Kuhn, 1955).",
        "However, since the matrix cij occurring for the decipherment using a unigram language model can be represented as the product cij = ai ?",
        "bj the decipherment problem can be solved more easily: In the Section ?Optimal Matching?, (Bauer, 2010) shows that in this case the optimal assignment is found by sorting the jobs ji by ai and workers wj by bj and then assigning the jobs ji to workers wj that have the same rank in the respective sorted lists.",
        "Sorting and then assigning the elements can be done in O(n log n)."
      ]
    },
    {
      "heading": "5 Decipherment Using Bigram LMs",
      "text": []
    },
    {
      "heading": "5.1 Problem Definition",
      "text": [
        "When using a 2-gram language model, Equation 2 simplifies to",
        "lower overall costs.",
        "Using the definitions from Section 3, Equation 19 can be rewritten as",
        "(Bauer, 2010) arrives at a similar optimization problem for the ?combined method of frequency matching?",
        "using bigrams and mentions that it can be seen as a combinatorial problem for which an efficient way of solving is not known.",
        "However, he does not mention the close connection to the quadratic assignment problem."
      ]
    },
    {
      "heading": "5.2 The Quadratic Assignment Problem",
      "text": [
        "The quadratic assignment problem was introduced by (Beckmann and Koopmans, 1957) for the following real-life problem: Given a set of facilities {f1, .",
        ".",
        ".",
        ", fn} and a set of locations {l1, .",
        ".",
        ".",
        ", ln} with distances for each pair of locations, and flows for each pair of facilities (e.g. the amount of supplies to be transported between a pair of facilities) the problem is to assign the facilities to locations such that the sum of the distances multiplied by the corresponding flows (which can be interpreted as total transportation costs) is minimized.",
        "This is visualized in Figure 2.",
        "Following (Beckmann and Koopmans, 1957) we can express the quadratic assignment problem as finding",
        "This formulation is often referred to as Koopman-Beckman QAP and often abbreviated as QAP (A,B,C).",
        "The so-called pure or ho",
        "is obtained by setting cij = 0, and is often denoted as QAP (A,B).",
        "In terms of the real-life problem presented in (Beckmann and Koopmans, 1957) the matrix A can be interpreted as distance matrix for locations {l1 .",
        ".",
        ".",
        "ln} and B as flow matrix for facilities",
        "(Sahni and Gonzalez, 1976) show that the quadratic assignment problem is strongly NP-hard.",
        "We will now show the relation between the quadratic assignment problem and the decipherment problem."
      ]
    },
    {
      "heading": "5.3 Decipherment Problem Quadratic Assignment Problem",
      "text": [
        "Every decipherment problem is directly a quadratic assignment problem, since the matrices Nff ?",
        "and Sff ?",
        "are just special cases of the general matrices A and B required for the quadratic assignment problem.",
        "Thus a reduction from the decipherment problem to the quadratic assignment problem is trivial.",
        "This means that all algorithms capable of solving QAPs can directly be used to solve the decipherment problem."
      ]
    },
    {
      "heading": "5.4 Quadratic Assignment Problem Decipherment Problem",
      "text": [
        "Given QAP (A,B) with integer matrices A = (aij), B = (bij) i, j ?",
        "{1, .",
        ".",
        ".",
        ", n} we construct the count matrix Nff ?",
        "and language model matrix Sff ?",
        "in such a way that the solution for the decipherment problem implies the solution to the",
        "quadratic assignment problem, and vice versa.",
        "We will use the vocabularies V e = V f = {1, .",
        ".",
        ".",
        ", n+ 3}, with n + 3 being the special sentence boundary token ?$?.",
        "The construction of Nff ?",
        "and Sff ?",
        "is shown in Figure 3.",
        "To show the validity of our construction, we will",
        "1.",
        "Show that Nff ?",
        "is a valid count matrix.",
        "2.",
        "Show that Sff ?",
        "is a valid bigram language model matrix.",
        "3.",
        "Show that the decipherment problem and",
        "the newly constructed quadratic assignment problem are equivalent.",
        "We start by showing that Nff ?",
        "is a valid count",
        "which follows from Equation (24) by summing over all f ?",
        "{1, .",
        ".",
        ".",
        ", n}.",
        "?",
        "For f = n+2 and f = n+3, the condition is fulfilled by construction.",
        "We now show that Sff ?",
        "is a valid bigram language model matrix:",
        "(a) By construction, Sff ?",
        "?",
        "[?",
        "?, 0] holds.",
        "(b) By construction, S$$ = ??",
        "holds.",
        "(c) By the construction of b?f?, the values Sff ?",
        "ful",
        "fill ?f ?",
        "exp(Sff ?)",
        "= 1 for all f .",
        "This works since all entries b?ff ?",
        "are chosen to be smaller than ?log(n+ 2).",
        "We now show the equivalence of the quadratic assignment problem and the newly constructed decipherment problem.",
        "For this we will use the defi",
        "We first show that solutions of the constructed decipherment problem with score > ??",
        "fulfill ?",
        "(f) = f for f ?",
        "B?.",
        "All mappings ?, with ?",
        "(f) = f ?",
        "for any f ?",
        "A?",
        "and f ?",
        "?",
        "B?",
        "will induce a score of ??",
        "since for f ?",
        "A?",
        "all Nff > 0 and Sf ?f ?",
        "= ??",
        "for f ?",
        "?",
        "B?.",
        "Thus any ?",
        "with score > ??",
        "will fulfill ?",
        "(f) ?",
        "B?",
        "for f ?",
        "B?.",
        "Further, by enumerating all six possible permutations, it can be seen that only the ?",
        "with ?",
        "(f) = f for f ?",
        "B?",
        "induces a score of",
        "and B = (bij) of the quadratic assignment problem QAP (A,B).",
        "Thus, with some constant c, we can finally rewrite",
        "Thus we have shown that a solution to the quadratic assignment problem in Equation 34 is a solution to the decipherment problem in Equation 20 and vice versa.",
        "Assuming that calculating elementary functions can be done inO(1), setting up Nff ?",
        "and Sff ?",
        "can be done in polynomial time.2 Thus we have given a polynomial time reduction from the quadratic assignment problem to 2This is the case if we only require a fixed number of digits precision for the log and exp operations.",
        "the decipherment problem: Since the quadratic assignment problem is NP-hard, it follows that the decipherment problem is NP-hard, too."
      ]
    },
    {
      "heading": "5.5 Traveling Salesman Problem Decipherment Problem",
      "text": [
        "Using the above construction we can immediately construct a decipherment problem that is equivalent to the traveling salesman problem by using the quadratic assignment problem formulation of the traveling salesman problem.",
        "Without loss of generality3 we assume that the TSP's distance matrix fulfills the constraints of a bigram language model matrix Sff ?",
        ".",
        "Then the count matrix Nff ?",
        "needs to be chosen as",
        "which fulfills the constraints of a bigram count matrix.",
        "3The general case can be covered using the reduction shown in Section 5.",
        "This matrix corresponds to a ciphertext of the form $abcd$ (36) and represents the tour of the traveling salesman in an intuitive way.",
        "The mapping ?",
        "then only decides in which order the cities are visited, and only costs between two successive cities are counted.",
        "This shows that the TSP is only a special case of the decipherment problem."
      ]
    },
    {
      "heading": "6 Conclusion",
      "text": [
        "We have shown the correspondence between solving 1:1 substitution ciphers and the linear sum assignment problem and the quadratic assignment problem: When using unigram language models, the decipherment problem is equivalent to the linear sum assignment problem and solvable in polynomial time.",
        "For a bigram language model, the decipherment problem is equivalent to the quadratic assignment problem and is NP-hard.",
        "We also pointed out that all available algorithms for the quadratic assignment problem can be directly used to solve the decipherment problem.",
        "To the best of our knowledge, this correspondence between the decipherment problem and the quadratic assignment problem has not been known previous to our work."
      ]
    },
    {
      "heading": "Acknowledgements",
      "text": [
        "This work was partly realized as part of the Quaero Programme, funded by OSEO, French State agency for innovation."
      ]
    }
  ]
}
