{
  "info": {
    "authors": [
      "Malte Nuhn",
      "Julian Schamper",
      "Hermann Ney"
    ],
    "book": "ACL",
    "id": "acl-P13-1154",
    "title": "Beam Search for Solving Substitution Ciphers",
    "url": "https://aclweb.org/anthology/P13-1154",
    "year": 2013
  },
  "references": [
    "acl-D08-1085",
    "acl-D12-1025",
    "acl-P10-1106",
    "acl-P11-1002",
    "acl-P11-1025",
    "acl-P12-1017"
  ],
  "sections": [
    {
      "heading": "Abstract",
      "text": [
        "In this paper we address the problem of solving substitution ciphers using a beam search approach.",
        "We present a conceptually consistent and easy to implement method that improves the current state of the art for decipherment of substitution ciphers and is able to use high order n-gram language models.",
        "We show experiments with 1:1 substitution ciphers in which the guaranteed optimal solution for 3-gram language models has 38.6% decipherment error, while our approach achieves 4.13% decipherment error in a fraction of time by using a 6-gram language model.",
        "We also apply our approach to the famous Zodiac-408 cipher and obtain slightly better (and near to optimal) results than previously published.",
        "Unlike the previous state-of-the-art approach that uses additional word lists to evaluate possible decipherments, our approach only uses a letter-based 6-gram language model.",
        "Furthermore we use our algorithm to solve large vocabulary substitution ciphers and improve the best published decipherment error rate based on the Gigaword corpus of 7.8% to 6.0% error rate."
      ]
    },
    {
      "heading": "1 Introduction",
      "text": [
        "State-of-the-art statistical machine translation (SMT) systems use large amounts of parallel data to estimate translation models.",
        "However, parallel corpora are expensive and not available for every domain.",
        "Recently different works have been published that train translation models using only non-parallel data.",
        "Although first practical applications of these approaches have been shown, the overall decipherment accuracy of the proposed algorithms is still low.",
        "Improving the core decipherment algorithms is an important step for making decipherment techniques useful for practical applications.",
        "In this paper we present an effective beam search algorithm which provides high decipherment accuracies while having low computational requirements.",
        "The proposed approach allows using high order n-gram language models, is scalable to large vocabulary sizes and can be adjusted to account for a given amount of computational resources.",
        "We show significant improvements in decipherment accuracy in a variety of experiments while being computationally more effective than previous published works."
      ]
    },
    {
      "heading": "2 Related Work",
      "text": [
        "The experiments proposed in this paper touch many of previously published works in the decipherment field.",
        "Regarding the decipherment of 1:1 substitution ciphers various works have been published: Most older papers do not use a statistical approach and instead define some heuristic measures for scoring candidate decipherments.",
        "Approaches like (Hart, 1994) and (Olson, 2007) use a dictionary to check if a decipherment is useful.",
        "(Clark, 1998) defines other suitability measures based on n-gram counts and presents a variety of optimization techniques like simulated annealing, genetic algorithms and tabu search.",
        "On the other hand, statistical approaches for 1:1 substitution ciphers were published in the natural language processing community: (Ravi and Knight, 2008) solve 1:1 substitution ciphers optimally by formulating the decipherment problem as an integer linear program (ILP) while (Corlett and Penn, 2010) solve the problem using A?",
        "search.",
        "We use our own implementation of these methods to report optimal solutions to 1:1 substitution ci",
        "phers for language model orders n = 2 and n = 3.",
        "(Ravi and Knight, 2011a) report the first automatic decipherment of the Zodiac-408 cipher.",
        "They use a combination of a 3-gram language model and a word dictionary.",
        "We run our beam search approach on the same cipher and report better results without using an additional word dictionary?just by using a high order n-gram language model.",
        "(Ravi and Knight, 2011b) report experiments on large vocabulary substitution ciphers based on the Transtac corpus.",
        "(Dou and Knight, 2012) improve upon these results and provide state-of-the-art results on a large vocabulary word substitution cipher based on the Gigaword corpus.",
        "We run our method on the same corpus and report improvements over the state of the art.",
        "(Ravi and Knight, 2011b) and (Nuhn et al., 2012) have shown that?even for larger vocabulary sizes?it is possible to learn a full translation model from non-parallel data.",
        "Even though this work is currently only able to deal with substitution ciphers, phenomena like reordering, insertions and deletions can in principle be included in our approach."
      ]
    },
    {
      "heading": "3 Definitions",
      "text": [
        "In the following we will use the machine translation notation and denote the ciphertext with",
        "with ?$?",
        "being a special sentence boundary token.",
        "We use the abbreviations V e = Ve ?",
        "{$} and V f respectively.",
        "A general substitution cipher uses a table s(e|f) which contains for each cipher token f a probability that the token f is substituted with the plaintext token e. Such a table for substituting cipher tokens {A,B,C,D} with plaintext tokens {a, b, c, d} could for example look like",
        "The 1:1 substitution cipher encrypts a given plaintext into a ciphertext by replacing each plaintext token with a unique substitute: This means that the table s(e|f) contains all zeroes, except for one ?1.0?",
        "per f ?",
        "Vf and one ?1.0?",
        "per e ?",
        "Ve.",
        "For example the text abadcab would be enciphered to"
      ]
    },
    {
      "heading": "BCBADBC",
      "text": [
        "when using the substitution",
        "In contrast to the 1:1 substitution cipher, the ho-mophonic substitution cipher allows multiple cipher tokens per plaintext token, which means that the table s(e|f) is all zero, except for one ?1.0?",
        "per f ?",
        "Vf .",
        "For example the above plaintext could be enciphered to"
      ]
    },
    {
      "heading": "ABCDECF",
      "text": [
        "when using the homophonic substitution",
        "We will use the definition",
        "to characterize the maximum number of different cipher symbols allowed per plaintext symbol.",
        "We formalize the 1:1 substitutions with a bijective function ?",
        ": Vf ?",
        "Ve and homophonic substitutions with a general function ?",
        ": Vf ?",
        "Ve.",
        "Following (Corlett and Penn, 2010), we call cipher functions ?, for which not all ?",
        "(f)'s are fixed, partial cipher functions .",
        "Further, ??",
        "is said to extend ?, if for all f that are fixed in ?, it holds that f is also fixed in ??",
        "with ??",
        "(f) = ?",
        "(f).",
        "The cardinality of ?",
        "counts the number of fixed f 's in ?.",
        "When talking about partial cipher functions we use the notation for relations, in which ?",
        "?",
        "Vf ?",
        "Ve.",
        "For example with",
        "The general decipherment goal is to obtain a mapping ?",
        "such that the probability of the deciphered text is maximal:",
        "Here p(.",
        ".",
        ". )",
        "denotes the language model.",
        "Depending on the structure of the language model Equation 3 can be further simplified."
      ]
    },
    {
      "heading": "4 Beam Search",
      "text": [
        "In this Section we present our beam search approach to solving Equation 3.",
        "We first present the general algorithm, containing many higher level functions.",
        "We then discuss possible instances of these higher level functions."
      ]
    },
    {
      "heading": "4.1 General Algorithm",
      "text": [
        "Figure 1 shows the general structure of the beam search algorithm for the decipherment of substitution ciphers.",
        "The general idea is to keep track of all partial hypotheses in two arrays Hs and Ht.",
        "During search all possible extensions of the partial hypotheses in Hs are generated and scored.",
        "Here, the function EXT ORDER chooses which cipher symbol is used next for extension, EXT LIMITS decides which extensions are allowed, and SCORE scores the new partial hypotheses.",
        "PRUNE then selects a subset of these hypotheses which are stored to Ht.",
        "Afterwards the array Hs is copied to Ht and the search process continues with the updated array Hs.",
        "Due to the structure of the algorithm the cardinality of all hypotheses in Hs increases in each step.",
        "Thus only hypotheses of the same cardinality",
        "1shorthand notation for ??",
        "extends ?",
        "1: function BEAM SEARCH(EXT ORDER, EXT LIMITS, PRUNE) 2: init sets Hs, Ht 3: CARDINALITY = 0 4: Hs.ADD((?, 0)) 5: while CARDINALITY < |Vf |do 6: f = EXT ORDER[CARDINALITY] 7: for all ?",
        "?",
        "Hs do 8: for all e ?",
        "Ve do 9: ??",
        ":= ?",
        "?",
        "{(e, f)} 10: if EXT LIMITS(??)",
        "then 11: Ht.ADD(?",
        "?,SCORE (??))",
        "12: end if 13: end for 14: end for 15: PRUNE(Ht) 16: CARDINALITY = CARDINALITY + 1 17: Hs = Ht 18: Ht.CLEAR() 19: end while 20: return best scoring cipher function in Hs 21: end function",
        "search algorithm for decipherment of substitution ciphers.",
        "The high level functions SCORE, EXT ORDER, EXT LIMITS and PRUNE are described in Section 4. are compared in the pruning step.",
        "When Hs contains full cipher relations, the cipher relation with the maximal score is returned.2 Figure 2 illustrates how the algorithm explores the search space for a homophonic substitution cipher.",
        "In the following we show several instances of EXT ORDER, EXT LIMITS, SCORE, and PRUNE."
      ]
    },
    {
      "heading": "4.2 Extension Limits (EXT LIMITS)",
      "text": [
        "In addition to the implicit constraint of ?",
        "being a function Vf ?",
        "Ve, one might be interested in functions of a specific form: For 1:1 substitution ciphers (EXT LIMITS SIMPLE) ?",
        "must fulfill that the number of cipher letters f ?",
        "Vf that map to any e ?",
        "Ve is at most one.",
        "Since partial hypotheses violating this condition can never ?recover?",
        "when being extended, it becomes clear that these partial hypotheses can be left out from search.",
        "2n-best output can be implemented by returning the n best scoring hypotheses in the final array Hs.",
        "extension limits (EXT LIMITS HOMOPHONIC) with nmax = 4, and histogram pruning with nkeep = 4.",
        "Hypotheses are visualized as nodes in the tree.",
        "The x-axis represents the extension order.",
        "At each level only those 4 hypotheses that survived the histogram pruning process are extended.",
        "Homophonic substitution ciphers can be handled by the beam search algorithm, too.",
        "Here the condition that ?",
        "must fulfill is that the number of cipher letters f ?",
        "Vf that map to any e ?",
        "Ve is at most nmax (which we will call EXT LIMITS HOMOPHONIC).",
        "As soon as this condition is violated, all further extensions will also violate the condition.",
        "Thus, these partial hypotheses can be left out."
      ]
    },
    {
      "heading": "4.3 Score Estimation (SCORE)",
      "text": [
        "The score estimation function needs to predict how good or bad a partial hypothesis (cipher function) might become.",
        "We propose simple heuristics that use the n-gram counts rather than the original ciphertext.",
        "The following formulas consider the 2-gram case.",
        "Equations for higher n-gram orders can be obtained analogously.",
        "With Equation 3 in mind, we want to estimate the best possible score",
        "3?",
        "denotes the Kronecker delta.",
        "we can equivalently use the scores",
        "Using this formulation it is easy to propose a whole class of heuristics: We only present the simplest heuristic, which we call TRIVIAL HEURISTIC.",
        "Its name stems from the fact that it only evaluates those parts of a given ??",
        "that are already fixed, and thus does not estimate any future costs.",
        "Its score is calculated as",
        "Here f, f ?",
        "?",
        "??",
        "denotes that f and f ?",
        "need to be covered in ??.",
        "This heuristic is optimistic since we implicitly use ?0?",
        "as estimate for the non fixed parts of the sum, for which Nff ?",
        "log p(?|?)",
        "?",
        "0 holds.",
        "It should be noted that this heuristic can be implemented very efficiently.",
        "Given a partial hypothesis ?",
        "with given SCORE(?)",
        "the score of an extension ??",
        "can be calculated as",
        "where NEWLY FIXED only includes scores for n-grams that have been newly fixed in ??",
        "during the extension step from ?",
        "to ?",
        "?."
      ]
    },
    {
      "heading": "4.4 Extension Order (EXT ORDER)",
      "text": [
        "For the choice which ciphertext symbol should be fixed next during search, several possibilities exist: The overall goal is to choose an extension order that leads to an overall low error rate.",
        "Intuitively it seems a good idea to first try to decipher higher frequent words rather than the lowest frequent ones.",
        "It is also clear that the choice of a good extension order is dependent on the score estimation function SCORE: The extension order should lead to informative scores early on so that misleading hypotheses can be pruned out early.",
        "In most of our experiments we will make use of a very simple extension order: HIGHEST UNIGRAM FREQUENCY simply fixes the most frequent symbols first.",
        "In case of the Zodiac-408, we use another strategy that we call HIGHEST NGRAM COUNT extension order.",
        "In each step it greedily chooses the symbol that will maximize the number of fixed ciphertext n-grams.",
        "This strategy is useful because the SCORE function we use is TRIVIAL HEURISTIC, which is not able to provide informative scores if only few full n-grams are fixed."
      ]
    },
    {
      "heading": "4.5 Pruning (PRUNE)",
      "text": [
        "We propose two pruning methods: HISTOGRAM PRUNING sorts all hypotheses according to their score and then keeps only the best nkeep hypotheses.",
        "THRESHOLD PRUNING keeps only those hypotheses ?keep for which SCORE(?keep) ?",
        "SCORE(?best)?",
        "?",
        "(9) holds for a given parameter ?",
        "?",
        "0.",
        "Even though THRESHOLD PRUNING has the advantage of not needing to sort all hypotheses, it has proven difficult to choose proper values for ?.",
        "Due to this, all experiments presented in this paper only use"
      ]
    },
    {
      "heading": "HISTOGRAM PRUNING. 5 Iterative Beam Search",
      "text": [
        "(Ravi and Knight, 2011b) propose a so called ?iterative EM algorithm?.",
        "The basic idea is to run a decipherment algorithm?in their case an EM algorithm based approach?on a subset of the vocabulary.",
        "After having obtained the results from the restricted vocabulary run, these results are used to initialize a decipherment run with a larger vocabulary.",
        "The results from this run will then be used for a further decipherment run with an even larger vocabulary and so on.",
        "In our large vocabulary word substitution cipher experiments we iteratively increase the vocabulary from the 1000 most frequent words, until we finally reach the 50000 most frequent words."
      ]
    },
    {
      "heading": "6 Experimental Evaluation",
      "text": [
        "We conduct experiments on letter based 1:1 substitution ciphers, the homophonic substitution cipher Zodiac-408, and word based 1:1 substitution ciphers.",
        "For a given reference mapping ?ref , we evaluate candidate mappings ?",
        "using two error measures: Mapping Error Rate MER(?, ?ref ) and Symbol Error Rate SER(?, ?ref ).",
        "Roughly speaking, SER reports the fraction of symbols in the deciphered text that are not correct, while MER reports the fraction of incorrect mappings in ?.",
        "Given a set of symbols Veval with unigram countsN(v) for v ?",
        "Veval, and the total amount of running symbols Neval = ?",
        "Thus the SER can be seen as a weighted form of the MER, emphasizing errors for frequent words.",
        "In decipherment experiments, SER will often be lower than MER, since it is often easier to decipher frequent words."
      ]
    },
    {
      "heading": "6.1 Letter Substitution Ciphers",
      "text": [
        "As ciphertext we use the text of the English Wikipedia article about History4, remove all pictures, tables, and captions, convert all letters to lowercase, and then remove all non-letter and non-space symbols.",
        "This corpus forms the basis for shorter cryptograms of size 2, 4, 8, 16, 32, 64, 128, and 256?of which we generate 50 each.",
        "We make sure that these shorter cryptograms do not end or start in the middle of a word.",
        "We create the ciphertext using a 1:1 substitution cipher in which we fix the mapping of the space symbol ?",
        "?.",
        "This",
        "ror rates (MER) and runtimes (RT) in dependence of language model order (ORDER) and histogram pruning size (BEAM) for decipherment of letter substitution ciphers of length 128.",
        "Runtimes are reported on a single core machine.",
        "Results for beam size ???",
        "were obtained using A?",
        "search.",
        "makes our experiments comparable to those conducted in (Ravi and Knight, 2008).",
        "Note that fixing the ?",
        "?",
        "symbol makes the problem much easier: The exact methods show much higher computational demands for lengths beyond 256 letters when not fixing the space symbol.",
        "The plaintext language model we use a letter based (Ve = {a, .",
        ".",
        ".",
        ", z, }) language model trained on a subset of the Gigaword corpus (Graff et al., 2007).",
        "We use extension limits fitting the 1:1 substitution cipher nmax = 1 and histogram pruning with different beam sizes.",
        "For comparison we reimplemented the ILP approach from (Ravi and Knight, 2008) as well as the A?",
        "approach from (Corlett and Penn, 2010).",
        "Figure 3 shows the results of our algorithm for different cipher length.",
        "We use a beam size of 100k for the 4, 5 and 6-gram case.",
        "Most remarkably our 6-gram beam search results are significantly better than all methods presented in the literature.",
        "For the cipher length of 32 we obtain a symbol error rate of just 4.1% where the optimal solution (i.e. without search errors) for a 3-gram",
        "letter substitution ciphers of different lengths.",
        "Error bars show the 95% confidence interval based on decipherment on 50 different ciphers.",
        "Beam search was performed with a beam size of ?100k?.",
        "language model has a symbol error rate as high as 38.3%.",
        "Table 1 shows error rates and runtimes of our algorithm for different beam sizes and language model orders given a fixed ciphertext length of 128 letters.",
        "It can be seen that achieving close to optimal results is possible in a fraction of the CPU time needed for the optimal solution: In the 3 gram case the optimal solution is found in 1400 thof the time needed using A?",
        "search.",
        "It can also be seen that increasing the language model order does not increase the runtime much while providing better results if the beam size is large enough: If the beam size is not large enough, the decipherment accuracy decreases when increasing the language model order: This is because the higher order heuristics do not give reliable scores if only few n-grams are fixed.",
        "To summarize: The beam search method is significantly faster and obtains significantly better results than previously published methods.",
        "Furthermore it offers a good trade-off between CPU time and decipherment accuracy.",
        "and its decipherment."
      ]
    },
    {
      "heading": "6.2 Zodiac-408 Cipher",
      "text": [
        "As ciphertext we use a transcription of the Zodiac-408 cipher.",
        "It consists of 54 different symbols and has a length of 408 symbols.",
        "The cipher has been deciphered by hand before.",
        "It contains some mistakes and ambiguities: For example, it contains misspelled words like forrest (vs. forest), experence (vs. experience), or paradice (vs. paradise).",
        "Furthermore, the last 17 letters of the cipher do not form understandable English when applying the same homophonic substitution that deciphers the rest of the cipher.",
        "This makes the Zodiac-408 a good candidate for testing the robustness of a decipherment algorithm.",
        "We assume a homophonic substitution cipher, even though the cipher is not strictly homophonic: It contains three cipher symbols that correspond to two or more plaintext symbols.",
        "We ignore this fact for our experiments, and count?in case of the MER only?the decipherment for these symbols as correct when the obtained mapping is contained in the set of reference symbols.",
        "We use extension limits with nmax = 8 and histogram pruning with beam sizes of 10k up to 10M .",
        "The plaintext language model is based on the same subset of Gigaword (Graff et al., 2007) data as the experiments for the letter substitution ciphers.",
        "However, we first removed all space sym",
        "ror rates (MER) and runtimes (RT) in dependence of language model order (ORDER) and histogram pruning size (BEAM) for the decipherment of the Zodiac-408 cipher.",
        "Runtimes are reported on a 128-core machine.",
        "bols from the training corpus before training the actual letter based 4-gram, 5-gram, and 6-gram language model on it.",
        "Other than (Ravi and Knight, 2011a) we do not use any word lists and by that avoid any degrees of freedom in how to integrate it into the search process: Only an n-gram language model is used.",
        "Figure 4 shows the first parts of the cipher and our best decipherment.",
        "Table 2 shows the results of our algorithm on the Zodiac-408 cipher for different language model orders and pruning settings.",
        "To summarize: Our final decipherment?for which we only use a 6-gram language model?has a symbol error rate of only 2.0%, which is slightly better than the best decipherment reported in (Ravi and Knight, 2011a).",
        "They used an n-gram language model together with a word dictionary and obtained a symbol error rate of 2.2%.",
        "We thus obtain better results with less modeling."
      ]
    },
    {
      "heading": "6.3 Word Substitution Ciphers",
      "text": [
        "As ciphertext, we use parts of the JRC corpus (Steinberger et al., 2006) and the Gigaword corpus (Graff et al., 2007).",
        "While the full JRC corpus contains roughly 180k word types and consists of approximately 70M running words, the full Gigaword corpus contains around 2M word types and roughly 1.5G running words.",
        "We run experiments for three different setups: The ?JRC?",
        "and ?Gigaword?",
        "setups use the first half of the respective corpus as ciphertext, while the plaintext language model of order n = 3 was",
        "rates (MER) and runtimes (RT) for iterative decipherment run on the (TOP) most frequent words.",
        "Error rates are evaluated on the full vocabulary.",
        "Runtimes are reported on a 128-core machine.",
        "trained on the second half.",
        "The ?JRC-Shuf?",
        "setup is created by randomly selecting half of the sentences of the JRC corpus as ciphertext, while the language model was trained on the complementary half of the corpus.",
        "We encrypt the ciphertext using a 1:1 substitution cipher on word level, imposing a much larger vocabulary size.",
        "We use histogram pruning with a beam size of 128 and use extension limits of nmax = 1.",
        "Different to the previous experiments, we use iterative beam search with iterations as shown in Table 3.",
        "The results for the Gigaword task are directly comparable to the word substitution experiments presented in (Dou and Knight, 2012).",
        "Their final decipherment has a symbol error rate of 7.8%.",
        "Our algorithm obtains 6.0% symbol error rate.",
        "It should be noted that the improvements of 1.8% symbol error rate correspond to a larger improvement in terms of mapping error rate.",
        "This can also be seen when looking at Table 3: An improvement of the symbol error rate from 6.51% to 5.96% corresponds to an improvement of mapping error rate from 21.78% to 19.40%.",
        "To summarize: Using our beam search algorithm in an iterative fashion, we are able to improve the state-of-the-art decipherment accuracy for word substitution ciphers."
      ]
    },
    {
      "heading": "7 Conclusion",
      "text": [
        "We have presented a simple and effective beam search approach to the decipherment problem.",
        "We have shown in a variety of experiments?letter substitution ciphers, the Zodiac-408, and word substitution ciphers?that our approach outperforms the current state of the art while being conceptually simpler and keeping computational demands low.",
        "We want to note that the presented algorithm is not restricted to 1:1 and homophonic substitution ciphers: It is possible to extend the algorithm to solve n:m mappings.",
        "Along with more sophisticated pruning strategies, score estimation functions, and extension orders, this will be left for future research."
      ]
    },
    {
      "heading": "Acknowledgements",
      "text": [
        "This work was partly realized as part of the Quaero Programme, funded by OSEO, French State agency for innovation.",
        "Experiments were performed with computing resources granted by JARA-HPC from RWTH Aachen University under project ?jara0040?."
      ]
    }
  ]
}
