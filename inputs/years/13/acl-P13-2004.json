{
  "info": {
    "authors": [
      "Jun Suzuki",
      "Masaaki Nagata"
    ],
    "book": "ACL",
    "id": "acl-P13-2004",
    "title": "Supervised Model Learning with Feature Grouping based on a Discrete Constraint",
    "url": "https://aclweb.org/anthology/P13-2004",
    "year": 2013
  },
  "references": [
    "acl-D07-1101",
    "acl-J93-2004",
    "acl-P05-1012",
    "acl-P07-1104",
    "acl-P08-1068",
    "acl-P09-1054",
    "acl-W03-0419"
  ],
  "sections": [
    {
      "text": [
        "Proceedings of the 51st Annual Meeting of the Association for Computational Linguistics, pages 18?23, Sofia, Bulgaria, August 4-9 2013. c?2013 Association for Computational Linguistics Supervised Model Learning with Feature Grouping based on a Discrete Constraint"
      ]
    },
    {
      "heading": "Abstract",
      "text": [
        "This paper proposes a framework of supervised model learning that realizes feature grouping to obtain lower complexity models.",
        "The main idea of our method is to integrate a discrete constraint into model learning with the help of the dual decomposition technique.",
        "Experiments on two well-studied NLP tasks, dependency parsing and NER, demonstrate that our method can provide state-of-the-art performance even if the degrees of freedom in trained models are surprisingly small, i.e., 8 or even 2.",
        "This significant benefit enables us to provide compact model representation, which is especially useful in actual use."
      ]
    },
    {
      "heading": "1 Introduction",
      "text": [
        "This paper focuses on the topic of supervised model learning, which is typically represented as the following form of the optimization problem:",
        "where D is supervised training data that consists of the corresponding input x and output y pairs, that is, (x,y) ?",
        "D. w is an N dimensional vector representation of a set of optimization variables, which are also interpreted as feature weights.",
        "L(w;D) and ?",
        "(w) represent a loss function and a regularization term, respectively.",
        "Nowadays, we, in most cases, utilize a supervised learning method expressed as the above optimization problem to estimate the feature weights of many natural language processing (NLP) tasks, such as text classification, POS-tagging, named entity recognition, dependency parsing, and semantic role labeling.",
        "In the last decade, the L1-regularization technique, which incorporates L1-norm into ?",
        "(w), has become popular and widely-used in many NLP tasks (Gao et al., 2007; Tsuruoka et al., 2009).",
        "The reason is that L1-regularizers encourage feature weights to be zero as much as possible in model learning, which makes the resultant model a sparse solution (many zero-weights exist).",
        "We can discard all features whose weight is zero from the trained model1 without any loss.",
        "Therefore, L1-regularizers have the ability to easily and automatically yield compact models without strong concern over feature selection.",
        "Compact models generally have significant and clear advantages in practice: instances are faster loading speed to memory, less memory occupation, and even faster decoding is possible if the model is small enough to be stored in cache memory.",
        "Given this background, our aim is to establish a model learning framework that can reduce the model complexity beyond that possible by simply applying L1-regularizers.",
        "To achieve our goal, we focus on the recently developed concept of automatic feature grouping (Tibshirani et al., 2005; Bondell and Reich, 2008).",
        "We introduce a model learning framework that achieves feature grouping by incorporating a discrete constraint during model learning."
      ]
    },
    {
      "heading": "2 Feature Grouping Concept",
      "text": [
        "Going beyond L1-regularized sparse modeling, the idea of ?automatic feature grouping?",
        "has recently been developed.",
        "Examples are fused lasso (Tibshirani et al., 2005), grouping pursuit (Shen and Huang, 2010), and OSCAR (Bondell and Reich, 2008).",
        "The concept of automatic feature grouping is to find accurate models that have fewer degrees of freedom.",
        "This is equivalent to enforce every optimization variables to be equal as much as possible.",
        "A simple example is",
        "have two and four unique values, respectively.",
        "There are several merits to reducing the degree",
        "of freedom.",
        "For example, previous studies clarified that it can reduce the chance of over-fitting to the training data (Shen and Huang, 2010).",
        "This is an important property for many NLP tasks since they are often modeled with a high-dimensional feature space, and thus, the over-fitting problem is readily triggered.",
        "It has also been reported that it can improve the stability of selecting non-zero features beyond that possible with the standard L1-regularizer given the existence of many highly correlated features (Jo?rnsten and Yu, 2003; Zou and Hastie, 2005).",
        "Moreover, it can dramatically reduce model complexity.",
        "This is because we can merge all features whose feature weight values are equivalent in the trained model into a single feature cluster without any loss."
      ]
    },
    {
      "heading": "3 Modeling with Feature Grouping",
      "text": [
        "This section describes our proposal for obtaining a feature grouping solution."
      ]
    },
    {
      "heading": "3.1 Integration of a Discrete Constraint",
      "text": [
        "Let S be a finite set of discrete values, i.e., a set integer from ?4 to 4, that is, S={?4,.",
        ".",
        ".",
        ", ?1, 0, 1, .",
        ".",
        ".",
        ", 4}.",
        "The detailed discussion how we define S can be found in our experiments section since it deeply depends on training data.",
        "Then, we define the objective that can simultaneously achieve a feature grouping and model learning as follows:",
        "where SN is the cartesian power of a set S .",
        "The only difference with Eq.",
        "1 is the additional discrete constraint, namely, w ?",
        "SN .",
        "This constraint means that each variable (feature weight) in trained models must take a value in S, that is, w?n ?",
        "S , where w?n is the nth factor of w?, and n ?",
        "{1, .",
        ".",
        ".",
        ", N}.",
        "As a result, feature weights in trained models are automatically grouped in terms of the basis of model learning.",
        "This is the basic idea of feature grouping proposed in this paper.",
        "However, a concern is how we can efficiently optimize Eq.",
        "2 since it involves a NP-hard combinatorial optimization problem.",
        "The time complexity of the direct optimization is exponential against N .",
        "Next section introduces a feasible algorithm."
      ]
    },
    {
      "heading": "3.2 Dual Decomposition Formulation",
      "text": [
        "Hereafter, we strictly assume that L(w;D) and ?",
        "(w) are both convex in w. Then, the properties of our method are unaffected by the selection of L(w;D) and ?(w).",
        "Thus, we ignore their specific definition in this section.",
        "Typical cases can be found in the experiments section.",
        "Then, we reformulate Eq.",
        "2 by using the dual decomposition technique (Everett, 1963):",
        "s.t.",
        "w = u, and u ?",
        "SN .",
        "(3) Difference from Eq.",
        "2, Eq.",
        "3 has an additional term ?",
        "(u), which is similar to the regularizer ?",
        "(w), whose optimization variables w and u are tightened with equality constraint w = u.",
        "Here, this paper only considers the case ?",
        "(u) = ?22 ||u||22 + ?1||u||1, and ?2 ?",
        "0 and ?1 ?",
        "02.",
        "This objective can also be viewed as the decomposition of the standard loss minimization problem shown in Eq.",
        "1 and the additional discrete constraint regularizer by the dual decomposition technique.",
        "To solve the optimization in Eq.",
        "3, we leverage the alternating direction method of multiplier (ADMM) (Gabay and Mercier, 1976; Boyd et al., 2011).",
        "ADMM provides a very efficient optimization framework for the problem in the dual decomposition form.",
        "Here, ?",
        "represents dual variables for the equivalence constraint w=u.",
        "ADMM introduces the augmented Lagrangian term ?2 ||w ?",
        "u||22 with ?>0 which ensures strict convexity and increases robustness3.",
        "Finally, the optimization problem in Eq.",
        "3 can be converted into a series of iterative optimization problems.",
        "Detailed derivation in the general case can be found in (Boyd et al., 2011).",
        "Fig.",
        "1 shows the entire model learning framework of our proposed method.",
        "The remarkable point is that ADMM works by iteratively computing one of the three optimization variable sets w, u, and ?",
        "while holding the other variables fixed in the iterations",
        "Step1 (w-update): This part of the optimization problem shown in Eq.",
        "4 is essentially Eq.",
        "1 with a ?biased?",
        "L2-regularizer.",
        "?bias?",
        "means here that the direction of regularization is toward point a instead of the origin.",
        "Note that it becomes a standard L2-regularizer if a = 0.",
        "We can select any learning algorithm that can handle the L2-regularizer for this part of the optimization.",
        "Input: Training data:D, parameters:?, ?, primal, and dual",
        "Break the loop if the above two conditions are reached, or go back to Step1 with t = t+ 1.",
        "Output: u(t+1)",
        "method derived from ADMM (Boyd et al., 2011).",
        "following equivalent simple form: u?= arg minu{12 ||u?",
        "b?||22 + ??1||u||1}s.t.",
        "u ?",
        "SN , (8) where b?",
        "= ?",
        "?2+?b, and ?",
        "?1 = ?1?2+?",
        ".",
        "Thisoptimization is still a combinatorial optimization problem.",
        "However unlike Eq.",
        "2, this optimization can be efficiently solved.",
        "Fig.",
        "2 shows the procedure to obtain the exact solution of Eq.",
        "5, namely u(t+1).",
        "The remarkable point is that the costly combinatorial optimization problem is disappeared, and instead, we are only required to perform two feature-wise calculations whose total time complexities isO(N log |S|) and fully parallelizable.",
        "The similar technique has been introduced in Zhong and Kwok (2011) for discarding a costly combinatorial problem from the optimization with OSCAR-regularizers with the help of proximal gradient methods, i.e., (Beck and Teboulle, 2009).",
        "We omit to show the detailed derivation of Fig. 2 because of the space reason.",
        "However, this is easily understandable.",
        "The key properties are the following two folds; (i) The objective shown in Eq.",
        "8 is a convex and also symmetric function with respect to u?",
        "?, where u??",
        "is the optimal solution of Eq.",
        "8 without the discrete constraint.",
        "Therefore, the optimal solution u?",
        "is at the point where the Input: b?",
        "= (b?n)Nn=1, ?",
        "?1, and S. 1, Find the optimal solution of Eq.",
        "8 without the constraint.",
        "The optimization of mixed L2 and L1-norms is known to have a closed form solution, i.e., (Beck and Teboulle, 2009), that is; u?",
        "?n = sgn(b?n)max(0, |b?n |?",
        "?",
        "?1), where (u?",
        "?n)Nn=1 = u??.",
        "2, Find the nearest valid point in SN from u??",
        "in terms of the",
        "where (u?n)Nn=1 = u?.",
        "This can be performed by a binary search, whose time complexity is generally O(log |S|).",
        "Output: u?",
        "always located at the vertexes of axis-aligned or-thotopes (hyperrectangles) in the parameter space of feature weights.",
        "Thus, the solution u?, which is the nearest valid point from u?",
        "?, can be obtained by individually taking the nearest value in S from u?",
        "?n for all n. Step3 (?-update): We perform gradient ascent on dual variables to tighten the constraint w = u.",
        "Note that ?",
        "is the learning rate; we can simply set it to 1.0 for every iteration (Boyd et al., 2011).",
        "Step4 (convergence check): It can be evaluated both primal and dual residuals as defined in Eq.",
        "7 with suitably small primal and dual."
      ]
    },
    {
      "heading": "3.3 Online Learning",
      "text": [
        "We can select an online learning algorithm for Step1 since the ADMM framework does not require exact minimization of Eq.",
        "4.",
        "In this case, we perform one-pass update through the data in each ADMM iteration (Duh et al., 2011).",
        "Note that the total calculation cost of our method does not increase much from original online learning algorithm since the calculation cost of Steps 2 through 4 is relatively much smaller than that of Step1."
      ]
    },
    {
      "heading": "4 Experiments",
      "text": [
        "We conducted experiments on two well-studied NLP tasks, namely named entity recognition (NER) and dependency parsing (DEPAR).",
        "Basic settings: We simply reused the settings of most previous studies.",
        "We used CoNLL?03 data (Tjong Kim Sang and De Meulder, 2003) for NER, and the Penn Treebank (PTB) III corpus (Marcus et al., 1994) converted to dependency trees for DEPAR (McDonald et al., 2005).",
        "Our decoding models are the Viterbi algorithm on CRF (Lafferty et al., 2001), and the second-order parsing model proposed by (Carreras, 2007) for NER and DEPAR, respectively.",
        "Features are automatically generated according to the predefined feature templates widely-used in the previous studies.",
        "We also integrated the cluster features obtained by the method explained in (Koo et al., 2008) as additional features for evaluating our method in the range of the current best systems.",
        "Evaluation measures: The purpose of our experiments is to investigate the effectiveness of our proposed method in terms of both its performance and the complexity of the trained model.",
        "Therefore, our evaluation measures consist of two axes.",
        "Task performance was mainly evaluated in terms of the complete sentence accuracy (COMP) since the objective of all model learning methods evaluated in our experiments is to maximize COMP.",
        "We also report the F?=1 score (F-sc) for NER, and the unlabeled attachment score (UAS) for DEPAR for comparison with previous studies.",
        "Model complexity is evaluated by the number of non-zero active features (#nzF) and the degree of freedom (#DoF) (Zhong and Kwok, 2011).",
        "#nzF is the number of features whose corresponding feature weight is non-zero in the trained model, and #DoF is the number of unique non-zero feature weights.",
        "Baseline methods: Our main baseline is L1-regularized sparse modeling.",
        "To cover both batch and online leaning, we selected L1-regularized CRF (L1CRF) (Lafferty et al., 2001) optimized by OWL-QN (Andrew and Gao, 2007) for the NER experiment, and the L1-regularized regularized dual averaging (L1RDA) method (Xiao, 2010)4 for DEPAR.",
        "Additionally, we also evaluated L2-regularized CRF (L2CRF) with L-BFGS (Liu and Nocedal, 1989) for NER, and passive-aggressive algorithm (L2PA) (Crammer et al., 2006)5 for DEPAR since L2-regularizer often provides better results than L1-regularizer (Gao et al., 2007).",
        "For a fair comparison, we applied the procedure of Step2 as a simple quantization method to trained models obtained from L1-regularized model learning, which we refer to as (QT)."
      ]
    },
    {
      "heading": "4.1 Configurations of Our Method",
      "text": [
        "Base learning algorithm: The settings of our method in our experiments imitate L1-regularized learning algorithm since the purpose of our experiments is to investigate the effectiveness against standard L1-regularized learning algorithms.",
        "Then, we have the following two possible settings; DC-ADMM: we leveraged the baseline L1-regularized learning algorithm to solve Step1, and set ?1 = 0 and ?2 = 0 for Step2.",
        "DCwL1ADMM: we leveraged the baselineL2-regularized learning algorithm, but without L2-regularizer, to solve Step1, and set ?1 > 0 and ?2 = 0 for Step2.",
        "The difference can be found in the objective function O(w,u;D) shown in Eq.",
        "3;",
        "In other words, DC-ADMM utilizes L1-regularizer as a part of base leaning algorithm ?",
        "(w)=?1||w||1, while DCwL1-ADMM discards regularizer of base learning algorithm ?",
        "(w), but instead introducing ?",
        "(u) = ?1||u||1.",
        "Note that these two configurations are essentially identical since objectives are identical, even though the formulation and algorithm is different.",
        "We only report results of DC-ADMM because of the space reason since the results of DCwL1-ADMM were nearly equivalent to those of DC-ADMM.",
        "Definition of S: DC-ADMM can utilize any finite set for S. However, we have to carefully select it since it deeply affects the performance.",
        "Actually, this is the most considerable point of our method.",
        "We preliminarily investigated the several settings.",
        "Here, we introduce an example of template which is suitable for large feature set.",
        "Let ?, ?, and ?",
        "represent non-negative real-value constants, ?",
        "be a positive integer, ?",
        "= {?1, 1}, and a function f?,?,?",
        "(x, y) = y(?",
        "?x + ?).",
        "Then, we define a finite set of values S as follows: S?,?,?,?",
        "={f?,?,?",
        "(x, y)|(x, y) ?",
        "S???}",
        "?",
        "{0}, where S?",
        "is a set of non-negative integers from zero to ?",
        "?",
        "1, that is, S?",
        "={m}??1m=0.",
        "For example, if we set ?",
        "= 0.1, ?",
        "= 0.4, ?= 4, and ?",
        "= 3, then S?,?,?,?",
        "= {?2.0, ?0.8, ?0.5, 0, 0.5, 0.8, 2.0}.",
        "The intuition of this template is that the distribution of the feature weights in trained model often takes a form a similar to that of the ?power law?",
        "in the case of the large feature sets.",
        "Therefore, using an exponential function with a scale and bias seems to be appropriate for fitting them.",
        "the trained model for the development data Note that we can control the upper bound of #DoF in trained model by ?, namely if ?",
        "= 4 then the upper bound of #DoF is 8 (doubled by positive and negative sides).",
        "We fixed ?",
        "= 1, ?",
        "= 1, ?2 = 0, ?",
        "= 4 (or 2 if ?",
        "?",
        "5), ?",
        "= ?/2 in all experiments.",
        "Thus the only tunable parameter in our experiments is ?",
        "for each ?."
      ]
    },
    {
      "heading": "4.2 Results and Discussions",
      "text": [
        "Fig.",
        "3 shows the task performance on the development data against the model complexities in terms of the degrees of freedom in the trained models.",
        "Plots are given by changing the ?",
        "value for DC-ADMM andL1-regularized methods with QT.",
        "The plots of the standard L1-regularized methods are given by changing the regularization constants ?1.",
        "Moreover, Table 1 shows the final results of our experiments on the test data.",
        "The tunable parameters were fixed at values that provided the best performance on the development data.",
        "According to the figure and table, the most remarkable point is that DC-ADMM successfully maintained the task performance even if #DoF (the degree of freedom) was 8, and the performance drop-offs were surprisingly limited even if #DoF was 2, which is the upper bound of feature grouping.",
        "Moreover, it is worth noting that the DC-ADMM performance is sometimes improved.",
        "The reason may be that such low degrees of freedom prevent over-fitting to the training data.",
        "Surprisingly, the simple quantization method (QT) provided fairly good results.",
        "However, we emphasize that the models produced by the QT approach offer no guarantee as to the optimal solution.",
        "In contrast, DC-ADMM can truly provide the optimal solution of Eq.",
        "3 since the discrete constraint is also considered during the model learning.",
        "In general, a trained model consists of two parts:",
        "data (K: thousand, M: million) feature weights and an indexed structure of feature strings, which are used as the key for obtaining the corresponding feature weight.",
        "This paper mainly discussed how to reduce the size of the former part, and described its successful reduction.",
        "We note that it is also possible to reduce the latter part especially if the feature string structure is TRIE.",
        "We omit the details here since it is not the main topic of this paper, but by merging feature strings that have the same feature weights, the size of entire trained models in our DEPAR case can be reduced to about 10 times smaller than those obtained by standard L1-regularization, i.e., to 12.2 MB from 124.5 MB."
      ]
    },
    {
      "heading": "5 Conclusion",
      "text": [
        "This paper proposed a model learning framework that can simultaneously realize feature grouping by the incorporation of a simple discrete constraint into model learning optimization.",
        "This paper also introduced a feasible algorithm, DC-ADMM, which can vanish the infeasible combinatorial optimization part from the entire learning algorithm with the help of the ADMM technique.",
        "Experiments showed that DC-ADMM drastically reduced model complexity in terms of the degrees of freedom in trained models while maintaining the performance.",
        "There may exist theoretically cleverer approaches to feature grouping, but the performance of DC-ADMM is close to the upper bound.",
        "We believe our method, DC-ADMM, to be very useful for actual use."
      ]
    }
  ]
}
