{
  "info": {
    "authors": [
      "Anders Søgaard"
    ],
    "book": "ACL",
    "id": "acl-P13-2113",
    "title": "Part-of-speech tagging with antagonistic adversaries",
    "url": "https://aclweb.org/anthology/P13-2113",
    "year": 2013
  },
  "references": [
    "acl-D07-1096",
    "acl-D10-1044",
    "acl-D11-1139",
    "acl-N06-1012",
    "acl-P07-1033",
    "acl-P07-1034",
    "acl-W02-1001",
    "acl-W06-1615",
    "acl-W10-2921"
  ],
  "sections": [
    {
      "text": [
        "Proceedings of the 51st Annual Meeting of the Association for Computational Linguistics, pages 640?644, Sofia, Bulgaria, August 4-9 2013. c?2013 Association for Computational Linguistics Part-of-speech tagging with antagonistic adversaries"
      ]
    },
    {
      "heading": "Abstract",
      "text": [
        "Supervised NLP tools and on-line services are often used on data that is very different from the manually annotated data used during development.",
        "The performance loss observed in such cross-domain applications is often attributed to covariate shifts, with out-of-vocabulary effects as an important subclass.",
        "Many discriminative learning algorithms are sensitive to such shifts because highly indicative features may swamp other indicative features.",
        "Regularized and adversarial learning algorithms have been proposed to be more robust against covariate shifts.",
        "We present a new perceptron learning algorithm using antagonistic adversaries and compare it to previous proposals on 12 multilingual cross-domain part-of-speech tagging datasets.",
        "While previous approaches do not improve on our supervised baseline, our approach is better across the board with an average 4% error reduction."
      ]
    },
    {
      "heading": "1 Introduction",
      "text": [
        "Most learning algorithms assume that training and test data are governed by identical distributions; and more specifically, in the case of part-of-speech (POS) tagging, that training and test sentences were sampled at random and that they are identically and independently distributed.",
        "Significance is usually tested across data points in standard NLP test sets.",
        "Such datasets typically contain running text rather than independently sampled sentences, thereby violating the assumption that data points are independently distributed and sampled at random.",
        "More importantly, significance across data points only says something about the likely-hood of observing the same effect on more data sampled the same way, but says nothing about likely performance on sentences sampled from different sources or different domains.",
        "This paper considers the POS tagging problem, i.e. where we have training and test data consisting of sentences in which all words are assigned a label y chosen from a finite set of class labels {NOUN, VERB, DET,.",
        ".",
        ".",
        "}.",
        "We assume that we are interested in performance across data sets or domains rather than just performance across data points, but that we do not know the target domain in advance.",
        "This is often the case when we develop NLP tools and on-line services.",
        "We will do cross-domain experiments using several target domains in order to compute significance across domains, enabling us to say something about likely performance on new domains.",
        "Several authors have noted how POS tagging performance is sensitive to cross-domain shifts (Blitzer et al., 2006; Daumé III, 2007; Jiang and Zhai, 2007), and while most authors have assumed known target distributions and pool unlabeled target data in order to automatically correct cross-domain bias (Jiang and Zhai, 2007; Foster et al., 2010), methods such as feature bagging (Sutton et al., 2006), learning with random adversaries (Globerson and Roweis, 2006) and L?-regularization (Dekel and Shamir, 2008) have been proposed to improve performance on unknown target distributions.",
        "These methods explicitly or implicitly try to minimize average or worst-case expected error across a set of possible test distributions in various ways.",
        "These algorithms are related because of the intimate relationship between adversarial corruption and regularization (Ghaoui and Lebret, 1997; Xu et al.,",
        "2009; Hinton et al., 2012).",
        "This paper presents a new method based on learning with antagonistic adversaries.",
        "Outline.",
        "Section 2 introduces previous work on robust perceptron learning, as well as the methods dicussed in the paper.",
        "Section 3 motivates and introduces learning with antagonistic adversaries.",
        "Section 4 presents experiments on POS tagging and discusses how to evaluate cross-domain performance.",
        "Learning with antagonistic adversaries is superior to the other approaches across 10/12 datasets with an average error reduction of 4% over a supervised baseline.",
        "Motivating example.",
        "The problem with out-of-vocabulary effects can be illustrated using a small labeled data set:",
        "our model on x1?3 and evaluate it on the fourth data point.",
        "Most discriminate learning algorithms only update parameters when training examples are misclassified.",
        "In this example, a model initialized by zero weights would misclassify x1, update the parameter associated with feature x2 at a fixed rate ?, and the returned model would then classify all data points correctly.",
        "Hence the parameter associated with feature x3 would never be updated, although this feature is also correlated with class.",
        "If x2 is missing in our test data (out-of-vocabulary), we end up classifying all data points as negative.",
        "In this case, we would wrongly predict that x4 is negative."
      ]
    },
    {
      "heading": "2 Robust perceptron learning",
      "text": [
        "Our framework will be averaged perceptron learning (Freund and Schapire, 1999; Collins, 2002).",
        "We use an additive update algorithm and average parameters to prevent over-fitting.",
        "In adversarial learning, adversaries corrupt the data point by applying transformations to data points.",
        "Antagonistic adversaries choose transformations informed by the current model parameters w, but random adversaries randomly select transformations from a predefined set of possible transformations, e.g. deletions of at most k features (Globerson and Roweis, 2006).",
        "Feature bagging.",
        "In feature bagging (Sutton et al., 2006), the data is represented by different bags of features or different views, and the models learned using different feature bags are combined by averaging.",
        "We can reformulate feature bagging as an adversarial learning problem.",
        "For each pass, the adversary chooses a deleting transformation corresponding to one of the feature bags.",
        "In Sutton et al. (2006), the feature bags simply divide the features into two or more representations.",
        "In an online setting feature bagging can be modelled as a game between a learner and an adversary, in which (a) the adversary can only choose between deleting transformations, (b) the adversary cannot see model parameters when choosing a transformation, and in which (c) the adversary only moves in between passes over the data.1 Learning with random adversaries (LRA).",
        "Globerson and Roweis (2006) let an adversary corrupt labeled data during training to learn better models of test data with missing features.",
        "They assume that missing features are randomly distributed and show that the optimization problem is a second-order cone program.",
        "LRA is an adversarial game in which the two players are unaware of the other player's current move, and in particular, where the adversary does not see model parameters and only randomly corrupts the data points.",
        "Globerson and Roweis (2006) formulate LRA as a batch learning problem of minimizing worst case loss under deleting transformations deleting at most k features.",
        "This is related to regularization in the following way: If model parameters are chosen to minimize expected error in the absence of any k features, we explicitly prevent under-weighting more than n ?",
        "k features, i.e. the model must be able to classify data well in the absence of any k features.",
        "The sparsest possible model would thus assign weights to k + 1 parameters.",
        "L?-regularization hedges its bets even more than adversarial learning by minimizing expected error with max ||w ||< C. In the online setting, this corresponds to playing against an adversary that clips any weight above a certain threshold C, whether positive or negative (Dekel and Shamir, 2008).",
        "In geometric terms the weights are projected back onto the hypercube C. A related approach, which is not explored in the experiments below, is to regularize linear models toward weights with low variance (Bergsma et al., 2010).",
        "1Note that the batch version of feature bagging is an instance of group L1 regularization (Jacob et al., 2009; Schmidt and Murphy, 2010; Martins et al., 2011).",
        "Often group regularization is about finding sparser models rather than robust models.",
        "Sparse models can be obtained by grouping correlated features; non-sparse models can be obtained by using independent, exhaustive views.",
        "1: X = {?yi,xi?",
        "}Ni=1, ?",
        "deletion rate 2: w0 = 0,v = 0, i = 0 3: for k ?",
        "K do 4: for n ?",
        "N do 5: ?1 ?",
        "random.sample(P (1) = 1?",
        "?)",
        "6: ?2 ?",
        "||w ||< ?||w ||+ ?||w|| 7: ?",
        "?",
        "(?1 + ?2)(0,1) 8: if sign(w ?",
        "xn ?",
        "?)",
        "6= yn then 9: wi+1 ?",
        "update(wi) 10: i?",
        "i+ 1 11: end if 12: v?",
        "v + wi 13: end for 14: end for 15: return w = v/(N ?K)"
      ]
    },
    {
      "heading": "3 Learning with antagonistic adversaries",
      "text": [
        "The intuition behind learning with antagonistic adversaries is that the adversary should focus on the most predictive features.",
        "In the prediction game, this would allow the adversary to inflict more damage, corrupting data points by removing good features (rather than random ones).",
        "If the adversary focuses on the most predictive features, she is implicitly regularizing the model to obtain a more equal distribution of weights.",
        "We draw random binary vectors with P (1) = 1 ?",
        "?",
        "as in adversarial learning, but deletions are only effective if ?j = 0 and the weight wj is more than a standard deviation (?||w||) from the mean of the current absolute weight distribution (?||w||).",
        "In other words, we only delete the predictive features, with predictivity being relative to the current mean weight.",
        "The algorithm is presented in Figure 1.",
        "For each data point, we draw a random binary vector ?1 with ?",
        "chance of zeros.",
        "?2 is a vector with the ith scalar zero if and only if the absolute value of the weight wi in w is more than a standard deviation higher than the current mean.",
        "The ith scalar in ?",
        "is only zero if the ith scalars in both ?1 and ?2 are zero.",
        "The corresponding features are a random subset of the predictive features.2 2The approach taken is similar in spirit to confidence-weighted learning (Dredze et al., 2008).",
        "The intuition behind confidence-weighted learning is to more agressively update rare features or features that we are less confident about.",
        "In learning with antagonistic adversaries the adversaries delete predictive features; that is, features that we are confident about.",
        "When these features are deleted, we do not update the corresponding weights.",
        "In relative terms, we therefore update rare features more aggressively than common ones.",
        "Note also that by doing so we regularize toward weights with low variance (Bergsma et al., 2010)."
      ]
    },
    {
      "heading": "4 Experiments",
      "text": [
        "We consider part-of-speech (POS) tagging, i.e. the problem of assigning syntactic categories to word tokens in running text.",
        "POS tagging accuracy is known to be very sensitive to domain shifts.",
        "Foster et al. (2011) report a POS tagging accuracy on social media data of 84% using a tagger that ac-chieves an accuracy of about 97% on newspaper data.",
        "In the case of social media data, many errors occur due to different spelling and capitalization conventions.",
        "The main source of error, though, is the increased out-of-vocabulary rate, i.e. the many unknown words.",
        "While POS taggers can often recover the part of speech of a previously unseen word from the context it occurs in, this is harder than for previously seen words.",
        "We use the LXMLS toolkit3 as our baseline with the default feature model, but use the PTB tagset rather than the Google tagset (Petrov et al., 2011) used by default in the LXMLS toolkit.",
        "We use four groups of datasets.",
        "The first group comes from the English Web Treebank (EWT),4 also used in the Parsing the Web shared task (Petrov and McDonald, 2012).",
        "We train our tagger on Sections 2?21 of the WSJ data in the Penn-III Treebank (PTB), Ontonotes 4.0 release.",
        "The EWT contains development and test data for five domains: answers (from Yahoo!",
        "), emails (from the Enron corpus), BBC newsgroups, Amazon reviews, and weblogs.",
        "We use the emails development section for development and test on the remaining four test sets.",
        "We also do experiments with additional data from PTB.",
        "For these experiments we use the 0th even split of the biomedical section (PTB-biomedical) as development data, the 9th split and the chemistry section (PTB-chemistry) as test data, and the remaining biomedical data (splits 1?8) as training data.",
        "This data was also used for developing and testing in the CoNLL 2007 Shared Task (Nivre et al., 2007).",
        "Our third group of datasets also comes from Ontonotes 4.0.5 We use the Chinese Ontonotes (CHO) data, covering five different domains.",
        "We use newswire for training data and randomly sampled broadcasted news for development.",
        "Finally we do experiments with the Danish section of the Copenhagen Dependency Treebank (CDT).",
        "For CDT we rely on the treebank meta-data and sin",
        "gle out the newspaper section as training data and use held-out newspaper data for development.",
        "We observe two characteristics about our datasets: (a) The class distributions are relatively stable across domains.",
        "For CDT, for example, we see almost identical distributions of parts of speech, except literature has more prepositions.",
        "(b) The OOV rate is significantly higher across domains than within domains.",
        "This holds even for the PTB datasets, where the OOV rate is 14.6% on the biomedical test data, but 43.3% on the chemistry test data.",
        "These two observations confirm that cross-domain data is primarily biased by covariate shifts.",
        "All learning algorithms do the same number of passes over each training data set.",
        "The number of iterations was set optimizing baseline system performance on development data.",
        "For EWT and CHO, we do 10 passes over the data.",
        "For PTB, we do 15 passes over the data, and for CDT, we do 25 passes over the data.",
        "The deletion rate in adversarial learning was fixed to 0.1% (optimized on the EWT emails data; not optimized on PTB, CHO or CDT).",
        "In L?-regularization, the parameter C was optimized the same way and set to 20.",
        "Results are averages over five runs."
      ]
    },
    {
      "heading": "4.1 Results",
      "text": [
        "The results are presented in Table 1.",
        "Learning with antagonistic adversaries performs significantly better than structured perceptron (SP) learning, L?-regularization and LRA across the board.",
        "We follow Demsar (2006) in computing significance across datasets using a Wilcoxon signed rank test.",
        "This is a strong result given that our algorithm is as computationally efficient as SP and does not pool unlabeled data to adapt to a specific target distribution.",
        "What we see is that letting an antagonistic adversary corrupt our labeled data - somewhat surprisingly, maybe - leads to better cross-domain performance.",
        "L?-regularization leads to worse performance, and LRA performs very similar to SP on average.",
        "Improvements to LRA have also been explored in Trafalis and Gilbert (2007) and Dekel and Shamir (2008).",
        "We note that on the in-domain dataset (PTB-biomedical), L?-regularization performs best, but our approach also performs better than the structured perceptron baseline on this dataset."
      ]
    },
    {
      "heading": "4.2 Analysis",
      "text": [
        "The number of zero weights or very small weights is significantly lower for learning with antagonistic adversaries than for the baseline structured perceptron.",
        "So our models become less sparse.",
        "On the other hand, we have more parameters with average weights in our models.",
        "Weights are in other words better distributed.",
        "We also observe that parameters are updated slightly more with antagonistic adversaries.",
        "In our PTB experiments, for example, the mean weight is 14.2 in structured perceptron learning, but 14.5 with antagonistic adversaries.",
        "On the other hand, weight variance is slightly lower; recall the connection to variance regularization (Bergsma et al., 2010).",
        "Note that L?-regularization with C = 20 corresponds to clipping all weights above 20, i.e. roughly a third of the weights in this case.",
        "To validate our intuitions about what is going on, we also tried to increase the deletion rate.",
        "If ?",
        "is increased to 1%, the mean weight goes up to 19.2.",
        "The adversarial model is less sparse than the baseline model.",
        "A last observation is that the structured perceptron baseline model expectedly fits the training data better than the robust models.",
        "On CDT, the structured perceptron has an accuracy of 98.26% on held-out training data, whereas our model has an accuracy of only 97.85%.",
        "The L?-regularized has an accuracy of 97.82%, whereas LRA has an accuracy of 98.18%."
      ]
    },
    {
      "heading": "5 Conclusion",
      "text": [
        "We presented a discriminative learning algorithms for cross-domain structured prediction that seems more robust to covariate shifts than previous approaches.",
        "Our approach was superior to previous approaches across 12 multilingual cross-domain POS tagging datasets, with an average error reduction of 4% over a structured perceptron baseline."
      ]
    }
  ]
}
