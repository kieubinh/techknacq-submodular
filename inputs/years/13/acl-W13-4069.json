{
  "info": {
    "authors": [
      "Sungjin Lee"
    ],
    "book": "SIGDIAL",
    "id": "acl-W13-4069",
    "title": "Structured Discriminative Model for Dialog State Tracking",
    "url": "https://aclweb.org/anthology/W13-4069",
    "year": 2013
  },
  "references": [
    "acl-W11-2016",
    "acl-W12-1626",
    "acl-W13-4066"
  ],
  "sections": [
    {
      "heading": "Abstract",
      "text": [
        "Many dialog state tracking algorithms have been limited to generative modeling due to the influence of the Partially Observable Markov Decision Process framework.",
        "Recent analyses, however, raised fundamental questions on the effectiveness of the generative formulation.",
        "In this paper, we present a structured discriminative model for dialog state tracking as an alternative.",
        "Unlike generative models, the proposed method affords the incorporation of features without having to consider dependencies between observations.",
        "It also provides a flexible mechanism for imposing relational constraints.",
        "To verify the effectiveness of the proposed method, we applied it to the Let's Go domain (Raux et al., 2005).",
        "The results show that the proposed model is superior to the baseline and generative model-based systems in accuracy, discrimination, and robustness to mismatches between training and test datasets."
      ]
    },
    {
      "heading": "1 Introduction",
      "text": [
        "With the recent remarkable growth of speech-enabled applications, dialog state tracking has become a critical component not only for typical telephone-based spoken dialog systems but also for multi-modal dialog systems on mobile devices and in automobiles.",
        "With present Automatic Speech Recognition (ASR) and Spoken Language Understanding errors, it is impossible to directly observe the true user goal and action.",
        "It is crucial, therefore, to accurately estimate the true dialog state from erroneous observations as a dialog unfolds.",
        "Since the Partially Observable Markov Decision Process (POMDP) framework has offered a well-founded theory for both state tracking and decision making, most earlier studies adopted generative temporal models, the typical way to formulate belief state updates for POMDP-based systems (Williams and Young, 2007).",
        "Several approximate methods have also emerged to tackle the vast complexity of representing and maintaining belief states, e.g., partition-based approaches (Gasic and Young, 2011; Lee and Eskenazi, 2012a; Williams, 2010; Young et al., 2010) and Bayesian network (BN)-based methods (Raux and Ma, 2011; Thomson and Young, 2010).",
        "To verify the effectiveness of these techniques, some were deployed in a real user system for the Spoken Dialog Challenge (Black et al., 2010).",
        "The results demonstrated that the use of statistical approaches helps estimate the true dialog state and achieves increased robustness to ASR errors (Thomson et al., 2010b; Lee and Eskenazi 2012b; Williams, 2011; Williams, 2012).",
        "However, further analysis also raised several fundamental questions about the formulation of the belief update as a generative temporal model: limitation in modeling correlations between observations in different time slices; and the insensitive discrimination between true and false dialog states (Williams, 2012).",
        "There are more potential downsides of generative models, which will be discussed in detail in Section 2.",
        "On the other hand, natural language processing, computer vision and other machine learning research areas have increasingly profited from discriminative approaches.",
        "Discriminative approaches directly model the class posteriors, allowing them to incorporate a rich set of features without worrying about their dependencies on one another.",
        "This could result in a deficient probability distribution with generative models (Sutton and McCallum, 2006).",
        "The aim of this paper is to describe a first attempt to adopt a structured discriminative model for dialog state tracking.",
        "To handle nonlinearity of confidence score and variable cardinality of the possible values of output variables, the traditional approaches applied to other tasks have been modified.",
        "To verify the effectiveness of the proposed method, we applied it to the Let's Go1 domain (Raux et al., 2005).",
        "The proposed model was compared with its unstructured version without relational constraints, the baseline system which always takes the top ASR hypothesis in the entire dialog, and finally the AT&T Statistical Dialog Toolkit2 (ASDT) which is one of the state-of-the-art generative model-based systems.",
        "This paper is structured as follows.",
        "Section 2 describes previous research and the novelty of our approach.",
        "Section 3 elaborates on our proposed structured discriminative approach.",
        "Section 4 explains the experimental setup.",
        "Section 5 presents and discusses the results.",
        "Finally, Section 6 concludes with a brief summary and suggestions for future research."
      ]
    },
    {
      "heading": "2 Background and Related Work",
      "text": [
        "A statistical dialog system needs to update its dialog state when taking the action and observing .",
        "Since the POMDP framework assumes the Markovian property between states, updating a belief state involves only the previous belief state, the system action, and the current observation:",
        "where ( ) denotes the probability distribution over states , ( |) the likelihood of given the state , ( |) the state transition probability, and is a normalizing constant.",
        "In practice, however, belief state updates (Equation 1) in many domains are often computationally intractable due to the tremendously large size of the belief state space.",
        "In order to reduce the complexity of the belief states, the following belief state factorization has been commonly applied to the belief update procedure (Williams et al., 2005):",
        "where , , , represents the user goal, the dialog history, and the user action, respectively.",
        "Partition-based approaches (Gasic and Young, 2011; Lee and Eskenazi, 2012; Williams, 2010; Young et al., 2010) attempt to group user goals into a small number of partitions and split a partition only when this distinction is required by observations.",
        "This property endows it with the high scalability that is suitable for fairly complex domains.",
        "In partition-based approaches, the goal model in Equation 2 is further approximated as follows:",
        "where is a partition from the current turn.",
        "One of the flaws of the partition-based approaches is that when one defines a partition to be a Cartesian product of subsets of possible values of multiple concepts, it will be difficult to adopt sophisticated prior distributions over partitions.",
        "That may lead to either employing very simple priors such as uniform distribution or maintaining partition structures separately for each concept.",
        "This is one of the main reasons that the previous partition-based approaches could not incorporate probabilistic or soft relational constraints into the models.",
        "To allow for relational constraints and alleviate the complexity problem at the same time, Dynamic Bayesian Networks (DBN) with more detailed structures for the user goal have also been developed (Thomson and Young, 2010).",
        "Nevertheless, there is still a limitation on the types of constraints they can afford.",
        "Since DBN is a directed network, it is not quite suitable for specifying undirected constraints.",
        "For example, in the Let's Go domain, users can say the same name for the arrival place as the departure place if they are distracted, missing the prompt for the arrival place and so repeating themselves with the departure place.",
        "It is also possible for some place names with similar pronunciations to be recognized as the same (e.g. Forbes and Forward).",
        "The system can, in this",
        "case, use the constraint that the departure and arrival places may not be identical.",
        "Another drawback of both approaches is that it is hard to incorporate a rich set of observation features, which are often partly dependent on each other.",
        "One can create a feature which reflects ASR error correlations between observations in different time slices.",
        "For example, a hypothesis that repeats with low confidence scores is likely to be a manifestation of ASR error correlations.",
        "Thus, the highest confidence score that a hypothesis has attained so far could be a useful feature in preventing repeated incorrect hypotheses from defeating the correct hypothesis (which had a higher score but was only seen once).",
        "Another useful feature could be the distribution of confidence scores that a hypothesis has attained thus far, since it may not have the same effect as having a single observation with the total score due to the potential nonlinearity of confidence scores.",
        "There are many other potentially useful features.",
        "The entire list of features is found in Section 3.2.",
        "Dynamic Probabilistic Ontology Trees (Raux and Ma, 2011) is another method based upon DBN which does not impose explicit temporal structures.",
        "Since it does not impose temporal structures, it is more flexible in considering multiple observations together.",
        "However, it is still difficult to capture codependent features, which are exemplified above, without introducing probabilistic deficiency due to its generative foundation (Appendix E).",
        "Moreover, the quality of the confidence score will be critical to all generative models up to that point since they do not usually try to handle potential nonlinearity in confidence scores.",
        "As far as discriminative models are concerned, the Maximum Entropy (MaxEnt) model has been applied (Bohus and Rudnicky, 2006).",
        "But the model is limited to a set of separate models for each concept, not incorporating relational dependencies.",
        "Also, it is restricted to maintain only top K-best hypotheses where K is a predefined parameter, resulting in potential degradation of performance and difficulties in extending it to structured models.",
        "In Section 3, our structured discriminative model is described.",
        "It is designed to take into consideration the aforementioned limitations of generative models and the previous discriminative approach."
      ]
    },
    {
      "heading": "3 Structured Discriminative Model",
      "text": [
        "Unlike generative models, discriminative models directly model the class posterior given the observations.",
        "Maximum Entropy is one of most powerful undirected graphical models (Appendix A).",
        "But for some tasks that predict structured outputs, e.g. a dialog state, MaxEnt becomes impractical as the number of possible outputs astronomically grows.",
        "For example, in the Lets Go domain, the size of possible joint output configurations is around 1017.",
        "To address this problem, Conditional Random Field (CRF) was introduced which allows dependencies between output variables to be incorporated into the statistical model (Appendix B)."
      ]
    },
    {
      "heading": "3.1 Model Structure for Dialog State Tracking",
      "text": [
        "We now describe our model structure for dialog state tracking in detail using the Let's Go domain as a running example.",
        "The graphical representation of the model is shown in Fig. 1.",
        "The global output nodes for each concept (clear nodes in Fig. 1) are unlike other temporal models, where a set of output nodes are newly introduced for each time slice.",
        "Instead, as a dialog proceeds, a set of new observations (shaded nodes in Fig. 1) are continuously attached to the model structure and the feature",
        "functions are responsible for producing fixed length feature vectors.",
        "The sequence of observations includes not only ASR N-best lists but also system actions from the beginning of the dialog to the current time slice .",
        "Any output node can be freely connected to any other to impose desirable constraints between them whether or not the connections form a loop (solid lines in Fig. 1).",
        "In practice, models rely extensively on parameter tying, e.g., transition parameters in a Hidden Markov Model.",
        "One specific example of relational constraints and parameter tying naturally arises in the Let's Go domain: the feature function which indicates whether a place is valid on a given route could use the same weights for both departure and arrival places (the solid node and the associated factor nodes in Fig. 1).",
        "Parameter tying is also implicitly taking place.",
        "This is crucial for robust estimation of the model parameters in spite of data sparseness.",
        "Some concepts such as from and to can have about 104 values but most of them are not seen in the training corpus.",
        "Thus we aggregate several feature functions which differ only by output labels into one common feature function so that they can gather their statistics together.",
        "For example, we can aggregate the observation feature functions (dotted lines in Fig. 1) associated with each output label except for None (Section 3.2).",
        "Here, None is a special value to indicate that the true hypothesis has not yet appeared in the ASR N-best lists.",
        "Since there are generally a large number of values for each concept, the probability of the true hypothesis will be very small unless the true hypothesis appears on the N-best lists.",
        "Thus we can make inferences on the model very quickly by focusing only on the observed hypotheses at the cost of little performance degradation.",
        "Additionally, the feature function aggregation allows for the entire observed hypotheses to be incorporated without being limited to only the predefined number of hypotheses."
      ]
    },
    {
      "heading": "3.2 Model Features",
      "text": [
        "In this section, we describe the model features which are central to the performance of discriminative models.",
        "Features can be broadly split into observation features and relational features.",
        "To facilitate readers?",
        "understanding an example of feature extraction is illustrated in Fig. 2.",
        "One of the most fundamental features for dialog state tracking should exploit the confidence scores assigned to an informed hypothesis.",
        "The simplest form could be direct use of confidence scores.",
        "But often pre-trained confidence measures fail to match the empirical distribution of a given dialog domain (Lee and Eskenazi, 2012; Thomson et al. 2010a).",
        "Also the distribution of confidence scores that a hypothesis has attained so far may not have the same effect as the total score of the confidence scores (e.g., in Fig. 2, two observations for 61C with confidence score 0.3 vs. 0.6 which is the sum of the scores).",
        "Thus we create a feature function that divides the range of confidence scores into bins and returns the frequency of observations that fall into the corresponding bin:",
        "where ( ) returns the set of confidence scores whose action informs in the sequence of observations .",
        "( ) computes the frequency of observations that fall into the bin.",
        "There are two types of grounding actions which are popular in spoken dialog systems, i.e., implicit and explicit confirmation.",
        "To leverage affirmative or negative responses to such system acts, the following feature functions are introduced in a similar fashion as the feature function:",
        "where ( ) / ( ) returns the set of confidence scores whose associated action affirms / negates in the sequence of",
        "where ( ) indicates whether or not the user has negated the system's implicit confirmation in the sequence of observations .",
        "Another interesting feature function is the so-called baseline feature which exploits the output of a baseline system.",
        "The following feature function emulates the output of the baseline system which always selects the top ASR hypothesis for the entire dialog:",
        "confidence score whose action informs in the sequence of observations .",
        "( ) indicates whether or not the maximum score falls into the bin.",
        "Yet another feature function of this kind is the accumulated score which adds up all confidence scores associated with inform and affirm and subtracts the ones with negation:",
        "Note that such feature functions as ( ) and ( ) are not independent of the others defined previously, which may cause generative models to produce deficient probability distributions (Appendix E).",
        "It is known that prior information can boost the performance (Williams, 2012) if the prior is well-estimated.",
        "One of advantages of generative models is that they provide a natural mechanism to incorporate a prior.",
        "Discriminative models also can exploit a prior by introducing additional feature functions:",
        "where ( ) returns the fraction of occurrences of in the set of true labels.",
        "If the system cannot process a certain user request, it is highly likely that the user change his/her goal.",
        "The following feature function is designed to take care of such cases:",
        "where ( ) indicates whether or not is out-of-coverage.",
        "As with other log-linear models, we also have feature functions for bias:",
        "Note that we have an additional bias term for None to estimate an appropriate weight for it.",
        "Regarding relational constraints, we have created two feature functions.",
        "To reflect the presumption that it is likely for the true hypothesis for the place concepts (i.e. from and to) to be valid on the true hypothesis for the route concept, we have:",
        "where ( ) indicates whether or not the place is valid on the route .",
        "Another feature function considers the situation where the same place name for both departure and arrival places"
      ]
    },
    {
      "heading": "3.3 Inference & Parameter Estimation",
      "text": [
        "One of the common grounding actions of spoken dialog systems is to ask a confirmation question about hypotheses which do not have sufficient marginal beliefs.",
        "This makes marginal inference",
        "to be one of the fundamental reasoning tools for dialog state tracking.",
        "In treelike graphs, exact marginal probabilities are efficiently computable by using the Junction Tree algorithm (Lauritzen and Spiegelhalter, 1988) but in general it is intractable on structured models with loops.",
        "Since it is highly likely to have loopy structures in various domains (e.g.",
        "Fig.",
        "1), we need to adopt approximate inference algorithms instead.",
        "Note that CRF (Equation 16) is an instance of the exponential family.",
        "For the exponential family, it is known that the exact inference can be formulated as an optimization problem (Wainwright and Jordan, 2008).",
        "The variational formulation opens the door to various approximate inference methods.",
        "Among many possible approximations, we adopt the Tree Reweighted Belief Propagation (TRBP) method which convexifies the optimization problem that it guarantees finding the global solution (Appendix C).",
        "On the other hand, joint inference also becomes important for either selecting a hypothesis to confirm or determining the final joint configuration when there exist strong relational dependencies between concepts.",
        "Moreover, we would like to find not just the best configuration but rather the top configurations.",
        "Since the number of concept nodes is generally moderate, we approximate the inference by searching for the top configurations only within the Cartesian product of the top hypotheses of each concept.",
        "For domains with a large number of concepts, one can use more advanced methods, e.g., Best Max-Marginal First (Yanover and Weiss, 2004) and Spanning Tree Inequalities and Partitioning for"
      ]
    },
    {
      "heading": "Enumerating Solutions (Fromer and Globerson,",
      "text": [
        "2009).",
        "The goal of parameter estimation is to minimize the empirical risk.",
        "In this paper, we adopt the negative of the conditional log likelihood (Appendix D).",
        "Given the partial derivative (Equation 26), we employ the"
      ]
    },
    {
      "heading": "Orthant-wise Limited-memory Quasi Newton",
      "text": [
        "optimizer (Andrew and Gao, 2007) for L1 regularization to avoid model overfitting."
      ]
    },
    {
      "heading": "4 Experimental Setup",
      "text": [
        "In order to evaluate the proposed method, two variants of the proposed method (discriminative model (DM) and structured discriminative model (SDM)) were compared with the baseline system, which always takes the top ASR hypothesis for the entire dialog and outputs the joint configuration using the highest average score, and the ASDT system as being the state-of-the-art partition-based model (PBM).",
        "To train and evaluate the models, two datasets from the Spoken Dialog Challenge 2010 are used: a) AT&T system (Williams, 2011), b) Cambridge system (Thomson et.",
        "al, 2010b).",
        "For discriminative models, we used 10 bins for the feature functions that need to discretize their inputs (Section 3.2).",
        "Parameter tying for relational constraints was applied to dataset A but not to dataset B.",
        "To make sure that TRBP produces an upper bound on the original entropy, the constants were set to be for SDM and 1 for DM (Appendix C).",
        "Also the weights for L1 regularization were set to be 10 and 2.5 for the prior features and the other features, respectively.",
        "These values were chosen through cross-validation over several values rather than doing a thorough search.",
        "For the ASDT system, we modified it to process implicit confirmation and incorporate the prior distribution which was estimated on the training corpus.",
        "The prior distribution was smoothed by approximate Good-Turing estimation on the fly when the system encounters an unseen value at run time.",
        "Two aspects of tracker performance were measured at the end of each dialog, i.e.",
        "Accuracy and Receiver Operating Characteristic (ROC).",
        "Accuracy measures the percent of dialogs where the tracker's top hypothesis is correct.",
        "ROC assesses the discrimination of the top hypothesis's score.",
        "Note that we considered None as being correct if there is no ASR hypothesis corresponding to the transcription.",
        "If all turns are evaluated regardless of context, concepts which appear earlier in the dialog will be measured more times than concepts later in the dialog.",
        "In order to make comparisons across concepts fair, concepts are only measured when",
        "number of dialogs which have non-empty utterances for that concept.",
        "From and To concepts add up the counts for their sub-concepts.",
        "Joint denotes the joint configuration of all concepts.",
        "they are in focus.",
        "It does not, however, allow for a tracker to receive score for new estimations about concepts that are not in focus.",
        "In addition, dialogs with more turns will have a greater effect than dialogs with fewer turns.",
        "Therefore we only measure concepts which appear in the dialog at the last turn of the dialog before restart.",
        "The statistics of the training and test datasets are summarized in Table 1."
      ]
    },
    {
      "heading": "5 Results and Discussion",
      "text": [
        "The results indicate that discriminative methods outperform the baseline and generative method by a large performance gap for both dataset A and B (Table 2).",
        "Also, SDM exceeds DM, demonstrating the effectiveness of using relational constraints.",
        "Furthermore, the performance of SDM surpasses that of the best system in the Dialog State Tracking Challenge3 (Lee and Eskenazi, 2013).",
        "Even though the generative model underperforms discriminative models, it is also shown that dialog state tracking methods in general are effective in improving robustness to ASR errors.",
        "Another noteworthy result is that the gains for Joint by using discriminative models are much larger than those for All.",
        "Estimating joint configurations correctly is crucial to eventually satisfy the user's request.",
        "This result implies that the proposed model performs evenly well for all concepts and is more robust to the traits of each concept.",
        "For example, PBM works relatively poorly for To on dataset A.",
        "What makes To different is that the quality of the",
        "ASR hypotheses of the training data is much better than that of test data: the baseline accuracy on the training data is 84.79% while 77.05% on the test data.",
        "Even though PBM suffers this mismatch, the discriminative models are doing well without significant differences, implying that the discriminative models achieve robustness by considering not just the confidence score but also several features together.",
        "Since there has been no clear evidence that the use of N-best ASR hypotheses is helpful for dialog state tracking (Williams, 2012), we also report accuracies while varying the number of N-best hypotheses.",
        "The results show that the use of N-bests helps boost accuracy across all models on dataset A.",
        "However, interestingly it hampers the performance in the case of dataset B.",
        "It demonstrates that the utility of N-bests depends on various factors, e.g., the quality of N-bests and dialog policies.",
        "The system which yielded dataset A employs implicit and explicit confirmation much more frequently than the system which produced dataset B does.",
        "The proposed model trained on dataset A without confirmation features incorporated actually showed a slight degradation in accuracy when using more than 3-bests.",
        "This result indicates that we need to take into consideration the type of dialog strategy to determine how many hypotheses to use.",
        "Thus, it can be conceivable to dynamically change the range of N-bests according to how a dialog proceeds.",
        "That allows the system to reduce processing time when a dialog goes well.",
        "means a weighted average accuracy across all concepts.",
        "The ROC curves assess the discrimination of the top hypothesis?",
        "score (Fig.",
        "3).",
        "Note that the discriminative models are far better than PBM on both dataset A and B.",
        "In fact, PBM turns out to be even worse than the baseline.",
        "The better discrimination can give rise to additional values of a tracker.",
        "For example, it can reduce unnecessary confirmations for values with sufficiently high belief.",
        "Also, it enables a model to adapt to test data in an unsupervised manner by allowing us to set a proper threshold to produce predictive labels."
      ]
    },
    {
      "heading": "6 Conclusion",
      "text": [
        "In this paper, we presented the first attempt, to our knowledge, to create a structured discriminative model for dialog state tracking.",
        "Unlike generative models, the proposed method allows for the incorporation of various features without worrying about dependencies between observations.",
        "It also provides a flexible mechanism to impose relational constraints.",
        "The results show that the discriminative models are superior to the generative model in accuracy, discrimination, and robustness to mismatches between training and test datasets.",
        "Since we used relatively simple features for this work, there is much room to boost performance through feature engineering.",
        "Also, more thorough search for regularization weights can give additional performance gain.",
        "Moreover, one can apply different loss functions, e.g., hinge loss to obtain structured support vector machine.",
        "In order to further confirm if the performance improvement by the proposed method can be translated to the enhancement of the overall spoken dialog system, we need to deploy and assess it with real users."
      ]
    },
    {
      "heading": "Acknowledgments",
      "text": [
        "This work was funded by NSF grant IIS0914927.",
        "The opinions expressed in this paper do not necessarily reflect those of NSF.",
        "The author would like to thank Maxine Eskenazi for helpful comments and discussion."
      ]
    }
  ]
}
