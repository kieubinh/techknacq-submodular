{
  "info": {
    "authors": [
      "Sujeeth Bharadwaj",
      "Mark Hasegawa-Johnson"
    ],
    "book": "COLING",
    "id": "acl-C14-1014",
    "title": "A PAC-Bayesian Approach to Minimum Perplexity Language Modeling",
    "url": "https://aclweb.org/anthology/C14-1014",
    "year": 2014
  },
  "references": [
    "acl-J92-4003",
    "acl-N09-1051",
    "acl-P06-1124",
    "acl-P96-1041"
  ],
  "sections": [
    {
      "text": [
        "Abstract",
        "Despite the overwhelming use of statistical language models in speech recognition, machine translation, and several other domains, few high probability guarantees exist on their generalization error.",
        "In this paper, we bound the test set perplexity of two popular language models ?",
        "the n-gram model and class-based n-grams ?",
        "using PAC-Bayesian theorems for unsupervised learning.",
        "We extend the bound to sequence clustering, wherein classes represent longer context such as phrases.",
        "The new bound is dominated by the maximum number of sequences represented by each cluster, which is polynomial in the vocabulary size.",
        "We show that we can still encourage small sample generalization by sparsifying the cluster assignment probabilities.",
        "We incorporate our bound into an efficient HMM-based sequence clustering algorithm and validate the theory with empirical results on the resource management corpus."
      ]
    },
    {
      "heading": "1 Introduction",
      "text": [
        "The ability to predict unseen events from a few training examples is the holy grail of statistical language modeling (SLM).",
        "Although the final test for any language model is its contribution to the performance of a real system, task-independent metrics such as perplexity are popular for evaluating the general quality of a model.",
        "Standard algorithms therefore attempt to minimize perplexity on some previously unobserved test set, assumed to be drawn from the same distribution as the training set.",
        "This begets the question of how the test set perplexity is related to training set perplexity ?",
        "every paper on SLM has an answer, with varying levels of theoretical and empirical justification.",
        "The problem of data sparsity and generalization can be traced back to at least as early as Good (1953), and possibly Laplace, who recognizes that the maximum likelihood (ML) estimate of event frequencies (n-grams) cannot handle unseen events.",
        "Smoothing techniques such as the add-one estimator (Lidstone, 1920) and the Good-Turing estimator (Good, 1953) assign a non-zero probability to events that have never been observed in the training set.",
        "Recently, Ohannessian and Dahleh (2012) strengthened the theory by showing that Good-Turing estimation is consistent when the data generating process is heavy-tailed.",
        "In the context of this paper, smoothing was perhaps the first attempt to bound generalization error, in that it successfully guarantees a finite test set perplexity.",
        "It is evident that smoothing of the n-gram estimate alone is not sufficient.",
        "Techniques that incorporate lower and higher order n-grams, such as Katz (1987) smoothing, Jelinek-Mercer (1980) interpolation, and Kneser-Ney (1995) smoothing, have become standard (Rosenfeld, 2000).",
        "Chen and Goodman (1999) provide a thorough empirical comparison of smoothing methods and uncover useful relationships between the test set cross-entropy (log perplexity) and the size of the training set, model order, etc.",
        "A Bayesian interpretation further explains why some of the techniques (don't) work.",
        "Teh (2006) discusses fundamental limitations of the Dirichlet process (Mackay and Peto, 1995) and proposes the hierarchical Pitman-Yor language model as a better way of generating the heavy-tailed (power law) distributions exhibited in natural language.",
        "130 Instead of directly modeling a heavy-tailed distribution over words, class-based models address data sparsity by estimating n-grams over clusters of words.",
        "Intuitively, clustering is a transformation of the event space from the space of word n-grams, in which most events are rare, to the space of class n-grams, which is more densely measured and therefore requires fewer training examples.",
        "Brown et al. (1992) show that the clustering function that maximizes the training data likelihood must also maximize mutual information between adjacent clusters; although several useful clustering algorithms are based on this principle, no provable guarantees currently exist.",
        "Moreover, word transitions are never completely captured by the underlying class transitions, and some tradeoff between accurate estimation of frequent events (word n-grams) and generalization to unseen events (class n-grams) is desired ?",
        "class-based models are therefore often interpolated with word n-grams using some of the previously described Bayesian methods (Rosenfeld, 2000).",
        "Our survey of SLM techniques and their treatment of generalization error has been rather brief and certainly not comprehensive.",
        "We focus primarily on n-grams and related models since they have dominated SLM over the last several decades (Rosenfeld, 2000), and therefore serve as a good starting point for further analysis.",
        "The existing literature suggests that apart from empirical validation and intuition, no provable guarantees exist on the generalization error of language models.",
        "Bayesian techniques work well only to the extent the prior assumptions are valid; in this paper, we present theoretical guarantees that hold irrespective of the correctness of the prior.",
        "Model selection approaches such as the Akaike Information Criterion (AIC) (Akaike, 1973) and its variants (Burnham and Anderson, 2002) quantify the tradeoff between complexity and goodness of fit.",
        "In the context of a language model, it can be shown that test set cross entropy is approximately the training set cross entropy plus the number of model parameters.",
        "Unfortunately, such bounds are loose and do not provide significant algorithmic insight ?",
        "at best, they recommend the smallest model that works well on the training set.",
        "Chen (2009) obtained a very accurate relationship for exponential language models by estimating the test set performance with linear regression.",
        "Although empirical, his approximation leads to better models based on l 1 + l 2 2 regularization.",
        "Exponential models are often motivated with the minimum discrimination information (MDI) principle, which roughly states that of all distributions satisfying a particular set of features, the exponential family is the centroid (minimizes distortion relative to the farthest possible true distribution) (Rosenfeld, 1996).",
        "This does not bound the generalization error in the manner we wish to, but it is nevertheless a useful property that complements Chen's observations.",
        "In this paper, we strive for the best of both worlds ?",
        "we present PAC-Bayesian theory as a powerful tool for deriving high probability guarantees as well as efficient and well-motivated algorithms.",
        "In the next section, we state some useful PAC-Bayesian theorems.",
        "In Section 3, we present our main results.",
        "We apply the PAC-Bayesian bounds to n-grams, class-based n-grams, and also sequence clustering, where classes represent longer context such as phrases.",
        "We show that for sequence clustering, the bound is dominated by the maximum number of sequences represented by each cluster, and consequently requires many more training examples than a class-based model over words.",
        "We address this issue by sparsifying the cluster assignment probabilities using the l ?",
        "norm, 0 < ?",
        "< 1, an effective proxy for the intractable l 0 norm.",
        "In Section 4, we show how our bound can be incorporated into an HMM-based clustering algorithm.",
        "In Section 5, we validate the theory presented in this paper with some empirical results on the resource management corpus.",
        "2 PAC-Bayesian Bounds PAC-Bayesian theory is a useful framework for combining frequentist bounds with the notion of a prior.",
        "Probably approximately correct (PAC) learning bounds the worst case generalization error of the best hypothesis selected from a hypothesis space ?",
        "and therefore treats all hypotheses uniformly (Valiant, 1984).",
        "PAC-Bayesian bounds, however, place a prior over the hypothesis space while making no assumptions on the data generating distribution (McAllester, 1998).",
        "Thus, PAC-Bayesian bounds can both 1) incorporate prior information, and 2) provide frequentist guarantees on the expected performance.",
        "They have been successfully applied to classification settings such as the support vector machine (SVM) (McAllester, 2003; Langford, 2005), yielding significantly tighter bounds.",
        "Seldin and Tishby (2010) extend the frame-131 work to include unsupervised learning tasks such as density estimation and clustering.",
        "Since statistical language modeling at its core is a discrete density estimation problem, we focus on the bounds developed by Seldin and Tishby (2010) and summarize key results in the following subsection.",
        "2.1 Unsupervised Learning Given a d-dimensional product space X (1) ?",
        "... ?",
        "X (d) and a collection of N samples, S, independent and identically distributed (i.i.d.)",
        "according to some unknown distribution p(x 1 , ..., x d ) over the product space, we want to estimate p(x 1 , ..., x d ) with some model q(x 1 , ..., x d ).",
        "In the case of clustering (e.g. class-based models), we make the following assumption on q(x 1 , ..., x d ) [Note: we make no assumptions on the true distribution p(x 1 , ..., x d )]: q(x 1 , ..., x d ) = ?",
        "c 1 ,...,c d q(c 1 , ..., c d ) d ?",
        "i=1 q(x i |c i ) (1) where c i = h i (x i ) for some clustering function h i : X (i) 7?",
        "C (i) .",
        "We refer to them collectively as a clustering function h, h = {h i } d i=1 ; hence h : X (1) ?",
        "...?X (d) 7?",
        "C (1) ?",
        "...?C (d) .",
        "We assume that the original space X (1) ?",
        "... ?",
        "X (d) has finite cardinality, with n i = |X (i) |, and likewise for the clustered space C (1) ?",
        "...?",
        "C (d) , where m i = |C (i) | is the number of clusters.",
        "We define a hypothesis space,H, to be the space of all possible clustering functions h \u000fH.",
        "For h \u000f H, we define the distributions p h (c 1 , ..., c d ) = ?",
        "x 1 ,...,x d p(x 1 , ..., x d ) ?",
        "d i=1 ?",
        "(h i (x i ) = c i ) and p?",
        "h (c 1 , ..., c d ) = ?",
        "x 1 ,...,x d p?",
        "(x 1 , ..., x d ) ?",
        "d i=1 ?",
        "(h i (x i ) = c i ), where p(x 1 , ..., x d ) is the unknown true distribution, and p?",
        "(x 1 , ..., x d ) is the empirical (maximum likelihood) estimate.",
        "The delta func-tion, ?",
        "(arg), takes a value of 1 only when arg is true, and 0 otherwise.",
        "We can extend to the original space with the model assumption in Equation (1).",
        "For example, p h (x 1 , ..., x d ) = ?",
        "c 1 ,...,c d p h (c 1 , ..., c d ) ?",
        "d i=1 q(x i |c i ).",
        "The key difference between PAC learning and the PAC-Bayesian framework is the following notion of a random predictor, which is a distributionQ(h), learnt over the hypothesis spaceH.",
        "Inference works as follows: for a new sample (x 1 , ..., x d ), we first draw a hypothesis h from H at random according to the distribution Q(h).",
        "We then return q(x 1 , ..., x d ) according to the model described by Equation (1) and the clustering function h. The PAC-Bayesian framework therefore allows for a second level of averaging over Q, and we can define the induced distributions: p Q (c 1 , ..., c d ) = ?",
        "h Q(h)p h (c 1 , ..., c d ) and p?",
        "Q (c 1 , ..., c d ) = ?",
        "h Q(h)p?",
        "h (c 1 , ..., c d ).",
        "Again, we can extend to the original space with p Q (x 1 , ..., x d ) and p?",
        "Q (x 1 , ..., x d ) using the model assumption in Equation (1).",
        "Note that p Q (x 1 , ..., x d ) is unknown since p(x 1 , ..., x d ) is unknown; but the goal is to bound some notion of generalization error, such as the KL-divergence KL(p?",
        "Q (x 1 , ..., x d )||p Q (x 1 , ..., x d )).",
        "The Change of Measure Inequality (CMI) (Seldin and Tishby, 2010) is central to almost every PAC-Bayesian bound, so we briefly state it here.",
        "For any measurable function ?",
        "(h) on H and for any distributions Q(h) and P(h): E Q(h) [?",
        "(h)] ?",
        "KL(Q||P) + lnE P(h) [ e ?",
        "(h) ] (2) where KL(Q||P) = E Q(h) [ ln Q(h) P(h) ] is the KL-divergence betweenQ andP .",
        "The proof is fairly straightforward and is a direct consequence of rewriting ?",
        "(h) as ln ( e ?",
        "(h) Q(h) P(h) P(h) Q(h) ) .",
        "Seldin and Tishby (2010) apply the CMI with ?",
        "(h) = N ?",
        "KL(p?",
        "h (x 1 , ..., x d )||p h (x 1 , ..., x d )) and simplify the KL-divergence term by recognizing that 1) {q(c i |x i )} d i=1 defines a distribution over all possible clusterings, and hence Q = {q(c i |x i )} d i=1 ; and 2) a specific P , which they call the prior, can be defined without making any assumptions on the true distribution p(x 1 , ..., x d ).",
        "Note that P is not a prior in the Bayesian sense: 1) it indicates preference on the structure of the hypothesis, not an assumption on the data generating distribution, although the latter could be a consequence of the former; 2) the bound holds regardless of P; and 3) the bound holds regardless ofQ, which is not necessarily the Bayes posterior.",
        "132 The following prior on H makes no assumptions on p(x 1 , ..., x d ).",
        "We present a simplified version of the prior developed by Seldin and Tishby (2010): P(h) ?",
        "1 exp [ ?",
        "d i=1 m i lnn i + n i lnm i ] (3) The prior is based on a combinatorial argument.",
        "In order to select a clustering function h i for some i, we first need to pick a cardinality profile (number of elements per cluster) for the m i clusters; there are n m i i such profiles, hence the first term in the sum.",
        "Next, given a cardinality profile, we need to bound the number of ways in which each of the n i elements can be assigned to the clusters given their sizes; there are at most m n i i possibilities, hence the second term in the sum.",
        "The CMI with ?",
        "(h) = N ?",
        "KL(p?",
        "h (x 1 , ..., x d )||p h (x 1 , ..., x d )), our modified prior, and a few information theoretic results lead to the following bound.",
        "PAC-Bayesian Clustering: For any distribution p over X (1) ?",
        "...?X (d) and an i.i.d.",
        "sample S of sizeN according to p, with probability at least 1?",
        "?, for all distributions of cluster functionsQ = {q(c i |x i )} d i=1 , the following holds: KL(p?",
        "Q (x 1 , ..., x d )||p Q (x 1 , ..., x d )) ?",
        "?",
        "d i=1 n i lnm i +K 1 N (4) where K 1 = ?",
        "d i=1 m i lnn i + (M ?",
        "1) ln(N + 1) + ln d+1 ?",
        ", and M = ?",
        "d i=1 m i .",
        "Although this shows convergence, in applications such as language modeling, we are interested in directly bounding the test set perplexity or cross-entropy.",
        "Seldin and Tishby (2010) smooth p?",
        "Q (x 1 , ..., x d ) to bound E p(x 1 ,...,x d ) [?",
        "ln p?",
        "Q(x 1 ,...,x d ) ] and provide the following useful result based on Equation (4).",
        "Bound on Cross-Entropy: For any probability measure p overX (1) ?...",
        "?X (d) and an i.i.d.",
        "sample S of size N according to p, with probability 1?",
        "?",
        "for all distributions of cluster functionsQ = {q(c i |x i )} d i=1 : E p(x 1 ,...,x d ) [?",
        "ln p?",
        "Q (x 1 , ..., x d )] ?",
        "?I(p?",
        "Q (c 1 , ..., c d )) + ln(M) ?",
        "?",
        "d i=1 n i lnm i +K 1 2N +K 2 (5) where p?",
        "Q (x 1 , ..., x d ) is now the smoothed empirical estimate induced by Q, I(p?",
        "Q (c 1 , ..., c d )) = ?",
        "d i=1 H(p?",
        "Q (c i ))?H(p?",
        "Q (c 1 , ..., c d )) is the multi-information of the clustering,M andK 1 are as defined in Equation (4), and K 2 is an additional term, K 2 ?",
        "I(p?",
        "Q (c 1 , ..., c d )), and the bound is non-negative.",
        "3 Language Models Since language modeling is yet another density estimation problem in which we want to minimize the test set perplexity, the bound in Equation (5) readily applies to both word n-grams and class-based n-grams.",
        "Note that the bounds are on cross-entropy, which is log perplexity, but we use the two terms almost interchangeably.",
        "We are now interested in estimating the unknown true distribution p(v 1 , ..., v n ) over the space V n , where V is some vocabulary consisting of V = |V| words.",
        "The degenerate case, d = 1, X (1) = V n , is the case of word n-grams and results in a bound that is dominated by n 1 = |X (1) | = V n .",
        "This suggests that the number of training samples, N , must be on the same order as V n for the bound (and hence the estimate) to be meaningful.",
        "It is also clear why class-based models are favored whenever they work.",
        "In this case, d = n, X (i) = V for all 1 ?",
        "i ?",
        "d, and the bound in Equation (5) reduces to something linear in V (since ?i, n i = |X (i) | = V ).",
        "Moreover, the clustering function is the same for all i ?",
        "that is, word clusters do not depend on the position in the n-gram.",
        "Assuming K word clusters, the number of training examples, N , only needs to be on the order of K n + nV , achieving effective small sample generalization especially when K << V .",
        "In the following subsections, we extend the bound to sequences and present a unique approach to regularize the bound.",
        "133 3.1 Sequence Clustering We have discussed two extreme cases, namely d = 1 and d = n, that correspond to word n-grams and class-based n-grams, respectively.",
        "In practice, they are often interpolated to retain the advantages of both, as shown in the following model: q(v 1 , ..., v n ) = ?q(v 1 , ..., v n ) + (1?",
        "?)",
        "?",
        "c 1 ,...,c n q(c 1 , ..., c n ) n ?",
        "i=1 q(v i |c i ) (6) for some 0 < ?",
        "< 1.",
        "A Bayesian interpretation of the above model is to select between the n-gram and the class-based model with probabilities ?",
        "and 1 ?",
        "?, respectively.",
        "In other words, for each n-gram (v 1 , ..., v n ), we simply flip an ?-biased coin to decide on one of the two models.",
        "In this paper, we interpolate across the entire spectrum, 1 ?",
        "d ?",
        "n, instead of just the extreme cases ?",
        "that is, we capture clusters over not just words, but also sequences of words (phrases).",
        "Previous results by Deligne and Bimbot (1995), Ries et al. (1996), and Justo and Torres (2007) indicate that clustering over phrases is practically useful and leads to significant improvements.",
        "Suppose our goal is to estimate the probability of a trigram, for example, ?the cat sat.?",
        "In the case of d = 1, we directly estimate the joint probability p(the, cat, sat).",
        "In the standard class-based model, where d = 3, we estimate with the model p(the, cat, sat) = ?",
        "c 1 ,c 2 ,c 3 p(c 1 , c 2 , c 3 )p(the|c 1 )p(cat|c 2 )p(sat|c 3 ).",
        "The intermediate cases, such as d = 2 in this ex-ample, are often neglected.",
        "The theory we subsequently develop interpolates over all four segmenta-tions, including the missing ones: p(the, cat, sat) = ?",
        "c 1 ,c 2 p(c 1 , c 2 )p(the cat|c 1 )p(sat|c 2 ) as well as p(the, cat, sat) = ?",
        "c 1 ,c 2 p(c 1 , c 2 )p(the|c 1 )p(cat sat|c 2 ).",
        "In general, an n-gram has 2 n?1 possible segmentations, as illustrated in the previous example.",
        "Suppose f \u000f F is a particular segmentation from the space of all possible segmentations, and we explicitly define it as the following mapping: f : V n 7?",
        "X (1) ?",
        "...?X (d) (7) where 1 ?",
        "d ?",
        "n and f is simply a segmentation that does not modify the joint distribution; that is, p(v 1 , ..., v n ) = p(x 1 , ..., x d ).",
        "If f is fixed a priori, we can immediately apply the bounds derived in Equation (5) over the segmented space X (1) ?",
        "...?",
        "X (d) .",
        "This is the case where we decide on a model, such as the standard class-based model (d = n), and simply use it.",
        "An extension to the case of interpolated models is straightforward.",
        "We modify the hypothesis space H to not only include all possible clusterings, but also all possible segmentations.",
        "The new random prediction Q over H works as follows: given an n-gram (v 1 , ..., v n ), draw a segmentation f \u000f F according to the distribution pi = (pi 1 , ..., pi 2 n?1), where the segmentations are indexed by j = 1, ..., 2 n?1 (the ordering does not matter), and pi j is the probability of drawing segmentation j; pick a clustering as in the random classifier described in Equation (5) for the new segmented space; and estimate q(v 1 , ..., v n ) according to the model described by the previous steps.",
        "The bound, in terms of pi, is given below.",
        "PAC-Bayes Sequence Clustering: For any probability measure p over V n , and an i.i.d.",
        "sample S of size N drawn according to p, with probability 1 ?",
        "?",
        "for all distributions of segmentations pi and for all distributions of cluster functions Q: E p(v 1 ,...,v n ) [?",
        "ln p?",
        "Q (v 1 , ..., v n )] ?",
        "2 n?1 ?",
        "j=1 ?",
        "?",
        "K 3 (j) + ln(M(j)) ?",
        "?",
        "d(j) i=1 V a i (j) lnm i (j) +K 1 (j) 2N ?",
        "?",
        "pi j (8) K 3 (j) = ?I(p?",
        "Q (c 1 , ..., c d(j) )) +K 2 (j) where ?j ?i, 1 ?",
        "a i (j) ?",
        "n, and ?j, ?",
        "d(j) i=1 a i (j) = n, and V a i (j) simply replaces n i in Equation (5) for a given j.",
        "The term K 2 (j) is from Equation (5).",
        "Note that all terms such as m i (j), the number of clusters corresponding to the space, their product M(j), and additional terms K 1 (j), K 2 (j) now depend on the segmentation j since X (i) and d(j) depend on j.",
        "134 We can favor certain segmentations (e.g. those that require few training examples), but note that the bound above is true regardless of the distribution over possible segmentations, pi.",
        "Also, the bound is dominated by the exponent a i (j) and the constraint ?",
        "d(j) i=1 a i (j) = n. Hence, the bound is polynomial in V for all segmentations except the standard class-based setting where d(j) = n, in which case ?i, a i (j) = 1.",
        "For example, if d(j) = n ?",
        "1 for some segmentation j, there exists some i such that a i (j) = 2 and hence represents clusters of bigrams.",
        "If d(j) = n ?",
        "2, there exists some segmentation j, and a space i such that a i (j) = 3, and so on until d(j) = 1, and this is the case of word n-grams where a 1 (j) = n. 3.2 Bound Minimization Imposing the restriction ?j ?i, a i (j) = 1 is simple, and although it can guarantee the small-sample benefits of a standard class-based model, it is not a useful strategy for incorporating the constraint.",
        "Since a i (j) corresponds to the original space X (i) for a given j, restricting a i (j) would restrict X (i) to an a priori, fixed set of V elements.",
        "To learn the best possible set of V elements, however, we need to minimize the effective size of X (i) .",
        "For example, suppose we are estimating trigrams over V 3 using the following segmentation: X (1) = V and X (2) = V 2 ?",
        "i.e. a bigram over clusters of words and clusters of word bigrams.",
        "The unconstrained bound is dominated by X (2) .",
        "We can restrict the effective size of X (2) by assigning zero probability to the vast majority of its elements, by constraining the hypothesis space to consider only cluster assignment functions q(x i |c i ) in which n 2 << V 2 of the elements have nonzero probability.",
        "Thus, every word sequence in V d can be generated by the d = n segmentation, but every other segmentation is constrained to generate at most a subset of V d with nonzero probability.",
        "We achieve this by imposing the restriction on the random predictor Q.",
        "By Bayes rule, q(c i |x i ) = q(x i |c i )q(c i ) q(x i ) and we can alternatively define Q as Q = {q(c i ), q(x i ), q(x i |c i )} d i=1 .",
        "Our goal is to learn a Q that minimizes the RHS of Equation (5), which includes maximizing the multi-information term, as well as constraining n i .",
        "As expected, q(x i ) controls the absolute size of X (i) and q(x i |c i ) controls the effective size based on the clustering.",
        "The dominant term in all of our bounds is n i (or a i , with n i = V a i ), which results from the second term in the prior defined in Equation (3), since it bounds the number of ways in which the n i items can be assigned to the m i clusters.",
        "Alternatively, we can represent this quantity with an upper bound, ( ?",
        "c i ?q(x i |c i )?",
        "0 ) lnm i .",
        "We can write q(x i ) = ?",
        "c i q(x i |c i )q(c i ), and n i = ?q(x i )?",
        "0 = ?",
        "?",
        "c i q(x i |c i )q(c i )?",
        "0 ; by the triangle inequality and scale invariance of the l 0 norm, this is less than or equal to ?",
        "c i ?q(x i |c i )?",
        "0 .",
        "We therefore limit the upper bound, ?",
        "c i ?q(x i |c i )?",
        "0 , by sparsifying q(x i |c i ) for every cluster c i .",
        "The Optimization Problem: Given some segmentation, we want to find a random predictorQ ?",
        "a class-based model over the fixed segmentation ?",
        "such that the bound in Equation (5) is minimized, which is given by the following optimization problem: maximize Q I(p?",
        "Q (c 1 , ..., c d )) subject to ?q(x i |c i )?",
        "0 ?",
        "V, ?",
        "c i \u000f C (i) , i = 1, .",
        ".",
        ".",
        ", d (9) Since such optimization problems are known to be NP-complete, we use a computationally tractable proxy.",
        "The standard practice is to use the l 1 norm instead of the l 0 norm; although non-convex, we resort to the l ?",
        "norm, 0 < ?",
        "< 1, since q(x i |c i ) is a probability vector with a fixed l 1 norm.",
        "We therefore solve the following problem: maximize Q I(p?",
        "Q (c 1 , ..., c d )) subject to ?q(x i |c i )?",
        "?",
        "?",
        "V, ?",
        "c i \u000f C (i) , i = 1, .",
        ".",
        ".",
        ", d (10) We have shown that one way to regularize the bound for a non-trivial sequence clustering problem, regardless of whether the segmentation is fixed or if we are interpolating across all segmentations, is to sparsify the cluster assignment probabilities for every cluster.",
        "There are many ways to sparsify a probability vector (Pilanci et al., 2012; Kyrillidis et al., 2013), and we select the l ?",
        "norm, 0 < ?",
        "< 135 1, for its simplicity and success in other applications (Chartrand and Staneva, 2008).",
        "Our approach guarantees manageable bounds on the test set cross-entropy for a general class of SLMs, without making any assumptions on the true distribution p(v 1 , ..., v n ).",
        "The Bayesian Connection A Bayesian interpretation of our regularization provides additional insight into other successful models, such as the hierarchical Pitman-Yor language model (HPYLM).",
        "In our approach, we impose the restriction ?q(x i |c i )?",
        "?",
        "?",
        "V , 0 < ?",
        "< 1, for every cluster c i .",
        "It can be shown that this is equivalent to a sub-exponential prior on q(x i |c i ) (Hastie et al., 2009).",
        "Since q(x i ) = ?",
        "c i q(x i |c i )q(c i ) and we make the assumption that q(x i |c i ) is sub-exponential for every c i , we are consequently assuming that q(x i ) is also sub-exponential.",
        "Although the PAC-Bayesian bounds hold regardless of the true distribution, our regularization technique implicitly assumes that it is heavy-tailed.",
        "The key to HPYLM's success within the Bayesian setting is a better prior that matches the heavy-tailed distribution of natural language (Teh, 2006) ?",
        "the regularization approach developed in this paper reassuringly corresponds to the assumption that the true distribution is heavy-tailed (sub-exponential).",
        "On the other hand, it may be possible to derive provable guarantees for HPYLM within the context of our clustering model.",
        "The main difference between HPYLM and the less successful Dirichlet process (DP) is the Chinese restaurant process, which assigns new tables (clusters) to customers (samples) much more aggressively in the former model than in the latter (Teh, 2006).",
        "HPYLM therefore has far fewer customers (samples) per table (cluster) than DP, resulting in significantly sparser q(x i |c i ).",
        "4 An Efficient HMM Algorithm The hidden Markov model (HMM) is a popular tool for modeling sequences and has been used in several speech and language clustering tasks (Rabiner, 1989; Smyth, 1997; Li and Biswas, 1999).",
        "Over its rich history, several techniques, including regularization and sparsification of the HMM parameters, have been developed (Bicego et al., 2007; Bharadwaj et al., 2013).",
        "The goal of this section is to show how our bound easily fits into a well-established model such as the HMM.",
        "We can rewrite the standard class-based model by making a Markov assumption on q(c 1 , ..., c n ): q(x 1 , ..., x d , c 1 , ..., c d ) = d ?",
        "i=1 q(x i |c i )q(c i |c i?1 ) (11) where {x i } d i=1 is some segmentation of (v 1 , ..., v n ) \u000f V n .",
        "The HMM literature refers to c i as the hidden state, q(x i |c i ) as the observation probability, and q(c i |c i?1 ) as the state transition probability (Rabiner, 1989).",
        "If we consider each state of the HMM to be a cluster, then as before, q(c i |x i ) = q(x i |c i ) q(c i ) q(x i ) is a distribution over all possible clustering functions.",
        "To solve the optimization problem described in Equation (10), we need to maximize the multi-information I(q(c 1 , ..., c n )) while satisfying the constraint ?q(x i |c i )?",
        "?",
        "?",
        "V .",
        "We can rewrite the constrained optimization problem as an unconstrained problem using a Lagrangian, and solve for q(x i |c i ) with an l ?",
        "regularized version of the expectation maximization (EM) algorithm, similar to Bharadwaj et al. (2013).",
        "To maximize the multi-information term I(q(c 1 , ..., c d )) in Equation (10), we sparsify the state transition probabilities q(c i |c i?1 ).",
        "This provably works when we use l ?",
        "regularization, 0 < ?",
        "< 1 for sparsifying q(c i |c i?1 ).",
        "The Renyi ?-entropy of a random variable with some probability distribution q is defined to be H ?",
        "(q) = ?",
        "1??",
        "log ?q?",
        "?",
        "and there are two useful results we use (Principe, 2010): 1) lim ?",
        "?1 H ?",
        "(q) = H(q), whereH(q) is the Shannon entropy; and 2)H ?",
        "(q) is non-increasing in ?.",
        "Thus, for ?",
        "< 1,H ?",
        "(q) is an upper bound on the Shannon entropy.",
        "Since l ?",
        "regularization minimizes the Renyi ?-entropy, which for 0 < ?",
        "< 1 is an upper bound on the Shannon entropy, it effectively maximizes the mutual information between c i and c i?1 , given that I(q?",
        "Q (c i , c i?1 )) = H(q?",
        "Q (c i ))?H(q?",
        "Q (c i |c i?1 )).",
        "Thus, we have shown that at least in the context of clustering, sparsifying both the observation probabilities and the state transition probabilities of an HMM using the l ?",
        "prior directly minimizes generalization error.",
        "136 500 700 900 1100 1300 1500 1700 19007 89 1011 1213 14 Training set size (# sentences) Test s et cros s?entr opy HMMSparse HMM Figure 1: Test set cross-entropy of HMM vs l ?",
        "-regularized (sparse) HMM as a function of the number of training sentences 5 Experiments We test our approach on a subset of the resource management (RM) corpus (Price et al., 1993), which consists of naval commands that span approximately V = 1000 words.",
        "First, we show that l ?",
        "regularization works.",
        "Figure 1 shows the estimated test set cross-entropy of an unregularized HMM and of an l ?",
        "-regularized HMM as a function of the number of training sentences.",
        "We vary the training set size from 10 to 2000 sentences and test the models on 800 sentences; Figure 1 reports the average cross-entropy on brackets of training sizes ?",
        "10-100, 110-200, and so on.",
        "The l ?",
        "-regularized HMM requires additional tunable parameters such as the value of ?.",
        "To simplify the search on a separate 300 sentence development set, we make a (rather restrictive) assumption that ?",
        "for both the transition and observation probabilities is the same, and that ?",
        "is independent of the size of the training set.",
        "Our solutions are therefore not opti-mal, but adequate to demonstrate our claims.",
        "To ensure that the cross-entropy is bounded, we smooth all estimates with add-one smoothing.",
        "For small training datasets, the unregularized HMM learns models that assign near-zero likelihood to some of the test sentences; hence, we only present results for training set sizes greater than 500 sentences.",
        "Like many other model selection results, Figure 1 suggests that model sparsity is essential when training datasets are small.",
        "In this example, about 900 sentences are required for the unregularized HMM to outperform the sparse HMM.",
        "In the context of the theory developed in earlier sections, it was shown that test set cross-entropy is proportional to n i N , where N is the number of training examples.",
        "In practical settings, N is fixed; hence, the only strategy for minimizing cross-entropy is to minimize n i .",
        "Figure 1 confirms that l ?",
        "regularization successfully sparsifies q(x i |c i ), the observation probabilities of the HMM, thereby minimizing n i .",
        "We also compare how the test set cross-entropy improves as a function of the training set size for four different models: 1) a baseline bigram model estimated over words; 2) a baseline class-based model using Brown's algorithm (Brown et al., 1992) with K = 20 clusters, learnt over the entire dataset so that it is also representative of knowledge-based approaches in which the true clusters are known a priori; 3) l ?",
        "-regularized HMM with 20 ergodic states; and 4) a special case of 3) in which the state transitions are constrained to artificially form m 1 = 10 word clusters (10 states) and m 2 = 5 clusters that represent word bigrams (10 states, where the 5 clusters are modeled with 2 left-to-right states each); therefore, the model represents an interpolation between the standard class-based model and word bigrams, but is of the exact same complexity as 2) and 3).",
        "Figure 2 shows the estimated test set cross-entropy for each of the four models.",
        "The values of ?",
        "used in our experiments are ?",
        "= 0.7 for the words only case and ?",
        "= 0.9 for sequences.",
        "It is clear 137 200 400 600 800 1000 1200 1400 1600 1800 20006 7 8 9 10 11 12 Training set size (# sentences) Test set cros s?en tropy 1) word bigrams2) class?based (Brown)3) HMM (words only)4) HMM (sequences) Figure 2: Test set cross-entropy as a function of the number of training sentences for the four settings from Figure 2 that l ?",
        "regularization helps even in the case of a standard class-based model, the bound for which is already linear in V .",
        "With fewer than 100 sentences, l ?",
        "regularization can both learn the clusters and estimate their transitions reasonably well, and surpasses Brown for training set sizes of N ?",
        "800 sentences.",
        "Brown's algorithm in 2) finds clusters such that pairwise mutual information terms are maximized; in 3), we not only maximize the mutual information, but we also reduce the effective V by ensuring that each cluster (or state) specializes and represents as few words as possible.",
        "As the number of training examples increases, estimates of class transitions indeed improve, but the class-based assumption itself becomes too restrictive.",
        "In 4), which represents an interpolated model, we see the tradeoff achieved by incorporating sequences: for small training sets, the model achieves better generalization than word bigrams, but is worse than the class-based model; and for larger training sets, the interpolated model learns better representations of high frequency events and outperforms the class-based models represented by 2) and 3).",
        "The value of ?",
        "in 3) is 0.7, whereas ?",
        "in 4) is 0.9; this seems counter-intuitive at first, but note that a smaller ?",
        "does not necessarily imply sparser observation probabilities; however, it implies a heavier distribution in a Bayesian setting.",
        "A Bayesian interpretation therefore suggests that in 4), the model itself is better equipped to cope with heavy tails, whereas a more aggressive ?",
        "is required in 3).",
        "6 Conclusion By defining a random clustering model (a model in which there is a distribution over possible cluster assignments, e.g. an HMM), it is possible to specialize published PAC-Bayesian cross-entropy bounds to the cases of n-gram and class-based n-gram estimation.",
        "A distribution over segmentations allows derivation of a cross-entropy bound on sequence clustering algorithms, which can be made useful by sparsifying the sequence cluster observation probabilities.",
        "An efficient l ?",
        "regularization technique can be used to maximize sparsity, thereby minimizing the test set cross-entropy.",
        "Acknowledgements We are grateful to the SST Group at Illinois and the anonymous reviewers for valuable feedback.",
        "Thanks also to Jitendra Ajmera, Om Deshmukh, and Ashish Verma for their contributions to the clustering algorithm.",
        "This work was supported by the NSF CDI Program Grant Number BCS 0941268 and ARO W9111NF-09-1-0383; the opinions expressed in this work are those of the authors and do not necessarily reflect the views of the funding agencies.",
        "138 References"
      ]
    }
  ]
}
