{
  "info": {
    "authors": [
      "Omer Levy",
      "Yoav Goldberg"
    ],
    "book": "ACL",
    "id": "acl-P14-2050",
    "title": "Dependency-Based Word Embeddings",
    "url": "https://aclweb.org/anthology/P14-2050",
    "year": 2014
  },
  "references": [
    "acl-D11-1014",
    "acl-J07-2002",
    "acl-J10-4006",
    "acl-J92-4003",
    "acl-N03-1033",
    "acl-N09-1003",
    "acl-N13-1090",
    "acl-P08-1086",
    "acl-P10-1040",
    "acl-P10-1044",
    "acl-P10-1045",
    "acl-P98-2127",
    "acl-W08-1301",
    "acl-W12-3308",
    "acl-W13-3520",
    "acl-W14-1618"
  ],
  "sections": [
    {
      "text": [
        "Proceedings of the 52nd Annual Meeting of the Association for Computational Linguistics (Short Papers), pages 302?308, Baltimore, Maryland, USA, June 23-25 2014. c?2014 Association for Computational Linguistics Dependency-Based Word Embeddings Omer Levy ?",
        "Abstract",
        "While continuous word embeddings are gaining popularity, current models are based solely on linear contexts.",
        "In this work, we generalize the skip-gram model with negative sampling introduced by Mikolov et al. to include arbitrary contexts.",
        "In particular, we perform experiments with dependency-based contexts, and show that they produce markedly different embeddings.",
        "The dependency-based embeddings are less topical and exhibit more functional similarity than the original skip-gram embeddings."
      ]
    },
    {
      "heading": "1 Introduction",
      "text": [
        "Word representation is central to natural language processing.",
        "The default approach of representing words as discrete and distinct symbols is insufficient for many tasks, and suffers from poor generalization.",
        "For example, the symbolic representation of the words ?pizza?",
        "and ?hamburger?",
        "are completely unrelated: even if we know that the word ?pizza?",
        "is a good argument for the verb ?eat?, we cannot infer that ?hamburger?",
        "is also a good argument.",
        "We thus seek a representation that captures semantic and syntactic similarities between words.",
        "A very common paradigm for acquiring such representations is based on the distributional hypothesis of Harris (1954), stating that words in similar contexts have similar meanings.",
        "Based on the distributional hypothesis, many methods of deriving word representations were explored in the NLP community.",
        "On one end of the spectrum, words are grouped into clusters based on their contexts (Brown et al., 1992; Uszkor-eit and Brants, 2008).",
        "On the other end, words ?",
        "Supported by the European Community's Seventh Framework Programme (FP7/2007-2013) under grant agreement no.",
        "287923 (EXCITEMENT).",
        "are represented as a very high dimensional but sparse vectors in which each entry is a measure of the association between the word and a particular context (see (Turney and Pantel, 2010; Baroni and Lenci, 2010) for a comprehensive survey).",
        "In some works, the dimensionality of the sparse word-context vectors is reduced, using techniques such as SVD (Bullinaria and Levy, 2007) or LDA (Ritter et al., 2010; S?eaghdha, 2010; Cohen et al., 2012).",
        "Most recently, it has been proposed to represent words as dense vectors that are derived by various training methods inspired from neural-network language modeling (Bengio et al., 2003; Collobert and Weston, 2008; Mnih and Hinton, 2008; Mikolov et al., 2011; Mikolov et al., 2013b).",
        "These representations, referred to as ?neural embeddings?",
        "or ?word embeddings?, have been shown to perform well across a variety of tasks (Turian et al., 2010; Collobert et al., 2011; Socher et al., 2011; Al-Rfou et al., 2013).",
        "Word embeddings are easy to work with because they enable efficient computation of word similarities through low-dimensional matrix operations.",
        "Among the state-of-the-art word-embedding methods is the skip-gram with negative sampling model (SKIPGRAM), introduced by Mikolov et al. (2013b) and implemented in the word2vec software.",
        "1 Not only does it produce useful word representations, but it is also very efficient to train, works in an online fashion, and scales well to huge copora (billions of words) as well as very large word and context vocabularies.",
        "Previous work on neural word embeddings take the contexts of a word to be its linear context ?",
        "words that precede and follow the target word, typically in a window of k tokens to each side.",
        "How-ever, other types of contexts can be explored too.",
        "In this work, we generalize the SKIPGRAM model, and move from linear bag-of-words contexts to arbitrary word contexts.",
        "Specifically, 1 code.google.com/p/word2vec/ 302 following work in sparse vector-space models (Lin, 1998; Pad√≥ and Lapata, 2007; Baroni and Lenci, 2010), we experiment with syntactic contexts that are derived from automatically produced dependency parse-trees.",
        "The different kinds of contexts produce noticeably different embeddings, and induce different word similarities.",
        "In particular, the bag-of-words nature of the contexts in the ?original?",
        "SKIPGRAM model yield broad topical similari-ties, while the dependency-based contexts yield more functional similarities of a cohyponym nature.",
        "This effect is demonstrated using both qualitative and quantitative analysis (Section 4).",
        "The neural word-embeddings are considered opaque, in the sense that it is hard to assign meanings to the dimensions of the induced representation.",
        "In Section 5 we show that the SKIPGRAM model does allow for some introspection by querying it for contexts that are ?activated by?",
        "a target word.",
        "This allows us to peek into the learned representation and explore the contexts that are found by the learning process to be most discriminative of particular words (or groups of words).",
        "To the best of our knowledge, this is the first work to suggest such an analysis of discriminatively-trained word-embedding models.",
        "2 The Skip-Gram Model Our departure point is the skip-gram neural embedding model introduced in (Mikolov et al., 2013a) trained using the negative-sampling procedure presented in (Mikolov et al., 2013b).",
        "In this section we summarize the model and training objective following the derivation presented by Goldberg and Levy (2014), and highlight the ease of incorporating arbitrary contexts in the model.",
        "In the skip-gram model, each word w ?",
        "W is associated with a vector v w ?",
        "R d and similarly each context c ?",
        "C is represented as a vector v c ?",
        "R d , where W is the words vocabulary, C is the contexts vocabulary, and d is the embedding dimensionality.",
        "The entries in the vectors are latent, and treated as parameters to be learned.",
        "Loosely speaking, we seek parameter values (that is, vector representations for both words and con-texts) such that the dot product v w ?",
        "v c associated with ?good?",
        "word-context pairs is maximized.",
        "More specifically, the negative-sampling objective assumes a dataset D of observed (w, c) pairs of words w and the contexts c, which appeared in a large body of text.",
        "Consider a word-context pair (w, c).",
        "Did this pair come from the data?",
        "We denote by p(D = 1|w, c) the probability that (w, c) came from the data, and by p(D = 0|w, c) = 1 ?",
        "p(D = 1|w, c) the probability that (w, c) did not.",
        "The distribution is modeled as: p(D = 1|w, c) = 1 1+e ?v w ?v c where v w and v c (each a d-dimensional vector) are the model parameters to be learned.",
        "We seek to maximize the log-probability of the observed pairs belonging to the data, leading to the objective: argmax v w ,v c ?",
        "(w,c)?D log 1 1+e ?v c ?v w This objective admits a trivial solution in which p(D = 1|w, c) = 1 for every pair (w, c).",
        "This can be easily achieved by setting v c = v w and v c ?v w = K for all c, w, where K is large enough number.",
        "In order to prevent the trivial solution, the objective is extended with (w, c) pairs for which p(D = 1|w, c) must be low, i.e. pairs which are not in the data, by generating the set D ?",
        "of random (w, c) pairs (assuming they are all incorrect), yielding the negative-sampling training objective: argmax v w ,v c ( ?",
        "(w,c)?D p(D = 1|c, w) ?",
        "(w,c)?D ?",
        "p(D = 0|c, w) ) which can be rewritten as: argmax v w ,v c ( ?",
        "(w,c)?D log ?",
        "(v c ?",
        "v w ) + ?",
        "(w,c)?D ?",
        "log ?",
        "(?v c ?",
        "v w ) ) where ?",
        "(x) = 1/(1+e x ).",
        "The objective is trained in an online fashion using stochastic-gradient updates over the corpus D ?D ?",
        ".",
        "The negative samples D ?",
        "can be constructed in various ways.",
        "We follow the method proposed by Mikolov et al.: for each (w, c) ?",
        "D we construct n samples (w, c 1 ), .",
        ".",
        ".",
        ", (w, c n ), where n is a hy-perparameter and each c j is drawn according to its unigram distribution raised to the 3/4 power.",
        "Optimizing this objective makes observed word-context pairs have similar embeddings, while scattering unobserved pairs.",
        "Intuitively, words that appear in similar contexts should have similar embeddings, though we have not yet found a formal proof that SKIPGRAM does indeed maximize the dot product of similar words.",
        "3 Embedding with Arbitrary Contexts In the SKIPGRAM embedding algorithm, the contexts of a word w are the words surrounding it 303 in the text.",
        "The context vocabulary C is thus identical to the word vocabulary W .",
        "However, this restriction is not required by the model; contexts need not correspond to words, and the number of context-types can be substantially larger than the number of word-types.",
        "We generalize SKIPGRAM by replacing the bag-of-words contexts with arbitrary contexts.",
        "In this paper we experiment with dependency-based syntactic contexts.",
        "Syntactic contexts capture different information than bag-of-word con-texts, as we demonstrate using the sentence ?Aus- tralian scientist discovers star with telescope?.",
        "Linear Bag-of-Words Contexts This is the context used by word2vec and many other neural embeddings.",
        "Using a window of size k around the target word w, 2k contexts are produced: the k words before and the k words after w. For k = 2, the contexts of the target word w are w ?2 , w ?1 , w +1 , w +2 .",
        "In our example, the contexts of discovers are Australian, scientist, star, with.",
        "2 Note that a context window of size 2 may miss some important contexts (telescope is not a context of discovers), while including some accidental ones (Australian is a context discovers).",
        "More-over, the contexts are unmarked, resulting in discovers being a context of both stars and scientist, which may result in stars and scientists ending up as neighbours in the embedded space.",
        "A window size of 5 is commonly used to capture broad topical content, whereas smaller windows contain more focused information about the target word.",
        "Dependency-Based Contexts An alternative to the bag-of-words approach is to derive contexts based on the syntactic relations the word participates in.",
        "This is facilitated by recent advances in parsing technology (Goldberg and Nivre, 2012; Goldberg and Nivre, 2013) that allow parsing to syntactic dependencies with very high speed and near state-of-the-art accuracy.",
        "After parsing each sentence, we derive word contexts as follows: for a target word w with modifiers m 1 , .",
        ".",
        ".",
        ",m k and a head h, we consider the contexts (m 1 , lbl 1 ), .",
        ".",
        ".",
        ", (m k , lbl k ), (h, lbl ?1 h ), 2 word2vec's implementation is slightly more complicated.",
        "The software defaults to prune rare words based on their frequency, and has an option for sub-sampling the frequent words.",
        "These pruning and sub-sampling happen before the context extraction, leading to a dynamic window size.",
        "In addition, the window size is not fixed to k but is sampled uniformly in the range [1, k] for each word.",
        "Australian scientist discovers star with telescope amod nsubj dobj prep pobj Australian scientist discovers star telescope amod nsubj dobj prep with WORD CONTEXTS australian scientist/amod ?1 scientist australian/amod, discovers/nsubj ?1 discovers scientist/nsubj, star/dobj, telescope/prep with star discovers/dobj ?1 telescope discovers/prep with ?1 Figure 1: Dependency-based context extraction example.",
        "Top: preposition relations are collapsed into single arcs, making telescope a direct modifier of discovers.",
        "Bottom: the contexts extracted for each word in the sentence.",
        "where lbl is the type of the dependency relation between the head and the modifier (e.g. nsubj, dobj, prep with, amod) and lbl ?1 is used to mark the inverse-relation.",
        "Relations that include a preposition are ?collapsed?",
        "prior to context extraction, by directly connecting the head and the object of the preposition, and subsuming the preposition itself into the dependency label.",
        "An example of the dependency context extraction is given in Figure 1.",
        "Notice that syntactic dependencies are both more inclusive and more focused than bag-of-words.",
        "They capture relations to words that are far apart and thus ?out-of-reach?",
        "with small window bag-of-words (e.g. the instrument of discover is telescope/prep with), and also filter out ?coinci- dental?",
        "contexts which are within the window but not directly related to the target word (e.g. Australian is not used as the context for discovers).",
        "In addition, the contexts are typed, indicating, for ex-ample, that stars are objects of discovery and scientists are subjects.",
        "We thus expect the syntactic contexts to yield more focused embeddings, capturing more functional and less topical similarity.",
        "4 Experiments and Evaluation We experiment with 3 training conditions: BOW5 (bag-of-words contexts with k = 5), BOW2 (same, with k = 2) and DEPS (dependency-based syntactic contexts).",
        "We modified word2vec to support arbitrary contexts, and to output the context embeddings in addition to the word embeddings.",
        "For bag-of-words contexts we used the original word2vec implementation, and for syntactic contexts, we used our modified version.",
        "The negative-sampling parameter (how many negative contexts to sample for every correct one) was 15.",
        "304 All embeddings were trained on English Wikipedia.",
        "For DEPS, the corpus was tagged with parts-of-speech using the Stanford tagger (Toutanova et al., 2003) and parsed into labeled Stanford dependencies (de Marneffe and Man-ning, 2008) using an implementation of the parser described in (Goldberg and Nivre, 2012).",
        "All tokens were converted to lowercase, and words and contexts that appeared less than 100 times were filtered.",
        "This resulted in a vocabulary of about 175,000 words, with over 900,000 distinct syntactic contexts.",
        "We report results for 300 dimension embeddings, though similar trends were also observed with 600 dimensions.",
        "4.1 Qualitative Evaluation Our first evaluation is qualitative: we manually inspect the 5 most similar words (by cosine similar-ity) to a given set of target words (Table 1).",
        "The first target word, Batman, results in similar sets across the different setups.",
        "This is the case for many target words.",
        "However, other target words show clear differences between embeddings.",
        "In Hogwarts the school of magic from the fictional Harry Potter series it is evident that BOW contexts reflect the domain aspect, whereas DEPS yield a list of famous schools, capturing the semantic type of the target word.",
        "This observation holds for Turing 3 and many other nouns as well; BOW find words that associate with w, while DEPS find words that behave like w. Turney (2012) described this distinction as domain similarity versus functional similarity.",
        "The Florida example presents an ontological difference; bag-of-words contexts generate meronyms (counties or cities within Florida), while dependency-based contexts provide cohy-ponyms (other US states).",
        "We observed the same behavior with other geographical locations, particularly with countries (though not all of them).",
        "The next two examples demonstrate that similarities induced from DEPS share a syntactic function (adjectives and gerunds), while similarities based on BOW are more diverse.",
        "Finally, we observe that while both BOW5 and BOW2 yield topical similarities, the larger window size result in more topicality, as expected.",
        "3 DEPS generated a list of scientists whose name ends with ?ing?.",
        "This is may be a result of occasional POS-tagging errors.",
        "Still, the embedding does a remarkable job and retrieves scientists, despite the noisy POS.",
        "The list contains more mathematicians without ?ing?",
        "further down.",
        "Target Word BOW5 BOW2 DEPS batman nightwing superman superman aquaman superboy superboy catwoman aquaman supergirl superman catwoman catwoman manhunter batgirl aquaman hogwarts dumbledore evernight sunnydale hallows sunnydale collinwood half-blood garderobe calarts malfoy blandings greendale snape collinwood millfield turing nondeterministic non-deterministic pauling non-deterministic finite-state hotelling computability nondeterministic heting deterministic buchi lessing finite-state primality hamming florida gainesville fla texas fla alabama louisiana jacksonville gainesville georgia tampa tallahassee california lauderdale texas carolina object-oriented aspect-oriented aspect-oriented event-driven smalltalk event-driven domain-specific event-driven objective-c rule-based prolog dataflow data-driven domain-specific 4gl human-centered dancing singing singing singing dance dance rapping dances dances breakdancing dancers breakdancing miming tap-dancing clowning busking Table 1: Target words and their 5 most similar words, as induced by different embeddings.",
        "We also tried using the subsampling option (Mikolov et al., 2013b) with BOW contexts (not shown).",
        "Since word2vec removes the subsam-pled words from the corpus before creating the window contexts, this option effectively increases the window size, resulting in greater topicality.",
        "4.2 Quantitative Evaluation We supplement the examples in Table 1 with quantitative evaluation to show that the qualitative differences pointed out in the previous section are indeed widespread.",
        "To that end, we use the WordSim353 dataset (Finkelstein et al., 2002; Agirre et al., 2009).",
        "This dataset contains pairs of similar words that reflect either relatedness (top- ical similarity) or similarity (functional similar-ity) relations.",
        "4 We use the embeddings in a re-trieval/ranking setup, where the task is to rank the similar pairs in the dataset above the related ones.",
        "The pairs are ranked according to cosine similarities between the embedded words.",
        "We then draw a recall-precision curve that describes the embedding's affinity towards one subset (?sim- ilarity?)",
        "over another (?relatedness?).",
        "We expect DEPS's curve to be higher than BOW2's curve, which in turn is expected to be higher than 4 Some word pairs are judged to exhibit both types of sim-ilarity, and were ignored in this experiment.",
        "305 Figure 2: Recall-precision curve when attempting to rank the similar words above the related ones.",
        "(a) is based on the WordSim353 dataset, and (b) on the Chiarello et al. dataset.",
        "BOW5?s.",
        "The graph in Figure 2a shows this is indeed the case.",
        "We repeated the experiment with a different dataset (Chiarello et al., 1990) that was used by Turney (2012) to distinguish between domain and functional similarities.",
        "The results show a similar trend (Figure 2b).",
        "When reversing the task such that the goal is to rank the related terms above the similar ones, the results are reversed, as expected (not shown).",
        "5 5 Model Introspection Neural word embeddings are often considered opaque and uninterpretable, unlike sparse vector space representations in which each dimension corresponds to a particular known context, or LDA models where dimensions correspond to latent topics.",
        "While this is true to a large extent, we observe that SKIPGRAM does allow a non-trivial amount of introspection.",
        "Although we cannot assign a meaning to any particular dimension, we can indeed get a glimpse at the kind of information being captured by the model, by examining which contexts are ?activated?",
        "by a target word.",
        "Recall that the learning procedure is attempting to maximize the dot product v c ?v w for good (w, c) pairs and minimize it for bad ones.",
        "If we keep the context embeddings, we can query the model for the contexts that are most activated by (have the highest dot product with) a given target word.",
        "By doing so, we can see what the model learned to be a good discriminative context for the word.",
        "To demonstrate, we list the 5 most activated contexts for our example words with DEPS embeddings in Table 2.",
        "Interestingly, the most discriminative syntactic contexts in these cases are 5 Additional experiments (not presented in this paper) reinforce our conclusion.",
        "In particular, we found that DEPS perform dramatically worse than BOW contexts on analogy tasks as in (Mikolov et al., 2013c; Levy and Goldberg, 2014).",
        "batman hogwarts turing superman/conj ?1 students/prep at ?1 machine/nn ?1 spider-man/conj ?1 educated/prep at ?1 test/nn ?1 superman/conj student/prep at ?1 theorem/poss ?1 spider-man/conj stay/prep at ?1 machines/nn ?1 robin/conj learned/prep at ?1 tests/nn ?1 florida object-oriented dancing marlins/nn ?1 programming/amod ?1 dancing/conj beach/appos ?1 language/amod ?1 dancing/conj ?1 jacksonville/appos ?1 framework/amod ?1 singing/conj ?1 tampa/appos ?1 interface/amod ?1 singing/conj florida/conj ?1 software/amod ?1 ballroom/nn Table 2: Words and their top syntactic contexts.",
        "not associated with subjects or objects of verbs (or their inverse), but rather with conjunctions, ap-positions, noun-compounds and adjectivial modifiers.",
        "Additionally, the collapsed preposition relation is very useful (e.g. for capturing the school aspect of hogwarts).",
        "The presence of many conjunction contexts, such as superman/conj for batman and singing/conj for dancing, may explain the functional similarity observed in Section 4; conjunctions in natural language tend to enforce their conjuncts to share the same semantic types and inflections.",
        "In the future, we hope that insights from such model introspection will allow us to develop better contexts, by focusing on conjunctions and prepositions for example, or by trying to figure out why the subject and object relations are absent and finding ways of increasing their contributions.",
        "6 Conclusions We presented a generalization of the SKIPGRAM embedding model in which the linear bag-of-words contexts are replaced with arbitrary ones, and experimented with dependency-based con-texts, showing that they produce markedly different kinds of similarities.",
        "These results are ex-pected, and follow similar findings in the distributional semantics literature.",
        "We also demonstrated how the resulting embedding model can be queried for the discriminative contexts for a given word, and observed that the learning procedure seems to favor relatively local syntactic contexts, as well as conjunctions and objects of preposition.",
        "We hope these insights will facilitate further research into improved context modeling and better, possibly task-specific, embedded representations.",
        "Our software, allowing for experimentation with arbitrary contexts, together with the embeddings described in this paper, are available for download at the authors?",
        "websites.",
        "306 References"
      ]
    }
  ]
}
