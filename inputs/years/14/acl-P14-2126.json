{
  "info": {
    "authors": [
      "Feifei Zhai",
      "Jiajun Zhang",
      "Yu Zhou",
      "Chengqing Zong"
    ],
    "book": "ACL",
    "id": "acl-P14-2126",
    "title": "RNN-based Derivation Structure Prediction for SMT",
    "url": "https://aclweb.org/anthology/P14-2126",
    "year": 2014
  },
  "references": [
    "acl-D11-1014",
    "acl-D11-1019",
    "acl-D13-1054",
    "acl-D13-1112",
    "acl-J07-2003",
    "acl-J97-3002",
    "acl-P02-1040",
    "acl-P06-1066",
    "acl-P06-1077",
    "acl-P06-1121",
    "acl-P08-1064",
    "acl-P13-1045",
    "acl-W06-1606"
  ],
  "sections": [
    {
      "text": [
        "Proceedings of the 52nd Annual Meeting of the Association for Computational Linguistics (Short Papers), pages 779?784, Baltimore, Maryland, USA, June 23-25 2014. c?2014 Association for Computational Linguistics RNN-based Derivation Structure Prediction for SMT Feifei Zhai, Jiajun Zhang, Yu Zhou and Chengqing Zong National Laboratory of Pattern Recognition Institute of Automation, Chinese Academy of Sciences, Beijing, 100190, China {ffzhai, jjzhang, yzhou, cqzong}@nlpr.ia.ac.cn",
        "Abstract",
        "In this paper, we propose a novel derivation structure prediction (DSP) model for SMT using recursive neural network (RNN).",
        "Within the model, two steps are involved: (1) phrase-pair vector represen-tation, to learn vector representations for phrase pairs; (2) derivation structure pre-diction, to generate a bilingual RNN that aims to distinguish good derivation structures from bad ones.",
        "Final experimental results show that our DSP model can significantly improve the translation quality."
      ]
    },
    {
      "heading": "1 Introduction",
      "text": [
        "Derivation structure is important for SMT decod-ing, especially for the translation model based on nested structures of languages, such as BTG (bracket transduction grammar) model (Wu, 1997; Xiong et al., 2006), hierarchical phrase-based model (Chiang, 2007), and syntax-based model (Galley et al., 2006; Marcu et al., 2006; Liu et al., 2006; Huang et al., 2006; Zhang et al., 2008; Zhang et al., 2011; Zhai et al., 2013).",
        "In general, derivation structure refers to the tuple that records the used translation rules and their compositions during decoding, just as Figure 1 shows.",
        "Intuitively, a good derivation structure usually yields a good translation, while bad derivations always result in bad translations.",
        "For example in Figure 1, (a) and (b) are two different derivations for Chinese sentence ???",
        "?",
        "?9 ?1 ?",
        "!?.",
        "Comparing the two derivations, (a) is more reasonable and yields a better translation.",
        "How-ever, (b) wrongly translates phrase ??",
        "?9?",
        "to -- and Sharon?",
        "and combines it with [??",
        ";Bush] incorrectly, leading to a bad translation.",
        "To explore the derivation structure's potential on yielding good translations, in this paper, we propose a novel derivation structure prediction (DSP) model for SMT decoding.",
        "(a) (b) ??",
        "Bush ???",
        "??",
        "held a talk ?",
        "??",
        "with Sharon ??",
        "?",
        "??",
        "held a talk ?",
        "??",
        "with Sharon ??",
        "Bush ??",
        "?",
        "??",
        "held a talk ?",
        "?",
        "?with Sharon ??",
        "Bush Bush and ?",
        "??",
        "Sharon ??",
        "??",
        "Bush ???",
        "??",
        "held a talk ?",
        "??",
        "and Sharon ?",
        "??",
        "and Sharon ??",
        "?",
        "??",
        "held a talk Figure 1: Two different derivation structures of BTG translation model.",
        "In the structure, leaf nodes denote the used translation rules.",
        "For each node, the first line is the source string, while the second line is its corresponding translation.",
        "The proposed DSP model is built on recursive neural network (RNN).",
        "Within the model, two steps are involved: (1) phrase-pair vector representation, to learn vector representations for phrase pairs; (2) derivation structure prediction, to build a bilingual RNN that aims to distinguish good derivation structures from bad ones.",
        "Extensive experiments show that the proposed DSP model significantly improves the translation qual-ity, and thus verify the effectiveness of derivation structure on indicating good translations.",
        "We make the following contributions in this work: ?",
        "We propose a novel RNN-based model to do derivation structure prediction for SMT decoding.",
        "To our best knowledge, this is the first work on this issue in SMT community; ?",
        "In current work, RNN has only been verified to be useful on monolingual structure learning (Socher et al., 2011a; Socher et al., 2013).",
        "We go a step further, and design a bilingual RNN to represent the derivation structure; ?",
        "To train the RNN-based DSP model, we propose a max-margin objective that prefers gold derivations yielded by forced decoding to n-best derivations generated by the conventional BTG translation model.",
        "779 2 The DSP Model The basic idea of DSP model is to represent the derivation structure by RNN (Figure 2).",
        "Here, we build the DSP model for BTG translation model, which is naturally compatible with RNN.",
        "We believe that the DSP model is also beneficial to other translation models.",
        "We leave them as our future work.",
        "2.1 Phrase-Pair Vector Representation Phrase pairs, i.e., the used translation rules, are the leaf nodes of derivation structure.",
        "Hence, to represent the derivation structure by RNN, we need first to represent the phrase pairs.",
        "To do this, we use two unsupervised recursive autoencoders (RAE) (Socher et al., 2011b), one for the source phrase and the other for the target phrase.",
        "We call the unit of the two RAEs the Leaf Node Network (LNN).",
        "Using n-dimension word embedding, RAE can learn a n-dimension vector for any phrase.",
        "Mean-while, RAE will build a binary tree for the phrase, as Figure 2 (in box) shows, and compute a reconstruction error to evaluate the vector.",
        "We use E(T ph ) to denote the reconstruction error given by RAE, where ph is the phrase and T ph is the corresponding binary tree.",
        "In RAE, higher error corresponds to worse vector.",
        "More details can be found in (Socher et al., 2011b).",
        "Given a phrase pair (sp, tp), we can use LNN to generate two n-dimension vectors, representing sp and tp respectively.",
        "Then, we concatenate the two vectors directly, and get a vector r ?",
        "R 2n to represent phrase pair (sp, tp) (shown in Figure 2).",
        "The vector r is evaluated by combining the reconstruction error on both sides: E(T sp , T tp ) = 1 2 [E(T sp ) + E(T tp ) ?",
        "N s N t ] (1) where T sp and T tp are the binary trees for sp and tp.",
        "N s and N t denote the number of nodes in T sp and T tp .",
        "Note that in order to unify the errors on the two sides, we use ratio N s /N t to eliminate the influence of phrase length.",
        "Then, according to Equation (1), we compute an LNN score to evaluate the vector of all phrase pairs, i.e., leaf nodes, in derivation d: LNN(d) = ?",
        "?",
        "(sp,tp) E(T sp , T tp ) (2) where (sp, tp) is the used phrase pair in derivation d. Obviously, the derivation with better phrase-pair representations will get a higher LNN score.",
        "??",
        "?",
        "??",
        "with Sharon ??",
        "?",
        "??",
        "held a talk Bush Figure 2: Illustration of DSP model, based on the derivation structure in Figure 1(a).",
        "The LNN score will serve as part of the DSP model for predicting good derivation structures.",
        "2.2 Derivation Structure Prediction Using the vector representations of phrase pairs, we then build a Derivation Structure Network (DSN) for prediction (Figure 2).",
        "In DSN, the derivation structure is represented by repeatedly applying unit neural network (UNN, Figure 3) at each non-leaf node.",
        "The UNN receives two node vectors r 1 ?",
        "R 2n and r 2 ?",
        "R 2n as input, and induces a vector p ?",
        "R 2n to represent the parent node.",
        "r1 r2 p score Figure 3: The unit neural network used in DSN.",
        "For example, in Figure 2, node [?",
        "?9; with Sharon] serves as the first child with vector r 1 , and node [?1 ?!",
        "; held a talk] as the second child with vector r 2 .",
        "The parent node vector p, representing [?",
        "?9 ?1 ?!",
        "; held a talk with Sharon], is computed by merging r 1 and r 2 : p = f(W UNN [r 1 ; r 2 ] + b UNN ) (3) where [r 1 ; r 2 ] ?",
        "R 4n?1 is the concatenation of r 1 and r 2 , W UNN ?",
        "R 2n?4n and b UNN ?",
        "R 2n?1 are the network's parameter weight matrix and bias term respectively.",
        "We use tanh(?)",
        "as function f .",
        "Then, we compute a local score using a simple inner product with a row vector W score UNN ?",
        "R 1?2n : s(p) = W score UNN ?",
        "p (4) The score measures how well the two child nodes r 1 and r 2 are merged into the parent node p. As we all know, in BTG derivations, we have two different ways to merge translation candi-dates, monotone or inverted, meaning that we 780 merge two candidates in a monotone or inverted order.",
        "We believe that different merging order (monotone or inverted) needs different UNN.",
        "Hence, we keep two different ones in DSN, one for monotone order (with parameter W mono , b mono , and W score mono ), and the other for inverted (with parameter W inv , b inv , and W score inv ).",
        "The idea is that the merging order of the two candidates will determine which UNN will be used to generate their parent's vector and compute the score in Equation (4).",
        "Using a set of gold derivations, we can train the network so that correct order will receive a high score by Equation (4) and incorrect one will receive a low score.",
        "Thus, when we merge the candidates of two adjacent spans during BTG-based decoding, the local score in Equation (4) is useful in two aspects: (1) for the same merging order, it evaluates how well the two candidates are merged; (2) for the different order, it compares the candidates generated by monotone order and inverted order.",
        "Further, to assess the entire derivation structure, we apply UNN to each node recursively, until the root node.",
        "The final score utilized for derivation structure prediction is the sum of all local scores: DSN(d) = ?",
        "p s(p) (5) where d denotes the derivation structure and p is the non-leaf node in d. Obviously, by this score, we can easily assess different derivations.",
        "Good derivations will get higher scores while bad ones will get lower scores.",
        "Li et al. (2013) presented a network to predict how to merge translation candidates, in monotone or inverted order.",
        "Our DSN differs from Li's work in two points.",
        "For one thing, DSN can not only predict how to merge candidates, but also evaluate whether two candidates should be merged.",
        "For an-other, DSN focuses on the entire derivation struc-ture, rather than only the two candidates for merging.",
        "Therefore, the translation decoder will pursue good derivation structures via DSN.",
        "Actually, Li's work can be easily integrated into our work.",
        "We leave it as our future work.",
        "3 Training In this section, we present the method of training the DSP model.",
        "The parameters involved in this process include: word embedding, parameters of the two unsupervised RAEs in LNN, and parameters in DSN.",
        "3.1 Max-Margin Framework In DSP model, our goal is to assign higher scores to gold derivations, and lower scores to bad ones.",
        "To reach this goal, we adopt a max-margin framework (Socher et al., 2010; Socher et al., 2011a; Socher et al., 2013) for training.",
        "Specifically, suppose we have a training data like (u i ,G(u i ),A(u i )), where u i is the input source sentence, G(u i ) is the gold derivation set containing all gold derivations of u i 1 , and A(u i ) is the possible derivation set that contains all possible derivations of u i .",
        "We want to minimize the following regularized risk function: J(?)",
        "= 1 N N ?",
        "i=1 R i (?)",
        "+ ?",
        "2 ?",
        "?",
        "?",
        "2 , where R i (?)",
        "= max ?",
        "d?A(u i ) ( s ( ?, u i , ?",
        "d ) + ?",
        "( ?",
        "d,G(u i ) ) ) ?",
        "max d?G(u i ) ( s ( ?, u i , d ) ) (6) Here, ?",
        "is the model parameter.",
        "s(?, u i , d) is the DSP score for sentence u i 's derivation d. It is computed by summing LNN score (Equation (2)) and DSN score (Equation (5)): s(?, u, d) = LNN ?",
        "(d) +DSN ?",
        "(d) (7) ?",
        "( ?",
        "d,G(u i )) is the structure loss margin, which penalizes derivation ?",
        "d more if it deviates more from gold derivations.",
        "It is formulated as: ?",
        "( ?",
        "d,G(u i ) ) = ?",
        "pi?",
        "?",
        "d ?",
        "s ?",
        "{pi 6?",
        "G(u i )}+ ?",
        "t Dist(y( ?",
        "d), ref) (8) The margin includes two parts.",
        "For the first part, pi is the source span in derivation ?",
        "d, ?",
        "{?}",
        "is an indicator function.",
        "We use the first part to count the number of source spans in derivation ?",
        "d, but not in gold derivations.",
        "The second part is for target side.",
        "Dist(y( ?",
        "d), ref) computes the edit-distance between the translation result y( ?",
        "d) defined by derivation ?",
        "d and the reference translation ref .",
        "Obviously, this margin can effectively estimate the difference between derivation ?",
        "d and gold derivations, both on source side and target side.",
        "Note that ?",
        "s and ?",
        "t are only two hyperparameters for scaling.",
        "They are independent of each other, and we set ?",
        "s = 0.1 and ?",
        "t = 0.1 respectively.",
        "1 We investigate the general case here and suppose that one sentence could have several different gold derivations.In the experiment, we only use one gold derivation for simple implementation.",
        "781 3.2 Learning As the risk function, Equation (6) is not differentiable.",
        "We train the model via the subgradient method (Ratliff et al., 2007; Socher et al., 2013).",
        "For parameter ?, the subgriadient of J(?)",
        "is: ?J ??",
        "= 1 N ?",
        "i ?s(?, u i , ?",
        "d m ) ??",
        "?",
        "?s(?, u i , d m ) ??",
        "+??",
        "where ?",
        "d m is the derivation with the highest DSP score, and d m denotes the gold derivation with the highest DSP score.",
        "We adopt the diagonal variant of AdaGrad (Duchi et al., 2011; Socher et al., 2013) to minimize the risk function for training.",
        "3.3 Training Instances Collection In order to train the model, we need to collect the gold derivation set G(u i ) and possible derivation set A(u i ) for input sentence u i .",
        "For G(u i ) , we define it by force decoding derivation (FDD).",
        "Basically, FDD refers to the derivation that produces the exact reference translation (single reference in our training data).",
        "For example, since ?Bush held a talk with Sharon?",
        "is the reference of test sentence ???",
        "?",
        "?9 ?",
        "1 ?!",
        "?, then Figure 1(a) is one of the FDDs.",
        "As FDD can produce reference translation, we believe that FDD is of high quality, and take them as gold derivations for training.",
        "For A(u i ), it should contain all possible derivations of u i .",
        "However, it is too difficult to obtain all derivations.",
        "Thus, we use n-best derivations of SMT decoding to simulate the complete derivation space, and take them as the derivations in A(u i ).",
        "4 Integrating the DSP Model into SMT To integrate the DSP model into decoding, we take it (named DSP feature) as one of the features in the log-linear framework of SMT.",
        "During decoding, the DSP feature is distributed to each node in the derivation structure.",
        "For the leaf node, the score in Equation (2), i.e., LNN score, serves as the feature.",
        "For the non-leaf node, Equation (4) plays the role.",
        "In order to give positive feature value to the log-linear framework (for logarithm), we normalize the DSP scores to [0,1] during decoding.",
        "Due to the length limit, we ignore the specific normalization methods here.",
        "We just preform some simple transformations (such as adding a constant, computing reciprocal), and convert the scores proportionally to [0,1] at last.",
        "5 Experiments 5.1 Experimental Setup To verify the effectiveness of our DSP model, we perform experiments on Chinese-to-English translation.",
        "The training data contains about 2.1M sentence pairs with about 27.7M Chinese words and 31.9M English words 2 .",
        "We train a 5-gram language model by the Xinhua portion of Gigaword corpus and the English part of the training data.",
        "We obtain word alignment by GIZA++, and adopt the grow-diag-final-and strategy to generate the symmetric alignment.",
        "We use NIST MT 2003 data as the development set, and NIST MT04-08 3 as the test set.",
        "We use MERT (Och, 2004) to tune parameters.",
        "The translation quality is evaluated by case-insensitive BLEU-4 (Papineni et al., 2002).",
        "The statistical significance test is performed by the re-sampling approach (Koehn, 2004).",
        "The baseline system is our in-house BTG system (Wu, 1997; Xiong et al., 2006; Zhang and Zong, 2009).",
        "To train the DSP model, we first use Word2Vec 4 toolkit to pre-train the word embedding on large-scale monolingual data.",
        "The used monolingual data contains about 1.06B words for Chinese and 1.12B words for English.",
        "The dimensionality of our vectors is 50.",
        "The detiled training process is as follows: (1) Using the BTG system to perform force decoding on FBIS part of the bilingual training data 5 , and collect the sentences succeeded in force decoding (86,902 sentences in total) 6 .",
        "We then collect the corresponding force decoding derivations as gold derivations.",
        "Here, we only use the best force decoding derivation for simple implementation.",
        "In future, we will try to use multiple force decoding derivations for training.",
        "(2) Collecting the bilingual phrases in the leaf nodes of gold derivations.",
        "We train LNN by these phrases via L-BFGS algorithm.",
        "Finally, we get 351,448 source phrases to train the source side RAE and 370,948 target phrases to train the target side RAE.",
        "2 LDC category number : LDC2000T50, LDC2002E18, LDC2003E07, LDC2004T07, LDC2005T06, LDC2002L27, LDC2005T10 and LDC2005T34.",
        "3 For MT06 and MT08, we only use the part of news data.",
        "4 https://code.google.com/p/word2vec/ 5 Here we only use the high quality corpus FBIS to guarantee the quality of force decoding derivation.",
        "6 Many sentence pairs fail in forced decoding due to many reasons, such as reordering limit, noisy alignment, and phrase length limit (Yu et al., 2013).",
        "782 (3) Decoding the 86902 sentences by the BTG system to get n-best translations and corresponding derivations.",
        "The n-best derivations are used to simulate the entire derivation space.",
        "We retain at most 200-best derivations for each sentence.",
        "(4) Leveraging force decoding derivations and n-best derivations to train the DSP model.",
        "Note that all parameters, including word embedding and parameters in LNN and DSN, are tuned together in this step.",
        "It takes about 15 hours to train the entire network using a 16-core, 2.9 GHz Xeon machine.",
        "5.2 Experimental Results We compare baseline BTG system and the DSP-augmented BTG system in this section.",
        "The final translation results are shown in Table 1.",
        "After integrating the DSP model into BTG sys-tem, we get significant improvement on all test sets, about 1.0 BLEU points over BTG system on average.",
        "This comparison strongly demonstrates that our DSP model is useful and will be a good complement to current translation models.",
        "Systems BLEU(%) MT04 MT05 MT06 MT08 Aver BTG 36.91 34.69 33.83 27.17 33.15 BTG+DSP 37.41 35.77 35.08 28.42 34.17 Table 1: Final translation results.",
        "Bold numbers denote that the result is significantly better than baseline BTG system (p < 0.05).",
        "Column ?Aver?",
        "gives the average BLEU points of the 4 test sets.",
        "To have a better intuition for the effectiveness of our DSP model, we give a case study in Figure 4.",
        "It depicts two derivations built by BTG system and BTG+DSP system respectively.",
        "From Figure 4(b), we can see that BTG system yields a bad translation due to the bad derivation structure.",
        "In the figure, BTG system makes three mistakes.",
        "It attaches candidates [??",
        "; achieve-ments], [?",
        "?\u0014 \u001b; has reached] and [#\\?",
        "; singapore] to the big candidate [?U\u001a\b?n ?\b,; cannot be regarded as a natural].",
        "Conse-quently, the noun phrase ?#\\?",
        "?",
        "?\u0014 \u001b ?",
        "??",
        "is translated separately, rather than as a whole, leading to a bad translation.",
        "Differently, the DSP model is designed for predicting good derivations.",
        "In Figure 4(c), the used translation rules are actually similar to Figure 4(b).",
        "However, under a better guidance to build good derivation structure, BTG+DSP system generates a much better translation result than BTG system.",
        "(c) an example derivation structure generated by the DSP+BTG system ?",
        "??",
        "?",
        "has reached ??",
        "achievements ?",
        "?",
        "?",
        "?",
        "?cannot be regarded as a ????",
        "natural ?",
        "?",
        "?",
        "??",
        "????",
        "cannot be regarded as a natural ??",
        "?",
        "?",
        "?",
        "??",
        "????",
        "achievements cannot be regarded as a natural ?",
        "??",
        "?",
        "??",
        "?",
        "?",
        "?",
        "??",
        "????",
        "has reached achievements cannot be regarded as a natural ???",
        "?",
        "??",
        "?",
        "??",
        "?",
        "?",
        "?",
        "??",
        "????",
        "singapore has reached achievements cannot be regarded as a natural ??",
        "?singapore ?",
        "??",
        "?attained by ?",
        "?",
        "?",
        "?",
        "?cannot be regarded as a ????",
        "natural ?",
        "?",
        "?",
        "??",
        "???",
        "?cannot be regarded as a natural ???",
        "?",
        "??",
        "?",
        "??",
        "?",
        "?",
        "?",
        "??",
        "????",
        "the achievements attained by singapore cannot be regarded as a natural ??",
        "?singapore ???",
        "?",
        "??",
        "?attained by singapore ?",
        "?the achievements ???",
        "?",
        "??",
        "?",
        "?",
        "?the achievements attained by singapore (b) an example derivation structure generated by BTG system ??",
        "?x inj iap o ?",
        "??",
        "?suo dadao de ?",
        "?c heng j iu ?",
        "?",
        "?",
        "?",
        "?bu neng bei dangzuo ????",
        "lisuodangran sing ap ore reac hed the ac hiev em ents c annot b e taken f or g ranted (a) the example test sentence and its corresponding reference.",
        "Figure 4: Different derivation structures.",
        "6 Conclusion In this paper, we explored the method of derivation structure prediction for SMT.",
        "To fulfill this task, we have made several major efforts as follows: (1) We propose a novel derivation structure prediction model based on RNN, including two close and interactive parts: LNN and DSN.",
        "(2) We extend monolingual RNN to bilingual RNN to represent the derivation structure.",
        "(3) We train LNN and DSN by derivations from force decoding.",
        "In this way, the DSP model learns a preference to good derivation structures.",
        "Experimental results show that the proposed DSP model improves the translation performance significantly.",
        "By this, we verify the effectiveness of derivation structure on indicating good translations.",
        "We believe that our work will shed new lights to SMT decoding.",
        "Acknowledgement We would like to thank the three anonymous reviewers for their valuable comments and suggestions.",
        "The research work has been partially funded by the Natural Science Foundation of China under Grant No.",
        "61333018 and 61303181, and the Key Project of Knowledge Innovation Program of Chinese Academy of Sciences.",
        "783 References"
      ]
    }
  ]
}
