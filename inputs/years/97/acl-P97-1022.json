{
  "info": {
    "authors": [
      "Stephen A. Della Pietra",
      "Mark Epstein",
      "Salim Roukos",
      "Todd Ward"
    ],
    "book": "Annual Meeting of the Association for Computational Linguistics",
    "id": "acl-P97-1022",
    "title": "Fertility Models for Statistical Natural Language Understanding",
    "url": "https://aclweb.org/anthology/P97-1022",
    "year": 1997
  },
  "references": [
    "acl-H90-1021",
    "acl-J93-2003",
    "acl-P96-1008"
  ],
  "sections": [
    {
      "text": [
        "Abstract model p, Several recent efforts in statistical natural language understanding (NLU) have focused on generating clumps of English words from semantic meaning concepts (Miller et al., 1995; Levin and Pierac-cini, 1995; Epstein et al., 1996; Epstein, 1996).",
        "This paper extends the IBM Machine Translation Group's concept of fertility (Brown et al., 1993) to the generation of clumps for natural language understanding.",
        "The basic underlying intuition is that a single concept may be expressed in English as many disjoint clump of words.",
        "We present two fertility models which attempt to capture this phenomenon.",
        "The first is a Poisson model which leads to appealing computational simplicity.",
        "The second is a general nonparametric fertility model.",
        "The general model's parameters are bootstrapped from the Poisson model and updated by the EM algorithm.",
        "These fertility models can be used to impose clump fertility structure on top of preexisting clump generation models.",
        "Here, we present results for adding fertility structure to uni-gram, bigram, and headword clump generation models on ARPA's Air Travel Information Service (ATIS) domain."
      ]
    },
    {
      "heading": "1 Introduction",
      "text": [
        "The goal of a natural language understanding (NLU) system is to interpret a user's request and respond with an appropriate action.",
        "We view this interpretation as translation from a natural language expression, E, into an equivalent expression, F, in an unambigous formal language.",
        "Typically, this formal language will be hand-crafted to enhance performance on some task-specific domain.",
        "A statistical NLU system translates a request E as the most likely formal expression P according to a probability P arg max p(FIE)--= arg max p(F, E).",
        "over all F over all F We have previously built a fully automatic statistical NLU system (Epstein et al., 1996) based on the source-channel factorization of the joint distribution p(F,",
        "This factorization, which has proven effective in speech recognition (Bahl, Jelinek, and Mercer, 1983), partitions the joint probability into an a priori intention model p(F), and a translation model p(EIF) which models how a user might phrase a request F in English.",
        "For the ATIS task, our formal language is a minor variant of the NL-Parse (Hemphill, Godfrey, and Doddington, 1990) used by ARPA to annotate the ATIS corpus.",
        "An example of a formal and natural language pair is:",
        "• F: List flights from New Orleans to Memphis flying on Monday departing early_morning • E: do you have any flights going to Memphis leaving New Orleans early Monday morning",
        "Here, the evidence for the formal language concept `early_rnorning' resides in the two disjoint clumps of English 'early' and 'morning'.",
        "In this paper, we introduce the notion of concept fertility into our translation models p(EIF) to capture this effect and the more general linguistic phenomenon of embedded clauses.",
        "Basically, this entails augmenting the translation model with terms of the form p(n I f), where n is the number of clumps generated by the formal language word f. The resulting model can be trained automatically from a bilingual corpus of English and formal language sentence pairs.",
        "Other attempts at statistical NLU systems have used various meaning representations such as concepts in the AT&T system (Levin and Pieraccini, 1995) or initial semantic structure in the BBN system (Miller et al., 1995).",
        "Both of these systems require significant rule-based transformations to produce disambiguated interpretations which are then",
        "used to generate the SQL query for ATIS.",
        "More recently, BBN has replaced handwritten rules with decision trees (Miller et al., 1996).",
        "Moreover, both systems were trained using English annotated by hand with segmentation and labeling, and both systems produce a semantic representation which is forced to preserve the time order expressed in the English.",
        "Interestingly, both the AT&T and BBN systems generate words within a clump according to bigram models.",
        "Other statistical approachs to NLU include decision trees (Kuhn and Mori, 1995) and neural nets (Gorin et al., 1991).",
        "In earlier IBM translation systems (Brown et al., 1993) each English word would be generated by, or \"aligned to\", exactly one formal language word.",
        "This mapping between the English and formal language expressions is called the \"alignment\".",
        "In the simplest case, the translation model is simply proportional to the product of word-pair translation probabilities, one per element in the alignment.",
        "In these models, the alignment provides all of the structure in the translation model.",
        "The alignment is a \"hidden\" quantity which is not annotated in the training data and must be inferred indirectly.",
        "The EM algorithm (Dempster, Laird, and Rubin, 1977) used to train such \"hidden\" models requires us to sum an expression over all possible alignments.",
        "These early models were developed for French to English translation.",
        "However, in NLU there is a fundamental asymmetry between the natural language and the unambiguous formal language.",
        "Most notably, one formal language word may frequently correspond to whole English phrases.",
        "We added the \"clump\", an extra layer of structure, to accomodate this phenomenon (Epstein et al., 1996).",
        "In this paradigm, formal language words first generate a clumping, or partition, of the word slots of the English expression.",
        "Then, each clump is filled in according to a translation model as before.",
        "The alignment is defined between the formal language words and the clumps.",
        "Then, both the alignment and the clumping are hidden structures which must be summed over to train the models.",
        "Already, these models represent significant progress.",
        "They learn automatically from a bilingual corpus of English and formal language sentences.",
        "They do not require linguistically knowledgeable experts to tediously annotate a training corpus.",
        "Rather, they rely upon a group of translators with significantly less linguistic knowledge to produce a bilingual training corpus.",
        "The fertility models introduced below maintain these benefits while slightly improving performance."
      ]
    },
    {
      "heading": "2 Fertility Clumping Translation Models",
      "text": [
        "The rationale behind a clumping model is that the input English can be clumped or bracketed into phrases.",
        "Each clump is then generated from a single formal language word using a translation model.",
        "The notion of what constitutes a natural clumping depends on the formal language.",
        "For example, suppose the English sentence were: I want to fly to Memphis please.",
        "If the formal language for this sentence were: LIST FLIGHTS TO LOCATION, then the most plausible clumping would be: [I want] [to fly] [to] [Memphis] [please], for which we would expect \"[I want]\" and \"[please]\" to be generated from \"LIST\", \"[to fly]\" from \"FLIGHTS\", \"[to]\" from \"TO, and \"[Memphis]\" from LOCATION.",
        "Similarly, if the formal language were: LIST FLIGHTS DESTINATION_LOC then the most natural clumping would be: [I want] [to fly] [to Memphis] [please], in which we would now expect \"[to Memphis]\" to be generated by \"DESTINATION_LOC\" .",
        "Although these clumpings are perhaps the most natural, neither the clumping nor the alignment is annotated in our training data.",
        "Instead, both the alignment and the clumping are viewed as \"hidden\" quantities for which all values are possible with some probability.",
        "The EM algorithm is used to produce a maximum likelihood estimate of the model parameters, taking into account all possible alignments and clumpings.",
        "In the discussion of fertility models we denote an English sentence by E, which consists of i(E) words.",
        "Similarly, we denote the formal language by F, a tuple of order i(F), whose individual elements are denoted by fj.",
        "A clumping for a sentence partitions",
        "E into a tuple of clumps C. The number of clumps in C is denoted by 1(C), and is an integer in the range 1 • • • 1(E).",
        "A particular clump is denoted by • where i E {1• • •1(C)}.",
        "The number of words in • is denoted by t(ci).",
        "c1 begins at the first word",
        "in the sentence, and ct(c) ends at the last word in the sentence.",
        "The clumps form a proper partition of E. All the words in a clump c must align to the same f. An alignment between E and F determines which f generates each clump of E in C. Similarly, A denotes the alignment, with 1(A) = 1(C), and the ai denote the formal language word to which each e in ci align.",
        "The individual words in a clump c are represented by el • • et().",
        "For all fertility models, the fundamental parameters are the joint probabilities p(E, C, A, F).",
        "Since the clumping and alignment are hidden, to compute the probability that E is generated by F, one calculates:"
      ]
    },
    {
      "heading": "3 General and Poisson Fertility",
      "text": [
        "In the general fertility model, the translation probability with \"revealed\" alignment and clumping is",
        "where p(ni I fi) is the fertility probability of generating ni clumps by formal word f. Note that E ni = L. The factorial terms combine to give an inverse multinomial coefficient which is the uniform probability distribution for the alignment A of F to C. It appears that the computation of the likelihood, which is the sum of gF)(P(F) 1)1(E)-1 product terms, is exponential.",
        "Although dynamic programming can reduce the complexity, there remain an exponentially large number of terms to evaluate in each iteration of the EM algorithm.",
        "We resort to a top-N approximation to the EM sum for the general model, summing over candidate clumpings and alignments proposed by the Poisson fertility model developed below.",
        "If one assumes that the fertility is modeled by the Poisson distribution with mean fertility Af",
        "q(c I f) = where Ain has been absorbed into the effective clump score q(c I f).",
        "In this form, it is particularly simple to explicitly sum over all alignments A to obtain p(E, C I F) by repeated application of the distributive law.",
        "The resulting polynomial time expressions are:",
        "The i(C I F) values for all possible clumpings can be calculated in 0(i(E)2((F)) time if the maximum clump size is unbounded, and in 0(i(E)E(F)) if bounded.",
        "The Viterbi decoding algorithm (For-ney, 1973) is used to calculate p(E j L, F) from these expressions.",
        "The Viterbi algorithm produces a score which is the sum over all possible clumpings for a fixed L. This score must then normalized by the exp( – Ef(Fi) Af, )/L!",
        "factor.",
        "The EM count accumulation is done using an adaptation of the Baum-Welch algorithm (Baum, 1972) which searches through the space of all possible clumpings, first considering 1 clump, then 2, and so forth.",
        "Initial values for p(e I f) are bootstrapped from Model 1 (Epstein et al., 1996) with the initial mean fertilities Af set to 1.",
        "We also fixed the maximum clump size at 5 words.",
        "Empirically, we found it beneficial to hold the p(e I f) parameters fixed for 20 iterations to allow the other parameters to train to reasonable values.",
        "After training, the translation probabilities and clump lengths are smoothed using deleted interpolation (Bahl, Jelinek, and Mercer, 1983).",
        "Since we have been unable to find a polynomial time algorithm to train the general fertility model, we use the Poisson model to \"expose\" the hidden alignments.",
        "The Poisson fertility model gives the most likely 1000 clumpings and alignments, which are then rescored according to the current general fertility model parameters.",
        "This gives fractional counts for each of the 1000 alignments, which are then used to update the the general fertility model parameters."
      ]
    },
    {
      "heading": "4 Improved Clump Modeling",
      "text": [
        "In both the Poisson and general fertility models, the computation of p(cIf) in equation 2 uses a unigram model.",
        "Each English word ei is generated with probability p(ei IL).",
        "Two more powerful modeling techniques for modeling clump generation are n-gram language models (Miller et al., 1995; Levin and Pier-accini, 1995; Epstein, 1996), and headword language models (Epstein, 1996).",
        "A bigram language model uses:",
        "where bdy is a special marker to delimit the beginning and end of the clump.",
        "A headword language model uses two unigram models, a headword model and a non-headword model.",
        "Each clump is required to have a headword.",
        "All other words are non-headwords.",
        "The identity of a clump's headword is hidden, hence it is necessary n!",
        "then a polynomial time training algorithm exists.",
        "The simplicity arises from the fortuitous cancellation of n!",
        "between the Poisson distribution and the uniform alignment probability.",
        "Substituting equation 3 into equation 1 yields:"
      ]
    },
    {
      "heading": "5 Example Fertilities",
      "text": [
        "To illustrate how well fertility captures simple cases of embedding, trained fertilities are shown in table 1 for several formal language words denoting time intervals.",
        "As expected, \"early_rnorning\" dominantly produces two clumps, but can produce either one or three clumps with reasonable probability.",
        "\"morning\" and \"afternoon\" train to comparable fertilities and preferentially generate a single clump.",
        "Another interesting case is the formal language token \"List\" which trains to a A of 0.62 indicating that it frequently generates no English text.",
        "As a further check, the A values for \"from\", \"to\", and the two special classed words \"CITY-1\" and \"CITY-2\" are near 1, ranging between 0.96 and 1.17.",
        "Some trained translation probabilities are shown for the unigram and headword models in table 2.",
        "The formal language words have captured reasonable English words for their most likely translation or headword translation.",
        "However, \"early\" and \"morning\" have fairly undesirable looking second and third choices.",
        "The reason for this is that these undesirable words are frequently adjacent to the English words \"early\" and \"morning\"; hence the training algorithm includes contributions with two word clumps containing these extraneous words.",
        "This is the price we pay for not using supervised training data.",
        "Intriguingly, the headword model is more strongly biased towards the likely translations and has a smoother tail than the unigram model."
      ]
    },
    {
      "heading": "6 Results",
      "text": [
        "The translation models were trained with 5627 context-independent ATIS sentences and smoothed with 600 sentences.",
        "In addition, 3567 training sentences were manually aligned and included in a separate training experiment.",
        "This allows comparison between an unannotated corpus and a partially annotated one.",
        "We employ a trivial decoder and language model since our emphasis is on evaluating the performance of different translation models.",
        "Our decoder is a simple pattern matcher.",
        "That is, we accumulate the different formal language patterns seen in the training set, and score each of them on the test set.",
        "The language model is just the unsmoothed unigram probability distribution of the patterns.",
        "This LM has a 10% chance of not including a test pattern and its use leads to pessimistic performance estimates.",
        "A more general language model for ATIS is presented in (Koppelman et al., 1995).",
        "Answers are generated by an SQL program which is a deterministically constructed from the formal language of our system.",
        "The accuracy of these database answers is measured using ARPA's Common Answer Specification (CAS) metric.",
        "The results are presented in table 3 for ARPA's December 1993 blind test set.",
        "The column headed DEC93 reports results on unsupervised training data, while the column entitled DEC93a contains the results from using models trained on the partially annotated corpus.",
        "The rows correspond to various translation models.",
        "Model 1 is the word-pair translation model used in simple machine translation and understanding models (Brown et al., 1993; Epstein et al., 1996).",
        "The models labeled \"Clump\" use a basic clumped model without fertility.",
        "The models labeled \"Poisson\" and \"General\" use the Poisson and general fertility models presented in this paper.",
        "The \"HW\" and \"BG\" suffixes indicate the results when p(cif) is computed with a headword or bigram model.",
        "The partially annotated corpus provides an increase in performance of about 2-3% for most models.",
        "For General-LM, results increased by 8-10%.",
        "The Poisson and general fertility models show a 2 5% gain in performance over the basic clump model when using the partially annotated corpus.",
        "This is a reduction of the error rate by 10-20%.",
        "The unannotated corpus also shows a comparable gain.",
        "Acknowledgement: This work was sponsored in part by ARPA and monitored by Fort Huachuca HJ1500-4309-0513.",
        "The views and conclusions contained in this document should not be interpreted as representing the official policies of the U.S. Government."
      ]
    }
  ]
}
