{
  "info": {
    "authors": [
      "Ye-Yi Wang",
      "Alex Waibel"
    ],
    "book": "Annual Meeting of the Association for Computational Linguistics",
    "id": "acl-P97-1047",
    "title": "Decoding Algorithm in Statistical Machine Translation",
    "url": "https://aclweb.org/anthology/P97-1047",
    "year": 1997
  },
  "references": [
    "acl-C96-2141",
    "acl-J93-2003"
  ],
  "sections": [
    {
      "heading": "Abstract",
      "text": [
        "Decoding algorithm is a crucial part in statistical machine translation.",
        "We describe a stack decoding algorithm in this paper.",
        "We present the hypothesis scoring method and the heuristics used in our algorithm.",
        "We report several techniques deployed to improve the performance of the decoder.",
        "We also introduce a simplified model to moderate the sparse data problem and to speed up the decoding process.",
        "We evaluate and compare these techniques/models in our statistical machine translation system."
      ]
    },
    {
      "heading": "1 Introduction",
      "text": []
    },
    {
      "heading": "1.1 Statistical Machine Translation",
      "text": [
        "Statistical machine translation is based on a channel model.",
        "Given a sentence T in one language (German) to be translated into another language (English), it considers T as the target of a communication channel, and its translation S as the source of the channel.",
        "Hence the machine translation task becomes to recover the source from the target.",
        "Basically every English sentence is a possible source for a German target sentence.",
        "If we assign a probability P(S I T) to each pair of sentences (S, T), then the problem of translation is to find the source S for a given target T, such that P(S T) is the maximum.",
        "According to Bayes rule,",
        "Since the denominator is independent of S, we have = arg max P(S)P(T I S) (2) Therefore a statistical machine translation system must deal with the following three problems:",
        "• Modeling Problem: How to depict the process of generating a sentence in a source language, and the process used by a channel to generate",
        "a target sentence upon receiving a source sentence?",
        "The former is the problem of language modeling, and the later is the problem of translation modeling.",
        "They provide a framework for calculating P(S) and P(T I S) in (2).",
        "• Learning Problem: Given a statistical language model P(S) and a statistical translation model P(T I S), how to estimate the parameters in these models from a bilingual corpus of sentences?",
        "• Decoding Problem: With a fully specified (framework and parameters) language and translation model, given a target sentence T, how to efficiently search for the source sentence .3 that satisfies (2).",
        "The modeling and learning issues have been discussed in (Brown et al., 1993), where ngram model was used for language modeling, and five different translation models were introduced for the translation process.",
        "We briefly introduce the model 2 here, for which we built our decoder.",
        "In model 2, upon receiving a source English sentence e = el , • • , ei, the channel generates a German sentence g = gi, • • • , gni at the target end in the following way:",
        "1.",
        "With a distribution P(in I e), randomly choose the length m of the German translation g. In model 2, the distribution is independent of m and e:",
        "where is a small, fixed number.",
        "2.",
        "For each position i (0 < i < m) in g, find the corresponding position cti in e according to an alignment distribution P(ai I i, m, e).",
        "In model 2, the distribution only depends on i, ai and the length of the English and German sentences: P(ai I i, a1, m, e) = a(cti I i, m, I) 3.",
        "Generate the word gi at the position i of the German sentence from the English word ea, at",
        "the aligned position ai of gi, according to a translation distribution P(gi I ar e) = t(giI e„,).",
        "The distribution here only depends on gi and ea,.",
        "Therefore, P(g I e) is the sum of the probabilities of generating g from e over all possible alignments A, in which the position i in the target sentence g is aligned to the position a• in the source sentence e:"
      ]
    },
    {
      "heading": "1.2 Decoding in Statistical Machine Translation",
      "text": [
        "(Brown et al., 1993) and (Vogel, Ney, and Tillman, 1996) have discussed the first two of the three problems in statistical machine translation.",
        "Although the authors of (Brown et al., 1993) stated that they would discuss the search problem in a follow-up article, so far there have no publications devoted to the decoding issue for statistical machine translation.",
        "On the other side, decoding algorithm is a crucial part in statistical machine translation.",
        "Its performance directly affects the quality and efficiency of translation.",
        "Without a good and efficient decoding algorithm, a statistical machine translation system may miss the best translation of an input sentence even if it is perfectly predicted by the model."
      ]
    },
    {
      "heading": "2 Stack Decoding Algorithm",
      "text": [
        "Stack decoders are widely used in speech recognition systems.",
        "The basic algorithm can be described as following:",
        "1.",
        "Initialize the stack with a null hypothesis.",
        "2.",
        "Pop the hypothesis with the highest score off the stack, name it as current-hypothesis.",
        "3. if current-hypothesis is a complete sentence, output it and terminate.",
        "4. extend current-hypothesis by appending a word in the lexicon to its end.",
        "Compute the score of the new hypothesis and insert it into the stack.",
        "Do this for all the words in the lexicon.",
        "5.",
        "Go to 2."
      ]
    },
    {
      "heading": "2.1 Scoring the hypotheses",
      "text": [
        "In stack search for statistical machine translation, a hypothesis H includes (a) the length 1 of the source sentence, and (b) the prefix words in the sentence.",
        "Thus a hypothesis can be written as H = 1 : e1e2 • • • ek , which postulates a source sentence of length 1 and its first k words.",
        "The score of H, fH , consists of two parts: the prefix score 9H for e1 e2 • • • ek and the heuristic score hH for the part ek+iek+2 • • el that is yet to be appended to H to complete the sentence."
      ]
    },
    {
      "heading": "2.1.1 Prefix score gH",
      "text": [
        "(3) can be used to assess a hypothesis.",
        "Although it was obtained from the alignment model, it would be easier for us to describe the scoring method if we interpret the last expression in the equation in the following way: each word ei in the hypothesis contributes the amount ct(gi",
        "probability of the target sentence word gi• For each hypothesis H = 1 : e2,• • , ek, we use SH(j) denote the probability mass for the target word gi contributed by the words in the hypothesis:",
        "Extending H with a new word will increase SH(j), 1 < j < m. To make the score additive, the logarithm of the probability in (3) was used.",
        "So the prefix score contributed by the translation model is ET....0 log SH(j).",
        "Because our objective is to maximize P(e, g), we have to include as well the logarithm of the language model probability of the hypothesis in the score, therefore we have",
        "A practical problem arises here.",
        "For a many early stage hypothesis P, Sp(j) is close to 0.",
        "This causes problems because it appears as a denominator in (5) and the argument of the log function when calculating gp.",
        "We dealt with this by either limiting the translation probability from the null word (Brown",
        "et al., 1993) at the hypothetical 0-position(Brown et al., 1993) over a threshold during the EM training, or setting SH,,(j) to a small probability r instead of 0 for the initial null hypothesis Ho.",
        "Our experiments show that r = 10-4 gives the best result."
      ]
    },
    {
      "heading": "2.1.2 Heuristics",
      "text": [
        "To guarantee an optimal search result, the heuristic function must be an upper-bound of the score for all possible extensions ek+iek+2 • • • el (Nilsson, 1971) of a hypothesis.",
        "In other words, the benefit of extending a hypothesis should never be underestimated.",
        "Otherwise the search algorithm will conclude prematurely with a non-optimal hypothesis.",
        "On the other hand, if the heuristic function overestimates the merit of extending a hypothesis too much, the search algorithm will waste a huge amount of time after it hits a correct result to safeguard the optimality.",
        "To estimate the language model score hm of the unrealized part of a hypothesis, we used the negative of the language model perplexity PPtrain on the training data as the logarithm of the average probability of predicting a new word in the extension from a history.",
        "So we have",
        "Here is the motivation behind this.",
        "We assume that the perplexity on training data overestimates the likelihood of the forthcoming word string on average.",
        "However, when there are only a few words to be extended (k is close to 1), the language model probability for the words to be extended may be much higher than the average.",
        "This is why the constant term C was introduced in (6).",
        "When k << 1, – (1 – k)P Ptrain is the dominating term in (6), so the heuristic language model score is close to the average.",
        "This can avoid overestimating the score too much.",
        "As k is getting closer to 1, the constant term C plays a more important role in (6) to avoid underestimating the language model score.",
        "In our experiments, we used C = P Ptrain+10g(Prnax), where Pmar is the maximum ngram probability in the language model.",
        "To estimate the translation model score, we introduce a variable vii (j), the maximum contribution to the probability of the target sentence word gi from any possible source language words at any position between i and 1:",
        "here LE is the English lexicon.",
        "Since vii (j) is independent of hypotheses, it only needs to be calculated once for a given target sentence.",
        "where log(v(k4.1)/ (j)) – log SH(j)) is the maximum increasement that a new word can bring to the likelihood of the j-th target word.",
        "When k = 1, since no words can be appended to the hypothesis, it is obvious that hit = 0.",
        "This heuristic function overestimates the score of the upcoming words.",
        "Because of the constraints from language model and from the fact that a position in a source sentence cannot be occupied by two different words, normally the placement of words in those unfilled positions cannot maximize the likelihood of all the target words simultaneously."
      ]
    },
    {
      "heading": "2.2 Pruning and aborting search",
      "text": [
        "Due to physical space limitation, we cannot keep all hypotheses alive.",
        "We set a constant M, and whenever the number of hypotheses exceeds M, the algorithm will prune the hypotheses with the lowest scores.",
        "In our experiments, M was set to 20,000.",
        "There is time limitation too.",
        "It is of little practical interest to keep a seemingly endless search alive too long.",
        "So we set a constant T, whenever the decoder extends more than T hypotheses, it will abort the search and register a failure.",
        "In our experiments, T was set to 6000, which roughly corresponded to 2 and half hours of search effort."
      ]
    },
    {
      "heading": "2.3 Multi-Stack Search",
      "text": [
        "The above decoder has one problem: since the heuristic function overestimates the merit of extending a hypothesis, the decoder always prefers hypotheses of a long sentence, which have a better chance to maximize the likelihood of the target words.",
        "The decoder will extend the hypothesis with large 1 first, and their children will soon occupy the stack and push the hypotheses of a shorter source sentence out of the stack.",
        "If the source sentence is a short one, the decoder will never be able to find it, for the hypotheses leading to it have been pruned permanently.",
        "This \"incomparable\" problem was solved with multi-stack search(Magerman, 1994).",
        "A separate stack was used for each hypothesized source sentence length 1.",
        "We do compare hypotheses in different stacks in the following cases.",
        "First, we compare a complete sentence in a stack with the hypotheses in other stacks to safeguard the optimality of search result; Second, the top hypothesis in a stack is compared with that of another stack.",
        "If the difference is greater than a constant (S, then the less probable one will not be extended.",
        "This is called soft-pruning, since whenever the scores of the hypotheses in other stacks go down, this hypothesis may revive."
      ]
    },
    {
      "heading": "3 Stack Search with a Simplified Model",
      "text": [
        "In the IBM translation model 2, the alignment parameters depend on the source and target sentence length 1 and m. While this is an accurate model, it causes the following difficulties:",
        "1. there are too many parameters and therefore too few training data per parameter.",
        "This may not be a problem when massive training data are available.",
        "However, in our application, this is a severe problem.",
        "Figure 1 plots the length distribution for the English and German sentences.",
        "When sentences get longer, there are fewer training data available.",
        "2. the search algorithm has to make multiple hypotheses of different source sentence length.",
        "For each source sentence length, it searches through almost the same prefix words and finally settles on a sentence length.",
        "This is a very time consuming process and makes the decoder very inefficient.",
        "To solve the first problem, we adjusted the count for the parameter a(i I j,/, m) in the EM parameter estimation by adding to it the counts for the parameters a(i I j,1', m'), assuming (1, m) and (1', m') are close enough.",
        "The closeness were measured in",
        "where é(i I j,1, m) is the adjusted count for the parameter a(i I j, 1, m), c(i I j, 1, m; e, g) is the expected count for a(i I j,1, m) from a paired sentence (e g), and c(i I j, I, m; e, g) = 0 when lel 0 1, or II m, or i > 1, or j> m. Although (9) can moderate the severity of the first data sparse problem, it does not ease the second inefficiency problem at all.",
        "We thus made a radical change to (9) by removing the precondition that (1, m) and (/', m') must be close enough.",
        "This results in a simplified translation model, in which the alignment parameters are independent of the sentence length I and m:",
        "length allowed in the translation system.",
        "A slight change to the EM algorithm was made to estimate the parameters.",
        "There is a problem with this model: given a sentence pair g and e, when the length of e is smaller than Lm, then the alignment parameters do not sum to 1: let E a(i 1:7) < 1.",
        "(10) i=o We deal with this problem by padding e to length Lm with dummy words that never gives rise to any word in the target of the channel.",
        "Since the parameters are independent of the source sentence length, we do not have to make an",
        "assumption about the length in a hypothesis.",
        "Whenever a hypothesis ends with the sentence end symbol </s> and its score is the highest, the decoder reports it as the search result.",
        "In this case, a hypothesis can be expressed as H = e1, e2, • • • , ek , and IH is used to denote the length of the sentence prefix of the hypothesis H, in this case, k."
      ]
    },
    {
      "heading": "3.1 Heuristics",
      "text": [
        "Since we do not make assumption of the source sentence length, the heuristics described above can no longer be applied.",
        "Instead, we used the following heuristic function:",
        "here hik is the heuristics for the hypothesis that extend H with n more words to complete the source sentence (thus the final source sentence length is IHI n.) Pp(x I y) is the Poisson distribution of the source sentence length conditioned on the target sentence length.",
        "It is used to calculate the mean of the heuristics over all possible source sentence length.",
        "m is the target sentence length.",
        "The parameters of the Poisson distributions can be estimated from training data."
      ]
    },
    {
      "heading": "4 Implementation",
      "text": [
        "Due to historical reasons, stack search got its current name.",
        "Unfortunately, the requirement for search states organization is far beyond what a stack and its push pop operations can handle.",
        "What we really need is a dynamic set which supports the following operations:",
        "1.",
        "INSERT: to insert a new hypothesis into the set.",
        "2.",
        "DELETE: to delete a state in hard pruning.",
        "3.",
        "MAXIMUM: to find the state with the best score to extend.",
        "4.",
        "MINIMUM: to find the state to be pruned.",
        "We used the Red-Black tree data structure (Cor-men, Leiserson, and Rivest, 1990) to implement the dynamic set, which guarantees that the above operations take 0(log n) time in the worst case, where n is the number of search states in the set."
      ]
    },
    {
      "heading": "5 Performance",
      "text": [
        "We tested the performance of the decoders with the scheduling corpus(Suhm et al., 1995).",
        "Around 30,000 parallel sentences (400,000 words altogether for both languages) were used to train the IBM model 2 and the simplified model with the EM algorithm.",
        "A larger English monolingual corpus with around 0.5 million words was used to train a bi-gram for language modelling.",
        "The lexicon contains 2,800 English and 4,800 German words in morphologically inflected form.",
        "We did not do any preprocessing/analysis of the data as reported in (Brown et al., 1992)."
      ]
    },
    {
      "heading": "5.1 Decoder Success Rate",
      "text": [
        "Table 1 shows the success rate of three models/decoders.",
        "As we mentioned before, the comparison between hypotheses of different sentence length made the single stack search for the IBM model 2 fail (return without a result) on a majority of the test sentences.",
        "While the multi-stack decoder improved this, the simplified model/decoder produced an output for all the 120 test sentences."
      ]
    },
    {
      "heading": "5.2 Translation Accuracy",
      "text": [
        "Unlike the case in speech recognition, it is quite arguable what \"accurate translations\" means.",
        "In speech recognition an output can be compared with the sample transcript of the test data.",
        "In machine translation, a sentence may have several legitimate translations.",
        "It is difficult to compare an output from a decoder with a designated translation.",
        "Instead, we used human subjects to judge the machine-made translations.",
        "The translations are classified into three categories'.",
        "1.",
        "Correct translations: translations that are grammatical and convey the same meaning as the inputs.",
        "2.",
        "Okay translations: translations that convey the same meaning but with small grammatical mistakes or translations that convey most but not the entire meaning of the input.",
        "3.",
        "Incorrect translations: Translations that are",
        "ungrammatical or convey little meaningful information or the information is different from the input.",
        "Examples of correct, okay, and incorrect translations are shown in Table 2.",
        "Table 3 shows the statistics of the translation results.",
        "The accuracy was calculate by crediting a correct translation 1 point and an okay translation 1/2 point.",
        "There are two different kinds of errors in statistical machine translation.",
        "A modeling error occurs when the model assigns a higher score to an incorrect translation than a correct one.",
        "We cannot do anything about this with the decoder.",
        "A decoding 'This is roughly the same as the classification in IBM statistical translation, except we do not have \"legitimate translation that conveys different meaning from the in-put\" – we did not observed this case in our outputs.",
        "input German sentence, the second line is the human made (target) translation for that input sentence, and the third line is the output from the decoder.",
        "error or search error happens when the search algorithm misses a correct translation with a higher score.",
        "When evaluating a decoding algorithm, it would be attractive if we can tell how many errors are caused by the decoder.",
        "Unfortunately, this is not attainable.",
        "Suppose that we are going to translate a German sentence g, and we know from the sample that e is one of its possible English translations.",
        "The decoder outputs an incorrect e' as the translation of g. If the score of e' is lower than that of e, we know that a search error has occurred.",
        "On the other hand, if the score of e' is higher, we cannot decide if it is a modeling error or not, since there may still be other legitimate translations with a score higher than e' – we just do not know what they are.",
        "Although we cannot distinguish a modeling error from a search error, the comparison between the decoder output's score and that of a sample translation can still reveal some information about the performance of the decoder.",
        "If we know that the decoder can find a sentence with a better score than a \"correct\" translation, we will be more confident that the decoder is less prone to cause errors.",
        "Table 4 shows the comparison between the score of the outputs from the decoder and the score of the sample translations when the outputs are incorrect.",
        "In most cases, the incorrect outputs have a higher score than the sample translations.",
        "Again, we consider a \"okay\" translation a half error here.",
        "This result hints that model deficiencies may be a major source of errors.",
        "The models we used here are very simple.",
        "With a more sophisticated model, more training data, and possibly some preprocessing, the total error rate is expected to decrease."
      ]
    },
    {
      "heading": "5.3 Decoding Speed",
      "text": [
        "Another important issue is the efficiency of the decoder.",
        "Figure 3 plots the average number of states being extended by the decoders.",
        "It is grouped according to the input sentence length, and evaluated on those sentences on which the decoder succeeded.",
        "The average number of states being extended in the model 2 single stack search is not available for long sentences, since the decoder failed on most of the long sentences.",
        "The figure shows that the simplified model/decoder works much more efficiently than the other mod",
        "els/decoders."
      ]
    },
    {
      "heading": "6 Conclusions",
      "text": [
        "We have reported a stack decoding algorithm for the IBM statistical translation model 2 and a simplified model.",
        "Because the simplified model has fewer Darameters and does not have to posit hypotheses with the same prefixes but different length, it outperformed the IBM model 2 with regard to both accuracy and efficiency, especially in our application that lacks a massive amount of training data.",
        "In most cases, the erroneous outputs from the decoder have a higher score than the human made translations.",
        "Therefore it is less likely that the decoder is a major contributor of translation errors."
      ]
    },
    {
      "heading": "7 Acknowledgements",
      "text": [
        "We would like to thank John Lafferty for enlightening discussions on this work.",
        "We would also like to thank the anonymous ACL reviewers for valuable comments.",
        "This research was partly supported by ATR and the Verbmobil Project.",
        "The views and conclusions in this document are those of the authors."
      ]
    }
  ]
}
