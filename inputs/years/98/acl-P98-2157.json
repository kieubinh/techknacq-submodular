{
  "info": {
    "authors": [
      "Mark-Jan Nederhof",
      "Anoop Sarkar",
      "Giorgio Satta"
    ],
    "book": "COLING-ACL",
    "id": "acl-P98-2157",
    "title": "Prefix Probabilities from Stochastic Free Adjoining Grammars",
    "url": "https://aclweb.org/anthology/P98-2157",
    "year": 1998
  },
  "references": [
    "acl-C88-1075",
    "acl-C92-2066",
    "acl-J91-3004",
    "acl-J95-2002"
  ],
  "sections": [
    {
      "heading": "Abstract",
      "text": [
        "Language models for speech recognition typically use a probability model of the form Pr (an I al , a2, .",
        ".",
        ", an_i) .",
        "Stochastic grammars, on the other hand, are typically used to assign structure to utterances.",
        "A language model of the above form is constructed from such grammars by computing the prefix probability EwEE.",
        "Pr(ai • • anw), where w represents all possible terminations of the prefix al • • an• The main result in this paper is an algorithm to compute such prefix probabilities given a stochastic Tree Adjoining Grammar (TAG).",
        "The algorithm achieves the required computation in 0(n6) time.",
        "The probability of sub-derivations that do not derive any words in the prefix, but contribute structurally to its derivation, are precomputed to achieve termination.",
        "This algorithm enables existing corpus-based estimation techniques for stochastic TAGs to be used for language modelling."
      ]
    },
    {
      "heading": "1 Introduction",
      "text": [
        "Given some word sequence al • • • an_i, speech recognition language models are used to hypothesize the next word an, which could be any word from the vocabulary E. This is typically done using a probability model Pr(anlai, , an_i).",
        "Based on the assumption that modelling the hidden structure of nat",
        "• Part of this research was done while the first and the",
        "third authors were visiting the Institute for Research in Cognitive Science, University of Pennsylvania.",
        "The first author was supported by the German Federal Ministry of Education, Science, Research and Technology (BMBF) in the framework of the VERBMOBIL Project under Grant 01 IV 701 VU, and by the Priority Programme Language and Speech Technology, which is sponsored by NWO (Dutch Organization for Scientific Research).",
        "The second and third authors were partially supported by NSF grant SBR8920230 and ARO grant DAAH0404-94G-0426.",
        "The authors wish to thank Aravind Joshi for his support in this research.",
        "ural language would improve performance of such language models, some researchers tried to use stochastic context-free grammars (CFGs) to produce language models (Wright and Wrigley, 1989; Jelinek and Lafferty, 1991; Stolcke, 1995).",
        "The probability model used for a stochastic grammar was E„EE.",
        "Pr(ai • • anw).",
        "However, language models that are based on trigram probability models outperform stochastic CFGs.",
        "The common wisdom about this failure of CFGs is that trigram models are lexicalized models while CFGs are not.",
        "Tree Adjoining Grammars (TAGs) are important in this respect since they are easily lexicalized while capturing the constituent structure of language.",
        "More importantly, TAGs allow greater linguistic expressiveness.",
        "The trees associated with words can be used to encode argument and adjunct relations in various syntactic environments.",
        "This paper assumes some familiarity with the TAG formalism.",
        "(Joshi, 1988) and (Joshi and Schabes, 1992) are good introductions to the formalism and its linguistic relevance.",
        "TAGs have been shown to have relations with both phrase-structure grammars and dependency grammars (Rambow and Joshi, 1995), which is relevant because recent work on structured language models (Chelba et al., 1997) have used dependency grammars to exploit their lex-icalization.",
        "We use stochastic TAGs as such a structured language model in contrast with earlier work where TAGs have been exploited in a class-based n-gram language model (Srinivas, 1996).",
        "This paper derives an algorithm to compute prefix probabilities E.EE.",
        "Pr(ai • • • anw).",
        "The algorithm assumes as input a stochastic TAG G and a string which is a prefix of some string in L(G), the language generated by G. This algorithm enables existing corpus-based estimation techniques (Schabes, 1992) in stochastic TAGs to be used for language modelling."
      ]
    },
    {
      "heading": "2 Notation",
      "text": [
        "A stochastic Tree Adjoining Grammar (STAG) is represented by a tuple (NT, E, I, A, 0) where NT is a set of nonterminal symbols, E is a set of terminal symbols, I is a set of initial trees and A is a set of auxiliary trees.",
        "Trees in IU A are also called elementary trees.",
        "We refer to the root of an elementary tree t as R. Each auxiliary tree has exactly one distinguished leaf, which is called the foot.",
        "We refer to the foot of an auxiliary tree t as F. We let ✓ denote the set of all nodes in the elementary trees.",
        "For each leaf N in an elementary tree, except when it is a foot, we define label(N) to be the label of the node, which is either a terminal from E or the empty string E. For each other node N, label (N) is an element from NT.",
        "At a node N in a tree such that label(N) E NT an operation called adjunction can be applied, which excises the tree at N and inserts an auxiliary tree.",
        "Function 0 assigns a probability to each adjunction.",
        "The probability of adjunction oft E A at node N is denoted by 0(t, N).",
        "The probability that at N no adjunction is applied is denoted by 0(nil, N).",
        "We assume that each STAG G that we consider is proper.",
        "That is, for each N such that label (N) E NT,",
        "For each non-leaf node N we construct the string cdn(N) = N1 • - • Nni from the (ordered) list of children nodes NI, ... , N7,2 by defining, for each d such that 1 < d < m, Nd = label(Nd) in case label(Nd) E E U fel, and Nd = Nd otherwise.",
        "In other words, children nodes are replaced by their labels unless the labels are nonterminal symbols.",
        "To simplify the exposition, we assume an additional node for each auxiliary tree t, which we denote by I.",
        "This is the unique child of the actual foot node F. That is, we change the definition of cdn such that cdn(Ft) = _I_ for each auxiliary tree t. We set VI = {N E V I label(N) E NT} U E u {1}.",
        "We use symbols a, b, c,... to range over E, symbols v, w, x,... to range over E*, symbols N, M,... to range over VI, and symbols a03,7,... to range over (V-1-)*.",
        "We use t, ti, ... to denote trees in I U A or subtrees thereof.",
        "We define the predicate dft on elements from V-1-as dft(N) if and only if (i) N E V and N dominates 1, or (ii) N = I.",
        "We extend dft to strings of the form N1... Nrn E (V±)* by defining dft(Ni ... N,n) if and only if there is a d (1 < d < m) such that dft(Nd).",
        "For some logical expression p, we define 8(p) = 1 if p is true, 6(p) = 0 otherwise."
      ]
    },
    {
      "heading": "3 Overview",
      "text": [
        "The approach we adopt in the next section to derive a method for the computation of prefix probabilities for TAGs is based on transformations of equations.",
        "Here we informally discuss the general ideas underlying equation transformations.",
        "Let w = aia2 • • • an E E* be a string and let N E V-L. We use the following representation which is standard in tabular methods for TAG parsing.",
        "An item is a tuple [N, i, j, Ii, 12] representing the set of all trees t such that (i) t is a subtree rooted at N of some derived elementary tree; and (ii) t's root spans from position i to position j in w, t's foot node spans from position Ii to position 12 in w. In case N does not dominate the foot, we set Ii = 12 = – .",
        "We generalize in the obvious way to items [t,i, j, Ii, 12], where t is an elementary tree, and [a, i, j, fi, f2], where cdn(N) = cti3 for some N and O.",
        "To introduce our approach, let us start with some considerations concerning the TAG parsing problem.",
        "When parsing w with a TAG G, one usually composes items in order to construct new items spanning a larger portion of the input string.",
        "Assume there are instances of auxiliary trees t and t' in G, where the yield of t', apart from its foot, is the empty string.",
        "If 0(t, N) > 0 for some node N on the spine of t', and we have recognized an item [Re, i, i, Ii, 12], then we may adjoin t at N and hence deduce the existence of an item [Re, i, j, Ii, 12] (see Fig. 1(a)).",
        "Similarly, if t can be adjoined at a node N to the left of the spine of t' and Ii = 12, we may deduce the existence of an item [Rt,, i, j, j, A (see Fig. 1(b)).",
        "Importantly, one or more other auxiliary trees with empty yield could wrap the tree t' before t adjoins.",
        "Adjunc-tions in this situation are potentially nonterminating.",
        "One may argue that situations where auxiliary trees have empty yield do not occur in practice, and are even by definition excluded in the",
        "case of lexicalized TAGs.",
        "However, in the computation of the prefix probability we must take into account trees with non-empty yield which behave like trees with empty yield because their lexical nodes fall to the right of the right boundary of the prefix string.",
        "For example, the two cases previously considered in Fig. 1 now generalize to those in Fig. 2.",
        "To derive a method for the computation of prefix probabilities, we give some simple recursive equations.",
        "Each equation decomposes an item into other items in all possible ways, in the sense that it expresses the probability of that item as a function of the probabilities of items associated with equal or smaller portions of the input.",
        "In specifying the equations, we exploit techniques used in the parsing of incomplete input (Lang, 1988).",
        "This allows us to compute the prefix probability as a by-product of computing the inside probability.",
        "In order to avoid the problem of nontermination outlined above, we transform our equations to remove infinite recursion, while preserving the correctness of the probability computation.",
        "The transformation of the equations is explained as follows.",
        "For an item I, the span of I, written a(/), is the 4-tuple representing the 4 input positions in I.",
        "We will define an equivalence relation on spans that relates to the portion of the input that is covered.",
        "The transformations that we apply to our equations produce two new sets of equations.",
        "The first set of equations are concerned with all possible decompositions of a given item I into set of items of which one has a span equivalent to that of I and the others have an empty span.",
        "Equations in this set represent endless recursion.",
        "The system of all such equations can be solved independently of the actual input w. This is done once for a given grammar.",
        "The second set of equations have the property that, when evaluated, recursion always terminates.",
        "The evaluation of these equations computes the probability of the input string modulo the computation of some parts of the derivation that do not contribute to the input itself.",
        "Combination of the second set of equations with the solutions obtained from the first set allows the effective computation of the prefix probability."
      ]
    },
    {
      "heading": "4 Computing Prefix Probabilities",
      "text": [
        "This section develops an algorithm for the computation of prefix probabilities for stochastic TAGs."
      ]
    },
    {
      "heading": "4.1 General equations",
      "text": [
        "The prefix probability is given by:",
        "where P is a function over items recursively defined as follows:",
        "ity of all possible trees derived from elementary tree t, having the indicated span over the input.",
        "This is decomposed into the contribution of each single node of t in equations (1) through (6).",
        "In equations (5) and (6) the contribution of a node N is determined by the combination of the inside probabilities of N's children and by all possible adjunctions at N. In (7) we recognize some terminal symbol if it occurs in the prefix, or ignore its contribution to the span if it occurs after the last symbol of the prefix.",
        "Crucially, this step allows us to reduce the computation of prefix probabilities to the computation of inside probabilities."
      ]
    },
    {
      "heading": "4.2 Terminating equations",
      "text": [
        "In general, the recursive equations (1) to (9) are not directly computable.",
        "This is because the value of P([A, i, j, f, f9) might indirectly depend on itself, giving rise to nontermination.",
        "We therefore rewrite the equations.",
        "We define an equivalence relation over spans, that expresses when two items are associated with equivalent portions of the input: (i', , (i, 12) if and only if",
        "We introduce two new functions Pow and P,„ht.",
        "When evaluated on some item I, Piow recursively calls itself as long as some other item I' with a given elementary tree as its first component can be reached, such that cr(/) a(r).",
        "Pow returns 0 if the actual branch of recursion cannot eventually reach such an item F, thus removing the contribution to the prefix probability of that branch.",
        "If item I' is reached, then Pow switches to Papht.",
        "Complementary to Pio., function Pspi,, tries to decompose an argument item I into items I' such that a(I) a-(I').",
        "If this is not possible through the actual branch of recursion, P3 returns 0.",
        "If decomposition is indeed possible, then we start again with Pio.",
        "at items produced by the decomposition.",
        "The effect of this intermixing of function calls is the simulation of the original function P, with Plow being called only on potentially nonterminating parts of the computation, and P12, being called on parts that are guaranteed to terminate.",
        "Consider some derivation tree spanning some portion of the input string, and the associated derivation tree r. There must be a unique elementary tree which is represented by a node in T that is the \"lowest\" one that entirely spans the portion of the input of interest.",
        "(This node might be the root of T itself.)",
        "Then, for each t E A and for each i, j, h,12 such that i < j and i < Ii <12 < j, we must have:",
        "The reason why Piow keeps a record of indices fl and f, i.e., the spanning of the foot node of the lowest tree (in the above sense) on which P1 called, will become clear later, when we introduce equations (29) and (30).",
        "We define Piou,([t,i, j,fi, 12], [t', ff, AD and ( [a, i, fi,121,[t` ,",
        "The definition of Pio,„ parallels the one of P given in §4.1.",
        "In (12), the second term in the right-hand side accounts for the case in which the tree we are visiting is the \"lowest\" one on which P0,,, should be called.",
        "Note how in the above equations Pow must be called also on nodes that do not dominate the footnode of the elementary tree they belong to (cf. the definition of r•:::).",
        "Since no call to Piplit is possible through the terms in (18), (19) and (20), we must set the right-hand side of these equations to 0.",
        "The specification of Pspht([ce,i, fi,12]) is given below.",
        "Again, the definition parallels the one of P given in §4.1.",
        "We can now separate those branches of recursion that terminate on the given input from the cases of endless recursion.",
        "We assume below that PoptitaRt, i,j, 11, AD > 0.",
        "Even if this is not always valid, for the purpose of deriving the equations below, this assumption does not lead to invalid results.",
        "We define a new function Pouter, which accounts for probabilities of sub-derivations that do not derive any words in the prefix, but contribute structurally to its derivation:",
        "We can now eliminate the infinite recursion that arises in (10) and (11) by rewriting",
        "Equations for Pout, will be derived in the next subsection.",
        "In summary, terminating computation of prefix probabilities should be based on equations (31) and (32), which replace (1), along with equations (2) to (9) and all the equations for"
      ]
    },
    {
      "heading": "4.3 Off-line Equations",
      "text": [
        "In this section we derive equations for function Pouter introduced in §4.2 and deal with all remaining cases of equations that cause infinite recursion.",
        "In some cases, function P can be computed independently of the actual input.",
        "For any i < n we can consistently define the following quantities, where t E IUA and a E V1 or cdn(N) = afi for some N and 0:",
        "where f = i if t E A, f = – otherwise, and f = i if dft(a), f = – otherwise.",
        "Thus, Ht is the probability of all derived trees obtained from t, with no lexical node at their yields.",
        "Quantities lit and H, can be computed by means of a system of equations which can be directly obtained from equations (1) to (9).",
        "Similar quantities as above must be introduced for the case i n. For instance, we can set 14 = P([t, n, n, f]), f specified as above, which gives the probability of all derived trees obtained from t (with no restriction at their yields).",
        "FunctionPouter is also independent of the actual input.",
        "Let us focus here on the case 11,12 0 (this enforces (fi, f2) = below).",
        "For any i, j, f, 12 < n, we can consistently define the following quantities.",
        "In the case at hand, Lt,t, is the probability of all derived trees obtained from t such that (i) no lexical node is found at their yields; and (ii) at some 'unfinished' node dominating the foot of t, the probability of the adjunction of t' has already been accounted for, but t' itself has not been adjoined.",
        "It is straightforward to establish a system of equations for the computation of Lt,t, and La,e, by rewriting equations (12) to (20) according to (29) and (30).",
        "For instance, combining (12) and (29) gives (using the above assumptions on fi and f2): Lt,t, = LR,tF 6(t t').",
        "Also, if a 0 E and dft(N), combining (14) and (30) gives (again, using previous assump",
        "tions on Ii and 12; note that the IL's are known terms here): LaN,t' For any i, f2 <n define: rI Va,t, Here Vt,t, is the probability of all derived trees obtained from t with a node dominating the foot node of t, that is an adjunction site for t1 and is 'unfinished' in the same sense as above, and with lexical nodes only in the portion of the tree to the right of that node.",
        "When we drop our assumption on h. and 12, we must (pre)compute in addition terms of the form",
        "are independent of the choice of i, j and fi.",
        "Full treatment is omitted due to length restrictions."
      ]
    },
    {
      "heading": "5 Complexity and concluding remarks",
      "text": [
        "We have presented a method for the computation of the prefix probability when the underlying model is a Tree Adjoining Grammar.",
        "Function P3 is the core of the method.",
        "Its equations can be directly translated into an effective algorithm, using standard functional memoization or other tabular techniques.",
        "It is easy to see that such an algorithm can be made to run in time 0(n6), where n is the length of the input prefix.",
        "All the quantities introduced in §4.3 (He, Lex , etc.)",
        "are independent of the input and should be computed off-line, using the system of equations that can be derived as indicated.",
        "For quantities He we have a non-linear system, since equations (2) to (6) contain quadratic terms.",
        "Solutions can then be approximated to any degree of precision using standard iterative methods, as for instance those exploited in (Stolcke, 1995).",
        "Under the hypothesis that the grammar is consistent, that is Pr(L(G)) = 1, all quantities fi; and 14, evaluate to one.",
        "For quantities Lex and the like, §4.3 provides linear systems whose solutions can easily be obtained using standard methods.",
        "Note also that quantities are only used in the off-line computation of quantities Lt,t, , they do not need to be stored for the computation of prefix probabilities (compare equations for Le,t, with (31) and (32)).",
        "We can easily develop implementations of our method that can compute prefix probabilities incrementally.",
        "That is, after we have computed the prefix probability for a prefix al • • • an, on input an+i we can extend the calculation to prefix al • • anan+1 without having to recompute all intermediate steps that do not depend on This step takes time 0(716).",
        "In this paper we have assumed that the parameters of the stochastic TAG have been previously estimated.",
        "In practice, smoothing to avoid sparse data problems plays an important role.",
        "Smoothing can be handled for prefix probability computation in the following ways.",
        "Discounting methods for smoothing simply produce a modified STAG model which is then treated as input to the prefix probability computation.",
        "Smoothing using methods such as deleted interpolation which combine class-based models with word-based models to avoid sparse data problems have to be handled by a cognate interpolation of prefix probability models."
      ]
    }
  ]
}
