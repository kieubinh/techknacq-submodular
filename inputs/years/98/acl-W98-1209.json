{
  "info": {
    "authors": [
      "Ingo Schellhammer",
      "Joachim Diederich",
      "Michael Towsey",
      "Claudia Brugman"
    ],
    "book": "Workshop on New Methods in Language Processing and Computational Natural Language Learning",
    "id": "acl-W98-1209",
    "title": "Knowledge Extraction and Recurrent Neural Networks: An Analysis of an Elman Network Trained on a Natural Language Learning Task",
    "url": "https://aclweb.org/anthology/W98-1209",
    "year": 1998
  },
  "references": [],
  "sections": [
    {
      "heading": "Abstract",
      "text": [
        "We present results of experiments with Elman recurrent neural networks (Elman, 1990) trained on a natural language processing task.",
        "The task was to learn sequences of word categories in a text derived from a primary school reader.",
        "The grammar induced by the network was made explicit by cluster analysis which revealed both the representations formed during learning and enabled the construction of state-transition diagrams representing the grammar.",
        "A network initialised with weights based on a prior knowledge of the text's statistics, learned slightly faster than the original network."
      ]
    },
    {
      "heading": "1. Introduction",
      "text": [
        "Since their renaissance in the mid-1980s, Artificial Neural Network (ANN) techniques have been successfully applied across a broad spectrum of problem domains such as pattern recognition and function approximation.",
        "However despite these capabilities, to an end user an ANN is an arcane web of interconnected input, hidden, and output units.",
        "Moreover an ANN solution manifests itself entirely as sets of numbers in the form of activation function parameters and weight vectors.",
        "As such a trained ANN offers little or no insight into the process by which it has arrived at a given result nor, in general, the totality of \"knowledge\" actually embedded therein.",
        "This lack of a capacity to provide a \"human comprehensible\" explanation is seen as a clear impediment to a more widespread acceptance of ANNs.",
        "In order to redress this situation, recently considerable effort has been directed towards providing ANNs with the requisite explanation capability.",
        "In particular a number of mechanisms, procedures, and techniques have been proposed and developed to extract the knowledge embedded in a trained ANN as a set of symbolic rules which in effect mimic the behaviour of the ANN.",
        "A recent survey conducted by Andrews et al.",
        "(1995) offered an insight into the modus operandi of a broad cross-section of such techniques.",
        "In this paper we focus on the extraction of grammatical rules from trained Artificial Neural Networks and, in particular, Elman-type recurrent networks (Elman, 1990).",
        "Unlike Giles & Omlin (1993 a,b) who used an ANN to simulate a deterministic Finite State Automaton (FSA) representing a regular grammar, we have extracted FSA's from a network trained on a natural language corpus.",
        "The output of k-means cluster analysis is converted to state-transition diagrams which represent the grammar learned by the network.",
        "We analyse the prediction and generalisation performance of the grammar."
      ]
    },
    {
      "heading": "2. Methods",
      "text": []
    },
    {
      "heading": "2.1. The data",
      "text": [
        "The data for these experiments were obtained from a first-year primary school reader published circa 1950's (Hume).",
        "To keep this initial task simple, sentences with embedded structures (relative clauses) and a length of more than eight words were eliminated.",
        "The resulting corpus consists of 106 sentences ranging from three to eight words in length, average length 5.06 words.",
        "The words were converted to 10 lexical categories, including a sentence boundary marker.",
        "The categories, their abbreviations as used in the text and their percent frequencies are shown in Table 1.",
        "The resulting data consist of a string of 643 categories in 106 sentences.",
        "There are 62 distinct sentence sequences of which 43 occur only once, the rest being replicated.",
        "The maximum replication of any sequence is eightfold.",
        "Where sequences, such as PR,VB,AR, are referred to in the text, AR is the current input, VB the previous input (at time step t-1) and PR the input at time step t-2."
      ]
    },
    {
      "heading": "2.2. The network",
      "text": [
        "Elman simple recurrent networks (SRN), with ten input and ten output units representing the sparse coded lexical categories, were trained on the category sequence.",
        "The task was to predict the next lexical category given the current category.",
        "The networks were trained by standard backpropagation with momentum and state unit activations were NOT reset to zero on presentation of a sentence boundary.",
        "Two networks were trained, one having two hidden units and the other nine, until prediction error stopped declining.",
        "The network with two hidden units had learned 51% of the training data and that with nine hidden units had learned 69% of the data.",
        "By way of comparison, 48%, 62%, 72% and 76% correct predictions could be obtained using bi-, tri-, 4 and 5-gram models of the training data respectively.",
        "At the end of training, the networks performed one pass through the data without learning in order to recover their hidden unit activations.",
        "Cluster analysis of the 642 output vectors was performed by graphical means for the two-hidden unit case and by k-means clustering for the nine-hidden unit case.",
        "Clusters from the latter case were used to prepare FSA's."
      ]
    },
    {
      "heading": "2.3. Cluster Analysis and Preparation of Finite State Automata",
      "text": [
        "(i) K-means cluster analysis software was used to label the 642 hidden unit activation vectors with cluster numbers between 1 and k. Each vector was thus assigned to a state, S\" , where 1 i k and t uniquely identifies the time step for each member of cluster i.",
        "(ii) For every current input, itt and previous state, S , there is a transition to a new state, S ; with a resulting output, ot.",
        "A transition table was created from this data.",
        "(iii) If the same input lead to more than one transition from a given state, the transition having highest frequency was chosen.",
        "Similarly, if any transition brought about by a given input, generated more than one possible output, the most frequent output was chosen.",
        "(iv) The transition rules so derived were used to construct deterministic FSA's having k states corresponding to the k clusters.",
        "We generated ten FSA's with k taking values in the range 6 to 22.",
        "(v) Each automaton was tested on the string of 643 categories used to train the original network.",
        "They were scored for total correct predictions, the fraction of missing transitions and score on the non-missing transitions.",
        "(vi) In some experiments, low frequency transitions (having less than 5 occurrences) were pruned from the automaton and the resulting automaton again tested for its performance on the original data sequence.",
        "Missing transitions were handled by jumping to a predefined 'rescue' state and producing a predefined 'rescue' output.",
        "In the default instance, the rescue state was the state, whose preceding inputs had earliest position in the sentence.",
        "The rescue output was always NN, the category having highest frequency."
      ]
    },
    {
      "heading": "2.4. Weight Initialisation with Domain Knowledge",
      "text": [
        "From an examination of bigram probabilities derived from the data sequence, it was determined that output categories NN and IS have the highest predictive rate.",
        "This knowledge can be used to initialise an Elman network with non-random weights in the expectation that training error should decline more rapidly than if the all the weights are initialised randomly.",
        "We initialised an Ehnan net having 11 hidden units with random weights between – 0.1 and 0.1, and then manually set to a value of +4.0 some of the weights linking the hidden layer to the input units coding for NN and /S.",
        "We refer to these as the set links.",
        "In different trials, we set 0, 1, 5, 8, or 11 of both the NN and /S links in such a way as to minimise the number of hidden units having two set links.",
        "Zero set links means that none of the original random weights were changed."
      ]
    },
    {
      "heading": "3. Results",
      "text": []
    },
    {
      "heading": "3.1. Graphical cluster analysis of the",
      "text": [
        "network having two hidden units.",
        "Graphical cluster analysis for the 2-hidden unit case is shown in Figure 1.",
        "Clusters are labeled with the current input.",
        "There is marked separation of clusters representing the high frequency inputs, NN, VB, /S, PR and IN.",
        "There is overlap of those clusters representing low frequency inputs.",
        "Although only 51% of the training set was learned by the network, there is evidence of further clustering based on the current and previous inputs.",
        "For example, Figure 2 shows cluster formation when NN is the current input and either AR, NN, PR, PS, VB or /S is the previous input.",
        "The PR,NN sub-cluster could be further broken down into sub-sub-clusters, representing the three input sequences /S,PR,NN and IN,PR,NN and VB,PR,NN."
      ]
    },
    {
      "heading": "3.2. Analysis of the FSA's",
      "text": [
        "The performance of FSA's having 6 to 22 states is displayed in Table 2.",
        "The second column gives the total number of transitions permitted by the FSA.",
        "The third column gives the percent prediction score on the training data.",
        "Best score is 60% which compares with 69% of the training data learned by the original Elman network from which the hidden unit activations were obtained.",
        "The total prediction score tends to increase with the number of states.",
        "The fourth column of Table 2 gives the percentage of the 642 transitions in the data not permitted by the FSA's. The number of missing transitions is small, in all but two cases less than 2%.",
        "When a missing transition occurs, the FSA defaults to a 'rescue' state.",
        "The percent correct predictions for non-missing transitions are shown in the rightmost column of Table 2.",
        "They are little different from the total scores in most cases, simply because the number of missing transitions is so few.",
        "The transition diagram for the 8-state FSA is shown in Figure 3.",
        "The table in the top right of the figure shows: (i) the number of visits to each state when the FSA is tested, (ii) the percentage of correct predictions associated with a transition to that state and (iii) the average word-position in the sentence of the inputs leading to that state.",
        "Transitions with thick arrows have a frequency count >20, transitions displayed with thin arrows have a frequency count of 5 to 20 and transitions with a frequency count <5 are not shown to preserve clarity.",
        "The states have been numbered in sequence according to the average word position of their associated inputs.",
        "For example states 2, 6 and 8 all occur following input of the NN category but they are distinguished in cluster analysis by the NN having an average word-position in the sentence of 3.1, 5.7 and 6.5 respectively.",
        "The states having highest correct prediction rate, S7 and S8, are associated with the ends of sentences.",
        "S7 is reached when the last category in a sentence is predicted to be NN and S8 occurs when the end-of-sentence is predicted.",
        "Many of the transitions in the FSA's occur with low frequency and could be pruned with minimal loss of performance.",
        "For example, the FSA with ten states has 45 permitted transitions.",
        "When transitions having a frequency are pruned, the number of missing transitions jumps from 1.7% to 10.28% but the prediction score drops only slightly from 53% to 51% (Table 3).",
        "Finally we look at the effect of the state chosen as the rescue state for the FSA having 10 states.",
        "The default state is the state closest to the beginning of the sentence, in this case state 2.",
        "Schellhammer, Diederich, Towsey and Brugman 76 Knowledge Extraction and Recurrent Neural Nets The percent score of correct predictions is greater only in two other cases, that is when states 7 and 9 are used as the 'rescue' state.",
        "Changing the 'rescue' state also changes the number of transitions that the FSA does not recognise.",
        "However only in the case of rescue state 8 is this number less than for rescue state 2.",
        "It is apparent that a decrease in the number of missing transitions does not necessarily lead to a higher score."
      ]
    },
    {
      "heading": "3.3. Weight initialisation using domain knowledge",
      "text": [
        "Setting links between the hidden layer and the NN and IS input units has a beneficial effect during the early • stages of network training.",
        "As indicated by the faster initial decrease in prediction error, the optimum number of set links from inputs NN and /S was 5 or 8 (Figure 3).",
        "Table 4 The effect of choice of 'rescue' state on the performance of the resulting 10-state FSA.",
        "methods section 2.4 for definition of this term) to the NN and the IS input units.",
        "1, 5 and 8 links means that this number of hidden units has a set link to the NN and /S input units."
      ]
    },
    {
      "heading": "4. Discussion",
      "text": [
        "Although an Elman network with two hidden units could learn only 51% of the training data, nevertheless graphical analysis reveals hierarchical clustering of hidden unit activations.",
        "There are clusters associated with each of the ten word categories (Figure I), although clusters associated with low frequency inputs such as AR, CC and JJ tend to overlap.",
        "Clusters labeled with the high frequency inputs revealed obvious sub-clusters and sub-sub-clusters such as those shown in Figure 2.",
        "In other words, the network had acquired internal representations of temporal sequences of at least length 3.",
        "However because the hidden unit space had such low dimensionality, it could not be partitioned by the output layer to achieve accurate prediction.",
        "An FSA with 18 states derived from k-means clustering of hidden unit activations scored 60% on the original training data (Table 2).",
        "This compares with a score of 69% by the original network and a score of 62% when predicting with a trigram model.",
        "Although in theory, the trigram model requires the calculation of Schellhammer, Diederich, Towsey and Brugman 77 Knowledge Extraction and Recurrent Neural Nets 10,000 transition probabilities, it reduces to 42 transition rules.",
        "This compares with of 62 transitions rules incorporated into the 18-state FSA.",
        "Thus the trigram model is a more compact definition of the grammar.",
        "However, low frequency transitions can be trimmed from the FSA's with minimal loss of performance as is demonstrated for the 10-state FSA in Table 3.",
        "Correct choice of the 'rescue' state is important for the efficient performance of an FSA because it determines the FSA's ability to pick up the sentence structure after a missing transition.",
        "In order to automate the production of FSA's following cluster analysis, we require a heuristic for the choice of 'rescue' state.",
        "Our initial choice, that state whose inputs on average are closest to the beginning of the sentence, seems to be a reasonable heuristic in the absence of other information (Table 4).",
        "Likewise, choosing the highest frequency category (in our case, NN) as the 'rescue' output is also confirmed by our results because the FSA scores achieved on non-missing transitions are not much better than the total scores, despite 10-20% of missing transitions (Table 4).",
        "The use of domain knowledge, such as category frequencies, to bias weight initialisation is successful in reducing error faster in the early stages of learning.",
        "Of course if training is continued for long enough, then any memory of the initial bias will be erased.",
        "Best results were achieved when five links were set (such that no hidden unit had a set link to both the NN and IS inputs) or eight links were set (such that only five hidden units had set links to both the NN and /S inputs)."
      ]
    },
    {
      "heading": "5. Conclusions",
      "text": [
        "This study has demonstrated one method for extracting the knowledge encoded in a trained neural network.",
        "Quite often knowledge extracted from neural networks is in the form of propositional rules (Andrews et al., 1995) but these are not always the most appropriate format for explication of network learning.",
        "For example where the network has been required to induce a grammar, cluster analysis of hidden unit activations and preparation of an FSA is a powerful technique to explicate the learned grammar.",
        "However, for this particular task, there is a trade-off between comprehensibility of the FSA (fewer states means more comprehensible) and its predictive performance compared to the original neural network.",
        "In these experiments an FSA with 18-states performed almost as well as a trigram model.",
        "The trigram model had the advantage of compactness, but the FSA had the advantage of comprehensibility."
      ]
    },
    {
      "heading": "6. References",
      "text": []
    }
  ]
}
